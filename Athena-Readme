----------------------------------------
//2261 by Rayce

・battle.cのdistance() を削除し、unit_distance2() を利用するように変更
・武器タイプの定数を定義してマジックナンバーを避ける
　（battle.c, pc.*, skill.c, status.c, unit.c）
　基本はeAベースですがハンドガンだけは W_REVOLVER → WT_HANDGUN に改名しています
　ついでにdoc/db_ref.txtに少し加筆
・混沌としてる battle_calc_weapon_attack() の整理
	武器の基本ダメージ計算の部分を battle_calc_base_damage() として分離
	それぞれの計算結果はwd構造体に直接代入し、使用する変数を減らすことで見通しを良くする

----------------------------------------
//2260 by Rayce

・gettick() を受け取る変数がunsignedになってなかった部分を修正（mob.c, skill.c, unit.c）
・地面スキルの設置可能最大数を計算するときの処理をまとめて skill_count_unitgroup() を使うように改善
・カイト中の対象にヒールおよび治療の手助けを使うと反射するように修正
　自分自身に使用した場合には反射回数を消費して回復量が0になる
・火炎陣を複数設置不可（古いものを消す）にし、水遁と併用不可に修正
・捕捉中のアンクルスネアについて、予期せぬ誤作動を起こす可能性を潰すために以下のように修正
　　スプリングトラップで破壊不可にしてみる
　　耐久切れのときは即座にスキルユニットを削除する
・月明かりの下でのインターバルを100ms（最小値）に変更

----------------------------------------
//2259 by Rayce

・使われていない宣言 status_get_sevenwind_element をコメントアウト（status.h）
・ソウルリンカースキルを本鯖仕様に近づけるための修正
	reported by 甘栗

　　カアヒ（battle.c）
	-> HPが最大のときは発動しない
	-> SPが減少量以下のときは発生しない（未満ではない）
	-> 攻撃が当たらなくても発動する
	-> 本人にのみ回復エフェクトを出す、番号がわからないのでとりあえずmisceffectの7番
　　テコンミッション（skill.c）
	-> テコンでなくても使用できるが効果が発動しない
	-> 対象モンスターの選択時に MOB_ID_MIN, MOB_ID_MAX を利用するように修正
	-> 理論上無限ループが起こる可能性を修正
　　カイゼル（pc.c）
	-> 一度死亡したことにして全ての処理が完了したあとに復活させる
	-> 復活時に無敵時間をつける
　　カイト（battle.c）
	-> 反射したときはダメージを受けない
	-> 反射した際に攻撃主の攻撃がMiss扱いにならないように修正
	　 反射によってダメージが消失する場合はdamage=0ではなくdamage=-1にしてください
	　 -1のときはダメージパケットを送信しません
	-> ボス属性の相手からの魔法は反射不可
　　エスカ（status.c）
	-> 除算DEFではなく減算DEFが+90
	-> 除算MDEFではなく減算MDEFが90固定

----------------------------------------
//2258 by Rayce

・Readmeの1304に従って2256の送信FIFOの変更を修正（socket.c, clif.c）
		pointed out by 7QLFJSMさん、thx a lot!!
	-> 最小限必要な送信バッファの空きサイズを16384に戻す
	-> clif_guildstorageitemlist(), clif_guildstorageequiplist(), clif_skillinfoblock()
	　 が16KB以上のデータをWFIFOSETする可能性があるので、先にWFIFORESERVEする

・moddb_checkid() でモンスターに英語名がなくても日本語名があればOKとする（mob.c）
・太陽と月と星の憎しみで転生・養子職を指定するとサーバクラッシュするバグを修正（clif.c）
	reported by drumatix

・パケット0x20eの送信方法をクライアントのパケット解析方法に合わせる
　WORD→BYTE+BYTE、詳細はdoc/client_packet.txtへ
・太陽と月と星の憎しみで対象を登録した際に、使用対象ではなく使用者が青く光るように変更してみる
・太陽と月と星の憎しみを1度登録すると変更できないようにし、登録したモンスターを表示するように修正
	clif_hate_info() 追加
・太陽と月と星の感情でMAPをセーブしたときのパケット変更、およびエフェクト追加（from eA）
	clif_feel_saveack() 追加
・新たに太陽と月と星の天使のメッセージが判明したので（type=30）、ついでなので関数だけ用意しておく
　ただし発動条件がある程度判明するまでは効果未実装です
	clif_angel_message() 追加

----------------------------------------
//2257 by 逆毛鰻
　ほったらかしにしていた箇所をよらんさんが直してくれていたので感謝
・vc_make.bat
・vc_clean.bat
	-> VC++ 2005 Express Edition の設定へのパス追記(2ちゃんねるエミュスレ報告より)
	-> 完全にゴミ消去出来てなかったのでdel追記
	-> Microsoft Visual C++ は Microsoft Platform SDKと共に使ってください
・doc/sqllogin.txt
	-> リンク切れだったので少し追記

----------------------------------------
//2256 by Rayce

・送信FIFOについて変更（socket.c）
　Readmeの0879と対比して見てください

　・最小限必要な送信バッファの空きサイズを16384から32768へ拡大
	clif_skillinfoblock() や clif_guildstorageequiplist() から一度に20kB近いパケットが
	WFIFOSETされる可能性があるためサイズを拡大しないと不正アクセスが発生します
　・パケット長が送信バッファの容量を越えていた場合はアクセス違反が起こって危険なので
　　　ソケット切断ではなくサーバ自体を落とすように変更
	「socket: ? wdata lost !!....」が表示されてサーバダウンする場合はこの事例に当てはまります
	 バグ、もしくは不正な攻撃の可能性が考えられますのでエラーメッセージに書かれた情報を提出してください
　・制限サイズを超過したら「socket: ? wdata (?) exceed limited size.」が表示されるようにコメントアウトを解除
	送信バッファに大量のパケットデータが積まれているので、これが表示されたら該当のソケットは切断されます
	socket_athena.confのsend_limit_buffer_sizeの値を大きくすればより大きなパケットを送信できますが
	ラグの原因になるかもしれません

　※ある種試験的なので、やたらと重くなった、あるいはメモリを食われまくるような現象が発生したら報告願います

----------------------------------------
//2255 by Rayce

・script.cについての修正
	-> プレフィックス l（小文字のエル）をコードから完全に除去
	　 今後 l はキャラ一時変数とみなされません
	-> getequipname関数でメモリリークが発生する可能性を修正
	-> getequipcardcnt関数でカードIDが4000〜5000でなくてもカウントするように拡張
	-> guildgetexp命令で負のExp値を指定できるように拡張
	-> 細かい修正

・ギルドの最大LvにMAX_GUILDLEVELを使うように修正（int_guild.c）
・ギルドExpがオーバーフローしてマイナス値にならないように修正（int_guild.c, guild.c）
　蔵側がunsignedに対応してないので0x7fffffffが最大
　上納したExpは見掛け上最大値でストップしますが、上納自体は行われてギルド全体のExpに加算されます
・ギルドExpのキャッシュ guild_expcache_db はtreedbだと大きすぎるのでlinkdbに変更
　GUILD_PAYEXP_LISTは不要になったので削除
・細かい修正（clif.c, intif.c）

・2254で一部のステータス異常が作動しなくなっていた問題を修正（status.c）
	reported by chise

----------------------------------------
//2254 by Rayce

・ギルドの最大メンバー数に関して少し修正（int_guild.c）
・パケット送信用のバッファサイズの修正
　（char.c, int_guild.c, int_party.c, inter.c, login.c, clif.c）
	reported by sanatata

・ステータス異常をセーブデータから復帰したときの挙動を修正（intif.c, skill.c, status.c）
		reported by BBB
	-> intif_parse_LoadStatusChange() で呼び出すstatus_change_start() のflagを4→6に変更
	-> flag+2のとき、AR, WP, OTの効果時間をヒルトバイディングの有無で補正しないように拡張
	-> ジョイントビートをflag+2に対応
	-> スピードポーション系およびSC_INCATK, SC_INCMATKの効果時間を内部で補正しない、ms単位にする
・item_db.txtの修正ついでに更新 from nuge cgi, thx

----------------------------------------
//2253 by Blaze

・忍者・ガンスリンガー転職実装（npc_job_28gunslinger.txt、npc_job_29ninja.txt）
・ハンター転職、ブラックスミス転職修正（npc_job_10blacksmith.txt、npc_job_11hunter.txt）
・忍者・ガンスリンガーのJobEXPテーブル48まで修正（exp.txt）
・map_athena.confに忍者・ガンスリンガー転職追記

----------------------------------------
//2252 by Blaze

・フィゲルクエスト修正（npc_town_hugel.txt、npc_misc_guide.txt）
・グリムトゥースの攻撃範囲を3x3に修正（skill.c）
・water_height更新

----------------------------------------
//2251 by Blaze

・フィゲルNPC・クエスト6種追加（npc_town_hugel.txt）
・フィゲル実装に伴う各種NPC修正（npc_town_airport.txt、npc_misc_guide.txt、npc_misc_inn.txt、npc_misc_zonda.txt）
・map_athena.conf、mapflag、各種warpをフィゲル対応

・忍者・ガンスリンガーのJobステータスを現段階の情報で修正（job_db1.txt）

----------------------------------------
//2250 by Rayce

・2243のケアレスミスを修正（char.c）
・キャラ永続変数保存時はアカウントIDの照合をするように強化（char.c, chrif.c）

・pc_checkitem() の宣言が重複していたのを修正（pc.h）
・MVPアイテム取得時に重量オーバーだった場合、メッセージを送信するように修正（clif.*, mob.c）
・doc/client_packet.txtにFreyaからの情報を追記

----------------------------------------
//2249 by Rayce

・2192でコメントアウトしたアスムと魂に関する部分を戻し（status.c）
　opt3系スキルをセーブデータから復帰させたときにエフェクトを表示する必要が出てきたためです
・2243の気になったとこを修正
・ディボーションのスキルLvが6以上のときにバッファオーバーフローするのを修正（skill.c）
・サンドマンとクレイモアトラップの発動範囲を3x3に変更（skill.c）
　効果範囲はソース側で補正しているので5x5のまま変更なし
	reported by C

----------------------------------------
//2248 by Rayce

・OnPCLoginイベントの実行をMAPロード完了後に行うように修正（clif.c, pc.c）
　イベント開始時にアカウント変数やホムのデータが参照できなかった不具合が解消されます
・battle_athena.confから wedding_relog, wedding_time を削除（clif.c, battle.*, status.c）
　PC_WEDDING_TIMEを使わないように変更、relog判定はdb/scdata_db.txtで行ってください
・マグナムブレイク中は火属性攻撃ダメージの20%が加算されるように修正（battle.c）

----------------------------------------
//2247 by Rayce

・ステータス異常セーブ実装
・int_status.*追加
・デフォルトでは有効になっています、無効にしたい人はNO_SCDATA_SAVINGのスイッチをオンにしてください
・セーブデータはTXTならsave/scdata.txtに、SQLならstatus_changeテーブルに保存されます
・セーブできる状態異常の個別設定はdb/scdata_db.txtで行います
・2243で通信量の削減をしたのでそこまで負荷は掛からないと思いますが、出来る限り無駄な処理を削減する方針を取りました
　そのためint_status.cで色々手を加えてます
・conveter対応済み
・Journalは相変わらず自信がありません

　※db/scdata_db.txtのSaveFlagが-1となっているものについては基本的に1に変更してはいけません
　　ソース内部で抑制はしないことにしたので、変更すると即座に不具合に繋がります
　※-1の設定はある程度やりましたが、抜けがあるかもしれません
　　また0/1の判定は本鯖をもうほとんど忘れているので適当です、どなたか修正お願いします

----------------------------------------
//2246 by Blaze

・2242の一部クエストを修正（npc_town_lighthalzen.txt、npc_town_einbroch.txt、npc_town_airport.txt）
・フィゲルまでのクエストアイテムのドロップ等処理を適応（item_db2.txt）
・ガンバンテインのディレイを2秒→5秒に修正（skill_cast_db.txt）
・ソウルリンカーのJobテーブルが拳聖と一緒だったのを修正（pc.c）

----------------------------------------
//2245 by Rayce

・2244を少し修正（pc.c）
・inter_athena.configのホムに関する設定が読み込まれてなかったのを修正（inter.c）
・homun_txt_save() を少し修正（int_homun.c）
・doc/inter_server_packet.txtおよびdoc/serverlink_packet.txtの整理（chrif.c, intif.c）
・ステータス異常セーブ実装の前準備（status.*）
　db/scdata_db.txt追加

・SQL: converter-txtを2243のmmo_charstatus構造体変更に対応（char-converter.*）

　※次回SnapShotのときにdoc/sc_start.txtの削除をお願いします

----------------------------------------
//2244 By Stinger

・@allskillでテコン・ケンセイ・リンカー・ガンスリンガー・忍者が表示されないバグを修正。
(シュガーレスさんの書き込みをそのままパッチ化しました。)
----------------------------------------
//2243 by Rayce

・mmo_charstatus構造体の見直し
　（char.*, int_mail.c, inter.c, mmo.h, chrif.c, intif.c, map.h, pc.*）
	-> mmo_charstatus構造体からグローバル変数の部分を切り離し、registry構造体として定義
	-> キャラ鯖に送信されるキャラデータのパケットサイズが約4KB（25%）削減されます
	-> グローバル変数は変更があったときのみ保存
	-> #変数と##変数は今まで通り変更があったときは直後にセーブを要求しますが
	　 キャラ永続変数は自動セーブのタイミングでセーブを要求します（そこそこ頻繁に変更される可能性が高いため）
	-> ##変数は利用頻度が低いと思われますので、キャラ鯖でのデータ書き込み処理は手抜きな方法で行っています
	-> 本パッチによりキャラ永続変数の保存数をある程度増やしても大きな負荷にはならないと思います
	　 保存可能の最大を越えたら警告が出力されますので、そのときはGLOBAL_REG_NUMの値を増やしてください
	-> converterは未対応です

・SC_DIVINAをSC_SILENTに置換し、SC_DEVINAを削除（skill.c, status.h）
・使われていないdefineを削除（map.h）
	LOCAL_REG_NUM, DAMAGELOG_SIZE
・2242で追加されたnpc_misc_zondaをmap_athena.confに記載

----------------------------------------
//2242-fix by Blaze

・リヒタルゼンクエスト追加（npc_town_lighthalzen.txt）
	研究所クエスト、大統領クエスト、スリクエスト
・シドクスクエスト修正（npc_town_einbroch.txt）
・飛行船NPCとクエスト追加（npc_town_airport.txt）
・ジョンダNPC追加（ジョンダ職員のみ）（npc_misc_zonda.txt）
・他小さな修正（npc_quest_noghalt.txt、npc_quest_skillget2.txt）

・クエスト関連地域、飛行船のwarp追加（npc_warp_town.txt）
・mob_***.txt関連をノーグハルトまで対応（mob_branch.txt、mob_boss.txt、mob_group_db.txt）

・fix追加
	各種フラグ名を統一
----------------------------------------
//2241 by Rayce

・pc_jobchange() 実行時、装備を外したあとに見た目変更パケットを送信するように修正（pc.c）
・ギルドのセーブデータ読み込み時におけるオーバーフロー対策の修正漏れを補完
・script_ref.txtのwaitingroom命令についての説明を少し修正

・SQL: 2221以降、新規作成したギルドが読み込めなくなっていたのを修正（int_guild.c）
       新規作成ギルドの最大メンバーが常に0となるバグを修正

----------------------------------------
//2240 by Rayce

・2201のNPCのID変更以降、IDの重複が生じていたので再編成（login.h, npc.h）
	END_ACCOUNT_NUM 100,000,000 →  5,000,000
	START_NPC_NUM     5,000,000 →  5,100,000
	END_NPC_NUM                    16,777,215

・アカウント作成時、およびログイン時にアカウントIDが上限を超えていたら失敗するように修正（login.c）
　アカウント登録回数が300万を越える場合は、saveデータを整理し直す必要があります
・NPCのIDが0x7fffffffを越える場合は整合性が取れなくなるので強制終了するように変更（npc.c）
・スクリプトにステータスを再計算するrecalcstatus命令を追加（script.c）
・頭装備のViewIDが256以上のものを扱えるように修正（clif.c）
	reported by あちゃこ and rewritten based on eA, thx

----------------------------------------
//2239 by Rayce

・map_id2su() 追加（map.*）
・スキルユニットに関連するキャスト問題バグ対策（battle.c, skill.c, status.c）
	変更前
		status_change_start(bl,type,sg->skill_lv,(int)src,0,0,sg->limit,0);
		    ↓
		struct skill_unit *unit = (struct skill_unit *)sc_data[SC_SAFETYWALL].val2;
	変更後
		status_change_start(bl,type,sg->skill_lv,src->bl.id,0,0,sg->limit,0);
		    ↓
		struct skill_unit *unit = map_id2su(sc_data[SC_SAFETYWALL].val2);

	今までは状態異常開始時にskill_unit型のデータをアドレスの整数値として渡していましたが、
	キャストして得られたデータが正しい型かどうかが保証できず、サーバクラッシュの原因の一つになります。
	今後はブロックIDを渡し、map_id2su() を使ってblock_list型のデータを得るようにします。
	これは原理的には BL_VALIDATE() でチェックするのと同じ機構を取ります。
	従って試験的に BL_VALIDATE() は無効にしていますが、これでもクラッシュが発生する場合は
	キャストに関してより厳密な対処法を考えないといけないかもしれません。

・全体的な細かい修正
・map_athena.confでMAP名が重複しているとき、多重に読み込まないように修正（map.c）
・無駄な処理を削減して高速化に貢献する（map.c, npc.c）
	-> WARPもしくは接触型NPCのみ map_addnpc() を呼び出して登録する
	-> map_id2**() 系の関数において、IDが0以下のときはサーチせずにNULLを返す
	-> 一時オブジェクトは id_db に登録しない、ただし @mapinfo で全NPCの情報が取れない副作用が生じています

----------------------------------------
//2238 by Rayce

・2200のチャットの引継ぎに関する修正を巻き戻し（chat.c）
	チャットを引き継いだ後に "get area char ???" が出力されるバグを内包してたので修正
	チャットは一時objectに登録されるだけでブロックリストには繋がれないし、繋ぐ必要もないためです
	バグ自体は恐らく2234のキャスト関連の修正によって潰れていると思います

・職業に関するビットフラグ変数をunsigned intに変更しておく（itemdb.*, script.c）
・隠れ蓑を潰した空きがあるので、SC_ADRENALINE2を365に変更（status.*）
・scriptの引数不要な関数のチェックを強化（script.c）
	例）checkcart(0) ではなく checkcart() にしないとエラーが出ます
・上記の変更に伴いエラーが出力されるスクリプトの修正
	reported by sia

・map_id2hd() 追加（map.*, homun.c）
　ついでなのでホムも用意しておきます
・全体的に細かい修正

----------------------------------------
//2237 by ＡＡＡ
・デスナイト/ダークコレクター追加
・デスナイト/ダークコレクター関係のDB修正

----------------------------------------
//2236 by T.N
・ホムンクルスの進化(homun_change_class())を実装(homun.c, homun.h)。
・@evolutionでhomun_change_class()を使うように変更(atcommand.c)。
・scriptからホムを進化させる命令(homunevolution)を追加(script.c)。
----------------------------------------
//2235 by Rayce

・2234の do_final_npc() のおけるミス修正（npc.c）
・flagname命令およびgetnpcposition命令を少し修正（script.c）
・skill_unit_move_unit_group() 内の変数 m_flag を動的確保しないように変更（skill.c）
　スキルグループのカウント数はMAX_SKILL_UNIT_COUNTまでが保証されている

・カード効果無効のスキルはカード補正計算をしないように改善（battle.c）
・アシデモに精錬/修練ダメージが乗らないように修正（battle.c）
・アシデモでPC以外に対して装備破壊が起こった場合はストリップ状態になるように修正（skill.c）
・ストリップウェポンをPC以外に使用したときのATK減少率を10%から25%に修正（status.c）

・バジリカ解除時は詠唱なしに修正（unit.c）
	reported by Sheep
・マヤカードの魔法反射時のダメージにエフェクトを付随するように修正（skill.c）
　ノックバックのある魔法なら自分が逆方向に吹き飛ぶように修正
	reported by free

----------------------------------------
//2234 by Rayce

・2233のキャスト関連修正の続き
　（atcommand.c, clif.c, chat.c, map.*, mob.c, npc.c, pet.c, script.c, skill.c, status.c）
	-> map_id2md(). map_id2nd(), map_id2cd() 追加
	-> map_id2sd() の MOB, NPC, CHAT版です、今後はこれを利用するようにしてください

・出来る限り pc_setdir() を利用する（battle.c, pc.c, skill.c, unit.c）
・scriptのagitcheck関数は引数を取らないように変更（script.c）
　@agit_flagへの代入は不要なので廃止
・既にチャットを持っているNPCに対してさらにwaitingroom命令を実行すると、チャットルームが分離してしまうバグを修正（chat.c）
　チャットの状態（タイトルや人数制限値）を変更するだけに変更します
・マクロ pc_setchatid() を削除（chat.c, pc.h）

----------------------------------------
//2233 by Rayce

・bin/tool/castcheckの出力結果を元にキャスト関連の一部を修正、および整理
　（atcommand.c, battle.c, clif.c, mob.c, pet.*, script.c, skill.*, status.c, unit.c）

----------------------------------------
//2232 by Rayce

・map_session_data構造体からrepeal_die_counterを削除（map.h）
・Aegisのパケットキャプチャ情報を元に霞斬りの仕様を戻す（homun.c, mob.c, pc.*, skill.c, status.c）
	-> 霞斬りによるハイド状態と通常ハイドは同じoption = 2を送信するがアイコンは表示しない
	-> 隠れ蓑状態（SC_KAKUREMINO）、および pc_iskakuremino() を廃止
	-> 通常ハイドからでも影斬り、影跳びが発動する

・SC_***とSI_***の定義をskill.hからstatus.hに移動
・StatusIconChangeTable[] をskill.cからstatus.cに移動

----------------------------------------
//2231 by ゆいらん

・「スーパーノービスの魂」発動時に1%の確率で死亡記録が削除されるが、
　魂状態終了時に死亡記録が削除される前に戻るようになっていたので、
　次に死亡するまで永続するように修正（status.c）

	sd->repeal_die_counter = 1;　→　pc_setglobalreg(sd,"PC_DIE_COUNTER",sd->die_counter = 0);

・スパノビの魂　死亡カウンタを一時的に無効化する(万分率)の文章を
　スパノビの魂　死亡カウンタを無効化する(万分率)　に修正（battle_athena.conf）

----------------------------------------
//2230 by Rayce

・2226で罠の耐久切れのときの挙動がおかしくなってたので修正（skill.c）
・2229のpacket_db.txtの変更は2215で既にカバー済みなので巻き戻し
　ついでに0x28aまでパケット長追加

・配列変数へデータを格納するスクリプト命令において配列の上限チェックをするように修正
・getskilllist命令において取得スキルが128個以上の場合は2次元配列で返すように拡張
・getequip***系の関数で11番の「矢」を指定できるように
・指定番目のアイテムを削除するdelinventory命令追加
・変数名の変更（script.c）
	pos[] → refine_posword[], equip[] → equip_pos[]
・skill_clear_unitgroup() からprintfを削除（見当違いでした）
・skill.cの細かい修正

・元職業からクラスIDを返すとき、結婚職（ID=22）が考慮されてなかったを修正（pc.c）
	reported by ルナ
・unequip命令の装備位置指定番号をgetequipidのものと同一にする
	reported by Cocoa
・map_athena.confによるコメントアウトやMAPサーバ分割などでスクリプトに記述されているMAPが
　無効の場合に「syntax error」が出るバグを修正（npc.c）
	reported by kazusuka

----------------------------------------
//2229 by GcwMfHQ

・packet_dbの更新 (merged from eA)

・db等の更新 thanks to huge cgi

	(db)
		item_db.txt
		mob_db.txt
		packet_db.txt
	(script/mob)
		npc_monster.txt
		npc_monster_future.txt

----------------------------------------
//2228 by ID:7QLFJSM

・httpd でダイジェスト認証ができないことがあるバグ修正
　パスワード格納用のバッファがオーバーフローしていました。
　
・httpd でドキュメントルート以外のディレクトリでファイル名を省略したときにも
　index.html を読むように修正

・2214 から利用できなくなっていた athena.php を修正

(src/common)	httpd.c		httpd_complement_file() 追加ほか
(bin/tool/php)	athena.php	connect() 修正

----------------------------------------
//2227 by Rayce

・Aegisのパケットキャプチャ情報により、空蝉発動時のエフェクト番号を462→463に修正（battle.c）
・@readvars, @writevars で変数/定数以外を読み書き出来ないように修正（script.c）

・スクリプトエンジンの改善（script.c）
	-> 命令において () は引数として許可されません
	　 例えば mes (); のような記述がサーバクラッシュを引き起こすのを防止するためです
	-> 関数においては引数が必要ないものについては () を何もないものとして使うことが可能です
	　 例えば debugmes getgmlevel(); は問題ありません
	-> mes "strings",; のように指定引数以上にカンマが存在する場合、エラーとなるように変更

・コードを持たないスクリプトは中間言語を保存しないように改善（homun.c, itemdb.c, npc.c, pet.c, pc.c, script.*）
	mergerd from eA and modified, thx !

　※以下のようにscript部分が {} で完結する場合、今までは何もないコードということで C_NOP が書き込まれていました。
　　当然 C_NOP があるのでNPCをクリックしたりアイテムを使ったりすればスクリプトの実行が走ります。
　　しかし何もしないコードのためにメモリ領域の確保/解放をやるのは極めて無駄なので、
　　scriptの解析および実行そのものを行わないように変更しました。
　　setjmpによる例外が発生した場合には error_code のアドレスを返すようにして区別しています。

	izlude.gat,132,115,4	script	Test	180,{}
	540,Falcon_food,ファルコンのえさ,0,,,50,,,,,1000333311,2,,,,,,{},{}

・上記変更によってエラーが出るスクリプトの修正
	script/sample/npc_test_hanoi.txt
・変数名が似通ってるので少し修正
	script/npc/npc_town_lighthalzen.txt
・MAP名である必要のある箇所がキャラ永続変数になってたバグを修正（DEBUG_VARSによるvariables.txt参照）
	script/npc/npc_quest_artifacts.txt

----------------------------------------
//2226 by Rayce

・ルアフで隠れた敵にダメージを与えるとき、スキルLvが常に0になっていたのを修正（status.c）
・罠の処理において怪しいところを修正（skill.c）
・skill_clear_unitgroup() でエラー文の出力を追加
	skill.cとdb.cで発生するメモリリークの原因を探るためです
	「skill_clear_unitgroup: src_id …」が表示されたら報告をお願いします

・warpおよびshopのNPCの名前に識別子を指定できるように拡張
・substoreでshopをコピーできるように拡張（duplicateのshop版）

・disp_error_message() 後のexit() をコメントアウト
　setjmpするため実際にはexitが呼ばれないことを明示するためです
・npc_clearsrcfile() が指定ノードを引数として受け取るように変更
・duplicate元がwarpやshopだった場合は警告を発するように変更
・scriptでマルチラインコメント（/* */）を閉じ忘れたとき、他スクリプトにまで判定が影響する問題を修正

・scriptブロック以外で余計な文字が存在する場合、警告を発するように改善
　スクリプトブロックごとマルチラインコメントできるように拡張（今まではブロック内でしか効果がなかった）
	詳細はdoc/script_ref.txtを参照してください
	また構文チェックが厳しくなっているので注意してください
	「npc file syntax error」が出た場合にはこのチェックに引っ掛かってるか
	NPC定義の区切りが間違ってたりする可能性が高いです（タブがスペースになってたり…）

　※以下のサンプルスクリプトは今までは何事もなかったかのように読み込みが完了します。
　　しかし実際には set の前の行の } がscriptの終了点として認識されており、set 以下の行は無視されます。
　　このようなミスを検出するため、修正後は set 以下の行をエラーとみなし警報と警告文が出力されます。

	prontera.gat,145,142,4	script	Test	120,{
		if('num)		// { を付け忘れてしまった
			heal MaxHp,MaxSp;
		}
		set 'num,1;
		close;
	}

・「npc file syntax error」の出るNPCスクリプトの修正
・細かい修正（status.c）
・doc/client_packet.txtを少しだけ修正
・SQL: char-converter.cを少し修正

----------------------------------------
//2225 by Rayce

・2222でconst.txtの負の値が読めなくなってたので修正（script.c）
・2224の巻き戻しが不完全だった部分を修正（skill.c）
・@itemcheckの廃止（atcommand.c）
・2195の skill_unit_effect() に対する修正を巻き戻し（skill.c）
	HOMを対象にする意味はありますが、PETその他も対象に含まれていたのでstatus_change_timer() で
	nullpoエラーが出力されるようです。
	ただしHOMを対象に入れるのであれば skill_unit_move() も修正しないといけないはずで、
	整合性が取れないので巻き戻す形をとりました。
	（どのスキルがHOMに対して効果を及ぼすのか、全てのスキルにおける情報がないため実装するわけにもいかず）

----------------------------------------
//2224
・2217〜2220のbattle_configについての改変を巻き戻しました。
（battle_athena.conf、skill.c、status.c、battle.c、battle.h）

----------------------------------------
//2223 by ID:7QLFJSM

・2214 から管理モードログインが不可能になっていたバグを修正
　原因は 2214 で md5key （CRAM のチャレンジ文字列）の長さを増やしたため、
　計算用のバッファが足りなくなって（条件次第ではオーバーフローして）いました。

(src/)	login.c	管理モードログインの暗号化ログインの処理を修正

---------------------------------------
//2222 by Rayce

・「太陽と月と星の感情」を保存するように修正
　txt-converter.exe対応済み
	TXT: save/athena.txtにセーブされます。場所は最後尾、友達リストの次。
	SQL: memoの項に `type` というカラムを追加します（sql-files/2222_changetable.sql）
	　　 W = ワープポータル, F = 感情の場所 で識別します
	　　 スキルLvはとりあえず `x` のカラムに格納してます

・battle_configの save_hate_mob をyesに変更
・battle_configに save_feel_map を追加（battle.*）
・db/const.txtの値を16進数でも読み込めるように拡張（script.c, merged from eA）
・ワープポータル使用時のチェック強化（skill.c）

・SQL: 友達リストをconvertする際に名前が正常に得られない可能性があるバグを修正
・SQL: ギルドとパーティのデータをconvert出来ない可能性を修正

----------------------------------------
//2221 by Rayce

・2220-fixの致命的なバグを修正（skill.c）
	-> GCCでの警告潰し
	-> battle_configのbs_make_lumpがnoのとき（デフォルト）、製造アイテムが正常に取得できないバグを修正
	-> サーバクラッシュする可能性を防ぐために不正チェックを強化

・水遁のスキルLvが11以上のときにサーバクラッシュする可能性を修正（skill.c）
・チェンジインストラクションのスキルLvが11以上のときにサーバクラッシュする可能性を修正（homun.c）
・scriptのchangebase命令の仕様を少し変更（script.c）
　引数を一つ増やせるようにして転生/拡張職に対応
　キャラIDの指定位置をずらしましたので、この命令を使っている方は修正し直してください

・saveデータの読み込みおよび書き込みの際、データ領域のチェックを行うように修正
　ある状況下においてセーブデータが吹き飛んだり不正なメモリアクセスが発生する可能性を防ぎます

・TXT: ワープポータルのメモを保存する際、各データをスペースで区切るように修正（char.c）
・SQL: インジェクションに対する脆弱性の修正（char.c）
・SQL: txt-converter.exeの修正と拡張
	-> 不要な #include を削除
	-> save/athena.txtの変換時にエラーが出る可能性を修正
	-> friendリスト、ワールド永続変数（##変数）、アカウント永続変数（save/accreg.txt）のconvertに対応
	　 inter-converter.c, inter-converter.h の追加

----------------------------------------
//2220-fix
・2220で入れ忘れたskill.cを入れました。
　評価スレ45氏の物が正常に動作することを確認したため、拝借させていただきました。

・battle_athena.confがデフォルト設定からかけ離れたものになっていたのを戻しました。

　配布ファイルの中身の確認を怠ってしまい、申し訳ありませんでした。

//2220 by りゅうさ
・2217以降、GCCでコンパイルエラーが出ていたのを修正（skill.c）
　ついでに、2217で変わりづらかった変数(iiやjjなど)を配列にまとめました。

・ブレッシングにおけるSTR,INT,DEXの上昇値を調整できるようにしました。
（battle_athena.conf、battle.c、battle.h、status.c）

----------------------------------------
//2219 by Rayce

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 2219

・AthenaDevのScriptFolder議論を実行に移します。
　src以外のファイル/フォルダの構成を大幅に変更します。
　これは不要になったファイルが存在していること、またファイルの統廃合により見通しを良くするための処置です。
　以前のmodとは互換性が無くなりますのでご注意ください。
　議論に参加くださった皆様方、この場をお借りして感謝の意を表します。

　捕捉）
　　１．scriptフォルダの構成ついて
　　　　　extensionはデフォルトでは空です。自作のスクリプトはここに格納すると良いでしょう。
　　　　　mapflagは今のところmapflag.txtが置かれているのみです。将来的にmapflagをfieldやdungeonで分けるかもしれません？
　　　　　mobは特に大きな変更はありません。
　　　　　npcは次項にて説明します。
　　　　　sampleはサンプルファイル群です。それぞれ機能別にcustom, debug, testの3種類にカテゴライズされています。
　　　　　　　custom = オリジナル系、debug = デバッグ・救済用、test = 新機能の使用例
　　　　　warpに変更はありません。

　　２．script/npcフォルダの構成について
　　　　　eventは期間限定イベントが配置されます。これらはデフォルトでは読み込み対象外です。
　　　　　gvgに変更はありません。
　　　　　jobは特に大きな変更はありません。
　　　　　miscは基本的に置き場所に困るものを格納する所とします。現在は各街で共通に機能するスクリプトを置いています。
　　　　　questは常設のクエストです。デフォルトで読み込まれます。
　　　　　townは街ごとに分類されたスクリプトが配置されます。

　変更したファイル「C」
　改名したファイル「R」
　削除したファイル「D」
　移動したファイル「M」（ただしフォルダを移動すると改名も行われます）

	.
		D : vc07_make.bat
		D : vc07_clean.bat
	./conf/
		D : jro/		→ 不要なのでフォルダごと全削除
		C : map_athena.conf	→ 変更後のファイル構成に対応
		M : mapflag.txt		→ script/mapflagフォルダを新設して移動
	./db/
		D : sample/		→ 不要なのでフォルダごと全削除
		D : item_delay.txt
		D : item_pet.txt
		D : item_prohibition_zone.txt
		D : item_upper.txt
	./doc/
		D : agitdb_ref.txt
		D : command.txt
		D : const.txt
		D : help.txt
		D : help2.txt
		D : help3.txt
		D : icon.txt
		D : item.txt
	./script/
		extension/
			M : eda.txt			→ npc_custom_branch.txtに改名してsampleへ移動
			D : npc_event_kataribe*.txt
			M : npc_gldcheck.txt		→ npc_custom_glcheck.txtに改名してsampleへ移動
			M : npc_produce.txt		→ npc_custom_produce.txtに改名してsampleへ移動
			D : npc_produceDATA.txt		→ npc_custom_produce.txtへ吸収
		mob/
			D : npc_monster_gvg.txt
			D : npc_monster_lite.txt
			R : npc_x-masmonster.txt	→ npc_monster_xmas.txtに改名
		npc/
			D : npc_function.txt		→ 既にmisc内のファイルに移植済み
			etc/
				D : npc_etc_cTower.txt
				D : npc_etc_gefenia.txt
				M : npc_etc_hairstylist.txt	→ npc_quest_hairstylist.txtに改名してeventへ移動
				M : npc_etc_pvp.txt		→ npc_misc_pvp.txtに改名してmiscへ移動
			job/
				R : npc_job_00newbie.txt	→ npc_job_00novice.txtに改名
				D : npc_job_27sl.txt
				D : npc_job_lite07-20.txt
			quest/
			　（各ファイル名のeventをquestに改名するだけのものは明記してません）
				M : npc_event_adoption.txt	→ 本鯖には存在しないのでnpc_custom_adoption.txtに改名してsampleへ移動
				D : npc_event_alchemist.txt
				M : npc_event_carnival.txt	→ eventへ移動
				R : npc_event_hat.txt		→ npc_quest_hat2.txtに改名
				R : npc_event_hat2.txt		→ npc_quest_hat3.txtに改名
				R : npc_event_hat3.txt		→ npc_quest_hat4.txtに改名
				M : npc_event_hinamatsuri.txt	→ eventへ移動
				M : npc_event_kataribe.txt	→ eventへ移動
				R : npc_event_ma_sword.txt	→ npc_quest_doomsword.txtに改名
				R : npc_event_making.txt	→ npc_quest_hat1.txtに改名
				D : npc_event_momotaro.txt
				M : npc_event_newyear.txt	→ eventへ移動
				M : npc_event_oni.txt		→ eventへ移動
				M : npc_event_pumpkin.txt	→ eventへ移動
				D : npc_event_rental.txt
				R : npc_event_skillget.txt	→ npc_quest_skillget1.txtに改名
				D : npc_event_tougijou.txt
				M : npc_event_valentine.txt	→ eventへ移動
				M : npc_event_whiteday.txt	→ eventへ移動
				M : npc_event_xmas.txt		→ eventへ移動
				D : npc_event_yuno.txt
			town/
				M : npc_town_board.txt		→ npc_misc_board.txtに改名してmiscへ移動
				M : npc_town_guide.txt		→ npc_misc_guide.txtに改名してmiscへ移動
				M : npc_town_inn.txt		→ npc_misc_inn.txtに改名してmiscへ移動
				M : npc_town_kafra.txt		→ npc_misc_kafra.txtに改名してmiscへ移動
				M : npc_town_refine.txt		→ npc_misc_refine.txtに改名してmiscへ移動
		sample/
			D : nep_debug_job_change.txt
			R : npc_debug_extendshop.txt		→ npc_custom_extendshop.txtに改名
			R : npc_debug_job_change2.txt		→ npc_custom_jobchange.txtに改名
			R : npc_func_library.txt		→ npc_test_library.txtに改名
			R : npc_original_revive.txt		→ npc_debug_revive.txtに改名
			R : npc_sample.txt			→ npc_debug_sample.txtに改名
			R : npc_test_cardremover.txt		→ npc_custom_cardremover.txtに改名

----------------------------------------
//2218 by Rayce

・skill_db.txtからUnknown_Skillをコメントアウト
・ターンアンデッドをクローンできるようにskill_db2.txtを修正
・dbファイルの更新 from huge cgi, thx

----------------------------------------
//2217 by りゅうさ
・battle_athena.confでBSの製造に関する項目を一つ追加
　面倒な鉱石の精製（鉄鉱石→鉄、鉄＆石炭→鋼鉄、属性原石→属性石、星の砂→星の欠片）の一括処理
　設定をyesにすると、携帯用溶鉱炉の消費一つで大量の鉱石が精製できちゃうミラクル錬金術ですが、現在のところ仕様。

いじったファイル：battle.c、battle.h、skill.c、battle_athena.conf

----------------------------------------
//2216 by Rayce

・scriptのgmcommand命令の処理方法改善（script.c）
　わざわざcallocしなくて済むように変更、およびバッファオーバーフロー対策
・VC++におけるsnprintfのエイリアスをmmo.hで一括定義するように変更

・item_delay.txt, item_upper.txt, item_prohibition_zone.txtを廃止しitem_db2.txtに統合
　捨てられるか、倉庫に入れられるか、倉庫からカートに出せるか、の3項目をitemdb.cから移動
　詳細はdoc/db_ref.txtを参照のこと
・item_pet.txtは紛らわしいのでitem_petbox.txtに改名（itemdb.c）
・倉庫関連の処理を全体的に書き換え（clif.c, storage.*）

・atcommand_homevolution() を少し修正（atcommand.c）
・MOBがサクリファイスを使用してHPが0以下になったとき、死亡と判定されない問題を修正（battle.c）
	reported by Cocoa

----------------------------------------
//2215 by Rayce

・doc/client_packet.txtの整理
	今までの記載漏れ分を補完し、さらに2006-09-18a Sakexeを元に解析した結果を追記
	「未調査」とは、定義はされているものの実際の機能の詳細が不明なものを表します
	結構穴だらけなので調査出来る方は穴埋めをお願い致します

・packet_db.txtに新規分を追記および整理
・/summonの効果を@summonと同等にし、/recallで@recallの効果が出るように変更
・/changemaptype, /remove, /rc, /check をサポートする、ただし詳細な効果不明によりとりあえず何もしない
	clif_parse_GMrecall()
	clif_parse_GMchangemaptype()
	clif_parse_GMremove()
	clif_parse_GMrc()
	clif_parse_GMcheck() 追加

・ROメール読み取りの際、稀にサーバクラッシュするバグを修正（int_mail.c）
・battle_athena.confにromailuseが抜けてたので追記
・パケットのparse部分において出来る限りGETPACKETPOSを利用するように修正（clif.c）
・ROメール返信機能によるパケット送信（0x273）をサポートする、ただし未実装
	clif_parse_ReturnMail() 追加

・MAX_PACKET_DBを0x300に拡張（clif.h）
・@packetの仕様を少し改善（clif.c）
	30byteまで任意に値を指定できるように拡張しました
	またそれぞれの値は10進数ではなくて16進数で取るように変更しました
	デバッグとしてだけでなく、scriptから無理矢理パケットを送り付けるといった活用法もあるかも？

	例：カプラのcutinを表示する
	　　@packet 145 6b 61 66 72 61 5f 30 34 0 0 0 0 0 0 0 0 2

----------------------------------------
//2214 by ID:7QLFJSM

・サーバー間接続の認証方法に CRAM (ハッシュ関数: HMAC-MD5) を採用
　いままでパスワードがプレーンに流れていたのが、HMAC-MD5 で暗号化されます。
　従来のプレーン認証も受け付けますが,接続に行くときの認証方式は選択できません。

・サーバー分散の解説がないので追加

・VC 用のバッチファイルの名前を変更と内容を整理
　vc_make.bat
　　VC++6.0 / VC++2005 への対応強化
　　txt モードのときに txt-converter をビルドしないように修正
　　sql モードのときでも txt-converter をビルドしないようにできる設定を追加
　　各種ビルドオプションのコメントを修正
　vc_clean.bat
　　デバッグファイルなども削除するように修正
  ****
　デフォルトで環境を選択していないので、自分の環境に合うように変更が必要です。
　特に、VC++ Toolkit 2003 を使用している人は、いままでデフォルトで設定されて
　いた場所がコメントアウトされているので、注意してください。
　なお、vc07_make.bat, vc07_clean.bat はもう必要ないので削除してください。
  ****
  

(/)
	vc_make.bat, vc_clean.bat		新規追加
	vc07_make.bat, vc07_clean.bat	削除
(src/common)
	md5calc.c, md5calc.h	HMAC-MD5 の処理追加など
(src/login)
	login.c, login.h	char サーバーの暗号化ログイン対応
(src/char)
	char.c, char.h		login サーバーへ / map サーバーからの暗号化ログイン対応
(src/map)
	chrif.c				char サーバーへの暗号化ログイン対応
(doc)
	distribute_servers.txt	新規追加：サーバー分散の解説
	serverlink_packet.txt	暗号化ログインのパケット追加

----------------------------------------
//2213 by Rayce

・使われていないbattle_configを削除（battle.*）
・conf/battle_athena.confに記載漏れの項目を追記
	-> deadly_potion_produce_rate
	-> castle_defense_rate
	-> tarotcard_display_position
	-> allow_weaponrearch_to_weaponrefine
	-> cooking_rate
	-> making_rate

・同じ人にディボーションすると使用可能回数が減る問題を修正
　効果時間をskill_cast_db.txtのupkeep_timeを利用するように変更（skill.c）
・プロボックとマインドブレイカーで詠唱妨害できなくなってた問題を修正（skill.c）
・一部のスキルを弓でも使用可能に修正（skill_require_db.txt）
	reported by queue

・BDPQ銀氏の地面指定スキルのディレイ無視の修正ファイルを取り込む、thx a lot!!
・スキル使用時の条件判定を少し修正（clif.c）
・packet読み取り時の出力文字を少し変更（login.c）
・pc.cを少し修正（pc.c）
・イベント名が重複するNPCスクリプトの修正
	npc/quest/npc_event_artifacts.txt

・SQL: onlineとoffline書き込み時にエラーチェックをする（char.c）
・SQL: txt-converter.exeに関する変更と修正（converter.*, char-converter.c, login-converter.c）
	-> save/homun.txtをconvert可能にする
	-> save/party.txtのconvert中に警告文が出力される可能性を修正
	-> save/account.txtをconvertする際、IDが0のものを読み込めるようにIDを1つずらすように修正
	-> save/account.txtのメールアドレスをconvert出来るように修正
	   アドレスが見つからない場合はTXTと同じく "@" を書き込む

----------------------------------------
//2212 by よらん

・2211で発生した警告つぶし（battle.c）
・sqlでの構築文編集(doc/sqllogin.txt)

-fix: 
・BCC・VCコンパイル時でのinclude、libmysql.lib指定箇所追加
・BCC・VCでのexeファイル作成場所をbinに移動
・上記変更に伴いクリーン処理変更
上記バッチファイルをを2211以前のものに変更

・sqlでの構築文変更を入れていたのにもかかわらずコメント
　がなかったので追加
----------------------------------------
//2211 by Blaze

・料理クエスト追加（npc_event_cooking）
・ゴスペルの効果時間の修正（skill.c）
・ビーストストレイフィング、一閃のダメージ計算式修正（battle.c）

----------------------------------------
//2210 by Blaze

・jRO2006 アマツ納涼泉水祭イベント追加（npc_event_2006summer）
・飛行船襲撃イベント追加（npc_town_airport）

----------------------------------------
//2209 by Blaze

・以下のNPCを修正
	リヒタルゼンのヘアスタイリストを追加（npc_etc_hairstylist）
	初心者修練場のレクチャー内容修正（npc_job_00newbie）
	テコンキッド試験免除Lvの修正（npc_job_24taekwonkid）
	拳聖転職試験が進まない可能性のあるバグを修正（npc_job_25stargladiator）
	神器クエストのNPCを追加 Thx Chiffon（npc_event_artifacts）
	リヒタルゼン追加頭装備作成NPC追加（npc_event_hat3）
	リヒタルゼンNPC修正（npc_town_lighthalzen）
	ニブルヘイムクエスト1種追加（npc_town_niflheim）
	タートルアイランドに騎士団NPC追加（npc_town_alberta）
	ノーグハルト2F→3Fゲート修正（npc_event_noghalt）
	メッセージ修正（npc_town_kafra、npc_event_hat、npc_event_dye）
	他イベントをtownに融合（npc_town_aldebaran、npc_town_yuno、npc_town_amatsu、npc_town_gonryun）
・クリスタルmob追加（npc_monster_crystal）
・map_athena.confに新規スクリプトを追記、イベント用MAPをコメントアウトで追加

----------------------------------------
//2208 by GcwMfHQ

・db等の更新 thanks to huge cgi
	(conf)
		mapflag.txt
	(db)
		item_db.txt
		mob_db.txt
		mob_skill_db.txt
	(script/mob)
		npc_monster.txt
		npc_monster_future.txt

----------------------------------------
//2207 by Nameless

VCのコンパイル環境の整備
・vc07_make.bat

各CPUスイッチは以下の通り
x32    基本32BIT CPU用(デフォルト)
x64    基本64BIT CPU用
HiMemL 関数レジスタの拡大(32bit)プログラムがとまりにくくなります
HiMemH 関数レジスタの拡大(64bit)プログラムがとまりにくくなります
Stac32 スタック制御(32bit)スタック時のメモリを大目に取ってスタック時間を短縮・回避します。
Stac64 スタック制御(64bit)スタック時のメモリを大目に取ってスタック時間を短縮・回避します。
A64x2  AMD系64bitCPU用 デュアルコアを有効にします
A64x1  AMD系64bitCPU用 3D NOW/3D NOW2のサポート
EM64T  Intel系64bitCPU用 EM64Tをサポートします
以下人柱モード
mode01〜mode05 CPUの最適化(最速化)です。サンプルが少ないので安定してません

----------------------------------------
//2206 by Rayce

・battle_athena.conf読み込み時に存在しないconfigが記載されていたとき、警告を出すようにチェック強化（battle.c）
・PC型MOBに対してもPACKETVER 7以上をサポートする（clif.c）
・2205のReadmeがおかしいので修正

----------------------------------------
//2205 by No Name

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 2205

----------------------------------------
//2204 by よらん
・2202での修正ミス (addaccount.cgi)
　thx a lot huge
----------------------------------------
//2203 by Rayce

・カートブースト終了時に移動速度が元に戻らない問題を修正（status.c）
・MAX_NPC_NUMのdefineをconstに変更（npc.*）
・細かい修正（battle.c, skill.c, status.c）

・PACKETVERを7に引き上げ（clif.c）
　PCの表示パケット 0x22a, 0x22b, 0x22c をサポート
　（PC型MOBに関してはとりあえず後回し）
・battle_configの changeoption_packet_type を削除
　PACKETVER 7以降はデフォルトで 0x229 をサポートするように変更

----------------------------------------
//2202 by よらん

・インジェクション攻撃を受けるセキュリティホールを修正 (addaccount.cgi)

もしアカウント登録CGIをご自分で修正せずそのままご利用の方は
すぐにこの修正モジュールを使用してください。

fix:Readme2174でのリビジョン番号が間違っていた。
----------------------------------------
//2201 by Rayce

・パケット0x229の修正（clif.c）
・養子要請条件が成立しないときにメッセージを表示するように変更（clif.*, pc.*）
　パケット0x216 clif_baby_req_fail() 追加
	packet data provided by 名無しさん、thx a lot!!
・養子関連の処理を少し修正（char.c, chrif.c）

・エスマ可能状態になったときにアイコンSI_SMAを送信するように修正（skill.*）
・エスマを正常に表示させるために、NPCの開始IDを 110000000→5000000 に変更してみる
　IDが MAX_NPC_NUM（0xffffff）に達したらエラー文を出力するように（npc.*）
・エストン使用時に対象が中型ならスタン効果追加（skill.c）

・battle_configにallow_es_magic_all追加（battle.*）
・エスティン、エストン、エスマをPCに対して使用できないように修正
・エスウ、エスク、エスカをPCに対して使用するときには自身にスタンが発生するように修正
・エスウ使用時に対象が既にエスウ状態なら対象のエスウ状態を解除して、自身にスタンが発生するように修正
・ボス属性のmobに対してエスウを使用した場合の持続時間は1/5に修正

----------------------------------------
//2200 by End_of_exam

・チャットの引き継ぎ時に落ちる可能性のあるバグを修正(chat.c thanks to kinaさん)
・ラベルを文字に変換しようとすると落ちるバグを修正(script.c npc_town_louyang.txt)

----------------------------------------
//2199 by Rayce

・2198のワープポータルの修正が手抜きだったので修正し直し（skill.c）
・一閃のスキルLvが25のときにサーバダウンする可能性を修正（battle.c）
・サクリファイスと一閃をPC以外も使用できるように拡張（battle.c）
・武器スキルのヒット数をskill_db.txtのlist_numで設定できるように拡張（battle.c）
	今までは武器スキルだけlist_numの値を利用してませんでしたが、
	例えばダブルストレイフィングのlist_numを2→4に変更するだけで4HIT攻撃になります
	ただし魔法やその他スキルとは違い、ヒット数を増やしてもダメージ総量は変化しません

・テコンランカーによる蹴りコンボのディレイ時間についても2198のものを適用してみる
・テコンボーナスで取得した飛び蹴りのスキルLvが0として認識される問題を修正（clif.c）
	reported by 名無しさん

----------------------------------------
//2198 by Rayce

・テコンの蹴りの構えの時間が本鯖と比べてあまりにも短すぎるので、とりあえずeAの計算式を採用（battle.c）
・構えの際に clif_combo_delay() を呼ばないようにしてみる
・ディスアームにエフェクト追加（skill.c）
・空蝉の修正（ref. 某動画とeAthena）
	-> 詠唱時間0秒に修正してみる
	-> 移動距離をskill_db.txtのblewcountを利用するように変更、デフォルト7セル
	-> 移動時にエフェクトが出るように（battle.c）

・scriptのsuccessrefitem命令、failedrefitem命令の最適化（script.c）
・ファーマシーの連続成功カウンタを埋め込み変数にする、2179の追加（map.h, pc.c）

・PCの足元にワープポータルが設置できないように修正（skill.c）
・PK不可地域で飛び蹴りがPCに対してダメージを与える問題を修正
	reported by Mana
・ルアフを聖属性に修正
	reported by Kiry

----------------------------------------
//2197 by Rayce

・ゴスペルが味方に掛かった場合、効果メッセージを表示するように（clif.*, skill.c）
　clif_gospel_message() 追加
	reported by oanes1 and packet data provided by tmp, thx a lot!!

・ゴスペルの味方への効果に「全状態異常回復」「全状態異常耐性」「防御力増加」の3つを追加（battle.c, skill.*, status.c）
　SC_STATUS_UNCHANGE, SC_INCDAMAGE 追加

　※SC_INCDAMAGE（367）は被ダメージ%上昇として実装しています
　　アスムと重複可能ですので、オリジナルのアイテム効果として使うのも面白いかもしれません

----------------------------------------
//2196 by Rayce

・アイテムスキルやアブラカタブラから阿修羅と飛び蹴りを使う場合は、対象指定スキルとして発動するよう修正（clif.c）
・アイテムスキルやアブラカタブラの使用条件チェックの強化（skill.c）
　気功不足やZeny不足だとスキル使用失敗になります
	reported by gerdlia

・アイテムスキルを使用失敗したあとに同じスキルを使用すると、必要アイテムやSPが消費なしで発動する問題の大部分を修正
	問題例）沈黙中にファイヤーボルトの書使用→スキル使用失敗→沈黙解除→ファイヤーボルト→SP消費なし
・battle_configのskill_out_range_consumeが機能してなかった問題を修正
・skill_check_condition2_pc() や skill_check_condition2_mob() においてステータス異常チェックが重複するので削除
　（skill_check_condition2() の時点でチェック済みなはず）

・アブラ専用スキルのクエスチョンで？エモーションを出すように
・db/abra_db.txtのスキル名称をskill_db.txtに合わせる

----------------------------------------
//2195 by End_of_exam

・2181の一部巻き戻し(storage.c)
・2194の修正漏れ(map.c thanks to Kiry.さん)
・skill_unit_effect() がPET/HOMを対象外にしていたのを修正(skill.c)

----------------------------------------
//2194 by End_of_exam

・2187の修正(mob.c)
・2193の修正(npc.c)
・status_change_timer() のバグ修正(status.c)
・battle.c で起こるSW落ちの*仮*修正(battle.c map.c map.h)
・SQL: ギルド作成時にエラーが出るバグの修正(int_guild.c)

今回の修正で「delete_timer error : function dismatch」が出るバグ、チャット禁止の
カウントダウンが中断されるバグを潰しましたが、他の所にも原因が潜んでいる可能性が
有ります。引き続き症状が出てくるようなら、報告をお願いします。

BL_VALIDATE( ) を用いることで、BL関連のアドレスが正しいものか確認出来ます。coreを
吐いているけど原因が特定しにくいような箇所に加えることで、クラッシュへの仮対策が
出来ます。

----------------------------------------
//2193 by Rayce

・スクリプトのnpcskill***命令系について、doc/script_ref.txtを少し書き直し
・conf/GM_account.txtで同一IDで上書きしてもメモリリークが発生しないように修正（login.c, login-converter.c, char.c, pc.c）
	reported by mag
・メモリリーク対策として、スクリプトの読み込み時のチェック強化（npc.c）
	-> 同名のイベント型NPCが存在するならサーバ終了
	-> 同名のユーザー定義関数スクリプトが存在するならサーバ終了
	-> エラーで終了する場合、サーバを落とす前にちゃんとメモリ領域をfreeする

・DEBUG_MEMMGR（デバッグモード）有効時にタイムスタンプの出力を追加（malloc.c）
	デバッグモードにするとメモリ領域確保時の時間を保存するようにします。
	メモリリークが発生したとき、その時間をログファイルに出力できます。
	原因の特定が困難な場合デバッグモードにすることで、いつ頃の行動がメモリリークの原因になったかを
	ある程度把握することが出来ると期待します。

	出力の一例）	memmgr: memory leaks found
			0001 [2006/08/21 19:49:21] : skill.c line 10334 size 40

----------------------------------------
//2192 by Rayce

・マリオネットコントロールの紐を本鯖仕様に修正（clif.*, skill.c）
	ようやく原因が判明
	アイコン番号121（SI_MARIONETTE）には紐のエフェクトを消す効果が含まれているようです
	従って clif_skill_nodamage() は clif_status_change() の後に呼び出す必要があります
	またディボーションとは違い特定のパケットは存在しませんので clif_marionetto() は削除

・状態異常の魂系で clif_misceffect2() を送らないようにしてみる（status.c）
　opt3でエフェクトは出てるはずなので多分不要
・状態異常のアスムで clif_misceffect2() を使わないように修正（status.c）

　※マリオネットの本鯖パケット調査により一つの結論を得ました。
　　mod-1572におけるＡＡＡさんの考察の通りで、アスムに限らす一部のスキルではアイコンにエフェクトを消す効果が含まれている
　　などがあり、clif_status_change() と clif_skill_nodamage() のパケットが連動性を持っていることがある
　　現Athenaでは clif_skill_nodamage() を呼び出してから状態異常処理を行っているが、実はこれが間違いの元で、
　　本鯖はアイコンパケット送信後に clif_skill_nodamage() を呼び出す仕組みのようです。
　　呼び出す順番を入れ替えることにより、小細工なしで正常に表示されるようになりました。

----------------------------------------
//2191 by Rayce

・飛び蹴り（ティオアプチャギ）修正（battle.c, clif.c, skill.c, status.c, unit.c）
	-> 即時発動スキルに変更
	-> ダメージ倍率修正
	-> 落法発動後に飛び蹴りを使用した場合はターゲット指定無しで敵に向かって飛んでいくように修正
	-> 落法発動中あるいはタイリギ移動中に使うとベースLvの影響を受けてダメージ上昇、計算は落法時に同じ
	-> 状態異常解除効果はPCに対しても機能するように修正
	-> タイリギ移動中で且つスパート状態なら更にダメージ上昇
	   計算式が不明なので適当に入れてます、情報お持ちの方は補完してください

・スフィアーマインの自爆中の移動を unit_walktodir() を使うように
　mob_linerwalk() は不要になったので削除（mob.*, status.c, unit.c）

----------------------------------------
//2190 by Rayce

・走り高跳び（ノピティギ）を本鯖仕様へ（skill.c, status.c, unit.c）
	-> 即時発動スキルに変更、詠唱妨害されない
	-> PCの向いている方向に飛ぶ
	-> テレポ禁止区域でGvマップでない、もしくはPvマップなら移動出来ずにその場に着地
	-> 壁越えは clif_blown() を利用するように最適化
	-> unit_movepos() の引数の使い方を少し整理
	-> 着地地点とその一歩先が移動可能セルでPC,MOB,NPCいずれも居ないときに移動可能
	-> PC以外が使用してもPCと同等の動作をするように変更
	-> 習得者は緊急召集の詠唱時間が2倍

・旧式の走り高跳びのコードを消すのはもったいないので、「進入不可セルを無視した歩行を行う状態異常」として再利用
　（battle.c, clif.c, mob.c, npc.c, pc,*, skill.h, status.c, unit.*）
	-> SC_HIGHJUMP を SC_FORCEWALKING に改名
	-> pc_walktodir() を汎用型の unit_walktodir() に変更
	-> pc_highjumptodir() を改名して汎用型の unit_forcewalktodir() に変更
	-> SC_FORCEWALKING はPC以外に対しても効果を発揮する
	-> （備考）
		今のところ使い道がなく、スクリプト命令からのみ発動できるだけです
		何か良い転用アイディアがあったら活用してください
		効果時間は移動が完了するまでに掛かる時間よりも長くとってください
		短いと進入不可セルでスタックする恐れがあります
			sc_start3 286,0,0,0,10,3000,0;	// 向いている方向に10セル移動、3秒間操作不能
			sc_start3 286,0,0,0,0,60000,0;	// セル数を0にすれば1分間その場から移動不能に出来る

----------------------------------------
//2189 by Rayce

・駆け足（タイリギ）を本鯖仕様へ（battle.c, map.*, npc.c, pc.c, skill.*, status.c, unit.c）
	-> 解除時はSPを消費しないように修正
	-> 解除時にエフェクトが発生するように修正
	-> 移動中にPCかMOBかNPCが居る場合も停止するように
	   map_count_oncell() をタイリギにも利用するため汎用仕様に拡張
	-> 移動中にダメージを受けても停止しない
	-> 移動中はログアウトやゲーム終了できない
	-> 移動中でも接触型NPCには反応する
	-> 停止時はノックバックしてエフェクトを出すように、ノックバック距離はskill_db.txtを利用、デフォルトは3セル
	-> 1歩も動けない場合はノックバックしない
	-> 斜め方向の移動経路検索を修正
	-> 範囲を持つNPCにアタッチされても停止しない（mesとか）
	-> 再度タイリギを使用して解除するときは詠唱時間なし
	-> 移動5セル以内に再度タイリギを使用するとスパート発動
	   本鯖と挙動が微妙に違う気がしますが詳細不明なのでとりあえずはこれで保留
	-> パッシブ効果として蹴り4種使用時にスキルLv×10の必中ダメージ追加
	-> スパート状態のアイコン変更
	-> スパート状態の持続時間はskill_cast_db.txtのupkeep_time2を利用するように変更
	-> スパート状態はATK加算ではなくSTR+10されるように
	-> 障害物に接触して停止してもスパート状態は解除されない
	-> （備考）
		本鯖のパケット解析の結果、アイコン133（SI_RUN）をONにした後にスキルエフェクトのパケットを送らないといけない模様
		どうやらアイコン番号133（SI_RUN）には足跡を消す効果が含まれているようです
		SI_RUNにはアイコン表示もなにもありませんが、これが実は重要で、事前にSI_RUNをONにしてないと
		タイリギ解除時にエフェクトが出ないようです
		また壁にぶつかったときにはタイリギ衝突（SI_RUN_STOP）が必要なので、衝突時にはその都度
		clif_status_change() を呼び出すようにしてます
		ただし本鯖と違いON/OFFで2回呼び出さないようにしてます（特に問題ないと考えたため）

----------------------------------------
//2188 by Rayce

・テコンの蹴り関連の修正
	-> テコンランカーはコンボを無限に連携できるように修正（battle.c, skill.c）
		reported by Mag
	-> 蹴りの構え中でも移動できるように
	-> ランカーでない場合は１発蹴ったらコンボ状態終了
	-> ランカーでない場合は構えとは違う蹴りを使おうとしたら「スキル使用失敗」と言われてコンボ状態終了
	-> ランカーのときはコンボ中に同じ蹴りを２連続で使おうとしたらその時点でコンボ終了

----------------------------------------
//2187 by Rayce

・ポインタsc_dataの条件判定を念のため修正（battle.c, mob.c, skill.c, status.c，unit.c）
・2183のインデュアの変更をmobにも適用（mob.c）
・skill.cとstatus.cの細かい部分を整形
・status_change_resistclear() で status_calc_pc_stop_***() を呼び出すようにしておく

----------------------------------------
//2186 by Rayce

・2185でbattle_athena.conf及びbattle.hが巻き戻ってるので修正
・2185のディスペルによる種族状態異常の解除にSC_RACECLEARを使うように修正（skill.c）
・2182で早まって unit_movepos() まで変更してしまったせいで影跳躍による壁越えが機能しなくなってたので一時巻き戻し（unit.c）

・map_freeblock_unlock() の呼び忘れ箇所を念のため修正（mob.c, skill.c）
・pc_isupper() と pc_isbaby() をマクロに変更（pc.*）
・アイテム合成可能判定で養子チェックに pc_isbaby() を利用するように変更（skill.c）
・拳聖の温もり系がとりあえず作動するように修正、skill_db.txtのrangeを修正（status.c）
	reported by Y
・db/skill_db2.txtの場所によるスキル制限で指定されたスキルを使おうとした場合に
　「スキル使用失敗」メッセージが出なかったのを修正（unit.c）
・スフィアーマインの自爆詠唱開始時の条件チェックを少し変更（mob.c）
・warp構文だけでなくscript構文で書かれたワープに対してもヘルモードの杖が発動できるように修正（skill.c）
	NPCID 45 のワープが対象です、他のNPCIDには反応しません

----------------------------------------
//2185 by ARIA

・ディスペルで種族変更の状態変化が解除できるように追加(src/map/skill.c)
	この機能をbattle_ahtena.confでスイッチできるように追加(src/map/battle.c src/map/battle.h conf/battle_athena.conf)

----------------------------------------
//2184 by Rayce

・conf/char_athena.confでキャラスロットの最大数を定義できるようにする、デフォルトは9（char.c）
	5スロットまでしか許可したくない場合に、蔵改造されて9キャラまで作成されてしまうのを防止できます。
	またスロット数を減らしてもキャラセレクトの画面でマスクされるだけで、セーブデータ自体は維持されます。

・クリティカル耐性確率が100を越えるとクリティカルを喰らうようになってしまうバグ修正（battle.c）
	reported by Cocoa
・ゴスペル使用時にサウンドが鳴るように修正（skill.c）
・ブラストマイン、クレイモアトラップの巻き込み倍加が1回分多かったのを修正、ただのbreak抜け？（skill.c）

・SQL: txt-converter.exe実行時に発生するメモリリーク修正（converter.c, login-converter.c）
・SQL: sql-files/drop_table.sqlにホムの項目が抜けてたので追加

----------------------------------------
//2183 by ARIA

・シーズモードでインデュアを使ったとき、ＭＤＥＦ増加だけ適用されるように変更(韓国仕様)（pc.c）
	現在は、skill2.dbでインデュアがGv使用禁止になっているので、
	先取り仕様がいい場合は、そちらを変更してください。

----------------------------------------
//2182 by Rayce

・服染めに関する変更（atcommand.c, clif.*, pc.c, status.*, unit.*）
	-> 服色を返す status_get_clothes_color() 追加
	-> unit_change_clothes_color() を廃止して代わりに clif_send_clothcolor() を用意
	   （256色以上表示できるようになってるかも？）
	-> 服染め状態で忍者の影分身を使うとエラー落ちするのを回避するために
	   影分身時は強制的に服色を基本の0に戻すように変更（merged fron eA）
	-> 影分身中に@modelやsetlook命令で服染めできないように変更（強制的に0になる）
	-> @modelでの服染めを行う際、MAX_CLOTH_COLORの値がデフォルトである5以下の場合にのみ
	　 男アサシンとローグの判定を行うように変更

・pet.cを少し修正、それに伴って unit_stop_walking() の引数 type を少し修正
・unit_remove_map() 内
	- if(mob_get_viewclass(md->class) <= 1000) {
	+ if(mob_get_viewclass(md->class) < MAX_VALID_PC_CLASS) {

----------------------------------------
//2181 by Rayce

・battle_confing関連
	-> storagesort_by_itemidを追加（battle.*, storage.c）
		アイテムのソート方式を本鯖仕様にするための準備で今の所は特に深い意味はなし
	-> check_sitting_player_using_skillとcheck_sitting_player_using_skill_pを削除（battle.*, clif.c）
		わざわざスイッチする必要はなく、常にチェックを入れる「yes」の状態に変更します
	-> extra_system_flagをデフォルトでnoに変更
	-> check_skillpos_rangeの判定はPCにだけ行うように修正（skill.c）
	-> 一部の説明文を少し修正

・doc/command.txtの内容をdoc/conf_ref.txtに移動
・doc/db_ref.txtをほんの少し修正
・2179でconf/help.txtを添付し忘れ
・storage.cを少し修正

----------------------------------------
//2180 by ドシャブリ
(scr/map/pc.c)
・死亡時ドクロのドロップをPKMAPのみをできるように拡張

(conf/battle_athena.conf)
//PC死亡時に、アイテムをドロップするか
//0:しない 1:PvPマップのみ 2:いつでも 3:PKマップのみ
bone_drop: 0

----------------------------------------
//2179 by Rayce

・db/const.txtで負の定数が正常に読み込めなかったバグを修正（script.c）
	reported by sid
・スクリプトのnpcskill系統において、命令元のNPCがない場合（アイテムスクリプトから使用した場合）は
　プレイヤーからスキルエフェクトが発動するように拡張（script.c）

・スフィア—マインが勝手に自爆する可能性があるので、スフィア—マインは通常スキルを使用不可に修正（mob.c）
・2178のmobdb_checkid() への置き換えの抜け修正（mob.c）

・キャラ永続変数でセーブされるデータについて、スクリプトから変数を変更した場合即座に反映されるように改善（map.h, pc.c）
	変数のタイプを埋め込み変数（C_PARAM）に変更し、スクリプトから呼ばれる場合にはpc_setparam() を経由したのち
	pc_setglobalreg() を呼び出すという流れにします。
	今までは set PC_MISSION_TARGET,1002; としても対象のミッションターゲットをポリンに置き換えることが
	出来ませんでしたが、今後は可能になります。
	変数はconst.txtに登録してありますので参考に。
	また副次的な効果として、スクリプトに記載してなくても「@readvars PC_DIE_COUNTER」のようにいつでも読み書き可能です。

	※PC_WEDDING_TIME と PC_KILLER_ID はsdに変数を持たせるものではないため、この処理からは除外されています

・クローンスキルで習得したスキルをリセットしてもリログすると再び習得した状態になるバグを修正（pc.c）
	バグ修正氏のファイルを取り込み、thx a lot!!
・gvgスクリプトの修正 from AthenaDev
		posted by ルナ, thx a lot!!
	npc/gvg/npc_gvg_adswitch.txt
	npc/gvg/npc_gvg_flag.txt

・NPCスクリプトの quest/npc_event_diamond.txt でランダムIDに定数を利用するように変更

----------------------------------------
//2178 by Rayce

・mobスキルの条件タイプにおいて、targetstatusoffとmasterstatusoffが正常に機能してなかったバグを修正（mob.c）
	reported by Cocoa
・mobIDに関して（atcommand.c, mmo.h, mob.*, npc.c, script.c）
	-> MOB_ID_MAXとMOB_ID_MINをmmo.hからmob.hに移動
	-> 値の使い方を統一するために MOB_ID_MIN = 1001, MOB_ID_MAX = 2001 に変更
　	   mobとして使えるデフォルトのIDは1001〜2000までの1000個です
	-> mobIDの最小値がMOB_ID_MINになってない抜けを修正
	-> mobIDのチェックは出来るだけ mobdb_checkid() を利用するように修正
	-> mob_class_change_randam() 修正
	-> db/mob_branch.txt等のランダムモンスター選択時に失敗したときの処理方法を変更
		MOB_ID_MINを1001に変更したため、MOB_ID_MINのsummonperに保存するとおかしくなります
		その代わりに mob_dummy_class[] を用意して利用することにします

・2145以降、モンスターのランダム召喚系統が作動しなくなってる部分があるので巻き戻し
　	二重にチェックが行われることもあるので、mobdb_checkid() を呼ばなくしたり。
	@mobsearch, @summon, @itemmonster, @mobinfo, areamonster命令など。
・@mobsaerchに-3を指定出来るように追加（atcommand.c）
	-2はボス属性のモンスターを検索しますが、-3はMVPボスだけを検索します

----------------------------------------
//2177 by Rayce

・やっぱり pc_authok() で pc_checkitem() を実行するように戻す（pc.c）
・clif_cart_equiplist() で本来 MAX_CART とすべきところが MAX_INVENTORY になってたバグを修正（clif.c）
・アイテムを捨てられないときは失敗パケットを飛ばすように、2099の修正漏れの補完（clif.c）
	reported by Debian

・リロードやオーバーライドと整合性が取れずバグの温床になってる可能性があるのでdbの処理方法の変更（pc.c, homun.c）
		reported by よらん
	-> dbの読み込み時に初期化をするように
		exp.txt, exp_homun.txt, embryo_db.txt
	-> homun_db.txtとembryo_db.txtから変数homun_countとembryo_count撤廃
	-> homun_get_create_homunid() を変更

・@readvars, @writevarsで大文字の変数が正しく読み書きできなかった問題を修正、というより部分巻き戻し（script.c）
・db/const.txtにランダムアイテム用の定数 -16 〜 -20を追加

----------------------------------------
//2176 by Rayce

・2164以降、自爆中のスフィアマインや駆け足で移動出来なくなってたバグを修正（clif.c, mob.c, unit.*）
		reported by Lion
	強制的な移動中かどうかを判定する関数 unit_isrunning() 追加
	unit_can_move() は純粋にユニットが移動出来るかどうかだけを判定するように変更します
	ついでに unit_can_move() の処理を少し改善

・離婚処理で鯖が落ちるバグを修正（pc.c）
	reported by よらん, thx
・MAX_SKILL_LEVELの値を10→12に変更（map.h）
	mob由来の高Lvスキルをすっかり忘れてました…

----------------------------------------
//2175 by名無し＠
・SWの拡張工事
	(conf)
	battle_config.conf
	設定3種類追加
	拡張工事なので設定を無視しても通常の近距離物理攻撃は防げます。
	calc_dist_flag
		距離によってレンジマスクを変化させるのを指定(本鯖は3がデフォルト)
		+1：物理スキル　+2：魔法スキル
	sw_def_type
		攻撃者によってSWが有効か無効か(本鯖は2がデフォルト)
		+1：プレイヤーが攻撃した時有効
		+2：モンスターが攻撃した時有効
	allow_sw_dist
		上記の設定でどこまでの距離が有効か(本鯖は4がデフォルト)
		数値を大きくすると近距離判定する領域が大きくなります。
		0以下を設定するとSWが役立たずになりますので注意してください。
	(src/map)
	battle.h
		設定を読めるよう変更
	battle.c
		物理スキルが距離に応じてレンジマスクが変化するよう拡張。
		そのため今後は遠距離スキルを追加する場合は以下のようにしてください。
	-	flag=(flag&~BF_RANGEMASK)|BF_LONG;
	+	calc_dist_on = 1;
		魔法スキルが距離によってはSWで防げるよう拡張。
		魔法は最初に一括処理なので特に弄る必要はありません。
----------------------------------------
//2174 by よらん

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 2174

----------------------------------------
//2173 by Cocoa

・トワイライトファーマシーの成功率計算でLukが計算されてなかったのを修正。(skill.c)
・良い味付けの焼き肉の材料の1種類が「にく」ではなく「イエロージェムストーンだったのを修正」(db/produce_db.txt)
----------------------------------------
//2172 by よらん

・2170のlogin.c巻き戻し
login.cを文字化けさせているのはパッチとして導入することは
今後の開発に影響がでます。よって巻き戻し。
以後、このようなことがないように気をつけてください。
改めてパッチアップお願いします。
----------------------------------------
//2171 by Nameless
・CoreDuo / Pentium4 EX / AMD Athlon64 FX-??系にてBCC32(Ver5.5.x)の
ハード的なスタックを回避するためのコンパイルオプションを追加。

----------------------------------------
//2170 by Sapientia

・2102の login.c 修正 07-03aSakexe クライアントに対応していなかったです. (login.c)
  0x27c パッケ?ジが何なのか分からないから残しておきました.
・デスペラドを近接スキルで修正 (battle.c)
  デスペラドはフニュ??の影響を受けないと言うのに近接で修正しました.
  長距離攻撃ながらフニュ??の影響を受けないことか近接かは不確実です.

----------------------------------------
//2169 by End_of_exam

・2160のコーディングスタイル変更を巻き戻し(map.c)
・2160の修正漏れ(map.c)

 void do_final(void) {
 	...
-	for(i = 0; i <= map_num; i++) {
+	for(i=0;i<map_num;i++){
 		...
 	}
 	...
 }

勝手にコーディングスタイルを慣れ親しんだものに置き換えることは、過去の
開発者を侮辱する行為だと思います。特にmap.cには初期の開発者の名残が沢山
残っているので、それを何のためらいもなく修正する人は、今までの積み重ねを
尊重していないと思われても仕方がないでしょう。

今後とも、このような暴挙を行う人には厳しく対処する予定ですので、悪しからず
ご了承ください。

----------------------------------------
//2168-fix by Yor
Fixed: Check about inter_fd, char_fd and login_fd.
----------------------------------------
//2168 by Yor
Fixed: bug about intif_guild_memberinfoshort (crash with an invalid inter_fd).
Note: fd is correctly defined, but we must check fd before to use it.
Note2: This post cancels the 2165 and correctly fixs the related bug (0 is a reserved FD number = keyboard)
5 modified files:
	Readme2110
	/src/char
		char.c
	/src/common
		socket.c
	/src/map
		chrif.c
		intif.c

----------------------------------------
//2167 by Rayce

・2099以降、@readvars, @writevarsで他のプレイヤーの変数が操作出来なくなってたバグを修正（script.c）
	reported by 十六, thx
・check_cmdcountとcheck_gotocountの値をscript_configから変更出来るように（script.c）
	スクリプトを書いててどうしてもinfinity loopに陥ってしまう場合には最終手段で値を上げてみてください
	あまりお勧めはしません、それよりもinfinity loopが出ないように書き直す方が得策です

・ドキュメント周りの整理、主にconfigファイルの翻訳や説明追加（pc.c）
・npc_job_09wizard, npc_job_16sage, npc_event_momotaroから重複するmapflagを削除

----------------------------------------
//2166 by Rayce

・dbのオーバーライドはdb/addonフォルダに格納するように変更（homun.c, itemdb.c, mob.c, pet.c, skill.c）
　それに伴いファイル名の変更
	homun_db2.txt     -> homun_db_add.txt
	item_db2.txt      -> item_db_add.txt
	mob_db2.txt       -> mob_db_add.txt
	mob_skill_db2.txt -> mob_skill_add.txt
	pet_db2.txt       -> pet_db_add.txt
	produce_db2.txt   -> produce_db_add.txt
・新しくskill_db_add.txt, skill_cast_db_add.txt, skill_require_db_add.txtの3つを追加
・produce_db.txtのオーバーライドが正常に行われなかったバグを修正

　※ファイルの構成および名称を変更します
　　オーバーライド可能なdbの種類が多くなってきたのでaddonとして隔離することで構成の見通しを良くすること、
　　またdb変更を容易にカスタマイズ出来るようにするための処置です
　　（battle_configのimportと似たようなものです）
　　名称に関してはskill_db2.txt, skill_require_db2.txtが混同することを考慮したからです
　　今までオーバーライド系を利用されていた方は名称変更、およびファイルの移動をお願いします

----------------------------------------
//2165 by End_of_exam

・2088の巻き戻し(socket.c char.c chrif.c thanks to よらんさん)

----------------------------------------
//2164 by Rayce

・猛毒のオプションに128を使うように変更（status.c）
・mobが詠唱しながら移動出来ていた問題を修正（unit.c）
・skill.hを少し整理
・ストーンカースのアイテム処理変更をskill_check_condition2_hom() にも適用（skill.c）
・db/castle_db.txtから余分な項目を削除
・status.cを少し整理
	-> soul_throughフラグを使わない
	-> opt3の設定が二重に行われる無駄を削減

・利用頻度が低いのでMIN_HAIR_STYLE, MIN_HAIR_COLOR, MIN_CLOTH_COLORを削除（mmo.h）
　MAX_CLOTH_COLORの値を4→5に変更
・スクリプト命令のsetlookで髪型/髪色/服色を指定するときMAX_***の値を超えるときは実行しないようにチェック強化（pc.c）

・ペットもPC型mobが表示できるように修正
・clif_changelook() をまとめたunit_change_clothes_color() 追加
　服染めを維持するためにパケットを送り付ける用です、単純に色を変更する場合は直接clif_changelook() を実行しないとダメです
・mobとpetの表示パケットにopt3を追加
　petとhomの表示パケットにopt1, opt2, opt3, optionを追加（今は未使用だけど将来的な拡張を見据えて）
・オプションに値を入れたPC型mobにおいて、時々オプションが消えたりするバグを修正

　※PC型mobがopt3系のスキルを使うと、mobが移動しない限りshiftを押さないと攻撃できないようです
　　謎っぽい挙動なのでとりあえずは仕様ということにしておきます
　　あとPC型mobに対してホムが攻撃しないのはAIのせいみたい？PCとして認識してる気がします。

・mob_avail.txtの仕様変更、新たに「見た目のサイズ」と「服色」の2項目を追加
	服色はPCの服染めと同様です、独自に拡張してる色も付けることが可能です
	mobのview_sizeを変化できる機会がなかったのでmob_availでサイズ調整をやることにします
	これはPC型mobに限らず通常のmobでも設定可能です
		例）1002,1002,-1　＝　ちっちゃいポリン

　※項目が増えているのでいままでmob_avail.txtを利用していた方は移植してください
　　そのまま使うとずれたり、場合によってはエラー吐きます

----------------------------------------
//2163 by lkm
delete 'gm_mode', it`s inappropriate

----------------------------------------
//2162-fix3 by Yor
Improved: 'gm_mode' option in battle_weapon_attack function -> add a check about sd (unnecessary, because pc_isGM check it, but better for presentation of code).
2 modified files:
	Readme2110
	/src/map
		battle.c
----------------------------------------
//2162-fix2 by Yor
Fixed: 'gm_mode' option -> target type must be a player in battle_check_target.
2 modified files:
	Readme2110
	/src/map
		battle.c
----------------------------------------
//2162-fix by Yor
Fixed: 'gm_mode_player' option -> gm can now attack gm
Thanks to End_of_exam for bug report.
2 modified files:
	Readme2110
	/src/map
		battle.c
----------------------------------------
//2162 by Yor
Improved: swich 'gm_mode':
- to define minimum concerned GM level.
- switched in 2 option: gm_mode_player and gm_mode_mob
Fixed: 'gm_mode' in battle_skill_attack function.
4 modified files:
	Readme2110
	/conf
		battle_athena.conf
	/src/map
		battle.c
		battle.h

----------------------------------------
//2161 by lkm

add swich 'gm_mode'
   if use then monster or player not attack gm
     and gm not attack player or monster

----------------------------------------
//2160 by Yor

Removed: MAX_MAP_PER_SERVER definition. Now quantity of maps is dynamic.
Removed: block_mob and block_mob_count. Perahps useful for debug, but use memory AND CPU for nothing when software is not in debug mode.
Improved: some functions in map.c (map_addblock, map_foreachinpath, map_searchrandfreecell, map_readallmap, etc.).
Styling: Hamonize styling of map.c
4 modified files:
	Readme2110
	/src/common
		mmo.h
	/src/map
		map.c
		map.h

----------------------------------------
//2159 by Rayce

・2157でログイン直後に装備の効果が反映されてないバグが発生してたので修正（pc.c）
・オートスペルでテレポートLv1が発動した場合、ダイアログなしで即座に飛ばすように変更（pc.c, skill.c）
	reported by kina

・2158のディスペルによるレジスト状態の解除にSC_RESISTCLEARを使うように変更
・GvGにおけるスキル制限をskill.cから削除してdb/skill_db2.txtでのみ行うように変更（skill.c）
・ストーンカースのアイテム消費処理方法を変更
・ストーンカースが成功しての失敗しましたと言われるバグ修正

----------------------------------------
//2158 by Kiry

・ディスペルでレジスト状態を解除できるように追加

----------------------------------------
//2157 by Rayce

・2156を少し修正
・「ワープポータル」「あなたに逢いたい」「ママ、パパ、来て」「坊や、いらっしゃい」が
　battle_configのplayer_land_skill_limitの影響を受けてなかったバグを修正
・火炎陣がskill_db.txtのmaxcountの値を反映するように修正（skill.c）
	reported by anoym
・カードスキルをロストしたとき即時発動型なら状態異常を解除するように修正（status.c）
	reported by queue and testarossa

・mapflag別で使用不可なアイテム（ハエの羽や古木の枝など）の処理をpc.cから切り離して
　item_prohibition_zone.txtで制御するように変更（pc.c）
・item_prohibition_zoneにテレポ禁止区域（+32）、リターン禁止区域（+64）、枝禁止区域（+128）追加

・pc_authok() ではpc_checkitem() を実行しないようにしてみる（pc.c）
　clif_parse_LoadEndAck() でも実行されるので結局二重に演算されてたはず
・@itemcheckにおいて念のためアイテムリストのパケットを送信するように修正（atcommand.c）

・db/item_noequip.txtを廃止（itemdb.*, pc.*）
	-> データベースの読み込み処理を全部削除
	-> pc_check_noequip() 削除
	-> pc_check_prohibition() 追加

　　※今後は装備品の制限を消費アイテムと同様にitem_prohibition_zone.txtで行います
　　　item_noequipを利用されていた方はすみませんがitem_prohibition_zoneへ移植してください

----------------------------------------
//2156 by Kiry

・ディスペルで魂とカー系スキルの状態を解除できるように修正

----------------------------------------
//2155 by Rayce

・旧式クローンスキルに関する処理を削除（char.c, int_homun.c, map.h, pc.c）
・MAX_SKILL_LEVELの値を20から10に変更（mmo.h）
	CLONE_SKILL_FLAGを削除しましたので、MAX_SKILL_LEVELの変更だけでスキルLvの上限を変更できます
	古いセーブデータによるクローンスキルはこれ以後互換性がなくなりますので注意してください

・2153のスティル関連修正
	-> atcommand.cの一部が巻き戻ってたので修正
	-> conf/battle_config.athenaが付属してなかったので添付
	-> steal_rateの値はデフォルトで100
	-> steal_rateの値を100以上に設定できるように変更

----------------------------------------
// 2154 by Hyoga

	テコン系列のJob補正値の修正。(db/job_db2.txt)
	(created by y [本鯖相違スレ4 70])
----------------------------------------
// 2153 by T.N
お騒がせしました。
- battle.c, battle.h, battle_athena.conf
	スティールの成功率補正をbattle_configのsteal_rateとして設定するように。
- pc.c
	スティールの成功率計算式を、
		成功率(万分率) = DropRate * ((自DEX - 敵DEX)/2 + SkillLv*6 +10) * steal_rate / 10000 + 1
	に修正。
- mob.c
	mob_db[x].dropitem[y].pには、補正前のDrop率(==dbに記載されている
	素のままの値, 万分率)が入るように修正。
	ItemのDrop判定の際(mob_damage())には一々補正作業が入りますが、
	これによるパフォーマンスの低下は殆どないと思います。
	これが無視できないレベルに達する場合は、ご報告ください。
	素の値を入れておけば、将来似たような事例が発生した場合に対応
	しやすいと思い、このようにしました。
- atcommand.c
	atcommand_mobinfo(): mob.cの修正に併せて修正。
	
アイテムドロップ率補正をスティールの成功率に反映すると、一つの種類の
アイテムしか盗めなくなりそうなので、今回は個別補正値を導入することで
対応しました。
----------------------------------------
// 2152 by huge
	mob_availを使って転生職の姿をしたMOBを出した時に、
	武器を持たせるとエラーが出ていたのを修正。
	※availで指定する武器の番号は、view値じゃなくitem_idを指定するようにして下さい。
	ついでに、PC型MOBをshiftを押さなくても攻撃できるように。
	(src/map/)
		clif.c

----------------------------------------
// 2151 by 報告は開発板へGO
	clif.cのみ
	2148のjA式対応版。エラー表示無し確認
	(thx 2chAthena開発板住民)
----------------------------------------
// 2150 by Yor
Fixed: displaying of the socket configuration file name on error.
Improved: when RFIFO can not be parsed, close connection even if it's not a player (not necessary to try again).
Added: Connection on winsock 2.0 if it's possible (not only use old winsock 1.1).
Added: Displaying of used winsock version at start.
Changed: Type of some functions: delete_session, WFIFOSET, SessionInsertSocket, do_sendrecv, do_parsepacket, socket_config_read(2) and WFIFORESERVE.
Fixed: possible crash with access_allow and access_deny (and init them and use aFree instead of free).
Clean up socket.c.
Fixed: remove $ as possible character for command_symbol (guild chat speaking) of Chronos.
5 modified files:
	Readme2110
	(conf/)
		atcommand_athena.conf
	(src/common/)
		socket.c
		socket.h
	(src/map/)
		atcommand.c

----------------------------------------
//2149 by Rayce

・2147を巻き戻し（map.h, pc.c）
	既存のもので表現できるのに余計なコードを増やすのは極めて無駄です
・2148を巻き戻し（clif.c, mob.c, pc.*）
	以前のtransを指定する仕様に戻します！
	NPCスクリプトと同様のjob番号とupperで見た目がPCのmobを正常に生成可能です

----------------------------------------
//2148 by 逆毛鰻

jA特有のJob番号に転生か養子かの番号をプラスしているだけでややこしいのでmob_availのtrans廃止
availを使って運営している人はExcel等で最後の行を一括削除して、2行目のview_class部分を
新しいものに書き換えてください。※doc/db_ref.txtに詳細を追記。

	(doc/)
	db_ref.txt
		mob_avail.txt,item_について追記。
	(src/map/)
	clif.c
		clif_mob0078()、clif_mob007b() 修正
	mob.c
		mob_readdb_mobavail() 修正
	(db/)
	mob_avail.txt		バイオプラントmob 暫定実装〜使用されていないので削除

----------------------------------------
//2147 by lkm

add 'bonus bAllStats,n;'
bonus bAllStats,n;  STR.AGI.VIT.INT.DEX.LUK+n

----------------------------------------
//2146 by Rayce

・2141のバイオプラントに関する変更を巻き戻し
・skill_db.txtのmaxcountをレベル別に設定出来るように拡張
・バイオプラントmobからHomへは敵でも味方でもないように変更（battle.c）
・pc_atuthok() で2回初期化されてた部分を削除（pc.c）

・バイオプラントmobの攻撃によるnullpoエラーを抑制（mob.c）
	reported by あちゃこ
・トゥルーサイトがQMの影響を受けないように変更（status.c）
	reported by Cocoa

----------------------------------------
//2145 by Chronos

Reading configuration of GM commands has been improved.
Adding of synonyms for GM commands.
Some GM commands have been improved (example: @monster can use "name with spaces" with ", @refine can now reduce or increase the value, etc.).
Symbol of GM commands can now be choosen.
A new function (mobdb_checkid) can check validity of a mob_id.

----------------------------------------
//2144 by Kiry.

・露店の税金システムを実装
　battle_ahtena.confのtax_rateで0〜100％まで設定できます。
----------------------------------------
//2143 by Rayce

・スパノビに対して「set JobLevel,99;」を実行しても70までしか上がらなかったバグを修正（pc.c）
・カード効果による反撃がPC以外に作動してなかった問題を修正（battle.c）
		reported by Cocoa
	castcheckのおかげでバグが浮き彫りになったといったところです。
	そういう意味でも2140は非常に意義のあるものだったと思います。

----------------------------------------
//2142 by Rayce

・バイオプラントmobがスキルを使えるように修正（mob.c）
	-> 条件タイプ「friend系」における味方は範囲内に存在するPCを指します、無差別に選択します
	-> 条件タイプ「master系」におけるマスターは召喚主を指します
	-> STATE: commandとmodechangeにおけるfriendやmaster指定は残念ながら対応してません

・バイオプラントや@summonで召喚されたmobはアゾートによる変化を受けないように修正（skill.c）
・MAXSPのときに生命力変換が発動しないように修正（skill.c）

----------------------------------------
//2141 by Rayce

・MAX_PACKET_DBを0x275から0x27dへ拡張（clif.h）
・バイオプラントがmaxcountの値を反映してなかったのを修正（skill.c）
	reported by ased and miso
・離婚時に「離婚しました」のメッセージを送るように修正（chrif.c, clif.*, pc.c）
	merged from eA
・2131以降、スフィアマインが自爆詠唱中に移動しなくなってたバグを修正（mob.c）
・サクライが実際にどうなのかはわかりませんが「畳返し」をユニット設置スキルに変更してエフェクトを出すように修正（skill.c）
	エフェクトを最後までキレイに見せるために1secくらい持続させてます
	そのためskill_unit_db.txtのinvertalを2secにして重複させないという特殊仕様になってます

----------------------------------------
//2140 by End_of_exam

・BL_CAST マクロの仕様変更及び BL_DOWNCAST への置き換え
　(battle.c map.h mob.c skill.c status.c unit.c)
・正しくキャストが行われていない可能性のある箇所を挙げるスクリプトの追加(castcheck)
・オートスペルとマジックロッドがキャストチェックに引っかかったので修正(battle.c)

　castcheck は余り賢く無いので、誤爆が多数含まれていますが、中には無視できない
　箇所も幾つか含まれています。暇な方がいましたら、チェックに引っかからないように
　修正を進めてくれればと思います。

----------------------------------------
//2139 by Rayce

・テコン/拳星スキルの共通パケット0x20eをeAから移植して補完（clif.*）
・テコンミッションの変更確率を5%から1%に修正（mob.c）
・「太陽と月と星の感情」を新規登録する際には確認ダイアログが出るように（skill.c）
　ただし相変わらず保存はされません・・・リログで解除されます
・「太陽と月と星の憎しみ」をPCに使用した場合、転生かどうかを区別するように修正（battle.c）

・状態異常タイマーのIDが合わないときのエラーログにtypeを出力するように追加（status.c）
	「status_change_timer %d != %d」のエラー解析用に情報を増やしておきます
・「太陽と月と星の融合」をもう１度使うと解除されるように修正（skill.c, status.c）

----------------------------------------
//2138 by Rayce

・白羽取り中でもアイテムを使えるように修正（clif.c）
	reported by free
・@refineで両手武器が二重に精錬される2101でのミスを修正というより巻き戻し（atcommand.c）
	reported by Keel
・メテオストームの落下地点に障害物がある場合は落下しないように修正（skill.c）
	reported by Hyoga

----------------------------------------
//2137 by T.N

・スティールの成功率が低いのを修正。
万分率での計算のはずが百分率になっていました。(pc.c l.3380)

----------------------------------------
//2136 by Rayce

・AIバグをさらに修正（clif.c）
・@homlevelでパケットを無駄に送りまくらないように処理改善（atcommand.c, homun.h）

----------------------------------------
//2135 by End_of_exam

・2102でmemcpyの長さが24文字を超えるバグを修正(login.c)
・2131のAIバグ修正(unit.c homun.c)

----------------------------------------
//2134 by GcwMfHQ

・NPCスクリプト修正＆更新 thanks to AthenaDev
	(script/warp)
		npc_warp_dun.txt
	(script/npc/job)
		npc_job_12assassin.txt
		npc_job_18alchemist.txt
・db等の更新 thanks to huge cgi
	(db)
		mob_db.txt
		mob_skill_db.txt
	(script/mob)
		npc_monster.txt
		npc_monster_future.txt

----------------------------------------
//2133 by Rayce

・隠れ蓑状態でのハイドやグリムが使えてた問題を修正（skill.c）
・治療の手助けをレッドスリムポーション1個消費に修正
・@summonとスクリプトのsummon命令を少し修正（atcommand.c, script.c）
・その他細かい修正（pc.c）

----------------------------------------
//2132 by Yor
Added: some 'hard' messages in msg_athena.conf.
9 modified files:
	Readme2110
	(conf/)
		msg_athena.conf
	(src/map/)
		atcommand.c
		chrif.c
		friend.c
		guild.c
		pc.c
		script.c
		skill.c
TODO: status.c, and some GM commands in atcommand.c.

----------------------------------------
//2131-fix by Yor
Fixed: compilation warnings.
4 modified files:
	Readme2110
	(src/map/)
		homun.c
		mob.c
		pc.c
----------------------------------------
//2131 by Rayce

・ホムがMOBの視界内に出入りしたときにもAIリンクリストに登録/削除するように修正（mob.c, unit.c）
　「ホムがMOBに攻撃→PCが視界外へ移動」すると、MOBは手抜きモードのAIになってた問題が解消されます
・定数BL_***をビット演算できるように値変更（map.h）
・map_foreach系関数のtypeをビットで処理するように改善（map.c）

・mob_can_move() とclif_parse_WalkToXY() の一部をunit_can_move() に統合（clif.c, mob.c, unit.c）
・伏虎拳の移動停止効果をステータス異常として処理するように変更（skill.c, status.*）

・「ボス属性ならアンクルに吸い寄せられない」処理が上手く折り合いが付かないので、吸い寄せられるように巻き戻し
	ログアウト時に二重freeされるバグを含んでいるのと、chase状態のmobが相変わらずアンクルを踏み潰してくるので
	良い手が見つかるまで保留にします

・霞斬りによるハイド状態を「隠れ蓑」と表現する、暫定でオプションは0x4002としてます
・動画の情報ではアイコン出ないので、隠れ蓑とハイドは別物扱いにする
・隠れ蓑時間をシーフスキルのハイドと同じにしてみる
・影跳躍後に隠れ蓑状態が解除されるように修正
	SC_KAUREMINO追加
	pc_iskakuremino() 追加

----------------------------------------
//2130 by kiry.

・エレメンタルチェンジが各属性コンバータを消費するように修正

----------------------------------------
//2129 by Rayce

・battle.cで「グランドクロスでないとき」の条件判定が論理的に間違ってたのを修正
　恐らく武器スキルとして計算されてたので、ダメージがおかしくなってたと思います
　こんな初歩的なバグが今まで生き残ってたことにある種感動すら覚えました・・・

・battle_skill_attack() におけるダメージ追加効果の処理を修正
・battle_configのmob_changetarget_byskillがオンのとき、攻撃主がホムであっても攻撃ターゲットを変えるように変更

・mobのAIで攻撃対象以外をターゲットしたときのログに、typeとIDを出力するように
	ルートmobを召喚すると稀に出力されるみたいなので、詳細な原因追及のために情報を増やしておきます
	コンソールに "mob_ai_sub_hard target type error" のログが見られたら報告お願いします

・手抜きモードMOB AIにおいて、沸き直したりワープしたりする処理部分が正常に機能してなかった問題を修正
・PCの近くにいるときは手抜きモードAIを実行しないように修正
・手抜きモードのときにもスキルを使用できるように追加
	PCが視界内に居なくてもヒールでHPを回復したり出来るようにするためです
	LAZYSKILLUSEPERCを好きな値に変えて調整してください
	負荷が気になるのなら0にすれば無効化できます

・mobskill_use() の仕様変更
	-> 関数の引数であるeventに値を入れた場合は、その条件でしか照合しないように変更しました
	　 即ちdbの優先順位に関わら指定条件のスキルを使用させることが可能です
	-> mob_skill_db.txtにおける条件を 常時型 / 反撃型 / 特殊型 の3つにカテゴライズします
	-> AIから呼び出されるときは常時型しか条件判定しません
	-> 反撃型は敵から何らかの攻撃を受けたときにのみ判定します
	-> 特殊型はそれ以外です（今のところはonspawnの沸いた瞬間でのみ）

・mobスキルのcasttargetedが「詠唱のターゲットにされたら」になってなかった（むしろ全く発動しなかった？）問題を修正
・非移動のmobがPCの近くに居るとき、攻撃射程外だったときはスキルを使えなかったのを使えるようにしてみる
・mobスキルのrudeattackedの条件を以下のように変更
　変なタイミングでテレポしたりと気持ち悪かったので勝手な妄想で書き換えました
　なにか情報ありましたら提供願います
	-> 動けるときで、例え移動したとしても攻撃できない場所（崖打ちとか）から攻撃されてて、周囲に他の敵が居ないとき
	-> 動けないときで、射程内に攻撃主が居なくて、周囲に他の敵が居ないとき

・エスク、及び魂スキル使用後にエスマ詠唱可能状態になってなかったバグ修正（skill.c）

----------------------------------------
//2128 by Yor
Updated: in packet_db.txt: 0x0168,14,guildinvite,2,6,10.
Check: source of invitation in a guild.
Fixed: message size when a character leaves a guild.
Used: 2 messages from msg_athena.conf instead of 'hard' message (clif.c).
3 modified files:
	Readme2110
	(db/)
		packet_db.txt
	(src/map/)
		clif.c

----------------------------------------
//2127 by End_of_exam

・2126のオンライン状況更新のバグ修正(char.c)
・Yor 氏による2088-fix以降のsocketのバグ修正（一部巻き戻し）　(socket.c)

To Yor:
DO NOT CHANGE CORE FUNCTION UNTIL YOU UNDERSTAND WHAT THE CHANGE EFFECTS
AND DIFFERENCE BETWEEN WINDOWS AND *INX SYSTEMS.

----------------------------------------
//2126 by lkm
add 'online update in char table' thanks to Ravak
fix homun_skill_tree.txt error in id 6015
add 'skip //' in converter.c

----------------------------------------
//2125 by Yor
Updated: a little some help files.
Fixed: maximum/minimum levels with @lvup and @charbaselvl commands.
Fixed: duplicated message 122 in atcommand.c (for 2 different things).
8 modified files:
	Readme2110
	(conf/)
		help.txt
		help1.txt
		help2.txt
		help3.txt
		help4.txt
		msg_athena.conf
	(src/map/)
		atcommand.c

----------------------------------------
//2124 by Kiry.
スキルDB関係の参照用の名前が本鯖の名前になってなかったので修正

----------------------------------------
//2123 by Yor
Added: name of skill 10005: GD_GLORY#ギルドの栄光
7 modified files:
	Readme2110
	(db/)
		guild_skill_tree.txt
		guild_db.txt
		guild_db2.txt
		guild_misfire.txt
		guild_prohibition_zone.txt
		guild_require_db2.txt

----------------------------------------
//2122 by Rayce

・パケット0x2b28用のバッファサイズの拡張し忘れ修正（char.c）
	pointed out by BBB, thx.
・グランドドリフトの追加ダメージをとりあえずで入れる（battle.c）
・SC_MDEFとSC_MATK、SC_MMDEFとSC_MMATKがそれぞれ入れ替わってたのを修正
	reported by tam

----------------------------------------
//2121 by Rayce

・「ママ、パパ、来て」「坊や、いらっしゃい」実装（intif.c, skill.c）
・「パパ、ママ、大好き」が敵指定スキルになってたためにエフェクトが出なかった問題を修正
・養子要請を重複して送れないように修正（clif.c, guild.c, map.h, party.c, pc.*, trade.c, unit.c）
・養子解体時にメッセージを表示するように変更（char.c, chrif.*, pc.c）
　それに伴いchar鯖用のパケット長を30に変更

・火炎陣は足元にユニットを設置しないように修正、skill_unit_db.txtも少し修正
・グランドドリフトのユニット設置処理を少し修正

----------------------------------------
//2120 by Rayce

・Y氏紹介の動画を元に忍者スキル修正、thx a lot!!
	-> 火炎陣をユニット配置型スキルに変更し（ユニットID: 0xbd）、ダメージを与えたら消えるように
	-> 爆炎龍を対象指定スキルに変更し（ユニットID: 0xba）、エフェクトを表示するように
・デスペラードに畳返しのエフェクトが混ざってたバグを修正
	reported by ショウ
・clif_skill_fail() の呼び出し前にsdのNULLチェックが抜けてた部分を修正（skill.c）
・2115以降、テコン/拳聖/ソウルリンカーのJobが50以上上がらなくなってた問題を修正（pc.c）
	reported by LebrEf

----------------------------------------
//2119 by Yor
Improved: not more need to activate new_account option to use httpd_new_account.
Fixed: a warning in pc.c.
4 modified files:
	Readme2110
	(conf/)
		login_athena.conf
	(src/login/)
		login.c
	(src/map/)
		pc.c

----------------------------------------
//2118 by Yor
Updated: help.txt with command.c: just add forgotten commands.
6 modified files:
	Readme2110
	(conf/)
		help.txt
		help1.txt
		help3.txt
		help4.txt
	(src/map/)
		atcommand.c

----------------------------------------
//2117 by Rayce

・本鯖準拠の養子システム実装
　右クリックで要請できます、何故か中途半端なままになってたので正常に機能するようにしました
	-> パケット0x1f6, 0x1f7の読み込み追加
	-> マクロmap_charid2sd() 追加
・スクリプトのadoption関数の第二引数を省略可能に変更
・養子解体を行うスクリプトbreakadoption関数追加
	-> char鯖用のパケット0x2b28,0x2b29追加

　※パケットは解析したわけじゃなくて当てずっぽうで探し当てただけですので
　　違ってたら指摘お願いします（詳細はclient_packet.txtで）。

----------------------------------------
//2116 by Yor
Fixed: @mobsearch GM command.
Moved: mobsearch_sub function near @mobsearch GM command.
3 modified files:
	Readme2110
	(conf/)
		msg_athena.conf
	(src/map/)
		atcommand.c

----------------------------------------
//2115 by Blaze

・テコンキッド、拳聖、ソウルリンカーのJOBEXPテーブルを修正（pc.c）
	それに伴い、exp.txtも更新
・battle_confingに「ペットの移動速度をPCに合わせる」命令を追加（battle.c, battle.h, pet.c）
	デフォルトyes、noで従来のpet_db.txt依存になります

----------------------------------------
//2114 by Rayce

・スクリプトのgetguildmasterid関数で発生するメモリリーク潰し（script.c）
	reported by あちゃこ
・@evolutionのバグ修正（atcommand.c）
	reported by 十六
・battle_confingに地面指定スキルの詠唱完了時に距離チェックをするかどうかを追加（battle.*, skill.c）
	デフォルトでは「チェックしない」です
	射程外の位置に使おうとすると歩き出すのに、スキル使用失敗と言われる気持ち悪さから解放されます

----------------------------------------
// 2113 by Yor
Improved: check of 256 colors emblem (even if norm is not respected, like with some savings of photoshop).
Added: an option to accept 16 bits and/or 32 bits BMP pictures for emblem.
6 modified files:
	Readme2110
	(conf/)
		battle_athena.conf
	(doc/)
		conf_ref.txt
	(src/map/)
		battle.c
		battle.h
		clif.c

----------------------------------------
//2112 by Blaze

・タイリギの素手時威力増加のパッシブ効果を追加（battle.c）
・タイリギ時の速度修正（status.c）
・テコン系列天使の祝福効果追加（pc.c）
・スティール計算式修正（pc.c）
・石投げに暗闇効果追加（skill.c）
・エスマ他スキルの詠唱時間修正（skill_cast_db.txt）
・テコンキッド転職スクリプト修正
・拳聖、ソウルリンカー転職スクリプト追加
・warp_dun、warp_fildをノーグハルトに対応
・monster、monster_futureを最新化

----------------------------------------
//2111 by Rayce

・カートターミネーションでスキルLvが16のときは鯖が落ちるバグを修正（merged from eA, battle.c）
　ついでにPC以外が使ったときはカート重量8000としてダメージが増加するように変更
・銭投げをお金消費なしに設定している状態でPC以外が銭投げを使うと鯖が落ちる可能性を修正
　この場合はPCのときと同じダメージになります
・スクリプトでrand(0)とした場合に鯖落ちしないように乱数そのものを返すように修正（script.c）

・マグナムブレイクのダメージが内周と外周で変わるように修正（battle.c, skill.c）
　ダメージ追加用にステータス異常の仕込みだけ（status.c）

・アイテムボーナスにbNoKnockback追加（map.h, pc.c, skill.c）
　db/const.txtおよびdoc/item_bonus.txt更新
・Translated battle_athena.conf and doc/conf_ref.txt

----------------------------------------
//2110 by どっかの嫌われGM

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 2110

----------------------------------------
// 2109 by Yor
Improved: zeny penalty configuration -> 3 parameters: zeny_penalty, zeny_penalty_percent, zeny_penalty_by_lvl.
          note: zeny_penalty is an absolute value of penalty now. Use zeny_penalty_percent to give a rate penalty.
6 modified files:
	Readme2060
	(conf/)
		battle_athena.conf
	(doc/)
		conf_ref.txt
	(src/map/)
		battle.c
		battle.h
		pc.c

----------------------------------------
//2108 by Rayce

・2092以降「月明かりの下で」の吹き飛ばし効果がなくなってた問題を修正
	skill_unit_onplace_timer()
・一部の@コマンドにおいてGMレベルが等しい場合でも効果が発揮されるように変更（atcommand.c）
・pc.hで存在しない関数をコメントアウト

・スクリプトのmes命令において空文字は送信しないように変更
・チャットルームのないNPCに対してdelwaitingroom命令を実行したときにnullpoエラーなしで終了するように修正（chat.c）
・getnpcposition命令でポジションが変更されてなかったのを修正

・successremovecards, failremovecards命令の機能拡張
	-> ID 4000〜5000でなくてもカードなら外せるように変更
	-> 引数を1つ増やす、指定位置のカードのみを外すことが可能になります、詳細はscript_ref.txtへ
	-> 位置指定ではなくて指定IDのカードだけ外させたい場合は
	　 一旦getinventory_list命令を実行し@inventorylist_card* の値から判定してください

----------------------------------------
// 2107 by Blaze
・リヒタルゼンクエスト追加（研究所進入、友達クエスト）
・ニブルヘイムボスの沸きスクリプトを追加
・テコンキッド転職実装
・タナトスタワー、アビスレイクの入口実装
・ジュペロス実装（保安区域未実装）
・ホムンクルスクエスト最適化
・map_athena.conf、ノーグハルトに対応

----------------------------------------
// 2106 by Yor
Fixed: can not more create account with less than 4 char when using _F/_M.
Improved: Search length of connection packet (login-server) only if necessary.
2 modified files:
	Readme2060
	(src/login/)
		login.c

----------------------------------------
//2105 by Rayce

・NPCスクリプト構文の改善（script.c）
	-> for( ; ; ) のように半角スペースが入っていても正しく解釈されるように修正
	-> if(...); や for(...) { ; } が正しく解釈されるように修正
	-> if(...): のようにセミコロンではなくコロンになっている場合はエラーを出すように変更
	-> 文字数0のラベルは登録できないようにチェック強化、"label length 0" が出力されます

・2049で暫定処置扱いにしてたソウルドレインをちゃんと修正（battle.c, mob.c）
・"label length 0" 警告が出るスクリプトの修正
	script/npc/job/npc_job_09wizard.txt
・mob_skill_db.txtの警告潰し
・2102でgccコンパイル時の警告潰し（login.c）

----------------------------------------
//2104 by lkm

add new map to 'go' command
update 'atcommand_go_significant_values'
	(conf)
		battle_athena.conf
		help1.txt
		help.txt
	(src\map)
		atcommand.c

----------------------------------------
//2103 by GcwMfHQ

・NPCスクリプト修正 thanks to AthenaDev
	(script/npc/job)
		npc_job_12assassin.txt
・db等の更新 thanks to huge cgi
	(conf)
		mapflag.txt
	(db)
		item_db.txt
		mob_db.txt
		mob_skill_db.txt
	(script/mob)
		npc_monster.txt
		npc_monster_future.txt

----------------------------------------
//2102 by subst

・07-03aログイン対応　(login.c, packet_db.txt)
・場所スキルエフェクトパケットで使用されなくなっているデータを削除　(clif.c)
　2006/03頃jROにおけるランドプロテクター他設置系スキルのパケット調査にて確認。
　03-06a,04-17a,07-03aSakにて長期的に動作テスト済。日蔵での詳細なテストは未済。
　「LPを出すとラグる」といった症例報告が緩和されると思われます。

--------------------------------------------------------------------------------
//2101 by Rayce

・atcommand.cを全体的に修正、特に@refine
・1783以降、走り高跳び（ノピティギ）が壁を越えられなかったのを修正（path.c, map.h）
・影跳躍が崖打ち可能セルを越えられるように修正（skill.c, unit.c）
　	path_search3() 追加
	移動不可セルをすり抜けさせて表示させるためにはclif_blown() を使わないとダメみたいです
		reported by testarossa

----------------------------------------
//2100 by Rayce

・デスペラードで敵の数だけ弾丸が消費されてしまうバグを修正（battle.c, skill.c）
・MAP移動時にホムのHP/SP自然回復が停止してしまうバグを修正（unit.c）
・文字列と数値の二項演算を実行したときメモリリークが発生するのを修正（script.c）

----------------------------------------
//2099 by Rayce

・スクリプトで多次元配列を扱えるように拡張（script.c）
・@readvars, @writevarsを多次元配列に対応（atcommand.c, script.h）
・doc/script_ref.txtに追記
	内部処理的には @val[2][1] を「@val[2]」という変数名で登録していきます
	文字列の場合には @str$[3][2][1] を「@str[3][2]$」という変数名に変換してます。
	eAのsetd, getdに比べたら汎用性は下がりますがこの形式の方が直感的で使い易いはず。

	（裏技）
	　本来配列が使えない変数（キャラクター永続変数など）も2次元以上の要素を使うことで配列化できます。
	　単に規制してないだけで、非推奨としておくために敢えてdoc/script_ref.txtには記載しません。

		例) 	// NUMBER,NUMBER[1],NUMBER[2]という3つの変数を配列的に扱う
			for(set '@i,0; '@i<3; set '@i,'@i+1) {
				set NUMBER['@i][0],'@j*10;
				set '@j,'@j+1;
			}

・マヤパープルカードの効果で、ハイドが見破られると動けなかったり
　カードを持ってないPCにも姿が見えたりするバグを修正（clif.c）
・未使用だったstatus_check_tigereye() とstatus_check_attackable_by_tigereye() をコメントアウト

・アイテムボーナスにbSkillDelayRate追加（map.h, pc.c, skill.c, status.c）
・db/const.txtとdoc/item_bonus.txtに追記
・bHPRatePenaltyUnrigとbSPRatePenaltyUnrigが%減少になってなかったのを修正（pc.c）
		merged from AthenaWiki

・storage_flagをの値を変更（clif.c, guild.c, intif.c, map.h, pc.c, storage.c, unit.c）
	0: 倉庫未使用, 1: 個人倉庫使用中, 2: ギルド倉庫使用中
・ギルド脱退/追放時にギルド倉庫を閉じるように修正
	誰も使ってないのにギルド倉庫が開けない現象が解消されるはず
・倉庫使用中はアイテムを使えないように修正

・1つのPTに同一アカウントのキャラが加入できるかどうかをbattle_configでスイッチ可能にする（battle.*, party.c）
　デフォルトでは当然ながら「加入不可」です
・敵が捕捉された状態のアンクルに対して、グリムトゥースでダメージが通るように修正（skill.c）
・GvGなら罠持続時間4倍に修正（skill.c）
・bin/tool/bench.batのタイプミス？修正

・捨てられないアイテムを捨てようとすると、以後全てのアイテムが使えないバグを修正（clif.c, pc.*）
		reported by BBB
・SPが0になったとき演奏/踊りのスキルユニットを削除するように修正（status.c）
		reported by Mag
・ディスペルの対象スキル修正（skill.c）
		reported by luc
	解除可能 → 暗闇、白刃取り、メモライズ、プリザーブ
	解除不可 → リジェクトソード、ウィンドウォーク、トゥルーサイト

----------------------------------------
// 2098 by にゃか
・殆ど使用されていない mob_db の SP の値を
  他の用途にも使用するオプション追加(とりあえずMATK補正のみ)
	(src/map/)
		status.c
		battle.c
		battle.h
	(conf/)
		battle_athena.conf
	(doc/)
		conf_ref.txt

例)アモンラーのMATKを10倍にする
	battle_athena.conf)
		mob_take_over_sp:1
	mob_db.txt)
		1511,AMON_RA,アモンラー,88,1214138,1000,87264,35891,3,1647,2576,26,52,1,1,90,124,74,45,10,12,2,7,62,180,100,1872,672,480,7211,8000,1552,5,985,3500,607,3000,616,450,5053,250,2615,100,512,0,512,0,4236,2,65448,10000,607,2000,608,800,732,735
	※詳しくは、battle_athena.conf または conf_ref.txt をご覧下さい。

----------------------------------------
// 2097 by Blaze
・モンスターが沸いた時にスキル使用する命令"onspawn"を追加。(mob.c、mob.h)
・mob_skill_dbを最新化。

----------------------------------------
// 2096 by Yor
Fixed: include <winsock.h> for inet_addr when reading listen_ip (win32).
4 modified files:
	Readme2060
	(src/char/)
		char.c
	(src/login/)
		login.c
	(src/map/)
		clif.c

----------------------------------------
// 2095 by Yor
Fixed: initialisation of sensor counter and structure.
Improved: remove internal function of graph.c from graph.h.
Commented: graph_getpixel function actually not used.
Added: Information message when a sensor can not be created.
Fixed: check on fd when a client try to 'connect' (specialy for win32).
Improved: connect_client function.
Added: check on valid fd in socket.c functions.
Added: check result of setsockopt (socket.c).
5 modified files:
	Readme2060
	(src/common/)
		graph.c
		graph.h
		socket.c
	(src/login/)
		login.c

----------------------------------------
// 2094 by Yor
Fixed: warning message about admin_pass (because now ladmin_pass exists).
Fixed: possible crash with account creation (invalid length calculation).
2 modified files:
	Readme2060
	(src/login/)
		login.c

----------------------------------------
// 2093 by Yor
Changed: 'illeagal' -> 'illegal'.
Added: a password (ladmin_pass) for remote administration of login-server (ladmin) not same of creation of accounts (admin_pass).
15 modified files:
	Readme2060
	(bin/tool/)
		ladmin
	(bin/tool/cgi/)
		addaccount.cgi
	(conf/)
		login_athena.conf
	(doc/)
		account_making.txt
		admin_packet.txt
		conf_ref.txt
		script_ref.txt
	(src/char/)
		int_guild.c
		int_party.c
	(src/login/)
		login.c
	(src/map/)
		clif.c
		path.c
		pc.c
		script.c

----------------------------------------
// 2092 by End_of_exam

・子守唄を使うと落ちる可能性があるバグを修正(skill.c status.c thanks to Manaさん)
・status_get_opt[1-3] のバグ修正(status.c map.h homun.c thanks to (　・ω・)モニュ? さん) 

----------------------------------------
// 2091 by End_of_exam

・2087以降で複数のマップサーバーに同じマップを読み込めないバグを修正(char.c map.c)
・2090の警告を修正(pc.c)
・SQL: 存在しないキャラの読み込み時にリソースリークが発生していたバグの修正(char.c)
・SQL: 読み込みルーチンが失敗を返さないバグを修正(int_party.c int_guild.c int_hom.c)

----------------------------------------
// 2090 by Yor
Fixed: duplicated map on 2 different map-servers (char.c).
Fixed: overflow on exp (base and job) (pc.c)
Added: A warning function about configuration of login_athena.conf.
5 modified files:
	Readme2060
	(src/conf/)
		login_athena.conf
	(src/char/)
		char.c
	(src/login/)
		login.c
	(src/map/)
		pc.c

----------------------------------------
// 2089 by Yor
Changed: some little things on sockets (socket.c)
On suggestion of another coder:
Re-added: a check to reduce number of memmove (socket.c)
Changed: the comment in char.c when reading of maps (char.c)
3 modified files:
	Readme2060
	(src/char/)
		char.c
	(src/common/)
		socket.c

----------------------------------------
// 2088-fix by Yor
Fixed: invalid MACRO __WIN32 -> _WIN32 (sorry) (socket.c)
Fixed: use previous signal on WIN32. First can work properly and improvement are not necessary. (core.c)
3 modified files:
	Readme2060
	(src/common/)
		core.c
		socket.c
----------------------------------------
// 2088 by Yor
Fixed: initialisation of map-servers list in char-server.
Fixed: possible infinite loop when a map-server try to connect to char-server.
Improved: make_connection and make_listen_port functions. Fixed check of result too.
Fixed: configuration reading of listen_ip.
Improved: socket signals.
8 modified files:
	Readme2060
	(src/char/)
		char.c
	(src/common/)
		core.c
		socket.c
	(src/login/)
		login.c
	(src/map/)
		chrif.c
		intif.c
		map.c

----------------------------------------
// 2087 by Yor
Changed: MAX_MAP_PER_SERVER from 512+64 to 512+128 to support more maps.
Improved: char-server can support any number of maps for each map-server
          (only limited by size of packet -> 2048 maps by map-server).
          map-server continue to use MAX_MAP_PER_SERVER definition.
Fixed: error message in map-server about packet_parse_time.
5 modified files:
	Readme2060
	(src/char/)
		char.c
		char.h
	(src/common/)
		mmo.h
	(src/map/)
		map.c

----------------------------------------
// 2086 by Yor
Added: listen_ip option to bind only from 1 ip if necessary.
Fixed: some possible configuration errors when reading login/char/map_athena.conf.
Improved: check about too big packets.
11 modified files:
	Readme2060
	(src/char/)
		char.c
	(src/conf/)
		char_athena.conf
		login_athena.conf
		map_athena.conf
	(src/common/)
		socket.c
		socket.h
	(src/login/)
		login.c
	(src/map/)
		clif.c
		map.c
		script.h

----------------------------------------
// 2085 by Yor
Improved: fixed realloc_fifo if new size if lesser than size of actual datas.
          With that, we can reduce FIFO size.
Improved: Read buffer doesn't more have same size of write buffer.
Improved: size of read buffer of socket:
          - read buffer of players: 64k -> 2k! it's enough to do all operations (more players you have, less memory you use than before (62k by player)).
          - automatic management of read buffer for servers.
          - read buffer of http: 64k -> 32k
Use #DEFINE for all FIFO sizes.
7 modified files:
	Readme2060
	(src/char/)
		char.c
	(src/common/)
		mmo.h
		socket.c
		socket.h
	(src/login/)
		login.c
	(src/map/)
		chrif.c

----------------------------------------
// 2084 by Yor
Fixed: clif_parse_GuildReplyInvite. reply is an int, not a char.
Improved: organisation of guild_leave function.
Improved: expulse from guild.
3 modified files:
	Readme2060
	(src/map/)
		clif.c
		guild.c

----------------------------------------
// 2083 by Yor
Fixed: guild_invite. New member must be near the member to be invited.
3 modified files:
	Readme2060
	(src/map/)
		clif.c
		guild.c

----------------------------------------
// 2082 by Yor
Fixed: guild_invite. Guild member must have ability to invite
3 modified files:
	Readme2060
	(src/map/)
		clif.c
		guild.c

----------------------------------------
// 2081 by Stinger
conf/msg_athena.confの149〜152のメッセージを日本語化しました。

----------------------------------------
// 2080 by Yor
Fixed/improved: change of guild notice
6 modified files:
	Readme2060
	(src/map/)
		clif.c
		guild.c
		guild.h
		intif.c
		intif.h

----------------------------------------
// 2079 by Yor
Fixed: online variable of guild member (all are now unsigned char) - thanks to lkm for bug report
5 modified files:
	Readme2060
	(src/char/)
		int_guild.c
	(src/common/)
		mmo.h
	(src/converter/)
		char-converter.c
	(src/map/)
		clif.c

----------------------------------------
// 2078 by Yor
Fixed: only guild master can change a member position
Fixed: only Guild Master can change emblem.
Added: a check on BMP structure of emblem.
6 modified files:
	Readme2060
	(src/map/)
		clif.c
		guild.c
		guild.h
		intif.c
		intif.h

----------------------------------------
//2077-fix by GcwMfHQ

・NPCスクリプト修正＆更新
	(npc/job)
		npc_job_06thief.txt
	(warp)
		npc_warp_dun.txt
		npc_warp_fild.txt
		npc_warp_town.txt
	thanks to AthenaDev
・npc_monster.txt,npc_monster_future.txtを更新 thanks to huge cgi
・mapflag.txtを更新 thanks to huge cgi

----------------------------------------
// 2076 by Yor
Added: extra system. What is it?
- it a system managed by map-server to add/remove zenys/items to/from characters.
- map-server use save/map_extra.txt file and manage it alone.
- to add a line in this file, use an other file (default: ./map_extra_add.txt; you can choose location and name of this file). map-server will check it every minute.
- because map-server READ and DESTROY this file, be sure that map-server has all permissions.
- When a character is online, map-serverwill do supposed actions (and check all: weigth, max values, etc...)
- To have more informations, read save/map_extra.txt file after a start of the map-server.
- you can disable this function by a option in map_athena.conf.
- The name? Because it's extra bonus/malus.
- Example of usages: on web site (bonus after an action), to remove easyly some items from a character (sprite error?), etc...
9 modified files:
	Readme2060
	(conf/)
		battle_athena.conf
		map_athena.conf
		msg_athena.conf
	(src/map/)
		battle.c
		battle.h
		map.c
		map.h
		pc.c

----------------------------------------
// 2075 by ARIA
・ASPDの最大値をPK,GVG,PVPで個別に制限できるように追加
	(conf/)
		battle_athena.conf
	(src/map/)
		battle.c
		battle.h
		status.c
----------------------------------------
// 2074 by Yor
Changed: GuildChangePositionInfo structure. guild_change_position can be use without the leader (create a GM command?).
Improved: GuildRequestInfo. do check in one place, and don't search sometimes twice the guild structure
5 modified files:
	Readme2060
	(src/map/)
		clif.c
		clif.h
		guild.c
		guild.h

----------------------------------------
// 2073 by Filia
・フルアドレナリンラッシュが遠距離攻撃に反映されている点を修正。
・生命力変換がSP_MAXでは使用出来ないように修正
　（本鯖相違スレッド４ 20 より）
　使用できない状況で使用失敗メッセージが出る・出ないが分からないので
　とりあえず使用失敗メッセージが出るようにしてあります
	Readme2060
	(db/)
		skill_require_db.txt
	(src/map/)
		skill.c
		status.c
----------------------------------------
// 2072 by luc
・スキル射程の見直し
・pet_db.txtの誤字を修正
・NPCスクリプトの修正
	(npc/town)
		npc_town_ayothaya.txt
		npc_town_kafra.txt
	(npc/job)
		npc_job_05merchant.txt
		npc_job_10blacksmith.txt
		npc_job_16sage.txt
	(warp)
		npc_warp_fild.txt
	thanks to AthenaDev

----------------------------------------
// 2071 by Yor
Improved: change_position in guild: check index.
Fixed: Only guild master can change position.
5 modified files:
	Readme2060
	(src/map/)
		clif.c
		guild.c
		intif.c
		intif.h

----------------------------------------
// 2070-fix by Yor
Fixed/improved: name in guild creation when @guild is used (guild_create in guild.c).
2 modified files:
	Readme2060
	(src/map/)
		guild.c
----------------------------------------
// 2070 by Yor
Checked: name in guild creation (guild_create in guild.c).
Improved: calls of (most) functions in guild.c/h.
Renamed: some 'index' variables to 'idx' variables.
7 modified files:
	Readme2060
	(src/map/)
		clif.c
		clif.h
		guild.c
		guild.h
		intif.c
		intif.h

----------------------------------------
//2069 by Rayce

・2067のMAX_SKILLの判定順がミスってたのを修正（pc.c）
		pointed out by Yor, thx a lot!!
・2068のbattle_config.gvg_flee_penaltyの処理を巻き戻し（status.c）
・カード効果によるコーマおよび即死が機能してなかったバグを修正（battle.c）

----------------------------------------
//2068 by ARIA

・MCの上限制限をPK,PVP,GVGでそれぞれbattle_athena.confで決めれるように追加

----------------------------------------
//2067 by Rayce

・pc.c, unit.cの処理改善
・skill_unit_db.txtの説明をdoc/db_ref.txtに記述
・skill.cのskill_misfire.txtとskill_prohibition_zone.txtに関する読み込み
　部分のコメントアウトを抹消
・clif.cからdb.hのincludeを削除（2064のやり残し）
・GvGマップでアンティペインメントを使用不可にする処理をpc.cから切り離して
　db/item_prohibition_zone.txtで制御するように変更
・クローンスキルの判定をダメージ発生前に移動
	battle_skill_attack()

----------------------------------------
//2066 by luc
・エラー E2313 clif.c 5778: 定数式が必要(関数 clif_showvendingboard )
・エラー E2313 clif.c 5801: 定数式が必要(関数 clif_closevendingboard )
コンパイル中に上記のエラーが出るため、clif.cの一部の巻き戻し。
----------------------------------------
//2065 by luc
・NPCスクリプトの修正
	(npc/town)
		npc_town_alberta.txt
		npc_town_guide.txt
	(npc/quest)
		npc_event_dye.txt
	thanks to AthenaDev

----------------------------------------
//2064 by Rayce

・add_timer() に起因するメモリリーク対策としてadd_timer2() を追加（timer.*）
　サーバプログラム終了時にタイマー待機中のデータをtimer.c内部でfreeします
	battle_delay_damage()
	clif_clearchar_delay()
	guild_agit_break()
	mob_damage()
	npc_event_dequeue()
	pet_lootitem_drop()
	skill_castend_delay()

・トラップ系スキルの修正（skill.c）
	-> アローシャワーで罠全般を吹き飛ばせます
	-> 敵がアンクルに捕捉されているときは飛びません
	　 またこのときブリッツビートでダメージが発生します（自動鷹のときはダメージ分散）
	　 ダメージ通せるスキルが他にもあった気がするけど記憶曖昧なので除外
	-> 罠の耐久HPは3500でそれ以上ダメージが蓄積すると消滅します

・@autolootでサーバクラッシュするバグを多分修正？（mob.c）
　ついでに死亡状態なら自動取得できないように変更
	reported by anonym
・パリィが機能してなかった問題を修正（battle.c, status.c）
	reported by G
・リジェクトソードの武器条件判定を修正（battle.c）
・skill.cの処理改善

----------------------------------------
// 2063 by Yor
Fixed: a vender must have a cart and the skill to open shop.
Improved: call of vending_openvending function.
Improved: open a shop (stop walking, check values, etc...)
5 modified files:
	Readme2060
	(src/map/)
		clif.c
		clif.h
		vending.c
		vending.h

----------------------------------------
// 2062 by Aarlex
・fix char_sql_nick2id for mail system in SQL version.

2 modified files:
	Readme2060
	(conf/)
		char.c

----------------------------------------
// 2061 by Yor
Improved: vending list sending (don't check twice the vender's sd).
Improved: protection of guild messages against hackers.
Renamed: message[] of web chat message -> webchat_message[] (some other functions use message[] in clif.c)
Added: MAX_VENDING macro.
Fixed: Purchase in vending (against hackers).
Moved: text of message aboutvender in msg_athena.conf.
7 modified files:
	Readme2060
	(conf/)
		msg_athena.conf
	(src/map/)
		clif.c
		clif.h
		map.h
		vending.c
		vending.h

----------------------------------------
// 2059 by Yor
Improved: call of intif_party_addmember function. don't send account_id and search sd. Send directly sd (checked before).
Improved: call of intif_party_changeoption and party_changeoption.
Removed: Unused return value of some functions (intif.c/h).
Improved: protection of party messages against hackers.
6 modified files:
	Readme1928
	(src/map/)
		clif.c
		intif.c
		intif.h
		party.c
		party.h

----------------------------------------
//2058 by くろぽ

・ジュノー、放浪ブラックスミスの羽耳製造クエスト中 getitemname が抜けている問題点を修正
　ちょっとしたことだけど、ちょっと目障りだったもので。(npc_event_hat2.txt)

----------------------------------------
//2057 by Rayce

・@mapflagおよびスクリプトのsetmapflag, removemapflag命令に
　不足分のマップフラグを追加して書き換え（atcommand.c, script.c）
・見た目がPCキャラのmobによるメモリリーク修正（clif.c）
		reported by 逆毛鰻
・ソウルブレイカーの魔法部分にbSubEleによるダメージ減少を追加
　ランダム部分の計算式修正（battle.c）
		reported by Mana

----------------------------------------
//2056 by End_of_exam

・2040のGRF ヘッダサイズ変更の巻き戻し(grfio.c)
・同一アカウントのキャラが同じパーティに加われるように修正(party.c)
・bin/tool/php以下の翻訳(chgpasswd.php createaccount.php)

----------------------------------------
//2055 by Rayce

・ギルドメンバーの座標表示を実装（clif.*, guild.c, map.h, pc.c）
		merged and modified based on eA, thx a lot!!

----------------------------------------
// 2054 by Yor
Improved: waterlist: no more limit with number of maps, correct free function, error message.
Fixed: map_getcell with number of maps.
2 modified files:
	Readme1928
	(src/map/)
		map.c

----------------------------------------
//2053 by GcwMfHQ

・npc_warp_vs.txtの更新 thanks to AthenaDev
・npc_monster.txt,npc_monster_future.txtを最新版に更新 thanks to huge cgi

----------------------------------------
//2052 by Rayce

・unit.cの処理手順をさらに改善
・Gvスクリプトにおける旗復帰処理のチェックを強化
	script/npc/gvg/npc_gvg_flag.txt

・夕陽のアサシンクロスが誤作動していたバグを修正
・サービスフォーユーがPTにしか効果がなかったのを修正
		reported by testarossa
	status_calc_pc()
	db/skill_unit_db.txt

----------------------------------------
// 2051 by Yor
Improved: party invite.
Fixed: multiple players of same account in a same party.
Fixed: only party leader can change options.
Improved: structure of party.c.
11 modified files:
	Readme1928
	(doc/)
		inter_server_packet.txt
	(src/char/)
		char.c
		int_party.c
		int_party.h
		inter.c
	(src/map/)
		clif.c
		intif.c
		intif.h
		party.c
		party.h

----------------------------------------
// 2050 by lmk
add kro new map

----------------------------------------
//2049 by Rayce

・battle.c, skill.c, status.c, unit.cの処理手順を改善
　　-> nullpoチェック前に関数を呼び出さない
　　-> 利用頻度の低い変数は必要なブロック内で宣言して収める
　　-> BL_CASTマクロを使う

・sc_start命令系の不正チェックを強化（script.c）
・ソウルバーンと気奪をmobも使用できるように拡張
・魅惑のウィンク修正
・2045のNPCスクリプト修正を部分的に巻き戻し（script/npc/job/...）

・キーピング時は攻撃できないように修正
		reported by Blaze
・クローキング、チェイスウォーク中およびチャット中はアイテムを拾えないように修正
		reported by Blaze
・マインドブレーカーで詠唱妨害および凍結等解除できるように修正
		reported by testarossa
・アシッドデモンストレーションのダメージがオーバーフローするバグを修正
		reported by あ
・NPC_SELFDESTRUCTIONが正常にヒットしなかったバグを修正
		reported by BBB
・ソウルドレインが対象指定型スキルでのみ発動するように暫定で修正
		reported by luc
	※eA方式の暫定処置でud.skilltargetを参照してるので、対象指定魔法→通常攻撃でトドメを刺す
	　状況下でも発動してしまうのは相変わらずです

----------------------------------------
// 2048 by Yor
Fixed: invalid party name (against hacker).
6 modified files:
	Readme1928
	(src/map/)
		clif.c
		intif.c
		intif.h
		party.c
		party.h

----------------------------------------
// 2047 by Yor
Removed: Unused return value of some functions (clif.c/h).
Improved: Call of some functions (clif.c/h, pc.c).
Changed: some 'index' variable to 'idx' (clif.c, pc.c).
Changed: 'bool' variable, it's a C reserved word (clif_bladestop function).
Moved: clif_parse_func structure just before clif_parse function to avoid duplicated definition of clif_parse functions.
Note: no new functions in code.
4 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h
		pc.c

----------------------------------------
// 2046 by Filia
・貪欲を街・PvP・GvGエリアでは使用不可に修正。
（街については、nopenaltyで判定）
・運命のタロットカードで恋人発動時、テレポ不可地域でも
　回復するように修正。テレポートはしません。
・ガーディアンに運命のタロットカードを使用し恋人発動で
　テレポートしないように、砦にmonster_noteleportフラグ追加。
・プレッシャーの詠唱妨害を不可に修正。
----------------------------------------
// 2045 by luc
・NPCスクリプトのバグ修正
	npc_job_00newbie.txt
	npc_job_09wizard.txt
	npc_job_transmigration.txt
		thanks to AthenaDev
・その他、細かい修正

----------------------------------------
// 2044 by Yor
Removed: Unused return value of some functions (50% of clif.c/h).
Improved: Call of some functions (50% of clif.c/h).
Changed: some 'index' variable to 'idx'.
Note: no new functions in code.
3 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h

----------------------------------------
// 2043 by Yor
Removed: invalid/unnecessary check (if storage is full or not) when we add an item in a cart.
Improved: functions when we add an item in a storage.
Fixed: quantity of equipment > 1 if a hacker try to add it in a storage.
2 modified files:
	Readme1928
	(src/map/)
		storage.c

----------------------------------------
// 2042 by Yor
Removed: Unused return value of some functions in storage.c/h.
Renamed: some 'index' variables to 'idx'.
Fixed: index check in storage_guild_storageaddfromcart based on MAX_CART (not more on MAX_INVENTORY).
4 modified files:
	Readme1928
	(src/map/)
		clif.c
		storage.c
		storage.h

----------------------------------------
// 2041-fix by Yor
Added: comment about changes in grfio.c.
----------------------------------------
// 2041 by Yor
Fixed: unreading of some files in some custumed GRF.
Fixed: reading of 'data\resnametable.txt' in some custumed GRF.
Removed: limit about number of files in GRF.
2 modified files:
	Readme1928
	(src/common/)
		grfio.c

----------------------------------------
// 2040 by Yor
Fixed: size of GRF header.
Fixed: calculation of number of files in GRF version 0x02xx.
Added: display version number and number of files for each GRF file.
Added: some comments (extract from OpenKore project) to explain GRF structure.
2 modified files:
	Readme1928
	(src/common/)
		grfio.c

----------------------------------------
// 2039-fix by Yor
Fixed error: \src\map\storage.c(520) : warning C4098: 'storage_guild_storageget' : 'void' function returning a value
Thanks to lkm for bug report.
----------------------------------------
// 2039 by Yor
Fixed: new test of PF_SOULBURN (skill.c).
Added: number of removed maps (map.c).
Removed: Unused return value of storage_guild_storageadd, storage_storageadd,
         storage_guild_storageget and storage_storageget functions.
Fixed: index check in storage_storageaddfromcart based on MAX_CART (not on MAX_INVENTORY).
Renamed: some 'index' variables to 'idx'.
6 modified files:
	Readme1928
	(src/map/)
		clif.c
		map.c
		skill.c
		storage.c
		storage.h

----------------------------------------
//2038-fix by GcwMfHQ

・npc_warp_dun.txtの更新 thanks to AthenaDev
・以下DBを最新版に更新 thanks to huge cgi
	item_db.txt
	item_bluebox.txt
	item_violetbox.txt
	item_cardalbum.txt
	mob_db.txt
	mob_skill_db.txt
・npc_monster.txt,npc_monster_future.txtを最新版に更新 thanks to huge cgi

----------------------------------------
// 2037 by Filia
・スパイダーウェブの効果時間がGvGでも半減となるよう修正。
・ソウルバーンが全く成功しない点を修正。
----------------------------------------
// 2036-fix by Yor
Fixed: quit map-server when no map was found.
----------------------------------------
// 2036 by Yor
Fixed: remove map name from the list when the map is not found in GRF file.
3 modified files:
	Readme1928
	(src/common/)
		grfio.c
	(src/map/)
		map.c

----------------------------------------
// 2035 by Yor
Working on grfio.c file:
- Fixed: increase FILELIST_LIMIT (32768->65536) to support more customed GRF.
- Fixed: some compilation errors (type's conversions).
- Improved: don't try to read a GRF that doesn't exist in configuration.
- Fixed: possible overflows with grf file names.
-Improved: getlong function.
2 modified files:
	Readme1928
	(src/common/)
		grfio.c

----------------------------------------
// 2034 by luc
・map_athena.confに同名のgatが重複して記述されていたので修正
・AthenaDevの修正分を追加
	npc_job_00newbie.txt
	npc_job_04acolyte.txt
	npc_warp_fild.txt

----------------------------------------
// 2033 by lkm
update msg_athena.conf
add kRO 2006-03-28 map

----------------------------------------
// 2032 by Yor
Fixed: dont use a value of the session before to check if session exists ('/lb').
Protected: clif_parse_LGMmessage function against possible hack.
Improved: call of clif_send() function.
2 modified files:
	Readme1928
	(src/map/)
		clif.c

----------------------------------------
// 2031 by Yor
Removed: Unused return value of some functions:
	clif_solved_charname
	chrif_searchcharid
	map_reqchariddb
	pc_resetstate
	pc_resetskill
9 modified files:
	Readme1928
	(src/map/)
		chrif.c
		chrif.h
		clif.c
		clif.h
		map.c
		map.h
		pc.c
		pc.h

----------------------------------------
// 2030-fix by Yor
Fixed: a incorrect check (clif_parse_InsertCard function).
2 modified files:
	Readme1928
	(src/map/)
		clif.c
----------------------------------------
// 2030 by Yor
Fixed: dont use a value of session before to check if session exists when we insert a card (clif_parse_InsertCard function).
Removed: Unused return value of pc_insert_card function.
Improved: call of clif_insert_card function.
5 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h
		pc.c
		pc.h

----------------------------------------
// 2029 by Yor
Fixed: invalid index value when a player uses a card (hack).
3 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h

----------------------------------------
// 2028 by Yor
Improved: enable ranges in GM accounts file.
7 modified files:
	Readme1928
	(conf/)
		GM_account.txt
	(src/char/)
		char.c
	(src/converter/)
		login-converter.c
	(src/login/)
		login.c
	(src/map/)
		pc.c
		pc.h

----------------------------------------
// 2027 by Yor
Removed: Unused return value of skill_autospell function.
Fixed: autospell with a skill that player doesn't have learn (hack).
4 modified files:
	Readme1928
	(src/map/)
		clif.c
		skill.c
		skill.h

----------------------------------------
// 2026 by Yor
Removed: Unused return value of pc_item_identify function.
Improved: call of clif_item_identified function.
Work on skill_arrow_create function:
- Removed: Unused return value.
- Renamed a variable: 'index' -> 'idx'.
- Moved: check about id and amount of new arrows.
- Improved: id search.
7 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h
		pc.c
		pc.h
		skill.c
		skill.h

----------------------------------------
// 2025 by End_of_exam

・repair_targetにidを保存するように修正(map.h clif.c pc.c skill.c)
・SQL: アイテム関連の AUTO_INCREMENT を int から bigint に変更(main.sql 2025_changetable.sql)

----------------------------------------
// 2024 by Yor
Removed: Unused return value of npc_scriptcont function.
Fixed: dont use a value of session before to check if session exists (clif_parse_NpcStringInput function).
Fixed: clif_parse_NpcStringInput against possible hack (to crash)
4 modified files:
	Readme1928
	(src/map/)
		clif.c
		npc.c
		npc.h

----------------------------------------
// 2023 by Yor
Fixed: check of index in clif_parse_RepairItem function (thanks to End_of_exam for correction).
2 modified files:
	Readme1928
	(src/map/)
		clif.c

----------------------------------------
// 2022 by Yor
Fixed: Read spaces between // and version number in 'readme' file when bin/tool/patchup is used.
Fixed: dont use a value of session before to check if session exists (clif_parse_WeaponRefine function).
Removed: Unused return value of skill_weapon_refine function.
Fixed: Do nothing before to have check parameter of the function (skill_weapon_refine).
Fixed: SQL compilation error with isGM on login-server (thank to End of Exam for bug reporting).
       (but why don't use `level` of `login` table in SQL version?)
6 modified files:
	Readme1928
	(bin/tool/)
		patchup
	(src/login/)
		login.c
	(src/map/)
		clif.c
		skill.c
		skill.h

----------------------------------------
//2021 by Rayce

・2019の全てを巻き戻し
・1968で巻き戻された服色の変更を修正して再度取り込み
	clif_parse_LoadEndAck()
	pc_changelook()
・スキッドトラップの修正（skill.c）
・NPCスクリプトのアリーナの修正
		thanks to AthenaDev

----------------------------------------
// 2020 by lkm
add 2019fix file by ARIA
fix 2019 in vc++ compile error
add switch 'spheremine_no_exp,spheremine_no_drop,spheremine_no_mvp'
	Readme1990
	(conf/)
		battle_athena.conf
	(src/map/)
		pc.c
		pc.h
		battle.c
		battle.h
		script.c
		skill.c

----------------------------------------
// 2019fix by ARIA
・battle_athena.confがたりなかったので追加
・スクリプトの装備修復命令でペナルティが反映されないのでscript.cを追加
fix2
・hugeさんの4/18修正を適用
----------------------------------------
// 2019 by lriy
・精錬武器が破壊されたとき、ペナルティを追加
・"絶対に壊れない"は除外される。
	Readme2018
	(src/map/)
		pc.c
		pc.h
		battle.c
		battle.h
				huge様に感謝

----------------------------------------
// 2018 by Yor
Clean up: clif_parse_ProduceMix function.
Removed: Unused return value of skill_produce_mix function.
Fixed: dont use a value of session before to check if session exists (skill_repair_weapon and clif_parse_RepairItem functions).
Improved: call of clif_item_repaireffect function.
Fixed: invalid index value in clif_parse_RepairItem function (hack).
5 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h
		skill.c
		skill.h

----------------------------------------
//2017 by Rayce

・Enemy系アイテムボーナスを6つ追加
　敵のタイプ（PC, MOB, HOM）に応じて効果を発揮するかどうかを決めます
	bIgnoreDefEnemy, bIgnoreMDefEnemy, bDefRatioAtkEnemy, bAddEnemy, bMagicAddEnemy, bSubEnemy
・map.hのSP_*系のenumを整理
・const.txtの更新

・SP_ITEM_NO_USEをpc_bonusへ移動
・item_bonus.txtに記載漏れの4つを追記
	bUnbreakableHelm, bUnbreakableShield, bItemNoUse, bFixDamage
・bSubGroupのバグ修正

・AthenaDevよりNPCスクリプトの修正
　アリーナのバグやカプラのセーブ処理など
		thanks to AthenaDev members !!

・skill.cの処理を少し修正
・map_session_data構造体を少しだけ整理
・気奪をmobに使用時にMAXSPを越えて回復するバグを修正（skill.c）
・Translated
	bin/tool/ladmin, conf/battle_athena.conf, doc/admin_packet.txt

----------------------------------------
// 2016 by Yor
Fixed: Memo points quantity (not 10, but 3).
       Define MAX_PORTAL_MEMO to 3 and remove MIN_PORTAL_MEMO definition
Removed: Unused return value of pc_memo function.
Improved: call of clif_skill_memo and clif_skill_teleportmessage functions.
10 modified files:
	Readme1928
	(bin/tool/)
		convert.c
	(src/char/)
		char.c
	(src/common/)
		mmo.h
	(src/converter/)
		char-converter.c
	(src/map/)
		atcommand.c
		clif.c
		clif.h
		pc.c
		pc.h

----------------------------------------
// 2015 by Yor
Changed: japan->japanese in createaccount.php.
Added: php file to change a password easily (chgpasswd.php).
3 modified files:
	Readme1928
	(bin/tool/php)
		createaccount.php
		chgpasswd.php [new]
To japanese coders: Please, translate japan section in chgpasswd.php (begining at 'Japanese' => array ().

----------------------------------------
// 2014-fix by Yor
Fixed: memset in the 2 new packets has now right value (150->120).
2 modified files:
	Readme1928
	(src/login/)
		login.c
----------------------------------------
// 2014 by Yor
Added: admin packets to:
       - have complete information about an account (by id or by name).
Added: 'version', 'info' and 'who' commands in ladmin (perl).
Added: accountinfo2 and accountinfo3 functions in ladmin class (athena.php).
5 modified files:
	Readme1928
	(doc/)
		admin_packet.txt
	(bin/tool/)
		ladmin
	(bin/tool/php/)
		athena.php
	(src/login/)
		login.c
To japanese coders: Please, translate doc/admin_packet.txt and new commands in /bin/tool/ladmin.

----------------------------------------
// 2013 by Blaze
・転生ノービスのステータス加重値を追加
	job_db2-2.txt
・アイテムの値段がおかしくなってしまうのでデフォルトでは未設定に
	item_value_db.txt
・他、DBを最新版に
	item_upper.txt
	mob_boss.txt
	mob_poring.txt
・バード転職クエスト実装
	npc_job_19bard.txt
	npc_town_lutie.txt
・ジュノーNPC修正
	npc_town_yuno.txt
・一部クエストとかぶっているNPC削除
	npc_town_board.txt
	npc_town_payon.txt
・誤字修正
	npc_town_refine.txt

----------------------------------------
// 2012 by Yor
Added: admin packets to:
       - have information about servers connected to login-server.
       - check the validity of a password.
Added: 'getcount' and 'check' commands in ladmin (perl).
Improved: alphabetic sorting of commands in ladmin (perl).
Added: checkaccount function in ladmin class (athena.php).
Improved: security on some administration packet in login-server.
Fixed: Set default password in createaccount.php.
6 modified files:
	Readme1928
	(doc/)
		admin_packet.txt
	(bin/tool/)
		ladmin
	(bin/tool/php/)
		athena.php
		createaccount.php
	(src/login/)
		login.c
To japanese coders: Please, translate doc/admin_packet.txt and new commands in /bin/tool/ladmin.

----------------------------------------
// 2011 by Yor
Added: version packets in login administration packets (0x7530, 0x7531, 0x7532).
Added: php class to use all login administration packets.
Added: php file to create an account easily.
4 modified files:
	Readme1928
	(bin/tool/php) [new]
		athena.php [new]
		createaccount.php [new]
	(src/login/)
		login.c
To japanese coders: Please, translate japan section in createaccount.php (begining at 'Japan' => array ().
                    Be careful. Japanese texts must be coded in utf-8 to be suported.
                    Japanese is not the only one language, and only utf-8 can support all languages.

----------------------------------------
// 2010 by Yor
Removed: Unused return value of skill_castend_map function.
Fixed: possible overflow when a player use a map skill (teleport, warp, etc...).
4 modified files:
	Readme1928
	(src/map/)
		clif.c
		skill.c
		skill.h

----------------------------------------
// 2009 by Yor
Improved: call of clif_skill_fail function.
Fixed: possible overflow with skills (to pos) incliding a player message.
Added: a battle option to authorise or not casting of a skill (to pos) when player is sitting (anti-hack).
6 modified files:
	Readme1928
	(conf/)
		battle_athena.conf
	(src/map/)
		battle.c
		battle.h
		clif.c
		clif.h

----------------------------------------
// 2008 by ＡＡＡ
・ターボトラックのスキル・アイテムの禁止が動作していなかったのを修正

----------------------------------------
// 2007 by Yor
Removed: Unused return value of pc_skillup, homun_skillup and guild_skillup functions.
Removed: check about guild skill in pc_skillup. This check is done before to call the function.
Added: a battle option to authorise or not casting of a skill (to ID) when player is sitting (anti-hack).
11 modified files:
	Readme1928
	(conf/)
		battle_athena.conf
	(src/map/)
		battle.c
		battle.h
		clif.c
		guild.c
		guild.h
		homun.c
		homun.h
		pc.c
		pc.h

----------------------------------------
//2006 by Orca

・'homun_delete_data' の呼び出し修正

----------------------------------------
//2005 by Rayce

・2002のミスを修正 thanks to End_of_Examさん
　　- battle_check_target() の処理
　　- makepet命令の巻き戻し

・changeviewsize命令でホムとNPCのサイズも変更できるように拡張
・MAX_DEAL_ITEMSの値を10に変更

----------------------------------------
// 2004 by Yor
Improved: call of pc_statusup function.
Added: check maximum of all stats when one stats is increased. So if it is, set status points to 0.
5 modified files:
	Readme1928
	(src/map/)
		clif.c
		pc.c
		pc.h
		script.c

----------------------------------------
// 2003 by Yor
Improved: call of pc_setoption and pc_setcart functions.
Fixed: cart changing with other options and hacking.
5 modified files:
	Readme1928
	(src/map/)
		clif.c
		pc.c
		pc.h
		script.c

----------------------------------------
//2002 by Rayce

・アローシャワーで矢が消費されない問題を修正
	skill_castend_damage_id()
・1995のシールドチェインのチェック抜けを修正
		pointed out by End_of_Examさん、thx a lot!!
・アシッドデモンストレーションの計算式修正
		reported by Blaze
・ソウルバーン処理のチェック強化
・mobスキルのターゲットanothertargetを少し修正
　ホムには無敵タイマーないみたいなので？
	mobskill_anothertarget()

・自爆処理の修正（battle.c, mob.*, skill.c, status.c, unit.c）
　　　スフィアマインは攻撃されたら攻撃主の向きの方向に直線移動
　　　ホムにもダメージを与える
　　　HPが全回復状態なら爆発しない
　　　ノックバック後に位置ズレするのを修正
・細かい修正
	mob_ai_sub_hard()
・ペット捕獲時の名前の修正策を取り込む（pet.c）
		thanks to 本鯖相違スレッド３ [136]

・1983と同じ鯖落ち対策を出来る限り追加（script.c）
・getmapxy命令でホムの情報を取得できるように拡張
・homunrename命令で鯖落ちしないように修正

----------------------------------------
// 2001 by Orca
・homundel命令追加
・homunrename命令追加
	(src/map/)
		script.c
		homun.h
・script_ref.txt修正

----------------------------------------
// 2000 by Yor
Removed: Unused return value of unit_stopattack and pc_getitemfromcart functions.
Added: A check about index when a player puts an item to cart or get an item from the cart.
6 modified files:
	Readme1928
	(src/map/)
		clif.c
		pc.c
		pc.h
		unit.c
		unit.h

----------------------------------------
// 1999 by Yor
Removed: re-deal check when a player adds an item in the trade list (the complete check is done just before complete trade).
Improved: zeny trade to support exchange of zenys.
2 modified files:
	Readme1928
	(src/map/)
		trade.c

----------------------------------------
// 1998 by Yor
Defined: MAX_DEAL_ITEMS macro for maximum number of items in a trade.
Fixed: possible zenys overflow when trade is commited.
Fixed: Do a complete check of trade before to valid it when trade is commited.
Improved: call of clif_tradecompleted function.
5 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h
		map.h
		trade.c

----------------------------------------
// 1997 by Yor
Fixed: If a player moves when in trade, cancel trade correctly (in trade_tradeok function).
Fixed: When target is disconnected, reset trade values of the player correctly.
Removed: Unused return value of clif_tradecancelled function.
Improved: call of clif_tradedeal_lock function.
4 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h
		trade.c

----------------------------------------
// 1996 by Yor
Fixed: When a player is asked to a trade, check if target is a player.
Fixed: Check re-deal when a player adds an item in the trade list.
Fixed: When an item can not be added in the trade list, send a message to player (item can not be added).
Improved: call of clif_traderequest, trade_tradeack, and clif_tradeitemok functions.
Added: a check on the type when a player send the answer of a trade request.
Changed: some 'index' to 'idx'.
5 modified files:
	Readme1928
	(src/map/)
		clif.c
		clif.h
		trade.c
		trade.h

----------------------------------------
//1995 by Rayce

・NPCスクリプトのバグ修正
			from AthenaDev, thx a lot!!
	npc_quest_arena.txt
	npc_quest_momotaro.txt
・@zenyで所持金よりも大きな負の値の場合は0zenyになるように拡張

・OTMAXがOTより優先されるように修正
	status_change_start()
・シールドチェインのダメージ計算順序修正
			reported by Blaze
	battle_calc_weapon_attack()
・1991のドロップ率の修正ミスを訂正
	battle_athena.conf
	mob_drop_fix()
・バーサーク中はHPの自然回復が発生しないように修正
			reported by gerdlia
	pc_natural_heal_sub()

----------------------------------------
//1994 by End_of_exam

・SSで巻き戻った homun_skill_tree.txt を復旧(homun_skill_tree.txt)
・1991の修正(npc_job_transmigration.txt)
・ファイル末の閉じ括弧判定が上手くいかないバグを修正(npc.c)

----------------------------------------
//1993 by Garc

・スナップショットによって巻き戻ってしまったホムンクルスの経験値テーブルの復旧　(exp_homun.txt)

----------------------------------------
//1992 by GcwMfHQ

・npc_warp_dun.txtの修正 thanks to AthenaDev
・npc_monster.txt,npc_monster_future.txtの更新 thanks to huge cgi
・bcc32_make.bat,bcc32_consqlmake.bat,vc07_make.batに
  コンパイルオプションAC_MAIL追加
・win32_start.batのmail_dataのパス修正

----------------------------------------
//1991 by Rayce

・announce命令を少し修正
・OnWeekTimeラベル修正
	npc_event_do_clock()
・ルート中のmobにプロボックをかけたときにタゲが変更されるように修正
			reported by luc
	mob_target()
・細かい整形と修正
	pc_damage()
	mob_droprate_fix()
・余りにも酷い@autolootをとりあえずで修正（atcommand.c, mob.c, pc.c）
・NPCスクリプトの修正と追記 thanks to AthenaDev
・script_ref.txt修正

----------------------------------------
//1990 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1990

//1989以前の変更点はReadmeを参照してください
----------------------------------------
// 1989 by 三郎
・@autolootをeAから移植 (item_auto_getを各自でon/offできるだけです)
・mob.cの警告つぶし

----------------------------------------
// 1988 by Kiry.
// 1988 fix by三郎
・zipの構造を修正
・battle_athena.confの英文を日本語訳

----------------------------------------
// 1988 by Kiry.
・gethomuninfo関数を拡張
　case 5:classを追加

----------------------------------------
// 1987 by Yor
Added: 2 options to check on GVG or PVP maps if a player tries to block a enemy with a trade request.
Added: a check when a trade is requested (don't trade to yourself!).
Removed: unused return value of clif_tradestart function.
Improved: call of clif_tradestart functions.
7 modified files:
	Readme1928
	(conf/)
		battle_athena.conf
	(src/map/)
		battle.c
		battle.h
		clif.c
		clif.h
		trade.c

----------------------------------------
// 1986 by Yor
Fixed: possible crash when a chat owner is changed or when chat user is kicked.
Added: check of NPC (if it is a chat) in chat_leavechat function.
Removed: unused return value of chat_changechatowner and chat_kickchat functions.
Improved: call of clif_leavechat and chat_leavechat functions.
5 modified files:
	Readme1928
	(src/map/)
		chat.c
		chat.h
		clif.c
		clif.h

----------------------------------------
// 1985 by lkm
change drop system
now time check item type dont check itemid
details = 3 is only use card_drop_rate,equip_drop_rate,etc....
	Readme1928
	(src/map/)
		battle.h
		battle.c
		mob.c
	(conf/)
		battle_athena.conf

----------------------------------------
// 1984 by Yor
Fixed: possible crash when a chat status is changed.
Removed: unused return value of chat_joinchat and chat_changechatstatus.
Added: check of NPC type in chat_joinchat and chat_changechatstatus.
Improved: call of chat_joinchat and chat_changechatstatus functions.
4 modified files:
	Readme1928
	(src/map/)
		chat.c
		chat.h
		clif.c

----------------------------------------
// 1983 by End_of_exam

・gethomuninfoで落ちそうなのを修正(script.c)
・不正パケットを送るとselect, menu 命令で落ちるバグを修正(script.c)
・プレイヤーがアタッチされていない状態でwarp 命令を使うと落ちるバグを修正(script.c)
・1980と同じ修正を露天にも追加(vending.c)
・1981の警告を修正(chat.c)
・1982のコンパイルエラーを修正(skill.c)

----------------------------------------
// 1982 by Filia
・ランドプロテクター上ではテレポートの使用が出来ないように修正
・battle_confにエレメンタルチェンジをボスに使用出来ないオプションを追加。
・永遠の混沌がボスに効果が出ないように修正。
・タロットカードの詠唱を固定に修正。
・ノービスが蘇生時にHPが1で蘇生される点を修正。
　restart_hp_rateを見るようにしました。
----------------------------------------
// 1981 by Yor
Fixed: possible crash when a chat is created.
Improved: call of chat_createchat function.
4 modified files:
	Readme1928
	(src/map/)
		chat.c
		chat.h
		clif.c

----------------------------------------
// 1980 by Yor
Fixed: overflow, invalid values, etc. when selling items in clif_parse_NpcSellListSend and npc_selllist (anti-hack).
3 modified files:
	Readme1928
	(src/map/)
		clif.c
		npc.c

----------------------------------------
// 1979 by KADP
// 1979-fix3 by 三郎

fix2で戻ってしまっていた部分を修正。
英語部分を日本語に翻訳。+補足。
2 modified files:
	Readme1928
	(conf/)
		battle_athena.conf
----------------------------------------
// 1979 by KADP
// 1979-fix2 by Yor (restore nex garbled characters)
・テストした値段を適用した誤打を修正.
・韓国語を日?語で修正.
2 modified files:
	Readme1928
	(conf/)
		battle_athena.conf

----------------------------------------
// 1978 by Yor
restored: japanese characters in 2 files.
2 modified files:
	Readme1928
	(conf/)
		battle_athena.conf

----------------------------------------
// 1977 by KADP
Added: It adds so that a consumption item and ZABUTEMU may be set up independently.
5 modified files:
	Readme1928
	(conf/)
		battle_athena.conf
	(src/map/)
		battle.c
		battle.h
		mob.c

----------------------------------------
// 1976 by Yor
Added: an option to save character when it drops an item (anti-hack).
5 modified files:
	Readme1928
	(conf/)
		battle_athena.conf
	(src/map/)
		battle.c
		battle.h
		clif.c

----------------------------------------
// 1975 by Kiry.
・gethomuninfo関数を追加

----------------------------------------
// 1974 by Yor
Fixed: overflow, invalid values, etc. when buying items in clif_parse_NpcBuyListSend and npc_buylist (anti-hack).
Clean up npc_buylist and npc_selllist functions.
3 modified files:
	Readme1928
	(src/map/)
		clif.c
		npc.c

----------------------------------------
// 1973 by Yor
Fixed: double call of map_id2bl when npc_checknear function is called.
Removed: unused return value of npc_click and npc_buysellsel.
Improved: call of npc_buysellsel.
4 modified files:
	Readme1928
	(src/map/)
		clif.c
		npc.c
		npc.h

----------------------------------------
// 1972 by Yor
Removed: unused return value of pc_dropitem, pc_delitem, pc_useitem, pc_putitemtocart, pc_equipitem, pet_equipitem and pc_unequipitem.
Fixed: possible hack in clif_parse_UseItem and clif_parse_EquipItem functions with an invalid index.
Replaced: some 'index' variables by 'idx' (index can be reserved in some C libraries).
6 modified files:
	Readme1928
	(src/map/)
		clif.c
		pc.c
		pc.h
		pet.c
		pet.h

----------------------------------------
//1971 by End_of_exam

・キャストリングをunit_moveposを使うように変更(skill.c)
・clif_parse_UseSkillToId, pc_skillcheck, pc_skillcheck2, pc_skillupで
　落ちそうなのを修正(pc.c clif.c)
・MAX_HOM_SKILLID の定義を混乱しにくいように修正(mmo.h)

----------------------------------------
//1970 by ＡＡＡ
・キャストリング修正

----------------------------------------
//1969 by ＡＡＡ
・ホムンクルスの自然回復力の公式修正
・キャストリング時の視界関係
・キャストリングを使用できないように修正
　MOBのAIにバグが出るため停止
　それでも使用したい場合skill_db2.txt 31->4にしてください

----------------------------------------
//1968 by こう
・転生１次職の服色が転生前の色になってしまう不都合を一応修正
　1809にて変更された該当個所を一旦戻しです（clif.c）
　（念のために変更されてた所はコメントアウトにて残してあります。）

----------------------------------------
//1967 by ＡＡＡ
・警告修正
・RJC2006記念ラグくじ(ネタ)
  getitem -20,1;
  確率適当
　ゴーストリングカード、エンジェリングカード、錐は多分出ません

----------------------------------------
//1966 by ＡＡＡ
・開始時にホムンクルスのスキルが表示されないのを修正
・キャストリング時のMOBがPCからHOMを攻撃するように変更
・ケンセイの祝福が二重に効果があったのを修正
・ニヨルドの宴を修正
・master_get_homun_base_exp: yes
・master_get_homun_job_exp: no
　マスターがホムンクルスの経験値を取得する

----------------------------------------
//1965 by ＡＡＡ
・カプリス
・転職後のホムンクルス維持？

----------------------------------------
//1964 by ＡＡＡ
・脳手術の数値修正

----------------------------------------
//1963 by ＡＡＡ
・ホムスキルのディレイ修正
・脳手術、アダマンティウムスキンに回復向上実装
・

----------------------------------------
//1962 by ＡＡＡ
・キャストリング修正
・ホムンクルスの親密度の保存修正

----------------------------------------
//1961 by ＡＡＡ
・カオティックベネディクション実装
・警告つぶし

----------------------------------------
//1960 by ＡＡＡ
・ホムスキルの射程バグ修正
・親密度関係のバグ修正
・homun_skill_intimate_type: 0
　ホムンクルスのスキルで親密度を消費する
・save_homun_temporal_intimate: yes
　ホムンクルスの一時的な親密度を保存する
・homun_speed_is_same_as_pc: yes
　ホムンクルスの移動速度をPCに合わせる
・@homfriendly追加

----------------------------------------
//1959 by ＡＡＡ
・警告つぶし
・homun_intimate_rate: 100
　ホムンクルス親密度の所得倍率（100で通常、200で倍…）
・homun_intimate_resilience: 50
　ホムンクルス親密度の回復力 (4秒毎)
・hvan_explosion_intimate: 45000
　バイオエクスプロージョンの使用条件(親密度)
・倍率実装により取得条件親密度をMAXに変更

----------------------------------------
//1958 by ＡＡＡ
・allow_homun_status_change: no追加
　ホムンクルスの状態異常を許可する
　※ただしホムスキルは常に許可
　ホムンクルスに使えるスキルは蔵制御？のため指定スキル(ブレスなど)を使えません
　PCと違ってステータスが違うので未設定ばかりです
・ホムンクルスのスキル(カオティックベネディクション以外)　仮実装
  バイオエクスプロージョンは親密度2000必要です
・ホムンクルスのスキルツリー修正
　親密度追加(条件:10000)　各自設定してください
　エミュで親密度MAX100000(初期値2000)の条件は辛いので少なめ
・スキルによる親密度減少追加
  減った親密度は自然回復(SP)毎に10回復します
　(現在リログなどで戻ります)
・ホムンクルスのスキルディレイ追加

----------------------------------------
// 1957 by Yor
Fixed: possible infinite loop with packet 0x7918 on login-server
       (to have admin access; infinite loop: with invalid lenght inside packet).
Fixed: possible overflow when displaying account name in parse_login (limit length of display to 24).
Improved: inside parse_login, when eof=1 is set, clean up properly FIFO (add RFIFOSKIP for principe).
2 modified files:
	Readme1928
	(src/login/)
		login.c

----------------------------------------
//1956 by ＡＡＡ
・ホムンクルスが状態異常にかかるように修正
・いくつかのホムンクルスのスキル　仮実装
　緊急回避
　脳手術
　ディフェンス
　アダマンティウムスキン
　フリットムーブ
　オーバードスピード
　カプリス
　チェンジインストラクション

----------------------------------------
//1955 by End_of_exam

・1951でmenu命令の末端の選択肢が機能しなくなっていたバグを修正(script.c)

----------------------------------------
//1954 by ＡＡＡ
・ホムンクルスがスキルを使用できるように修正
　ムーンライト追加
・ホムンクルスに初期レベル追加

----------------------------------------
//1953 by lkm
add OnWeekTime label thanks to ea code
		OnWeekTimeXXXXXX
			Each week XXdayXXhourXXmin run some script
			     day : 00=Sun,01=Mon,02=Tue,03=Wed,04=Thu,05=Fri,06=Sat

----------------------------------------
//1952 by ＡＡＡ
・コールホムンクルス修正(安息時)

----------------------------------------
//1951 by End_of_exam

・1948の修正(clif.c)
・buildin_select, buildin_menu の境界チェックの修正(script.c thanks to Rohypnolさん)
・skill_unit_onplaceで落ちるバグの最終手段追加(skill.c)
・VC 2005での警告を修正(httpd.c vc07_make.bat thanks to 匿名さん)

----------------------------------------
// 1950 by Yor
Fixed: possible overflow with abnormal software in global messages and wisp messages (new hack from 1948, sorry).
Improved: check NULL string and void message in clif_parse_GMmessage.
Removed: unused return value of pc_takeitem.
Modified files:
	Readme1928
	(src/map/)
		clif.c
		pc.c
		pc.h

----------------------------------------
//1949 by ＡＡＡ
・ガンスリンガーのエフェクト修正
・ホム関係修正

----------------------------------------
// 1948 by Yor
Added: check of NULL in global messages and wisp messages (against hackers).
Improved: Wisp: don't wisp yourself (against hackers).
Removed: answer of intif_wis_message not used.
	Readme1928
	(src/map/)
		clif.c
		intif.c
		intif.h

----------------------------------------
// 1947 by Yor
Added: check of sex in auth request.
Improved: chrif_authreq -> not need to search session. We already have the value.
	Readme1928
	(src/map/)
		chrif.c
		chrif.h
		clif.c

----------------------------------------
//1946 by intig
・homun.cを修正

----------------------------------------
//1945 by intig
・STR料理の材料「バッタの足」が「バッタ人形」になっていたのを修正
・リザレクションホムンクルスでもホムが作成できてしまう不具合を修正

----------------------------------------
//1944 by Rayce

・homun_db2.txt利用時のメモリリークを潰すついでに
　@reloadhomundb追加（atcommand.*, homun.*）

・自爆関連の処理修正（mob.*, skill.c, status.c, unit.c）
	詠唱時間はupkeep_timeの値ではなく純粋にcast_listの値を使う
	爆発連鎖する
	PCに対してはPv,Gvのみダメージが発生
・スフィアーマインの挙動修正
	移動速度 100msごとに5加速
	HP 2000+Lv*400
	NPC_SELFDESTRUCTION2が必須なためmob_skill_db.txtを最新版にして追加
		（hugeさんの所を使わせてもらいました、thanks）

----------------------------------------
//1943 by ＡＡＡ
・進化後のホムンクルスのスキルツリーを修正（不足分追加）
・ホムDBに経験値テーブル追加
  ※経験値テーブルの指定方法が変更になりました
・囲まれてもFLEE・DEFは減少しないように修正
----------------------------------------
//1942 by intig
・進化後のホムンクルスの経験値テーブルを追記
とりあえず進化前と同じ値です・・・
・進化後のホムンクルスのスキルツリーに足りない部分があったので追記
----------------------------------------
//1941 by intig
進化後のホムンクルスのスキルツリーを追加
----------------------------------------
//1940 by Stinger
コンパイル時に
警告 W8065 homun.c 513: プロトタイプ宣言のない関数 'homun_get_create_homunid' の
呼び出し(関数 homun_callhom )を出ないように修正
----------------------------------------
//1939 by ＡＡＡ
・DBのSIZE,RACE,ELEMENTを使用するように変更
・homun_db.txt修正
　SIZE=1,RACE=0,ELEMENT=80 (status.cより決定)
・@makehomun　指定したIDのホムンクルス作成

----------------------------------------
//1938 by ＡＡＡ
・ホムＤＢ拡張
　VIEWCLASS,SIZE,RACE,ELEMENT,EVOCLASS
  ※SIZE,RACE,ELEMENTは予約(MOB型ホム用)
・暫定進化
・ホム用コマンド追加
  @homviewclass ホムの見た目を変える
　@homrecalc ホムのステータスを再計算
  @evolution ホムを進化させる
・embryo_db.txtで作成できるホムを指定できるように修正

----------------------------------------
//1937 by End_of_exam

・ホムンクルスの修正(homun.c mob.c)
・1933の修正(skill.c)

----------------------------------------
//1936 by huge
・homun.cのメモリリーク修正。
・新規作成時に、エンブリオを複数持っていた場合に、正常に動作しなかったのを修正。(Thanks Rayceさん)
・型警告の修正。(Thanks lkmさん)

----------------------------------------
//1935 by huge
・ホムンクルス実装。(といっても、基本的な動作だけです）
・ホムの新密度上限を、10,000から100,000へ変更。(short->intへ型変更)
・ホムのレベルを操作するコマンド、@homulv追加。
・ROメールの修正。
・@mobsearch拡張。
	IDを-2にするとBOSS属性を持つMOBのみ表示できるように。
	"@mobsearch id mapname"と、マップを指定できるように。
・@mobinfoをeAから移植。
・packe_db.txt修正。
・win32_start.batの修正。(Thanks ERKさん)

ホム実装にあたり、
システム面の調査＆パケット関連でお世話になったトロご夫妻、
ステータスの情報を集めて下さったtomoさん、
それから、様々な情報を寄せて頂いた方々に大感謝。

※動作確認 Cygwin+gcc TXT_ONLYのみ

----------------------------------------
//1934 by Rayce

・ダブルキャスティングが連撃するようにしてみる
		reported by free
	battle_skill_attack()
・スキッドトラップのノックバック方向修正（弓手wiki + 本鯖実地調査）
	skill_unitsetting()
	skill_unit_onplace_timer()
・吹き飛ばし関連のフラグを改変（battle.c, skill.c, skill.h）

・job関連のscript修正
		reported by ルナさん、thx a lot!!
	NV,MC,KN,PR,AS,CRU,SA,DCの8点

----------------------------------------
//1933 by Rayce

・アローシャワーのノックバック修正
	指定セルを中心にして外側に飛びます
・一部のスキルで吹き飛び経路にデッドセルがあったときは移動停止するように修正（path.c, map.h）
	（アローシャワー、バックステップ）
・ボウリングバッシュのノックバック方向修正
	自分が向いてる方向に吹き飛ばします
・対人で不死属性のPCにPTメンバーがヒールした場合はダメージが発生しないように修正
・1931のmap_athena.confを少し修正

----------------------------------------
//1932 by End_of_exam

・単項演算子の直後に関数を呼び出すスクリプトが誤動作するバグを修正(script.c thanks to AthenaDev)

　if( !rand(2) ) set '@a, '@a + ( -rand(1) ); などの修正です。

----------------------------------------
//1931 by Rayce

・AthenaDevから全NPCスクリプトの改修版をリリース
		originally reformed by Rayce and fixed by AthenaDev's member, thx a lot!!

	GvGのファイル群の構成が異なっており互換性が失われているのでご注意ください
	また変数名を統廃合を行っているので既存の変数を保持したい場合は
	sample内のnpc_debug_convertvars.txtを設置の上、各ユーザーに実行させてください

	変更点は余りにも多すぎるのでAthenaDev「NPC/改修」にある添付ファイル内のReadmeをお読みください
	全ては本鯖調査に力を注いでくれた人（過去/現在問わず）のおかげであることを努々忘るることなかれ！

----------------------------------------
//1930 by ＡＡＡ
・スキル毎のダメージ補正修正

----------------------------------------
//1929 by Rayce

・maprespawnguildid命令を修正
・warp, areawarp, warpwaitingpc命令の"SavePoint"指定時にmapflagを無視するように変更

----------------------------------------
//1928 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1928

//1927以前の変更点はReadmeを参照してください
----------------------------------------
//1927 by Rayce

・mobスキルのareaslavegt, areaslaveleをさらに変更
	下位8bitに数を、上位8bitに範囲を指定します（mob.c）
・@healに負の値を入力するとHP,SPを減少できるように（デバッグ向け atcommand.c）

・出血実装（battle.c, pc.c, script.c, skill.c, status.c）
	10秒ごとに200〜800のダメージを受ける
	HP,SPの自然回復停止
	モンスターの場合HPが50以下にならない、
	耐性は毒の計算と同じにしました　確率 = 100-(3+VIT+LUK/3) (%)
	基本効果時間は90秒、ただしこれはヘッドクラッシュのupkeep_time2の値を利用します
	実効果時間も毒と同様　時間 = (基本効果時間)*(1-(VIT+LUK/5)/100)
	不死、ボスには無効

・メテオアサルト修正、出血効果追加
	スタン、出血、暗闇の効果時間は武器の追加効果による状態異常と同じものを利用
	（面倒だったのでupkeep_time2は使ってません）
・ヘッドクラッシュ修正
・ジョイントビートの効果実装
・アシッドテラー修正、出血効果追加（skill_cast_db.txtも修正）

----------------------------------------
//1926 by ＡＡＡ
・normal,pvp,gvg,pk時のスキル毎のダメージ補正追加
　※攻撃スキルのみ有効(skill_db2.txt)
・pvp_edp_down_rate,pk_edp_down_rate追加
  ※pkはPCにのみ有効
・落法取得条件修正　飛び蹴りLV1->LV7
・@mapinfoにPK情報追加
・@mapflagにPK追加

----------------------------------------
//1925 by End_of_exam

・MySQL 5.0でアカウント作成が出来ないバグを修正(login.c)
・存在しないNPC ファイルを読み込もうとするとnullpo が出るバグを修正(skill.c)

----------------------------------------
//1924-fix by kiry

・フルバスターの最大レベル修正(skill_tree.txt)
・fix前のskill_db.txtに戻し
----------------------------------------
//1923 by Rayce

・@writevarsの改善（atcommand.c, script.c）
	"で囲むことで半角スペースを含む文字列を渡すことが可能になります
・script命令を少しだけ修正
	buildin_awake()
	buildin_sc_starte()
	buildin_flagname()
	buildin_getnpcposition()
・ゴスペル修正
			reported by kina
	skill_castend_nodamage_id()
	skill_check_condition2_pc()

・conf/help.txtを整備
	doc/help.txtの方はいずれ抹消するつもりなのでほったらかし
・Translated a part of battle_athena.conf into Japanese

----------------------------------------
// 1922-fix by Filia
・カートターミネーションに特化カード効果が乗っていたので修正。(battle.c)
・ダストの射程が近距離になっていたので、他の銃スキルに射程を合わせました。
・マナリチャージの取得条件がディバインプロテクションLV10になっていたので
　デーモンベインLV10に修正。
----------------------------------------
// 1921 by Yor
Added: possibilities to do gm at_command when you wisp someone.
	Readme1850
	(src/map/)
		clif.c

----------------------------------------
// 1920-fix by ARIA
・GvGでEDPの効果を下げられる設定
gvg_edp_down_enableをgvg_edp_down_rateに変更
----------------------------------------

// 1919 by Yor
Fixed: checked message when testing atcommand of a party message (11->1).
Added: an option to check hacker using incorrect name in party and guild messages.
	Readme1850
	(conf/)
		battle_athena.conf
	(src/map/)
		battle.c
		battle.h
		clif.c

----------------------------------------
// 1918-fix by Yor
Fixed: compilation error on 1917.
Fixed: skill message length when global message is checked for player name.
Changed: name of configuration: check_proof_name_global_msg->check_player_name_global_msg.
	Readme1850
	(conf/)
		battle_athena.conf
	(src/map/)
		atcommand.c
		battle.c
		battle.h
		clif.c

----------------------------------------
// 1917 by Yor
Fixed: changed value in @statall between each stat.
Fixed: check of max_parameter configuration for each stat (when battle_athena.conf is loaded).
	Readme1850
	(src/map/)
		atcommand.c
		battle.c

----------------------------------------
// 1916 by Yor
Checked if mapname is not void in clif_parse_MapMove (/mm) before to try to move.
Fixed: in clif_parse_Restart and clif_parse_UseItem don't get packet information before to check if session data exists.
Moved: message from clif_parse_DropItem to msg_athena.conf.
Check: index value in pc_unequipitem (to avoid hacker crash with clif_parse_UnequipItem).
	Readme1850
	(conf/)
		msg_athena.conf
	(src/map/)
		clif.c
		pc.c

----------------------------------------
//1915 by Rayce

・doc/save_refを少しだけ修正
・doc/db_refに追記
・Translated battle_athena.conf into Japanese and a little modified msg_athena.conf (number 45)
・Arranged battle.*

・mobスキルの拡張と処理の見直し（mob.c）
	- ターゲットのslaveを機能化
	- ターゲットにfriendを指定したときでも条件タイプを自由に選択できるように改良
	- ターゲットmaster, slave, anothertargetのセルに場所指定スキルを発動できるように改良
	- mobスキルの条件タイプで以下のものの対象検索能を改善
		friendhpltmaxrate, friendstatuson, friendstatusoff

----------------------------------------
// 1914 by Yor
Fixed a possible overflow in ranking.c.
	Readme1850
	(src/map/)
		ranking.c

----------------------------------------
// 1913 by Yor
Fixed a possible overflow on 1911.
	Readme1850
	(src/map/)
		clif.c

----------------------------------------
// 1912 by End_of_exam

・1910の修正(1912_changetable.sql int_homun.c)

----------------------------------------
// 1911 by Yor
Added an option to display party name even if player is not in a guild.
	Readme1850
	(src/conf/)
		battle_athena.conf
		msg_athena.conf
	(src/map/)
		battle.h
		battle.c
		clif.c

----------------------------------------
//1910 by huge
・ホムンクルスの経験値を保存し忘れていたのを修正。
・SQL: テーブルhomunculusにbase_expを追加(main.sql 1910_changetable.sql)
・ホムンクルスの新密度が、一定以上にならなかったのを修正。
・int_homun.hの置換ミス修正。
	(src/char/)
		int_homun.c .h

----------------------------------------
//1909 by Rayce

・db/sample/item_value_db.sampleにある説明文をdoc/db_refに記述
　ついでに他の項目を少し補足
・doc/agitdb_refの内容を再編集してdoc/save_refとして設置する

・1906を受けてさらに鯖落ちしないように修正（skill.c）
・mobスキルの条件タイプareaslavegt, areaslaveleの記述法変更
　値1に範囲を入れる方式だと一部のNPCスキルが機能しないためです、詳細はdoc/db_ref参照
	mobskill_use()
	mob_readskilldb()

----------------------------------------
// 1908 by Yor
Fixed: overflow when copy with memcpy(x,"NPC",24) in clif_parse_GetCharNameRequest function.
	Readme1850
	(src/map/)
		clif.c

----------------------------------------
// 1907 by Yor
Removed: unused parameter (fd) when pc_setnewpc is called.
Removed: return value (not used) of chrif_authreq and pc_setnewpc.
	Readme1850
	(src/map/)
		clif.c
		pc.c
		pc.h
		chrif.c
		chrif.h

----------------------------------------
//1906 by End_of_exam

・1905の修正(skill.c)
・SQL: ホムンクルスのスキル保存部分を追加(int_hom.c main.sql 1906_changetable.sql thanks to hugeさん)
・SQL: テーブルcharのname, account_id にインデックスを追加(main.sql 1906_changetable.sql)

----------------------------------------
//1905 by Rayce

・csvreload命令を2回以上使うとメモリリークが発生するのを修正（script.c）
・1904で発生するコンパイルエラーの修正（atcommand.h）

・伏虎拳の移動停止処理修正
・ソニックブロウ、アローバルカンのモーション中は移動できないように修正
	skill_castend_damage_id()

　時間の計算式がわからなかったので自分で計測してみて適当に実装しました
　近似曲線とか取ったわけでもなく勘で反比例の曲線に合わせてます
　ディレイ時間の情報をお持ちの方は提供お願いします
	<delay time> = 300/<ASPD> (sec)、3secを越える場合は3sec

----------------------------------------
// 1904 by Yor
Fixed: invalid value of message number when displayed (msg_table).
Improved: use dynamic memory for msg_table (and not 1024 bytes for each message).
	Readme1850
	(src/map/)
		atcommand.c
		atcommand.h
		chrif.c
		intif.c
		map.c
		mob.c
		pc.c
		ranking.c

----------------------------------------
//1903 by Rayce

・item_db.txtのJOBを16進数でも表記できるように拡張（merged from eA）
　全職業可能を0xffffffffとしても機能します
	itemdb_read_itemdb()
・mobスキルのターゲットの項目にanothertargetを追加（mob.*）
　現在攻撃しているターゲット以外の敵をランダムに検索してスキルを発動します
　mobのターゲット自体は変更されません
	mobskill_use()
	mobskill_anothertarget() 追加
	mob_readskilldb()

	例）ターゲットと交戦しつつ30%の確率でスキル射程範囲内の別のPCに対してJTを撃つ
		1201,ユピテルサンダー＠リビオ,attack,84,10,3000,800,0,no,anothertarget,always,0,,,,,,

・doc/db_ref追記

----------------------------------------
//1902 by ＡＡＡ
・スパイダーウェッブの枚数制限修正

----------------------------------------
//1901 by worisy

・詠唱無しになるDEXを指定できるるように修正
　以前の詠唱時間調整の指定方式(no_spel_dex1,no_spel_dex2)を削除
　conf/battle_athena.conf
  src/map/battle.h
  src/map/battle.c
  src/map/skill.c

・no_casting_dexについてドキュメント追記
　1898で忘れてたno_delay_dexについても追記
　doc/conf_ref.txt

----------------------------------------
//1900 by End_of_exam

・1899の修正とSQL 暫定対応(inter_athena.conf int_homun.c skill.c main.sql 1900_changetable.sql)
・SQL: DBに挿入したIDを得るのにmysql_insert_id() を使うように修正(char.c pet.c)

----------------------------------------
//1899 by huge
・ホムンクルス実装準備 inter鯖,status,battle
・コールホムンクルス・安息・リザレクションホムンクルス追加
・ポーションピッチャーの成功条件修正(特殊になりそうなので、dbのinf2ではなくソースで制限)
・リザレクションホムンクルスのcasttime追加(3secは体感)
・homun_db.txt更新
・db_ref.txtにhomun_db.txtについて追記

例のごとく、int_homun.cではSQLに対応しておりません。
自信がないので、全部コメントアウト。

----------------------------------------
//1898 by worisy

・ディレイ無しになるDEXを指定できるように修正
　conf/battle_athena.conf
  src/map/battle.h
  src/map/battle.c
  src/map/skill.c

----------------------------------------
//1897 by Rayce

・input命令で変数 "l14" に代入しないように、
　menu/select命令で変数 "l15" に代入しないようにコメントアウト（script.c）
・関数名の細かい修正（map.c, mob.c, mob.h）

・NPCファイルが見つからない時でもメモリリークしないように修正
	do_init_npc()
・mobが動けないときにrudeattacked指定のmobスキルを発動するように改善
	mob_ai_sub_hard()

・mobスキルのcommandについて
　　- 命令対象でslaveとslavesの区別がなかったのを修正
　　- スキル対象のtargetが「命令相手が攻撃中の場合はそのターゲットに、待機状態なら命令主と同じターゲットにスキル攻撃」
　　　になるように多分修正
		mobskill_command()
　　- スキル対象にslavesとfriendsが指定できなかったのを修正
		mobskill_command_use_id_sub()
・mob_skill_db.txtの説明文をdoc/db_ref.txtに記述する
　ついでに説明が抜けているものを補完

・ダメージの発生しない吹き飛ばし系スキルを使うと位置ズレを起こすバグを修正
　（バックステップ、スキッドトラップ、バジリカ、月明りの下で）
・ボーリングバッシュの吹き飛び処理を念のため修正
・Pvモードにおいてスキッドトラップが自分とPTMに作動しなかったバグを修正
	skill_castend_nodamage_id()
	skill_unit_onplace_timer()
	skill_blown()

	ダメージやエフェクトの発生しない吹き飛ばしをclif_blown() で行うと
	ズレが生じるようなので、これらに関してはclif_fixpos2() を使うようにします。
	相変わらずパケット0x01ffの挙動が掴み切れてないので仕方なく…。

----------------------------------------
//1896 by lkm
update some db file

----------------------------------------
//1895 by ＡＡＡ
・ワープポータル修正
　同一マップは即移動

----------------------------------------
//1894 by End_of_exam

・合奏スキルでダンスユニットの引き継ぎが上手くいかないバグを修正(unit.c skill.c)
・無敵タイマー中にスキルユニットからの影響を受けないように修正(skill.c)

<開発者向けの情報>
	スキルユニットの影響を受けるのは、キャラが生存していて、かつ無敵タイマー中以外の時です。
	ユニット（PC、ペット、ホムンクルスなど）が死ぬ直前に onout イベントを呼び出す必要があり、
	生き返った直後（or 無敵タイマーが解除された直後）には、onplace イベントを呼び出す必要が
	あります。

	注意：「死ぬ直前」には死亡フラグが立っている時は含みません。1872では unit_isdead() が
	　　　０以外を返す時（＝死亡フラグ確定済み）にonout イベントを呼び出していたのを修正しました。

----------------------------------------
//1893 by ＡＡＡ
・skill_db2.txt追加 skill_misfire,skill_zone統合
・クローン可否判定の見直し
・battle_athenaからクローン関係削除
  extended_cloneskill削除
  expansion_job1_skill_cloneable削除
  questskill2_cloneable削除
　※skill_db2で設定してください
・@cloneskill,@cloneskill2追加
@cloneskill ID [LV]	--- 指定したクローン可能なスキルを覚える
			    LV省略時は最大値
@cloneskill2 ID [LV]	--- 指定したスキルを覚える
			    LV省略時は最大値
  ※クローンスキルを所持していること
・ストリップをPC,MOB以外に使うとサーバーが落ちるのを修正
・スパイダーウェッブ修正

----------------------------------------
//1892 by Rayce

・distance関数の機能追記
	PCとNPCが別MAPであれば-1を返すように
・enablenpc/disablenpc命令の引数を省略可能に拡張
・hideonnpc/hideoffnpcの一部のprintfをコメントアウト
	対象NPCをconfigの設定により読み込んでないとき等にエラー文を出力しないためです
・copyarray命令のバグ修正
・getwaitingpcid命令に文字列型変数名も指定できるように
・script.cの細かい修正

----------------------------------------
//1891 by ＡＡＡ
・ワープポータルに乗ってもすぐに移動しないように修正
　※雰囲気を作っただけです。
　　本鯖では同一マップは乗った瞬間に移動するので、移動の遅れはサーバー間で行っているPCデータ関係の遅れ？

----------------------------------------
//1890 by ＡＡＡ
・@goにフィゲル追加、スタートポイント削除
・スパノビのLV99 HPボーナス修正
・移動処理修正　境界ー＞マス中央へテスト修正
　unit_walktoxy_timer()
  // マス目境界へ到着　以下を移動しただけです。
　不具合出るようでしたら戻してください。

----------------------------------------
// 1889 by Yor
Fixed checked values of message number when reading msg_athena.conf.
Fixed displaying of found GMs quantity when reading GM account file.
Improved error messages when reading GM account file.
	Readme1850
	(src/char/)
		char.c
	(src/converter/)
		login-converter.c
	(src/login/)
		login.c
	(src/map/)
		atcommand.c
		pc.c

----------------------------------------
// 1888 by Yor
Removed duplicated messages from msg_athena.conf.
	Readme1850
	(conf/)
		msg_athena.conf
	(src/map/)
		atcommand.c
		ranking.c

----------------------------------------
// 1887 by Yor
Added ranking messages of rankinc.c in msg_athena.conf.
Added show_steal messages of pc.c in msg_athena.conf.
	Readme1850
	(conf/)
		msg_athena.conf
	(src/map/)
		pc.c
		ranking.c

----------------------------------------
// 1886 by Yor
Fixed some possible overflows when reading converter_athena.conf.
Added some TXT files in configuration inside converter_athena.conf.
Added login DB configuration inside converter_athena.conf.
Fixed usage of login_db_level and other login_db definitions in converter software.
Added error message when an option is unknown in converter_athena.conf.
	Readme1850
	(conf/)
		converter_athena.conf
	(src/converter/)
		converter.c
		converter.h
		login-converter.c

----------------------------------------
//1885 by End_of_exam

・mob_skill_db の [target/master]status[on/off] の誤判定を修正(mob.c)
・1882の気になった箇所を修正(login.c mob.c)
・SQL: homun_id をテーブルに追加(main.sql 1885_changetable.sql char.c char-converter.c)
・SQL: Request で始まるデバッグ用メッセージをコメントアウト(char.c int_guild.c int_party.c int_pet.c)

----------------------------------------
//1884 by huge
・SQLでコンパイルエラーが出る箇所を修正
	(src/char/)
		char.c

----------------------------------------
// 1883 by Yor
Fixed incuvate->incubate in char-converter, main.sql, inter_server_packet.txt.
Added 1882_changetable.sql.
to fix:
	char.c: In function `parse_char':
	char.c:2986: error: too many arguments to function `char_sql_make'

----------------------------------------
//1882 by huge
・@reloaditemdbをやると、落ちそうな部分を修正。
・ホムに関連する構造体を追加。
・ROメールの不具合が出そうな部分を修正。
・athena.txtに、ホムのIDを記録するように修正。
・athena-startで、使われていないはずのbank.txtを作成するのをやめ、homun.txtを作成するよう修正。
・ホムに経験値を渡しやすいよう、Mobの経験値分配で記録するIDをchar_idからbl.idへ変更。
・ドロップアイテムの取得権の計算を、sdからblへ変更。
・dbの修正。
・その他、気になった部分の修正とか。
	(src/char/)
		char.c
		int_mail.c
		int_pet.c
	(src/common/)
		mmo.h
	(src/login/)
		login.c
	(src/map/)
		clif.c .h
		itemdb.c
		map.c .h
		mob.c .h
		pc.c .h
		pet.c
		unit.c
※必ず、save/athena.txtのバックアップを取るようにして下さい。
※中途半端にホム関連の記述が入っていますが、まだホムは使えません。

----------------------------------------
//1881 by End_of_exam

・map_foreachinpath のバグ修正(map.c)
・ギルドスキルを使うと落ちそうなバグを修正(clif.c)

----------------------------------------
//1880 by Yor.
Fixed @commands inside conf_ref.txt and atcommand_athena.conf files with real list.

----------------------------------------
//1879 by luc

・スキルユニット発動時に斜線チェックするように修正しました。

----------------------------------------
//1878 by Yor.
Added @monstermap command in atcommand_athena.conf file.
Fixed check of maximum x,y coordinates in @jump command with real coordinates of the map.
Fixed possible overflow when testing maximum values with @heal and @zeny commands.
Init a variable before sscanf function in somme commands:
 @item3, @charitemreset, @giveitem, @npctalk, @pettalk, @rankingpoint, @readvars, @writevars, @kami(c), @gm, @party, @guild and @mannerpoint.
Fixed possible overflow of @go value when atcommand_go_significant_values is too big.
Added '全員' (all members) of @giveitem in msg_athena.conf file.

----------------------------------------
//1877 by Filia

・水晶落スキルがskill_tree.txtではLv5までですがskill_db.txtではLv10になっていた為、
　Lv5以上を取得出来ていたバグを修正。
・パラディンのJLv69でINTが上がっているのをVITを上げるように修正。
　（クルセイダーテンプレより）
----------------------------------------
//1876 by Yor.

Added @monstermap command to spawn on entire map.
	It's not like @monster + @shuffle, because this command only distributes new monsters, not monsters already present on the map.
Added 'start point' to @go command.
	GM can help new players easier now.
Fixed 'atcommand_go_significant_values' option with actual @go command.

----------------------------------------
//1875 by Yor.

Fixed memory leak when reading GM account file with a broken data.
Fixed possible overflow when reading GM account file.
Added configuration of GM account file in char_athena.conf.
Removed 'gm_pass' option from login_athena.conf and login-server code (this option is not used).

----------------------------------------
//1874 by Kiry.

・produce_db.txtエンブリオを追加
----------------------------------------
//1873 by Rayce

・areakillmonster命令の仕様変更
	<x0,y0> を中心とした範囲ではなく、<x0,y0> → <x1,y1> の範囲に変更します
	areakillmonsterを使っている方はご注意を
・distance関数追加
	eAとは違いRIDとNPC名を引数とします
・script_refの修正と追記

----------------------------------------
//1872 by End_of_exam

・死亡時にスキルユニットからの離脱が正常に行えないバグを修正(unit.c pc.c mob.c)

----------------------------------------
//1871 by Rayce

・1868の@readvars, @writevarsのバグ修正
	script_operate_vars()

　埋め込み変数の書き込みもちゃんと機能してました、誤報申し訳ない

----------------------------------------
//1870 by huge
・ホムンクルス実装準備で、DB関連ファイル更新
・修正
	skill_db.txt,skill_tree.txt,skill_require_db.txt
・追加
	homun_db.txt,exp_homun.txt,homun_skill_tree.txt

----------------------------------------
//1869 by Filia

・トリプルアクション取得条件がシングルアクションLv10になっていたので
　チェインアクションLv10へ修正。
・正確性向上（インクリーシンクアキュラシー）のコイン消費が
　4になっていたので2消費へ修正。
・ソウルブレイカーの詠唱が固定になっていたのでDEX依存へと修正。
・ペット ジルタスがイシスの会話をしていたのを修正。
・ペット アリスがソヒーの会話をしていたのを修正。
----------------------------------------
//1868 by Rayce

・1857のスクリプトのバグ修正と整形
	npc_quest_newyear.txt
	npc_town_guide.txt
	npc_town_inn.txt
	npc_town_lighthalzen.txt
・ワープの修正をAthenaDev投稿分からmerge
		script originally fixed by luc and reported by ルナ、thx a lot!!

・GSとNJのリセットスキルを微修正
	pc_calc_skilltree()
・カートレボリューションの挙動をたぶん修正
			reported by Esr
	skill_castend_damage_id()

・@readvars, @writevars追加
	スクリプトの変数を操作するためのコマンド、主にデバッグ用
	あらかじめスクリプトに記載されている変数が対象
	const.txtの埋め込み変数は読み取りだけ可能なようです

	atcommand_vars_sub()
	atcommand_readvars()
	atcommand_writevars()
	script_operate_vars() 追加

----------------------------------------
//1867 by Kiry.

ミュージックストライクの矢消費修正(skill_require_db2.txt)
----------------------------------------
//1866 by lkm 

update
	./db/item_bluebox.txt
	./db/item_db.txt
	./db/mob_db.txt
	./db/mob_skill_db.txt
	./script/mob/npc_monster.txt
	./script/mob/npc_monster_future.txt

from huge , last update time 2006/03/31 20:11:30

----------------------------------------
//1865 by End_of_exam

・ポーションピッチャー、スリムポーションピッチャー、吸血(MOB)、
　エナジードレイン(MOB)を使うと希に落ちるバグを修正(skill.c)

----------------------------------------
//1864 by ＡＡＡ
・ガンスリンガーのASPD修正(UNLIMITED参考)
・フリップザコイン修正
　１個に付き必中固定ダメージ+3
・グラウンドドリフトを専用弾のみに修正
・グラウンドドリフト設置エフェクト変更
　※弾によって設置表示が違ったようなので修正
  　フレアスフィアのみ0x7fから0xbdに変更

----------------------------------------
//1863 by ＡＡＡ
・ヘルモードの杖修正
・属性変化スキル修正
・NPC_CHANGETELEKINESIS(168)とNPC_CHANGEDARLNESS(169)のID入れ替え
 ※聖属性変化->念属性変化->Unknown(闇属性変化)->防御無視攻撃
   とアイコンが続いたので合っていると思います。
・凍結・石化時の属性変化を優先するように修正
　status_get_element
・爆炎龍のダメージ修正
　INT110+バゼラルドの爆炎龍が8000程度だったので
　MATK+900%*3ではなく、(MATK+900%/3)*3に修正。
・ガンスリンガー、忍者のスキルをクローン出来るように修正
・mob_skill_db.txt修正
  念属性変化 ID 169->168
----------------------------------------
//1862 by End_of_exam

・グラフ表示の改良とバグ修正(graph.c)

----------------------------------------
//1861 by End_of_exam

・unit_iscasting(詠唱中判定), unit_iswalking(歩行中判定) の追加(unit.*)
・上の変更に伴い、map_session_data から status.casting を削除(map.h 他)
・skill_area_sub の対象にunit_dataを加えるように修正(skill.c)
・skill_castend_nodamage_id のクラスチェンジIDをstaticに変更(skill.c)
・skill_check_cloakingで落ちるバグを修正(skill.c)
・エレメンタルチェンジが正しく動作しないバグを修正(skill.c thanks to フェルシアさん)
・gcc での警告を修正(atcommand.h)
・battle_config_read の微修正(battle.c)
・char_sql_load_all のtypoを修正(char.c)

----------------------------------------
//1860 by ＡＡＡ
・念のパラメーター補正再修正
・弾の消費修正
・bAutoStatusCalcPc修正
・bEternalStatusChange修正
・sc_start,sc_start2,sc_start3修正(死亡時無効)
  問題が出たら死亡判定を追加して無効化処理を削除してください
  { if(生死判定){bonus bAutoStatusCalcPc,110; sc_start 110,1000,0;} }

----------------------------------------
//1858 by Filia
・プレッシャーがエナジーコートに軽減されていた現象を修正。(battle.c)
・太陽と月と星の融合を使用時に、HPが20％以上でも即死していた現象を修正。(battle.c)

※太陽と月と星の融合の仕様
 ソウルリンカーの支援を受けて魂状態にある時のみ使用できるスキルです。
 持続時間は10分間固定で、移動速度が速くなり、命中率が 100%になります。
 また、すべての攻撃時にDEFを無視します。ただし、攻撃時に HPを 2%ずつ消費します。
 プレイヤーが人を攻撃した場合には、8％ずつ減少するペナルティとなり
 HPが20％未満である時、攻撃をすれば即死します。

----------------------------------------
//1858 by lkm
update msg_athena.conf

fix run error
     script\npc\town\npc_town_guide.txt
     script\npc\quest\npc_event_whiteday.txt

----------------------------------------
//1857 by Blaze
・リヒタルゼンNPC実装（クエスト未実装）
・mapflag、water_height、warp、map_athena.confのリヒタルゼン対応化・最適化
・townNPCのリヒタルゼン対応化
・2005クリスマス、2006お正月、2006バレンタイン、2006ホワイトデーのNPC追加。

----------------------------------------
//1856 by ルナ
・クラスチェンジにて一部MVPBOSSが出ない不具合を修正。
　([45] Re:本鯖相違スレッド３報告分)
  黒蛇王、ストームナイト、月夜花、ドラキュラ、ハティー、マヤー、アモンラー追加。
・新実装MVPBOSS追加VER
　クラスチェンジでいまいち情報が無いので分からないのですが、
　一応現在本鯖にて追加されているMVPBOSSも追加した物も入れておきました。
  上の追加に加えて、タオグンカ、RSX-0806、ペクソジン、ヴェスパー、セイレン=ウィンザー、
  セシル=ディモン、カトリーヌ=ケイロン、マーガレッタ=ソリン、ハワード=アルトアイゼン、
  エレメス=ガイル、イグニゼム=セニアを追加。
  
  現在クラスチェンジにより出るMVPBOSSの情報が有りましたら報告を貰えると助かります。
  
----------------------------------------
//1855 by ＡＡＡ
・キャスティング中武器を変更できないように修正
  (conf参照)

----------------------------------------
//1854 by ＡＡＡ
・銭投げ修正
・念のパラメーター補正修正
・銃装備時に夕陽のアサシンクロスの効果が出ないように修正
・二次クエストスキル修正
・ファーマシーの成功率修正
・コンバーター製造の成功率修正
・エスマの詠唱条件修正

----------------------------------------
//1853 by lkm 

update
	./db/item_bluebox.txt
	./db/item_cardalbum.txt
	./db/item_db.txt
	./db/item_violetbox.txt
	./db/mob_db.txt
	./db/mob_skill_db.txt
	./script/mob/npc_monster.txt
	./script/mob/npc_monster_future.txt

from huge , last update time 2006/03/25 14:57:53

----------------------------------------
//1852 by 味噌じゅんき 

・sampleの追加職対応スクリプトの修正
	(./sample/npc_debug_job_change2.txt)

----------------------------------------
//1851 by End_of_exam

・1849のフルストリップ修正の補完(skill.c)
・オートスペルの連鎖を一段階に抑制(skill.c)
・MOBAI 手抜きモードの沸き直し処理の修正漏れ(mob.c)

----------------------------------------
//1850 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1850

//1849以前の変更点はReadmeを参照してください
----------------------------------------
//1849 by 雷折
・スプレッドアタックを対象指定スキルに変更(skill.c)
・グラヴィテーションフィールドの修正(battle.c)
	どのような状況でも一定のダメージを与える
・プレッシャーの挙動修正(battle.c)
	どのような状況でも一定のダメージを与える
	※エンペにも承認有りなら当たるようになったままです
・状態反撃の挙動修正(battle.c)
	PVでの検証をしてきましたが、有る程度このような結果が得られました。＞発動上限が半分
・ストリップ系スキルの挙動修正(skill.c)
	未装備箇所は失敗
	フルストリップは未装備箇所、コート箇所のみ失敗＞エフェクトは発生
・シールドチェインの修正(battle.c)
	遠距離、HIT補正はバッシュと同等
・武器破壊で鈍器、斧、杖、本が破壊されない様に修正(pc.c)

----------------------------------------
//1848 by ＡＡＡ
・矢の消費関係修正(範囲)
・skill_require_db2.txt修正

----------------------------------------
//1847 by ＡＡＡ
・専用弾以外でも攻撃できたのを修正
・矢の消費関係修正
・skill_require_db2.txt修正

----------------------------------------
//1846 by ＡＡＡ
・アイテムに矢のタイプ(矢・ナイフ・専用弾・手裏剣・クナイ)追加
・矢・ナイフ・専用弾・手裏剣・クナイの消費関係修正
　※item_arrowtype.txtに追加することでナイフ・専用弾・手裏剣・クナイを簡単に追加できるようになりました。
　　矢はお手数ですがタイプの追加をお願いします。

----------------------------------------
//1845 by ＡＡＡ
・アイテムを鑑定状態で出す(battle_athena.conf)
  itemidentify: 0
・skill_db修正

----------------------------------------
//1844 by Kiry.
・空蝉のスキルツリー修正
・忍者、ガンスリンガーのステータス補正追加

----------------------------------------
//1843 by ＡＡＡ
・コイン修正(パケット不明により気球で代用)
・一閃修正(無属性化)
・インクリージングアキュアラシー修正
・ブルズアイ修正
・アドジャストメント修正
・マジシャルブレット修正
・ピアーシングショット修正
・フルバスター修正
・skill_require_db2.txt追加

----------------------------------------
//1842 by 神楽坂

・WhitesmithのDEX補正値が+11で1低かったのを修正(job_db2-2.txt)
	既存の補正に加え新たにJobLV32でDEX+1となるようにしています。

----------------------------------------
//1841 by Rayce

・1837のメモリリーク修正のミスを訂正
	chat_createnpcchat()
			pointed out by End_of_Examさん、thx a lot!!
・option変更直後も服色が変わらないように修正
	（atcommand.c, clif.c, pc.c, status.c）

・MAPロード時に接触型NPCを有効にする
	clif_parse_LoadEndAck()
・メモリリーク対策
	guild_gvg_eliminate_timer()
	guild_agit_break()
	guild_broken()
	npc_enable_sub()

----------------------------------------
//1840 by 雷折

・シールドチェインの余分な部分を削除(battle.c)
・クナイ投げ、ベナムナイフで属性が乗らなかったバグの修正(battle.c)
・弾丸等消費のおかしな部分を修正(battle.c skill.c)
・NJ_KIRIKAGEの挙動修正(battle.c)
・GS_DESPERADO,GS_GROUNDDRIFT,NJ_SHADOWJUMP,NJ_NINPOU,NJ_KAENSIN,NJ_BAKUENRYU,実装。(skill.c)

----------------------------------------
//1839 by Rayce

・射線範囲攻撃を対人で使う際のバグ修正
	map_foreachinpath()
・ペット作成時のメモリリーク潰し（たぶんTXTだけ？）
	mapif_create_pet()
・ロキはボス無効
	skill_unit_onplace()

----------------------------------------
//1838 by 名前がない

・battle_athena.confの見直し
	
----------------------------------------
//1837 by Rayce

・@reloadgmaccountで発生するメモリリーク潰し
	pc_read_gm_account()
・PT解散時に発生するメモリリーク潰し
	party_broken()
・NPCチャットで発生するメモリリーク潰し
	chat_createnpcchat()

----------------------------------------
//1836 by Filia

・カートブースト・メルトダウン・EDP・オートスペル
以上についてディスペルで解除されないように修正。
(skill.c)

----------------------------------------
//1835 by ＡＡＡ
・水遁追加
・ガバンティン修正
・念修正
・フルバスター修正
・畳返し修正

----------------------------------------
//1834 by Rayce

・gmcommand命令の一部のコマンドをイベント系でも使用可能に修正
・strcharinfo命令の微修正
・areasoundeffect命令のバグ修正
・areamisceffect命令追加
・pet_db2.txtがオーバーライドされないバグを修正
　@reloadmobdbで発生するメモリリーク潰し（pet.c）

----------------------------------------
//1833 by Kiry.

・分身の術のスキルツリーと霞斬りの最大レベル修正

----------------------------------------
//1832 by ＡＡＡ
・テコンランカーボーナス修正
・ウォールオブフォグ修正

----------------------------------------
//1831 by Rayce

・1828のsleep系処理の最適化
			pointed out by End of Examさん、thx a lot!!
・スキッドトラップを暫定で修正
	skill_blown()
・枝mobのmodeを修正
	mob_once_spawn()
	mob_spawn()

----------------------------------------
//1830 by フェルシア

・ペットが消えた時に改名すると落ちるバグを修正(pet.c)

----------------------------------------
//1829 by Kiry.

ブルズアイ・スプリッドアタック・グラウンドドリフト・
風魔手裏剣投げ・影斬り・分身の術のスキルツリー修正

----------------------------------------
//1828 by Rayce

・sleep命令で発生するメモリリーク潰し（script.*）
・awake命令追加

・スパイダーウェブを微修正
			reported by RIN
	battle_calc_damage()

----------------------------------------
//1827 by lkm

update msg_athena.conf
fix in vc++ build warning

----------------------------------------
//1826 by Filia

・グラウンドドリフトのスキルツリーが出ない点を修正
・朔風のスキルツリーが出ない点を修正
・トラッキングのキャストが発生しない点を修正
・忍術の触媒消費を追加
・植物栽培を攻城戦時に使用不可に

----------------------------------------
//1825 by End_of_exam

・map_foreachinmovearea がMAP外の領域を含む場合に誤動作していたのを修正(map.c)
・battle_calc_damageで落ちそうなのを修正(battle.c)
・setusescript, setequipscript命令の微修正(script.c)
・MOB AI関連でdelete_timer error : function dismatchが出るバグを修正(mob.c)

----------------------------------------
//1824 by 雷折
・チェインアクションの判定式がおかしい部分の修正(battle.c)
	thanks to よらんさん
・NJ_HYOUSYOURAKU,NJ_RAIGEKISAIの追加(battle.c skill.c)
・GS_GATLINGFEVERの挙動修正(pc.c)

----------------------------------------
//1823 by Rayce

・itemdb.cの処理最適化
	itemdb_read_itemdb()
・scriptにsetusescript命令、setequipscript命令の追加（based on eA）
・一部の"this"指定script命令をアイテムからでも使えるように修正

----------------------------------------
//1822 by 雷折

・ガンスリンガースキルの修正(battle.c)
　GS_RAPIDSHOWER,GS_FULLBUSTERでの弾丸使用数変更
　GS_CHAINACTIONの武器判定追加
	thanks

・ガンスリンガースキルのdb修正

----------------------------------------
//1821 by Rayce

・1813のitemdb.cをきちんと修正し直してメモリリーク潰し
　@reloaditemdbでリロードされない問題を修正（atcommand.c, itemdb.c）

・細かい修正（script.c, skill.c, status.c）

----------------------------------------
//1820 by 雷折
・clif_skill_fail(sd,skillid,0,0)の前にif(sd)が抜けていたのを修正(skill.c)
			thanks to フェルシアさん
・1819のReadme追加

----------------------------------------
//1819 by Kiry.

・doc/item_bonus.txtに
　bHPPenaltyTime
　bSPPenaltyTimeの記述を追加。

----------------------------------------
//1818 by End_of_exam

・MOB 手抜きモードの改良(mob.c)
・httpd のグラフ表示にMOB 処理の手抜き度合いを追加(map.c mob.c)
・畳替しが発動者と同じマスにいる敵に４回攻撃していたのを修正(skill.c)
・一閃、フライングなどにNULLチェック追加(battle.c skill.c)

　MOB 手抜きモードですが、GHz 以上向けに調整をしました。遅いマシンでは上手く
　制限出来ないかもしれません。グラフの表示値の意味は、100%＝リミッターが働いて
　いない状態、80%＝20%の処理を省いた、ということです。負荷測定の目安として
　ご利用ください。

----------------------------------------
//1817 by ＡＡＡ
・空蝉の使用条件に念状態が必要だったのを修正(skill.c)

----------------------------------------
//1816 by 雷折
・GS_GLITTERINGの挙動を微妙に修正(skill.c)
・GS_MAGICALBULLETでMAP鯖が落ちそうな部分の修正(battle.c)
・NJ_TATAMIGAESHI状態がうまく反映されていなかったのを修正(status.c)
・NJ_KIRIKAGEがハイディング中使えなかったのを修正(skill.c)

----------------------------------------
//1815 by ＡＡＡ
・空蝉
・影分身
・念
・一閃
・ガトリングフィーバー修正
・アイコン追加
・DB修正(情報の無いスキルの詠唱消費は仮実装)

----------------------------------------
//1814 by 雷折
・ダストで弾を消費するように修正(battle.c)
・銭投げでプレイヤーとボス属性のMOBはダメージが半減するように変更(battle.c)
・手裏剣系スキルの計算修正(battle.c skill.c)
・ニンジャ及びガンスリンガーのskill関係db追加(db)

----------------------------------------
//1813 by Rayce

・1809でカードが刺せないバグが発生してたのを修正
			thanks to momoさん
	itemdb_readdb()

----------------------------------------
//1812 by 雷折

・ガンスリンガー及びニンジャのスキル追加(battle.c status.c skill.c skill.h unit.c clif.c)
 GS_GLITTERING,GS_FLING,GS_TRIPLEACTION,GS_BULLSEYE,GS_MADNESSCANCEL,
 GS_ADJUSTMENT,GS_INCREASING,GS_MAGICALBULLET,GS_CRACKER,GS_CHAINACTION,
 GS_TRACKING,GS_DISARM,GS_PIERCINGSHOT,GS_RAPIDSHOWER,GS_GATLINGFEVER,
 GS_DUST,GS_FULLBUSTER,GS_SPREADATTACK,NJ_SYURIKEN,NJ_KUNAI,
 NJ_HUUMA,NJ_ZENYNAGE,NJ_TATAMIGAESHI,NJ_KASUMIKIRI,NJ_KIRIKAGE,
 NJ_KOUENKA,NJ_HYOUSENSOU,NJ_HUUJIN,NJ_KAMAITACHI,

　妄想、ミスが多いかもしれません。
・ガンスリンガースキル及びニンジャで弾丸等を消費するように(暫定(battle.c skill.c)
・銃の使用可能弾丸を制限(battle.c)

----------------------------------------
//1811 by Kiry

・ガンスリンガーと忍者のスキルツリーを追加

----------------------------------------
//1810 by End_of_exam

・1805のバグ修正、デバッグメッセージの消去(mob.c thanks to ラファエルさん)
・MOB 処理に手抜きモードを追加(battle.* mob.c 詳細は battle_athena.conf 参照)

　手抜きモードについては、人柱的要素が大きいです。いつも通り十分な実験を
　していないので、1805に続き使用感など報告して頂ければ嬉しいです。

----------------------------------------
//1809 by Rayce

・mobが攻撃開始するときに位置補正をするかどうかを選択可能にしてみる （battle.*, mob.c, battle_athena.conf）
　	吹き飛ばした後に位置ズレするのを強制的に解消します、が挙動が気持ち悪いので暫定処置です
　	（良い方法があればbattle_configによるスイッチは削除でお願いします）

・mobが吹き飛ばされたときにタゲを破棄しないように変更 （unit.c）
			thanks to yukitoさん バグ報告スレッド９ [67]
・item_db2利用時に必ず発生するメモリリーク対策 		（itemdb.c）
・MAPロード直後は元の服色が表示されていた問題を修正 	（clif.c）

・マリオネットコントロール修正 			（pc.c, skill.c, status.c）
・自分勝手なダンスをSPダメージに修正 		（skill.c, status.c）
・ノビは死亡直後にHPを半分にするように修正 	（pc.c）
・アブラ使用時は条件チェックを行うように修正
　ついでにscriptのitemskill命令で条件チェックの選択ができるように引数拡張 （clif.c, map.h, pc.c, script.c, skill.c）

・skill_db.txt 射程修正

----------------------------------------
//1808 by ＡＡＡ
・ガンスリンガー、忍者のJOBが70まで上がるように修正
・ガンスリンガー、忍者の必要JOB経験値を修正
  pc_nextjobexp()
・exp.txtの読み込み修正
  pc_readdb()
・skill_db.txt,skill_tree.txt修正
・銃装備時の攻撃力がDEXの影響を受けるように修正
・スネークアイ追加
・シングルアクション追加
  status_calc_pc()
・銃は弾を消費するように修正(専用弾未実装どれも装備可能です)
・銃を遠距離に修正＆不具合を色々と微修正
  unit_attack_timer_sub() etc
・二刀・カタール関係修正
・オートカウンターが銃に反応しないように修正

・ガンスリンガー、忍者の転職レベル削除
script/sample/npc_debug_job_change2.txt

以下デバック用サンプル
sample/
  ReadMe.txt
  item_db.txt
  exp.txt
----------------------------------------
//1807 by Rayce

・吹き飛ばしを20セルまでは警告なしで許可するように変更
	path_blownpos()
・位置スライド用パケットを吹き飛ばしに利用してみる（merged from eA）
	clif.*		追加：clif_blown()
	unit.*		変更：unit_movepos()
	skill.c		修正
・ポイズンリアクト修正（based on eA、しかし本鯖再現度は低い）
	battle_calc_weapon_attack()
	battle_weapon_attack()
	status_change_start()
	skill_db.txt
・細かい修正
	unit_stop_walking()
	skill_castend_damage_id()

----------------------------------------
//1806 by ＡＡＡ
・job_db1.txtに銃と手裏剣のASPD追加(情報無しの為デバック用に定義)
　,ピストル=17,ライフル,ショットガン,ガトリンガン,グレネードランチャー,手裏剣=22)
・size_fix.txt1に銃と手裏剣のサイズ補正追加(情報無しの為一律100)
・ガンスリンガー、忍者の必要JOB経験値を二次職と同等に修正(現サクライ)
  pc_nextjobexp()
・ASPD,SIZE補正関係修正
  status_calc_pc()
・追加武器のASPD_DB,SIZE_FIX拡張
  status_readdb()
・ガンスリンガー、忍者の武器type設定
　itemdb_search
・飛刀修練修正
  battle_addmastery()

----------------------------------------
//1805 by End_of_exam

・MOB AI処理の最適化(clif.c map.h mob.* unit.c)
・map_delblockのバグを修正(map.c)

----------------------------------------
//1804 by Rayce

・ルートmobが攻撃されてもルートを最優先してたバグを修正（reference : 1446SS）
	mob_ai_sub_hard()
・アンクルの吸い寄せ効果はボス属性には作用しない
	skill_unit_onplace_timer()
・「月明りの下で」修正
			reported by とり and sin
	skill_unit_onplace_timer()
	skill_unit_db.txt

・1803を巻き戻してmodeを初期化するように訂正
	mob_spawn()
	mob_class_change_id()
・1803におけるgccでの警告潰し、ついでに整形
	battle_calc_weapon_attack()

----------------------------------------
//1803 by 雷折

・クラスチェンジのmodeを引き継いでしまっていた不具合修正(mob.c)
・防御無視に錐が乗らないように修正(battle.c)
	防御無視が優先されて錐は乗らない
・カートターミネーションに錐が乗るかどうか選択出来るように修正(battle.c battle.h battle_athena.conf)

----------------------------------------
//1802 by Rayce

・mobのスキル条件にrudeattacked追加（based on eA、かなり不完全…）
	mobskill_use()
	mob_readskilldb()
	mob.h に MSC_RUDEATTACKED 追加

・細かい修正
	skill_check_condition2()
	unit_attack_timer_sub()
	unit_counttargeted_sub()

----------------------------------------
//1801 by Rayce

・チャットBANを実装
	chat.*, clif.*, map.h, script.c, unit.c, vending.c
・1800のコンボ系スキルの修正漏れを修正
	skill_castend_id()
・アンクルスネアの拘束時間が間違ってたので修正
　最低拘束時間補償を追加
　　情報サイトによって式がマチマチなのでeAのものを採用（3000 + 30×Skill-Lv）
	skill_unit_onplace_timer()

・伏虎拳に動作停止効果を追加
	skill_additional_effect()
・ソウルバーンの固有ディレイをdbのupkeep_time2から取得するように改良
	skill_castend_damage_id()
・skill_cast_db.txt変更

----------------------------------------
//1800 by Rayce

・1797SSでscript.cが巻き戻ってたのを復旧
・範囲攻撃スキルが壁向こうに突き抜けないことをデフォルトの仕様としてみる
　skill_unit_db.txtへのUF_PATHCHECKフラグは不要になります
	skill_unit_timer_sub_onplace()

・yukitoさん報告分の「GXにbDefRatioAtk系を乗せない」をmergeしてみる
	battle_calc_weapon_attack()
			thanks to yukitoさん！ バグ報告スレッド９ [67]

・友達登録したキャラクターがログインしたとき以外でもオンライン情報の通知を
　行っていた問題を修正
	pc_authok()
	map.h map_session_data構造体に friend_sended 追加
	friend_add_reply()
	friend_delete()
	friend_send_info()
	friend_send_online()

・モンクやテコンのコンボ系スキルをターゲットが指定されてない状態で使用する場合の
　判定を早めに行うように修正
	unit_skilluse_id2()

・UF_NOREITERRATIONフラグのあるスキルユニットを設置する際、有効範囲以内に同一の
　スキルユニットが既にあるときは失敗するように
	skill_check_unit_range_sub()
	skill_unit_db.txt ついでに修正

			reported by とり / 1766 / RIN

----------------------------------------
//1799 by End_of_exam

・battle_check_target で落ちるバグを修正(battle.c)
・マップ移動するとペットの満腹度が減らなくなるバグを修正(unit.c)

----------------------------------------
//1798 by Rayce

・scriptのannounce命令で、flag=0x08のときに「全てのMAPに送信」されてなかったのを修正
・OnPCLogoutイベントをunit_free() 内で行うように
	これにより、OnPCLogout実行時にキャラクター永続変数を書き換えても
	反映されなかった問題が解消します。
			pointed out by End_of_Examさん、thx a lot !!

・プレイヤーがログインするときOnPCMoveMapイベントを実行しないように変更
	OnPCMoveMapとflag=0x01, 0x04のannounce命令を組み合わせるとキャラクターが
	ログインできないバグがあったため、やむなく仕様を変更しました。

	map_quit()
	unit_free()
	pc_setpos()

・script_refの修正とpceventのサンプルを少し修正

----------------------------------------
//1797 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1797
・ladmin2が前回のSSにて削除されていなかったので削除

//1796以前の変更点はReadmeを参照してください
----------------------------------------
//1796 by End_of_exam

・1795のオートスペル修正の残りを修正(battle.c)
・倉庫ロストを（たぶん）修正(intif.c thanks to substさん)

----------------------------------------
//1795 by よらん

・GCCでコンパイルすると
	ダークロードカード
	ブラッディナイトカード
	上記カードのオートスペル反撃が
　正常に動作しなかった問題を修正(battle.c)
	thanks to End_of_exam and maya@Liar!

	//PCの反撃オートスペル
	skill_bonus_autospell(&sd->bl,&target->bl,asflag,0,0);
	→skill_bonus_autospell(&sd->bl,&target->bl,asflag,gettick(),0);
	
	//カードによるオートスペル
	skill_bonus_autospell(src,target,asflag,0,0);
	→skill_bonus_autospell(src,target,asflag,gettick(),0);

	＊上記２箇所以外にも６箇所修正が必要と思われる箇所が
　ありますが、テストを行っていないのでそのままに
　しておきます。
	
----------------------------------------
//1794 by Rayce

・1793でbattle_athena.confが巻き戻ってたのを復旧
・カートレボリューションとアローシャワーのノックバック方向を修正
	battle_calc_weapon_attack()
	skill_castend_damage_id()
・SC_RACE系のずれを補正（status.c）
　		reported by test Re:バグ報告スレッド９ [91]

----------------------------------------
//1793 by 雷折

・シールドチェインの計算式と錐が乗るか乗らないか選択出来るように修正(battle.c battle.h battle_athena.conf)
　実装国によって違うかもしれない…？
　計算式も暫定
・グラヴィテーションフィールドの挙動を選択出来るように修正(battle.c battle.h status.c clif.c mob.c battle_athena.conf)
　実装国によって違う
・NPC爆裂波動と速度強化の計算式修正(status.c)
　NPC爆裂波動はATK3倍、DEXが3倍らしい
　速度強化はAGIが3倍らしい
・速度減少状態の挙動修正(status.c)
　速度減少中はツーハンドクイッケン、ワンハンドクイッケン、アドレナリンラッシュ、フルアドレナリンラッシュ、スピアクイッケンを使用出来ない
　カートブーストで解除することが出来る
・移動速度増加スキルの挙動修正(status.c)
　バーサーク		ウィンドウォーク、IAと重複しない
　回避率上昇		ウィンドウォーク、IAと重複しない
　カートブースト	ウィンドウォーク、IAと重複しない
　駆け足		IAと重複しない？
　ウィンドウォーク	IAと重複しない
　クローキング		IAと重複する
　プッシュカート	IAと重複する
　トンネルドライブ	IAと重複する
　騎兵修練		IAと重複する
　上記より、バーサーク、回避率上昇、カートブースト、ウィンドウォーク、速度増加は重複せず、増加率のもっとも高いものを適用するように
　アイテムについては未修正↓
　月夜花カード		騎乗による移動速度と重複しない
　スレイプニール	騎乗による移動速度と重複しない
　ブラッドアックス	IAと重複しない
・readparamで読めるステータスを追加(pc.c)
　Atk,Atk2,Matk1,Matk2,Def,Def2,Mdef,Mdef2,Hit,Flee,Flee2,Critical,Aspd
・クラスチェンジでmodeを引き継いでしまうバグの修正(mob.c)

----------------------------------------
//1792 by Rayce

・プレイヤー駆動型イベントを追加（modified based on eA）
　OnPCDie, OnPCKill, OnPCMoveMap, OnPCLogin, OnPCLogout

　利用価値を高めるために一部eAとは違う仕様にしています。
　script_ref.txtおよびnpc_test_pcevent.txt参照してください。
　デフォルトでは全て無効。利用する場合はbattle_athena.confでスイッチをオンにすること。

	pc_damage()
	pc_setpos()
	pc_authok()
	map_quit()
	npc_event_doall_id() 追加
	npc_event_doall_id_sub() 追加
	npc.h に追加
	battle_config_read()
	battle.h battle_config構造体

・battle_athenal.confに追加
　	自分を倒した相手がプレイヤーの場合、そのプレイヤーのアカウントIDを
　	キャラクター永続変数 PC_KILLER_ID に保存する

----------------------------------------
//1791 by Rayce

・スクリプトに関してeAよりmerge
　　- OnTouchイベントが識別子に対応してなかったのを修正
		npc_enable_sub()
		npc_touch_areanpc()
　　- hideon/off命令が識別子で読まれてなかったのを修正
　　- gettimetick関数にflag 2を追加、system timeを返す
　　- checkweight関数の強化
　　　指定個数がMAX_AMOUNT以上、またはPCのアイテム種類数がMAX_INVENTORYのときも0を返すように

・clif_skill_fail() を呼ぶ前にsdのチェックが抜けてた部分を修正（skill.c）
・スキル使用者がプレイヤーならアンクル状態での残影を許可
	skill_castend_pos2()
	skill_check_condition2_pc()
・アンクル状態なら吹き飛ばされないように修正
	skill_blown()
・ヒール砲にメディタティオが乗るように修正
	battle_calc_magic_attack()

・サンドマンをボス無効
・ショックウェーブトラップのSP減少効果がすぐに反映されない問題を修正
・フラッシャーに暗闇効果（ボス/植物無効）
	skill_additional_effect()

----------------------------------------
//1790 by Rayce

・1782のGvGスクリプトがバグ入りだったので修正
・JNameの文字数拡張の抜け修正
　（thx to バグ報告スレッド９[75] 1766氏）
	itemdb_read_itemnametable()
	atcommand_giveitem()
・@idsearchのコーディングを最適化
	atcommand_idsearch()
・識別子付きのNPCでglobalmes命令を使ったときのバグを修正
	buildin_globalmes()
	npc_globalmessage()
・範囲攻撃スキルが壁向こうまで突き抜けてダメージを発生する問題を暫定的に修正

　skill_unit_db.txtのflagにUF_PATHCHECKが指定されていたとき、ユニット設置系スキル以外の
　スキル（大魔法など）に対しても射線チェックを行います。
　（仕様をどうするか迷ったので暫定です。dbまでは変更してないので自前でやってください。）
	skill_unit_timer_sub_onplace()

----------------------------------------
//1789 by End_of_exam

・csvdb でコンマが入った列が正しく書き出せないバグを修正(db.c)
・csvdb_insert_row で最後行が隠れてしまうバグを修正(db.c)
・スクリプトにcsvflush 命令を追加(script.c db.c)

----------------------------------------
//1788 by Rohypnol

・1786のバグ葬り（login.c）[thanx to End_of_exam氏]
  キャラサーバ接続要求時にIPアドレスが渡されていなかったのを修正。
  IPアドレスを保持する配列のサイズを、文字列終端のNULLを考慮したものに修正。
----------------------------------------
//1787 by End_of_exam

・スクリプトの使用変数一覧をvariables.txt に書き出すように変更(script.c)
・64bit でコンパイル出来るように修正(core.c malloc.c)
・1786でSQL インジェクションに対する脆弱性が生まれていたのを修正(login.c)

　一応x64 でのコンパイルは出来るようになりますが、動作に関してはメモリの
　上位32bit が0x00000000になっている環境限定です。ポインタをint にキャスト
　している箇所が幾つかあるので、修正が終わるまで（他人任せになる確率大）は
　人柱扱いでお願いします。

----------------------------------------
//1786 by Rohypnol

・SQL版で、ログインしたときに、IPアドレスをloginテーブルのlastipに保持するように修正
・SQL版で、アカウントを登録する際にメールアドレスが渡された場合、メールアドレスがloginテーブルのemailに登録されるように修正
----------------------------------------
//1785 by End_of_exam

・スクリプトに使用変数一覧を出力するスイッチを追加(script.c)
・それに関わる幾つかのスクリプト修正

　サーバーの実行終了時に、スクリプト解析時に変数として扱われた文字列の一覧を
　表示するスイッチを追加しました。

出力例：
> NEW_MES_FLAG0           4 script/npc/job/npc_job_00newbie.txt line 12

この例では、npc_job_00newbie.txtの12行から始まる*スクリプト*とその他3つの
スクリプトの中で、変数「NEW_MES_FLAG0」が使われています。以下の出力を見て
何かに気づいた人なら、この機能を存分に使い倒せるでしょう。

> @mennnum                1 script/npc/job/npc_job_02magician.txt line 332
> @menonum                1 script/npc/job/npc_job_02magician.txt line 332
> bSPVanis                1 db/item_db.txt line 474
> L_erase                 1 script/npc/town/npc_town_guide.txt line 1451
> L13                     1 script/npc/quest/npc_event_hat.txt line 514
> LendB                   1 script/npc/quest/npc_event_dye.txt line 847
> Llowlv                  1 script/npc/job/npc_job_05merchant.txt line 5
> Lque1_2                 1 script/npc/job/npc_job_07knight.txt line 1378
> Ls3_32                  1 script/npc/town/npc_town_gonryun.txt line 1502
> n                       1 db/item_db.txt line 568

上の内容を見ても気づかない人向けにヒント。

・１つのスクリプトでしか利用されていない変数は、安全にスクリプト依存変数
　('@temp　や 'temp)に移行できます。

・２つ以上のスクリプトで使われている@ 変数は要注意です。スクリプトの組み方
　次第では、dupeにつながる可能性もあります。スクリプト依存変数の利用を検討
　しましょう。

・いかにもラベルっぽい名前(L13)や、const.txt に登録されてそうな名前が
　挙がっているのに気づいたら、すぐに検証しましょう。タイプミスの疑いが
　濃厚です。

・キャラクター永続変数(先頭がアルファベットで始まる変数)の個数は限られて
　います。不必要な箇所で使われていないか確認しましょう。

・同じような名前の変数がいくつも出ていたら、タイプミスの可能性があります。
　上の例でいくと、@men[n]num @men[o]num です。

・ラベル名のミスを防ぎたければ、if() { } else {}, switch 等の利用を検討
　しましょう。

----------------------------------------
//1784 by Rayce

・npc_func_library.txtを1783の修正に合わせて書き直し
・マップに配置されないNPCに対してMAP情報が必要な命令/関数を使ったときに
　サーバダウンする問題を回避するための対策としてgetmapxyの拡張

　上記のNPCに対してgetmapxyを使うと、MAP名に "-" が返ってくるように。
　スクリプト内部で自前で条件判定してください。

　例）	-	script	Duplication	-1,{
	OnInit:
		set '@dummy,getmapxy('@map$,'@dummy,'@dummy,1);
		if('@map$ != "-")		//この判定をしないと鯖落ちします
			hideonnpc;
		end;
	}

----------------------------------------
//1783 by End_of_exam

・MOB の射線チェックの修正(thanks to yukitoさん)
・gcc の警告を（たぶん）修正(script.c)
・スクリプトのop_2str 関数内部のメモリリークを修正(script.c)
・path_search() の最適化(path.c map.h 実験では３倍速)
・1781の気になった点を修正(battle.c skill.c)

　path_search() の最適化についてですが、旧バージョンを利用している
　方もmap.h, path.c を置き換えれば、それなりに負荷が減ると思います。

----------------------------------------
//1782 by Rayce

・ディスペルの成功確率実装（skilllv×10+50 %）
	skill_castend_nodamage_id()
・スクリプトにstrcut関数追加
	これまで出来なかった文字列処理を可能にします。
・strcutを使った汎用関数 script/sample/npc_func_library.txt を同梱
・GvGスクリプト ev_agit_common.txt の一部を書き換え
　ついでにGvG開始/終了時刻を分単位で設定できるように拡張
	const.txtの数を2桁から4桁に変更します
・script.refの追記等
・const.txt変更

----------------------------------------
//1781 by 雷折

・レイドリックカード等の無属性耐性効果が属性無しに適用されていないバグを修正(battle.c)
・無属性MOBスキルを強制無属性に変更(battle.c)
・シールドチェインの計算式を変更(battle.c)
・ダークブレスの計算式を変更(battle.c)
・精神攻撃の計算式を変更(skill.c)
・プロヴィデンスをクルセイダーに使用できないように変更(skill.c)

---------------------------------------
//1780 by End_of_exam

・アクティブMOB の移動不可な場所にプレイヤーがいる場合に重くなる現象を修正(mob.c)
・アクティブMOB のロックオン時に斜線チェックを追加(mob.c)
・スクリプトの読み込み速度の向上(script.c npc.c)
・スクリプトのエラー処理関連の見直し(script.c npc.c itemdb.c)
・スクリプトのselect, menu関数で空文字を送信しないように変更(script.c)
・1777のchar.cの修正を補完(char.c)
・1779のバックスタブ修正の補完(skill.c)
・幾つかの関数をsqlに対応(login.c char.c)
・アカウントIDに空文字チェックを追加(login.c)
・その他細かい修正

----------------------------------------
//1779 by ABC

・スペルブレイカーを街中(flag.nopenalty)に限りPCに対して使用可能に (skill.c)
・マジッククラッシャーを近接攻撃から遠距離攻撃に変更 (battle.c)
・バックスタブを受けた対象が術者の方を向くように変更 (skill.c)
・取得経験値が0の場合(被弾のみの戦闘参加等)経験値表示をしないように変更 (pc.c)
・太陽と月と星の憎悪およびカード効果による経験値増加が、公平分配時にパーティー全体に適用されていたのを個人適用に変更 (party.c party.h pc.c pc.h mob.c npc.c)

・skill_weapon_refine()内の参照されないローカル変数joblvを削除 (skill.c)
・警告潰しのためclif_parse_GetCharNameRequest()内の使用されない変数の宣言をコメントアウト (clif.c)

----------------------------------------
//1778 by subst

・キャラ名送信処理からmobの名前以外の処理をコメントアウト　(clif.c)
・ガーディアンが同盟に攻撃しないよう修正　(mob.c)
・バイオプラントのGvG時の挙動を変更
・貫通不能の壁を挟んだ時の過負荷問題について暫定対策　(mob.c)

　->ガーディアン
　　城主ギルド所属のPC、またはその同盟ギルド所属のPCには攻撃しない
　->バイオプラント(GvGのみ)
　　召喚主と同一ギルド所属のPC、またはその同盟ギルド所属のPCには攻撃しない
　　上記PCを召喚主に持つバイオプラントには攻撃しない

----------------------------------------
//1777 by subst

・存在しないキャラ、または認証されていないアカウントのキャラの
　削除要求を受けるとCHAR鯖が落ちるバグを修正(char.c)
・キャラ作成時の不正コード抑制をコメントアウトにて追加(char.c)

・PCが移動したら必ず立ち上がるよう修正(pc.c)
・チェイスウォークの移動速度を修正(status.c)

バグ報告スレッド９[3]DonnySasa氏報告分
・パーティ作成時のバグを修正(party.c)

本鯖相違スレッド２[142]報告分
・スペルブレイカーがBOSS相手に90%の確率で失敗するよう修正(skill.c)
・バーサクの攻撃力増加効果を修正(battle.c)

本鯖相違スレッド２[143]報告分
・ターンアンデッドが不死PC相手にも効果が出るよう修正(battle.c skill.c)

----------------------------------------
//1776 by lkm

update src\char\*.dsp

----------------------------------------
//1775 by フェルシア

・login,char以下のMakefileに修正漏れがあったのを修正

----------------------------------------
//1774 by lkm

update map.dsp

----------------------------------------
//1773 by フェルシア

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1773
----------------------------------------
//1772 by フェルシア

・mingwでコンパイルできない不具合を修正

----------------------------------------
//1771 by End_of_exam

・ワープポータルや強制切断時に落ちるバグを修正
　　(skill.c unit.c thanks to iofuさん / substさん)
・多人数接続時のラグ対策(clif.c)
・スクリプトに三項演算子を追加する(script.c)

----------------------------------------
//1770 by yukito
・mob_skill_db.txtのaround系が正常に動作していなかったバグを修正
　ついでにaround5〜8も実装。around5〜8はターゲットの周辺を指します。
　around5 ターゲットの周囲９マス / around6 ターゲットの周囲25マス /
　around7 ターゲットの周囲49マス / around8 ターゲットの周囲81マス

----------------------------------------
//1769 by ABC

共闘ボーナス関連
・共闘ボーナスを+10%、上限150%から+25%、上限600%に変更。
・さらにこれらを自由に設定できるように拡張。
  battle_confにjoint_struggle_exp_bonusとjoint_struggle_limitを追加しました。
・mobにダメージを与えていなくても、攻撃を受けたことがあれば共闘ボーナスが加算されるように修正。
  (pc.c  mob.c  battle.c  battle.h  battle_athena.conf)

その他
・@storageおよび@gstorage使用時、誰かが倉庫を使用中で開けない場合にメッセージを表示するようにした。
  (atcommand.c  msg_athena.conf)
・連打数分ダメージ保証の際に、三段掌を255Hitsとして扱っていた問題の修正。(battle.c)

----------------------------------------
//1768 by Rayce

・script.cにgetlook関数追加
	buildin_getlook()
・mapflag norevive追加
	npc_parse_mapflag()
	pc_damage()
	map.h / map_data構造体
・doc/script_ref.txt追記

----------------------------------------
//1767 by iofu

・ワープポータルが完全に発動する前からそのセルに乗っていると、
  発動しても転送されない不具合を修正
・PT メンバにヒールをかけたとき、HP ゲージがすぐに更新されない不具合を修正

----------------------------------------
//1766 by Rayce

・カプラ転送NPCの修正ミスを訂正（-1してたのを忘れてました…）
	script/npc/npc_function.txt
・アイテムのJNameの登録文字数を12から16文字に拡張
　（thanks to qqqqq氏、バグ報告スレッド８[61]）
	itemdb_searchname_sub()
	itemdb_readdb()
	item_data構造体のnameおよびjname

----------------------------------------
//1765 by ABC

・ランドプロテクター展開時に、範囲内に展開されている独奏スキルまで消してしまうという、1750で残った問題の修正(substさん多謝)

----------------------------------------
//1764 by Rayce

・menuおよびselect命令に空文字を入れた場合、@menuの返り値を補正するように改良
　それに伴い暫定でカプラ転送NPCを修正
　（suggested by End_of_Examさん、and thanks to nice report on eA forum !!）
	※実質の仕様変更ですので、空文字を使ったmenu/selectが正常に動作しなくなる可能性があります
	　今までのように扱いたい場合は委託販売員NPCのようにreturn ;でメニューを作る必要があります

・getarraysizeのさらなる修正
　（reported by End_of_Examさん、thx a lot !）
・1763の残影とバックステップの修正部分を整形
　ついでにmobが使用してもアンクル状態なら脱出不可に
	skill_castend_nodamage_id()
	skill_castend_pos2()
	skill_check_condition2_pc()

----------------------------------------
//1763 by ID:dex

・アンクルスネア設置時、アンクルの拘束時間が切れる前に残影とバックステップで脱出
出来ていた現象を修正
・PVPで今まで不発になっていたスキッドトラップをプレイヤーにも適用（正確な方向など詳細は暫定的なので、もし詳しい方いましたら距離など修正をお願いいたします）
----------------------------------------
//1762 by ID:ABC

・NPC_CRITICALSLASH(防御無視攻撃)を防御無視かつ必中に変更
・倉庫とギルド倉庫の一方を開いているときにもう一方を開こうとしたとき、先に開いていた方を閉じるように修正
上記操作を行うと先に開いていた方がクライアント上で表示されなくなり、
(消えるだけで倉庫を閉じる処理は行われないため)再起動時まで開けることができなくなっていた問題が解消されます。

----------------------------------------
//1761 by ID:7QLFJSM

・memmgr で一度に 4MB 以上のメモリを割り当てるとアクセス違反が起きるバグを修正
・mob_db2.txt が存在するとき正常に処理されないバグを修正
・AC_MAIL の設定にかかわらずメールアドレスを account.txt に保存するように修正
　・メールアドレスの含まれていない account.txt の読み込みにも対応しているので、
　　account.txt を書き換える必要はありません。
　・AC_MAIL を使ってなかった場合、account.txt の書式が変わるので
　　バックアップを忘れないでください ***
　・AC_MAIL を使わない場合、メールアドレスは保存されるだけで意味を持ちません。
　　（しかし、データフォーマットが共通になることには利点があると思います）
・ladmin をメールアドレスを含むものに統一
　・メールアドレスを指定しなくてもアカウントは作れます
　・ladmin2 はもう必要なくなります。削除してください。

(src/common)
malloc.c
	hash2size() 修正など
(src/login)
login.c
	login_txt_init(), login_txt_sync() 修正など
(src/map)
mob.c
	mob_readdb() 修正
(doc/)
admin_packet.txt
serverlink_packet.txt
	修正
(bin/tool/)
ladmin
	ladmin2 をリネーム＆バージョン番号など修正

----------------------------------------
//1760 by Rayce

・script命令/関数の拡張と追加
	emotionおよびmisceffect命令をNPC名指定可能に拡張
	strnpcinfo関数追加
	getpartyleader関数追加
	areasoundeffect命令追加
・script.cのバグ修正（reported by End_of_Examさん、thx a lot !）
	getarraysizeに空の配列を渡すと1が返ってくる問題を修正
	getelementofarrayのバグ修正
	返り値が文字列の関数においてエラー文のときは "null" ではなく ""（空文字）を返すように修正
・doc/script_ref.txtの追記と一部説明が間違ってた部分を修正

----------------------------------------
//1759 by luc

・skill_db.txtの修正
　わかる範囲でスキルの射程を修正しました。

----------------------------------------
//1758 by luc

・produce_db.txtの修正
　ツーハンドソードの武器Lvを修正
　ランスの材料を修正

----------------------------------------
//1757 by lkm

fix produce_db.txt Req itemid err

----------------------------------------
//1756 by huge

・SQLでコンパイルエラーが出るのを修正

----------------------------------------
//1755 by Rayce

・battle_configのexpansion_job1_skill_cloneableがyesのとき
　NPCスキルをクローンしてしまうバグを修正
	skill_cloneable()
・ソウルバーン修正
	skill_castend_damage_id()
	skill_cast_db.txt
・プロフェッサーのフロストダイバーのスキルツリーがおかしかったのを修正
　（本鯖相違スレッド２[124]報告分）
	skill_tree.txt

----------------------------------------
//1754 by Rayce

・sc_start3のflagが+8のときには、完全耐性およびカードによる耐性の
　計算をしないように拡張
・SC_NPC_DEFENDERのときに警告が出ないように抑制
　（スキル自体の効果は発現してない模様）
	status_change_start()
・script命令追加
	kickwaitingroom
	kickwaitingroomall → 機能してなかったので有効化
・sc_end命令を対象指定可能に拡張
・気奪をモンスターに使用して失敗したとき、失敗メッセージ出るように修正
	skill_castend_nodamage_id()
・doc/script_ref.txtの修正および追記

----------------------------------------
//1753 by free
・スプリングトラップ修正(アンクルスネアも解除できるように修正)

----------------------------------------
//1752 by Kiry.
・料理システムの製造データを追加。(produce_db.txt)
 暫定的に難易度設定は料理本レベルと同じ。

----------------------------------------
//1751 by yukito
・速度減少の移動速度減少効果の修正(Lv1〜5:33%減少/Lv6以上:50%減少)
・金剛の移動速度減少効果の修正(35%減少)
・金剛中は速度増加・ウィンドウォークの移動速度上昇効果が無効になるように修正(AGI補正は有効)

----------------------------------------
//1750 by ABC

・金剛状態でも速度増加とパーティースキルが有効になるように修正
・独奏スキル(詩、踊り個人スキル)がランドプロテクター上に展開可能かつ、ランドプロテクター上で独奏スキルが有効になるように修正
すでに展開している独奏スキルにランドプロテクターを重ねると、範囲内の独奏スキルが消えるバグがあります。
・ブラックスミス製造スキルの成功率計算式を修正
これまでのものではJobLvではなくBaseLvの影響を受けている等怪しい点が見られたので、現在最も信頼されている(と思われる)次の式に変更。
ただし、属性武器については属性石をいくつ入れても1個分の成功率低下しかありません。
また、星のかけらについては基本的に100%ですが、養子の成功率補正やbattle_config.making_rateの値の影響を受けます。(要するに養子の場合70%になる等、現状必ずしも100%ではない)

製造基本値 = JobLv*2 + Dex + Luk

鉄：(製造基本値 + 鉄製造Lv[500 550 600 650 700])/10 [%]
鋼鉄：(製造基本値 + 鋼鉄製造Lv[400 450 500 550 600]/10 [%]
属性石：(製造基本値 + 属性石製造Lv[200 250 300 350 400]/10 [%]

武器：
(製造基本値 + 武器製造Lv[500 550 600] + 武器研究Lv*10 +
 金敷[0 0 30 50 100] - 作成武器Lv[0 200 300] - (属性石[250]*数) -
 (星のかけら[150]*数))/10 [%]

----------------------------------------
//1749 by ルナ

・転生後本来は転生前が騎士だった場合、剣士にしかなれないのが、
  他の1次職になれてしまうバグを修正。
  
----------------------------------------
//1748 by huge

・1741の後始末
・メール関連の修正
・アカウントデータにメールアドレスを記録するようにした時に
  アカウント変数を保存しないようにしてました。(accregではない方です)
  その分の修正。
	account.txtに、メールアドレスを記録する場合は、
	今までのaccount.txt内のアカウント変数記録前にメールアドレスを入れた後Tabを入れてください。
	※[AccountID]\t[UserID]\t[pass]\t[LastLogin]\t[sex]\t[LoginCount]\t[state]\t[ここにメアド]\t...
	※メアド無しのアカウントには、'@'一文字だけ入れて下さい。キャラ消去時には、空白を送ります。
	そして、MakefileのAC_MAILを有効にしてコンパイルした上で、以降アカウントの作成は添付したladmin2を使って下さい。
	SQLでは非対応のまま。応急処置的な・・・

----------------------------------------
//1747 by Rayce

・@kamic追加（神の声マルチカラー版、based on eA）
・@repair追加（所持装備品を全て修理）
・@shuffleのPCランダムワープを少し改良
	mapflagがnoteleportでも強制的にシャッフルします
・script命令を追加
	getwaitingpcid		チャット内に待機しているPCのアカウントIDを取得
	npcskillattack		攻撃スキルのエフェクト
	npcskillsupport		支援/回復スキルのエフェクト
	npcskillpos		場所指定スキルのエフェクト
・getmapxy使用時のメモリリーク潰し
・script_ref.txt追記（1741追加分も記載）
・NPCスクリプトのバグ修正（開発板報告分）
・bcc32_make.batにmail系が抜けていたのを修正
・int_mail.h修正

----------------------------------------
//1746 by Lkm

fix script err
 script\mob\npc_x-masmonster.txt
 script\npc\town\npc_town_einbroch.txt

----------------------------------------
//1745 by subst

・バックステップまわりの修正が不完全だった問題を修正

----------------------------------------
//1744 by valoque

./conf/atcommand.conf
	・1741で追加された"item3"の権限設定がされていなかったので追加
./conf/help.txt
./conf/help3.txt
	・上記コマンドの説明の追加

----------------------------------------
//1743 by subst

battle.c
・オーバートラスト、オーバートラストマックス、バーサク、トゥルーサイト
　の攻撃力増分がクリティカル時に無視されていたバグを修正
・サクリファイスにエフェクトを追加

pc.c
・装備解除時に、状態異常解除判定が一度しかなされないバグを修正

skill.c
・ロキの叫びの効果のBOSSモンスターに対する判定記述を削除
　(これまでも有効として正常動作していましたが、無効にし損ねていた形跡があった部分を削除)
・クローズコンファインの持続時間を修正(skill_cast_db.txt)
　クローズコンファインがバックステップまたはハイディングで解除されるよう修正

status.c
・永遠の混沌のバグを修正

補足
本鯖では、OTの増分とスキル倍率が別個に防御による減衰と端数切り捨てを受けた後に和算だったので、
恐らくあれで間違いない…と思います。違ったら直して下さい。サクリのエフェクトは他に使用例のない
misceffectの使い方なので、問題がありましたら適宜修正して下さい。全て本鯖エミュレートです。

ラーゲの情報を見る限り、OTMの「増加攻撃力」という和訳は「増加後の攻撃力」という事のようです。
http://ragnagate.dreamwiz.com/zboard/zboard.php?id=screen4&page=1&divpage=39&category=6&ss=on&no=199413

----------------------------------------
//1742 by Blaze
・アリーナ実装（個人戦のみ）
・クリスマスイベント2005NPC追加
・アユタヤNPC修正

----------------------------------------
//1741 by huge
・メール機能を実装。(05-12/28現状対応しているのはSakexeのみ？)
	使用するには、packet_dbのコメントアウトを外し、battleconfに書き加えて下さい。
	自分で追加できない方は、DUPE対策が確立するまでは使用されない事をお勧めします。
・アカウントにメールアドレスが登録できるよう修正。(TXT_ONLYのみ。上記機能とは関係なし)
・@misceffectで、対象idを指定してもエフェクトを出せるように修正。
・@item2の限定機能で@item3を追加、キャラ名入りのアイテム作成コマンド。
	@item3 アイテム名 個数 キャラ名　で、その時接続しているキャラに限りますが、ID逆引きで代入します。
・item bonusで、fixdamage追加。固定ダメージです。
・scriptに、いくつか追加。
	countcartitem(itemid);	countitemのカート版。
	usediteminfo(flag);	使ったアイテムのIDや製作者IDを返す。
	getitemid("item_name");	アイテム名からIDを逆引き。
	getguildmembers(guild_id);	ギルド員の人数を取得。接続人数ではなく、登録人数。
・nobranchフラグのあるマップでは、ゾイストCのような効果でmobが変化しないように。
・job_soul_check 〜魂の職チェックの設定が適用されていなかったのを修正。
・武器精錬スキルの処理修正。
・その他、細かい修正
・packet_db.txtの更新

----------------------------------------
//1740 by 三味線

・map_athena.confに最新MAP追記（コメントアウトにて）
・フィゲル等のワープNPC、サンプルNPC更新

----------------------------------------
//1739 by End_of_exam

・1738のバグ修正
　　crc32算出をgrfioのルーチンを用いるように変更した関係上、以前とcrc32の
　　計算結果が異なります(crc32 の正しい初期値は0xFFFFFFFF)。

・NO_CSVDB_SCRIPT オプションの追加(script.c)
・csvdb_delete_row, csvdb_insert_row, csvdb_clear_row 命令を実行して、
　csvreload 命令を使用すると、変更内容が保存されないバグを修正
　(db.c thanks to Rayceさん)

----------------------------------------
//1738fix by ID:7QLFJSM

・TXT にジャーナリング機能を追加
　デフォルトでは無効になっています。詳しくは doc/journal.txt を参照。
・2005-12-11bRagexe jRO の packet_db 追加
・2005-09-06gRagexe jRO の packet_db 修正 (changedir)

・(fix) Makefile 修正
・(fix) 未使用の変数の警告を修正

(/)
vc07_make.bat
bcc32_make.bat
makefile
(common/, login/, char/, map/)
makefile
	ジャーナルの設定追加
(login/)
login.c
(char/)
*.c
	ジャーナル機能を呼ぶようにいろいろ追加
(common/)
journal.*
	ジャーナル機能、新しく追加。
(doc/)
conf_ref.txt
	ジャーナルの設定の説明を追加
journal.txt
	ジャーナルの説明、新しく追加
(conf/)
login_athena.conf
char_athena.conf
inter_athena.conf
	ジャーナルの設定追加
(db/)
packet_db.txt
	2005-12-11bRagexe jRO 追加、2005-09-06gRagexe jRO 修正

----------------------------------------
//1737 by yukito
・@allskillでサービスフォーユーが覚えられないバグ修正(バグ報告スレ７[107]KAJIKEN氏投稿分)

----------------------------------------
//1736 by yukito
・サンタ服の時は見かけ上素手になるように修正(蔵のリソースエラー対策)

----------------------------------------
//1735 by よらん

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1735

----------------------------------------
//1734 by End_of_exam

・サーバー間通信の別ポートを閉じ忘れていたのを修正(char.c)
・getvariableofnpc関数の追加(script.c)
・copyarray, deletearray, getmapxy, csvreadarray 命令に' 変数を渡すと
　警告メッセージが表示されるバグを修正(script.c thanks to Rayceさん)
・return 命令で' 変数を返す時に参照渡しするように変更(script.c)
・unit_remove_map にpvp タイマーの消去処理が抜けていたので追加(unit.c)
・DYNAMIC_SC_DATA有効時にアンクル発動中に敵を倒すと落ちるバグを修正(mob.c unit.c)
・DYNAMIC_SC_DATAなどの微修正

----------------------------------------
//1733 by Rayce
・NPCチャットの制限条件にJobとUpperを追加
　手抜きのためupperは個別にかかりません （eg.LKとBSのみという設定は不可）
	chat.c
		chat_createchat() 追記
		chat_joinchat() 変更
		chat_createnpcchat() 変更
	chat.h
		chat_createnpcchat() 変更
	map.h
		chat_data構造体にjob,upper追加
	script.c
		buildin_waitingroom() 追記
		buildin_getwaitingroomstate() 追記

・死亡状態でワープするとまた倒れてしまうのを修正
	script.c
		buildin_warp()
		buildin_areawarp()

・気奪をmobに使用して失敗したときディレイが生じる問題を修正
	skill.c
		skill_castend_nodamage_id()

・script_ref.txt 追記

----------------------------------------
//1732 by iofu
・毒状態でHPが1になるバグを修正
・ポート変更時にサーバ間の通信ポートが追従しないバグを修正

----------------------------------------
//1731 by lkm
add DYNAMIC_SC_DATA to map.dsp

----------------------------------------
//1730 by End_of_exam

・倉庫の内容が保存されないバグを修正(unit.c)
・モンスターが指弾を使うと落ちるバグを修正(unit.c thanks to substさん)

----------------------------------------
//1729 by Filia
・フリージングトラップの属性を地→水
・ブラストマインの属性を火→風
・クレイモアトラップの属性を地→火

----------------------------------------
//1728 by End_of_exam

・リログやMAP 間移動のバグ修正(unit.c)
・' 変数をreturnに渡すと違う値が戻るバグを修正(script.c)

----------------------------------------
//1727 by End_of_exam

・' 変数のバグ修正、仕様変更(script.c他　詳細は script_ref.txt 参照)
・コンパイル済みスクリプトの型をunsigned charからstruct script_codeに変更

----------------------------------------
//1726 by yukito
・1720のマヤパープルカード効果のバグ修正

----------------------------------------
//1725 by ＡＡＡ
・テコンランカーのボーナス修正
　※テコン少年/少女の全てのスキルを使用できるようになります。
　　LV90以上、テコンミッション習得、スキルポイント0(転職出来なくなるため)の場合のみ

----------------------------------------
//1724 by yukito
・csvdbをscript以外に転用出来ないように、db.*巻き戻し

----------------------------------------
//1723 by End_of_exam

・スクリプト変数 ', '@ の追加(script.* 詳細は script_ref.txt 参照)
・1722の修正(socket.c)
・MAP 移動時にグラフィティが発動してると変になるバグを修正
・MAP 移動時にペットが移動元マップに残る可能性のあるバグを修正
・csvdb をscript以外にも転用出来るように、db.*のNO_CSVDBを削除
・その他メモリリーク、鯖落ちなどの細かい修正。

----------------------------------------
//1722 by ID:7QLFJSM

・socket の FIFO がオーバーフローするバグをたぶん修正

(src/common)
socket.c
	WFIFOSET(), WFIFORESERVE() 修正

----------------------------------------
//1721 by GSX
・転生職と非転生職のHP/SP補正をbattle_athena.confから変更出来るよう追加

battle_athena.conf
	upper_hp_rate  追加
	upper_sp_rate  追加
	normal_hp_rate 追加
	normal_sp_rate 追加

----------------------------------------
//1720 by ＡＡＡ
・マヤパープルカード効果修正
　黒く表示するように修正

----------------------------------------
//1719 by ABC
・毒のダメージでHPが0になると無敵になる問題の修正
・アンクルスネアの対象が死んだとき、その場で罠が消えるように修正

----------------------------------------
//1718 by ID:7QLFJSM

・httpd の秒間リクエスト数制限機能が誤動作するバグを多分修正
・httpd の外部 CGI で nph 処理の際にログに不正なステータスコードが吐かれるバグを修正
・socket コントロールパネルの URL を変更できるようにした

(src/common)
httpd.*
	httpd_erase_pages() 追加, httpd_pages(), do_init_httpd() 修正など
socket.*
	get_socket_ctrl_panel_url() 追加, socket_httpd_page*() 修正など
(conf/)
socket.conf
	socket_ctrl_panel_url 追加
(doc/)
conf_ref.txt
	socket_ctrl_panel_url 追加

----------------------------------------
//1717 by ABC
・1715の修正がファルコンアサルトに適用されていなかった問題の修正
・自決スキル使用時にExpおよびアイテムドロップが無くなるようにした
・プレイヤー魔法スキルの1ダメージ保証廃止(mobは保証)
・草やきのこ等一部のmobに対するダメージの修正
  魔法はロードオブヴァーミリオンのみダメージなし。それ以外は連打数分のダメージ。
  武器攻撃は三段掌のみ3ダメージ。それ以外は連打数にかかわらず1ダメージ。

  ただし、battle_athena.confのskill_min_damageがyesの場合は今まで通り
  全てのスキルで連打数分のダメージを保証します。

----------------------------------------
//1716 by ID:7QLFJSM

・httpd で外部 CGI プログラムを呼べるようにした
　デフォルトではこの機能は無効になっていて、コンパイルすらされません。
　制限などもありますので、詳細は doc/httpd.txt を参照してください。
・httpd でログの形式として combined_log を吐けるようにした (httpd.conf)
・ログをフラッシュする設定の場合、ログを毎回 close するようにした
　( 試してませんが、logrotate とかを使うならこうしないといけない気がしたので )
・httpd.conf の読み込み時、target を指定しないまま target 指定が必要な項目を
　設定したときにエラーメッセージを出すようにした。

・patchup を改良
　fix パッチをリネームしなくてもいいように修正
　ファイルコピーが cp だけでなく、xcopy に対応

(common/)
httpd.*
	httpd_cgi_〜 関数多数追加など
(conf/)
httpd.conf
	外部 CGI 関係追加
(doc/)
conf_ref.txt
	httpd.conf の追加分
httpd.txt
	新規に追加。httpd に関する注意や仕様の説明など
(bin/tool)
patchup
	fix パッチへの対応強化と xcopy に対応

----------------------------------------
//1715 by ABC
・ブリッツビートと石投げスキルが、近接攻撃かつ遠距離攻撃、
  さらに自動鷹の場合武器攻撃という属性まで持っていた問題の修正。

----------------------------------------
//1714 by yukito
・bAutoSpellで使用レベルがランダムになるバグ修正(バグ報告スレ７[106]aaa氏投稿分を適用)

----------------------------------------
//1713 by yukito
・bDefRatioAtkRaceとbIgnoreDefRaceの修正

----------------------------------------
//1712 by Ｎ
・1710の変更追加で発生していたコンパイル時のwarning対策
（コピペ関数を廃止しmake_listen_port関数にbindするIPアドレス用引数 unsigned long を追加）

----------------------------------------
//1711 by yukito
・1707のbIgnoreDefRaceとbIgnoreDefEleの修正
・1709で巻き戻っていた部分の修正

----------------------------------------
//1710 by Ｎ
・サーバ間通信をユーザとの通信と別リスナにするかしないか選択できるように対応

----------------------------------------
//1709 by ABC
・回避および完全回避成功時にもセイフティウォールの耐久値が減少するように修正
・ポーション作成NPC、ジュース作成関連NPCの台詞を現行のものに対応

----------------------------------------
//1708 by yukito
・ナパームバルカンが分散スプラッシュになっていなかったのを修正
・battle_athena.confのboss_no_knockbackingをMVPボスのみノックバック無効にできるよう拡張

----------------------------------------
//1707 by yukito
・メモリリークの修正(雑談スレ５[109]End_of_exam氏投稿分)
・1705で自動鷹の発動率がLuk*0.3+1(%)に変更されていなかったので補完
・アローシャワーを地面指定に変更(既知のバグ：ノックバック方向が正しくない・罠に当たらない)
・battle_athena.confのleft_cardfix_to_rightがyesの時に
　bDefRatioAtkRaceまたはbDefRatioAtkEleのボーナスを持つ武器を両手に装備すると
　右手の攻撃力が異常だったのを修正
・battle_athena.confのleft_cardfix_to_rightがyesの時に
　左手装備のbIgnoreDefRaceとbIgnoreDefEleが右手に適用されなかったバグ修正

----------------------------------------
//1706 by Filia
・セイフティウォールの詠唱時間をDEX依存に再修正
・ソニックブローに2秒のディレイを再度追加

----------------------------------------
//1705 by ABC
・プリースト転職クエストで、JobLv50転職時にバイブルではなくブックが渡された不具合を修正
・セイフティウォールの詠唱時間がDexの影響を受けないように修正
・鷹ダメージ計算式の修正。自動鷹発動率を Luck*0.3 + 1(%)に変更。
・battle_athena.confにmin_hitrateを追加(最低命中率を設定できます)
・同じくallow_any_weapon_autoblitzを追加
  弓以外の武器で通常攻撃を行った場合に鷹が飛ぶかどうかを設定できます。
  コモドパッチ以前を再現したいときにどうぞ。

----------------------------------------
//1704 by Blaze
・アユタヤNPC改善、クエストが進まないバグ修正
・アインブロック商店の一部アイテムの価格がおかしいのを修正
・龍之城クエスト、詩が一部表示されなかったのを修正

----------------------------------------
//1703 by yukito
・速度減少にかかった時にツーハンドクイッケン、スピアクイッケン、
　アドレナリンラッシュが解除されるように修正
・死んだふりの時にHPとSPが自然回復していたバグ修正
・バーサーク中の相手にポーションピッチャーを使うと実際には回復しないのに
　数字だけ表示されていたバグ修正

----------------------------------------
//1702 by ＡＡＡ
・テコン系のupperを0に修正
・上記の変更による修正

----------------------------------------
//1701 by ＡＡＡ
・ストームガストが1発で凍結するのを修正
・1687が不完全だったのを修正

----------------------------------------
//1700 by yukito
・equippeditem関数の戻り値が個数を返すように拡張(複数個の装備が判定できるように)
・オーガトゥース(短剣)を両手に装備した時にDEF減少が74%になるように修正(本来は75%ですが)

----------------------------------------
//1699 by yukito
・相手との距離が離れすぎていて取引要請が失敗した時メッセージが出るように
　※huge氏のWebサイトより抜粋させて頂きました。

----------------------------------------
//1698 by yukito
・battle_athena.confのleft_cardfix_to_rightがyesの時に
　左手装備のbDefRatioAtkRaceとbDefRatioAtkEleが右手に適用されなかったバグ修正

----------------------------------------
//1697 by ＡＡＡ
・Mobスキルのエモーションを詠唱完了後に表示
・プレッシャー修正
　草にも固定ダメージが通る
　シーズモードにおいてもダメージ補正を受けない。
　特例的にエンペリウムにも使用することができる。（これにも固定ダメージ？　アルケミのイクラと同じか）
　LA状態の相手にプレッシャーを当ててもLAは解けず、ダメージも2倍にならない。
・PKポイント修正
----------------------------------------
//1696 by Kiry
・血枝、ポリン箱のnobranchフラグで規制されるように修正（のつもり）
----------------------------------------
//1695 by Rayce
・チャットの持ち主の譲渡が機能してなかったのを修正
		clif_parse_ChangeChatOwner()

・announce命令におけるエリアフラグ0x00指定時のマルチカラー化対応
                                         thx for the eAthena Dev team !!
	(map/intif.c)
		intif_GMmessage()
		intif_announce()
		intif_parse()		変更および修正
	(char/inter.c)
		mapif_parse_GMmessage()
		mapif_GMmessage()	変更および修正

・NPCチャットの上限Lv指定を255からMAX_LEVELを参照するように訂正
		chat_createchat()
		buildin_waitingroom()	修正

・doc微修正および追記
	(doc/) script_ref.txt/client_packet.txt (主にfail文)
・組み合わせ警告回避のためmob_skill_db.txt最新版
・map_athena.conf（Blaze氏のNPC抜け分）

----------------------------------------
//1694 by ICO

・ソニックブローのディレイ修正
・一部支援系スキルの属性変更

----------------------------------------
//1693 by Blaze

・龍之城クエスト修正
・飛行船アナウンス修正
・一部NPCの削除

----------------------------------------
//1692 by よらん

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1692

----------------------------------------
//1691 by よらん
（./db）
・ローヤルゼリーと万能薬で幻覚を解除できるように修正

const.txt内
312行目に
SC_Hallucination 34
を追加。

----------------------------------------
//1690 by よらん
（./sql-files）
・テーブル作成時稀にプライマリーキーが設定されない
ことがあるのでドロップテーブル文を追加

（./doc）
・sqllogin.txtの変更
	ドロップテーブル文追加に伴う説明文追加
　SQLツール（Windowsのみ動作可）の紹介文追加

----------------------------------------
//1689 by Rayce
・GMメッセージのマルチカラー対応を暫定実装（from eAthena）
	‐announce/mapannounce/areaannounceをカラーコード拡張
	　　eg. announce "message",0,0xFF0000;

　※パケット0x01c3の解析がまだ終わってないようなので
　　一部おかしい部分もあるかもしれません（0x000000の色とか…）
　※announceをマルチカラーで使う場合、エリアフラグの0x00は未完成です
　　inter鯖内のパケットがまだ判明してない…？
　　よってMAP鯖を分割してる場合は別鯖のMAPにマルチカラーアナウンス不可

	(map/)
	clif.*
		clif_announce() 追加
	intif.*
		intif_announce() 追加
	script.c
		announce/mapannounce/areaannounce変更

・NPCチャットの入場条件追加
	‐waitingroomにお金とBaseLvで制限をかけることができます
	　（手抜きのため制限条件を使う場合には第6,7,8引数いずれも省略不可）
	　　eg. waitingroom "chat",10,"",0,10000,30,90;

	(map/)
	chat.c
		chat_createchat() 追記
		chat_joinchat() 変更
		chat_createnpcchat() 変更
	chat.h
		chat_createnpcchat() 変更
	map.h
		chat_data構造体にzeny,lowlv,highlv追加
	script.c
		buildin_waitingroom() 追記
		buildin_getwaitingroomstate() チャット制限値を参照できるように

・doc追記
	(doc/) script_ref.txt/client_packet.txt (0x01c3,0x00da)

----------------------------------------
//1688 by yukito
・ファイアーボールの計算式を修正
・ソウルストライクを不死のPCに撃った時にダメージが増加するように修正

----------------------------------------
//1687 by ＡＡＡ
・sc_dataのfree関係を修正
・FIREBALLを修正

----------------------------------------
//1686 by Filia
・ソニックブローにディレイ値がなかったのを2秒に修正
・プレッシャーが無詠唱だったのを修正

----------------------------------------
//1685fix by ＡＡＡ
・サンタ服実装 sc_start SC_Santa
・item_db微修正 
　全職可能アイテムをガンスリンガーと忍者にも対応
・sc_data関係を修正
・静的確保の修正

----------------------------------------
//1684 by ＡＡＡ
・動的確保の改良

----------------------------------------
//1683 by ＡＡＡ
・動的にmobのsc_dataを確保できるように修正
　確保の仕方は適当(エラー出るのは潰しました)
　面倒なsc_dataチェックは追加したので、高速化する人はご自由に

----------------------------------------
//1682 by yukito
・bAddMonsterDropItemに倍率を指定して掛けられるように拡張

----------------------------------------
//1681 by ＡＡＡ
・駆け足修正
武器を装備しなかった時の蹴りの威力が[駆け足（競走）]スキル1あたり+10ずつ増加するようになります。
[駆け足（競走）]スキル10を習得した場合には+100になります。
・レベル90以上の[テコンランカー]はMAX HPとMAX SPが3倍に修正
・[太陽の温もり]
スキル発動時のSP消費量が100->20に減りました。
・[月の温もり]
スキル発動時のSP消費量が100->20に減りました。
・[星の温もり]
スキル発動時のSP消費量が60->10に減りました。
・[太陽の安楽さ]
敵に受けるダメージは(Lv+Dex+Luk)/10程度減少させたが(Lv+Dex+Luk)/2程度減少させるように修正されます。
defからdef2に修正
[ウィザードの霊魂]
・霊魂の性能が追加されます。霊魂状態の時"水晶のかけら"を持っていれば
"水晶のかけら"が消費しながら、カイトにより自身に向かって反射した魔法が蒸発するようになります。
・[クルセイダーの霊魂]
霊魂状態の時シールドブーメラン使用時に後ディレイも半分に減るようになります。[太陽と月と星の友人]
・[太陽と月と星の悪魔]
ジョブレベル50になってこそ悪魔の効果が発動するようになります。
・[太陽と月と星の友人]
発動確率上昇率が増加します。
1レベル20% ->100%
2レベル50% ->150%
3レベル100% ->200%

----------------------------------------
//1680 by ＡＡＡ
・clif_fixpos_type追加
//位置パケットの処理方法
//0: 1456以前
//1: 1456以降
・忍者・ガンスリンガー・ホムスキルをskill.hとskill_dbに追加
・拡張職オプションによって表示するスキルを限定するように修正
　※スキルアイコンのエラー対策

----------------------------------------
//1679 by yukito
・mob.cのgccでの警告潰し

----------------------------------------
//1678 by ＡＡＡ
・item_dbの修正
　オートスペルの発動率修正(万分率へ)
　新カードの効果を調整
　ベスパーコアの装備制限修正
　

----------------------------------------
//1677 by yukito
・ギャングスターパラダイスが発動しなくなっていたのを修正
・ギャングスターパラダイスで昆虫・悪魔にもタゲられないように修正
・ボスが毒・暗黒・呪い等の状態異常にかかってしまうバグを修正

----------------------------------------
//1676 by yukito
・対人エリアでのゴスペルはPTMであれば無条件にプラス効果になるように修正
　※aaa氏のパッチより該当部分を抜粋させて頂きました。
・インティミデイトを弓でも使用可能に修正(ただし近付いてからスキル発動)
・鈍器がシーフ系でも装備可能だったのを修正

----------------------------------------
//1675 by yukito
・テンションリラックス・バーサークをPC以外が使用するとマップサーバーが落ちるのを修正
　※フェルシア氏のcpaパッチより該当部分を抜粋させて頂きました。
・atcommand_athena.confの巻き戻し忘れを補完

----------------------------------------
//1674 by yukito
・コンセントレーションで無限インデュアになっていたのを修正
・プレイヤーから攻撃された時はインデュアのカウント対象外になるように修正

----------------------------------------
//1673 by yukito
・csvdbを無効に出来るコンパイルオプション追加

----------------------------------------
//1672 by yukito
・チャット・スキル禁止(赤エモ)付与できるGMのレベルを設定可能に(battle_athena.conf)
・bAddMonsterDropItemのドロップ率に倍率をかけるかどうか設定可能に(battle_athena.conf)
・モンスターの暗黒処理の無駄を削除(ウォールオブフォグと一括処理のため)
・細かな整形

----------------------------------------
//1671 by Kiry
・ジプシーのヘルモードの杖のスキルツリー修正

----------------------------------------
//1670 by yukito
・cpa関係の巻き戻しの不足分を補完
・ナイト転職スクリプトのセリフ修正(ルナ氏up分)

----------------------------------------
//1669 by フェルシア
・cpa関係の巻き戻し

----------------------------------------
//1668 by Rayce
・script.cのgccでの警告潰し
・性転換時に雷鳥の職変更が反映されてなかったのを暫定的に修正
　（char.c parse_tologin()）
・doc/script_ref.txtの書き漏らし分追記

----------------------------------------
//1667 by ルナ
・version.hの更新（SSの修正
・npc_job_07knight.txt
一部性別でコメントの変わる部分の修正。

----------------------------------------
//1666 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1666

----------------------------------------
//1665 by ＡＡＡ
・PKでの取得経験値関係を修正

----------------------------------------
//1664 by Rayce
・スクリプト命令/関数の拡張（script.c）
　monster及びareamonsterをIDだけでなく名前でも呼べるように拡張
　getmapmobsを書き換え、ついでにgetareamobs関数追加
　areamonsterのmap全体ランダム湧き対応
　　（mob.c mob_once_spawn_area()）
　map名指定を"this"にすると命令したNPCの居るMAPを参照
　　→killmonster,killmonsterall,areakillmonster,
    　getmapusers,getareausers,areawarp の計6種
・script_ref.txt追記と部分修正

----------------------------------------
//1663 by ＡＡＡ
・PKのペナルティ追加
　時間内に続けて攻撃できなくなるだけです。
　リログで直るのも、アイテムスキルを使えるのも仕様です。
・ウォールオブフォグ修正
　モンスターの索敵範囲が狭くなるように修正

----------------------------------------
//1662 by yukito
・モンスターが暗黒状態になった時に索敵範囲が狭くなるように修正

----------------------------------------
//1661 by ＡＡＡ
・ウルド仕様の修正
・PK可能、およびPK対象となるキャラクターは以下のとおりです。
BaseLv61以上のノービス 
BaseLv61以上の1次職(テコン)
特殊1次職（スーパーノービス・忍者・ガンスリンガー）
2次職 
全ての転生職 
・マーダラーボーナス
※キラーポイントは ranking_get_point(sd,RK_PK)で取得できます
※全ての能力値（STRなどの6つの能力）が上昇。
　キラーポイントが100を超えると全ての能力値が+3。
　キラーポイントが400を超えると全ての能力値が+5。 
※物理攻撃力（ATK）・魔法攻撃力（MATK）が10%上昇。 
※NPCにアイテムを販売するとき、10%高く販売可能。 
※キラーポイントが上昇する条件でPKを行った場合、
　倒されたプレイヤーの消失する経験値を獲得。
　※ただし即経験が減る設定のみ

　経験値ドロップ関係はウルド仕様用に計算を変える予定はありません。
　PKペナルティ(１時間〜、２４時間〜)もやる気はありません。

----------------------------------------
//1660 by ＡＡＡ
・ウォールオブフォグ修正

----------------------------------------
//1659 by yukito
・ディテクティングの効果範囲修正
・スチールクロウの攻撃力増加値修正
・寒いジョーク、スクリームの効果範囲修正
・ハンマーフォールはエフェクト終了後にスタンするように修正
　（スキル使用後、実際にスタンするまでの時間はskill_cast_db.txtのupkeep_timeを使用）

----------------------------------------
//1658 by ＡＡＡ
・スキルに禁止地域を追加
・ターボトラック用フラグ追加
alde_tt02.gat	mapflag	turbo	dummy

----------------------------------------
//1657 by yukito
・敵の状態異常攻撃スキルの属性を修正
・敵の属性攻撃、状態異常攻撃スキルの射程を修正
・インベナムがダメージ0の時、毒化できなかったバグ修正

----------------------------------------
//1656 by ＡＡＡ
・sc_start3
・sc_starte
  Equip Scriptにsc_starteを使用できるようにしました
  doc参照
・status_chagen_startのflag&4でstatus_calc_pcを呼ばなくなりました
・ウォールオブフォグ修正
　霧の効果対象を修正
  ※不発情報が違っていたので巻き戻し
　　無属性耐性も霧効果の勘違いの一部と思うので削除
・ウォールオブフォグの不発をskill_misfire.txtで定義するように修正
  もうこれ以上の修正は勘弁…

----------------------------------------
//1655 by yukito
・万能薬とローヤルゼリーで錯覚状態が治るように修正

----------------------------------------
//1654 by ＡＡＡ
・装備品に装備制限と禁止地域が適用されていなかったのを修正

----------------------------------------
//1653 by ＡＡＡ
・@disppethp 	<数値>
  1: 表示ON
  0: 表示OFF
　HPに変化があると表示
・@pethp
  ペットのHP/MAXHP表示

----------------------------------------
//1652 by yukito
・金剛中にウィンドウォークを使用した場合のチェック漏れ修正

----------------------------------------
//1651 by End_of_exam

・hideonnpc, hideoffnpc に存在しないNPC を指定すると落ちるバグを修正(script.c)
・getpetinfo(2), getmapname 命令を使うと落ちるバグを修正(script.c thanks to DonnySasa)
・その他微修正(script.c)
・メモリマネージャの最適化、エラーチェックの強化(malloc.c)

----------------------------------------
//1650 by ＡＡＡ
・ウォールオブフォグ修正
　・通常攻撃も不発するように修正
　・無属性耐性追加
　・暗闇ペナルティ修正
　※詳しい方修正お願いします。(伝聞だけじゃ謎過ぎ…)
・気爆発修正
　

----------------------------------------
//1649 by ＡＡＡ
・イドゥンの林檎の回復をPCが使用した場合はPC
  MOBが使用した場合はMOBが対象になるように修正
　※petは除外してます

----------------------------------------
//1648 by yukito
・コンセントレーション、バーサークでインデュア効果が出るように修正
・金剛中は囲まれによるDEF低下が発生しないように修正
・速度増加・金剛・ウィンドウォークの重複チェック追加

----------------------------------------
//1647 by Rohypnol
・GvG関連スクリプト巻き戻し
----------------------------------------
//1646 by ＡＡＡ
・使用制限修正
・警告修正

----------------------------------------
//1645 by ＡＡＡ
・アイコン修正
・禁止地域追加の判定位置修正

----------------------------------------
//1644 by ＡＡＡ
・アイテム拡張
　upperによるアイテム装備制限(テコン系はupper:0として扱ってます)
　使用ディレイ追加
　禁止地域追加
・bonus bItemNoUse,n; アイテムが使えない

----------------------------------------
//1643 by End_of_exam

・1638のstatus.c修正抜けを修正(status.c)
・スクリプトコマンドsc_ison を追加(script.c)
・status_calc_pcを初回のみUse Scriptを追加実行するように修正(status.c)
・item_db のuse scriptに{}を使えるように修正(itemdb.c)
・アンデットMOB にリザレクションが使えないバグを修正(skill.c)
・battle_check_undead に属性＋Lvの値を渡しても正常に動作するように変更(battle.c)

装備品に状態変化を使う場合、Use Scriptの欄にsc_startを記入するように
してください。守られていない場合には、sc_ison とsc_startの組み合わせに
不具合が生じる可能性があります。

----------------------------------------
//1642 by Rohypnol
砦名称の修正
	db/castle_db.txt
砦陥落時の地域名称の修正
	script/npc/gvg/ev_agit_*
スクリプトのタブ文字に全角空白が含まれていたのを除去
（問題なく動作してるようですが、思わぬ動作不良につながりかねないため）
	script/npc/gvg/*_cas*
ちょっとした警告の削除
	src/map/status.c
----------------------------------------
//1641 by 逆毛鰻
　conf/char_athena.conf
　src/char/char.c  if(login_fd <= 0)〜

　char_loginaccess_autorestart: 0 (0=今まで通り終了しない 1=終了する)

・指定されたログインサーバが発見出来ず、ログインが出来ない場合
　終了するか(自動再起動スクリプト利用で再起動可能)　しないかの選択が出来るように
・終了しない場合は従来通りの動作。デフォルトではしない

　ログインサーバ共有等で、ログインサーバのアドレスにDDNSを指定してる場合
　相手のログインサーバのIPが変更される事があり、Charを再起動しなければ
　ずっと相手のログインサーバに表示されなくなる。
　終了させて、自動で再起動がかかれば自動でDDNSから新しいIPを
　探して正しいログインサーバへ接続してくれます。
　IPが変わりやすいADSL運営で、出勤等で放置運営が続く場合、1にするといいかも？

----------------------------------------
//1640 by ＡＡＡ
・モンスター情報をペットに対応
　他

----------------------------------------
//1639 by yukito
・battle_athena.confのallow_cloneskill_at_autospellがnoの時、
　オートスペルのカードと同じスキルの最大レベルをクローンしていると
　発動したスキルのレベルが0になる不具合の修正

----------------------------------------
//1638 by ＡＡＡ
・status.cの修正

----------------------------------------
//1637 by ＡＡＡ
・status_calc_pcの無限ループ修正
(status.c)
	-status_calc_pc_stop_begin()
	-status_calc_pc_stop_end()
----------------------------------------
//1636 by End_of_exam

・Visual C++ .NET 2005 対応 (*.dsp core.c login.c httpd.c status.c)
・httpd のService Unavailableにbreakが抜けていたバグを修正(httpd.c)

----------------------------------------
//1635 by yukito
・スティールした装備品が鑑定済みになっているバグ修正
・ボウリングバッシュで連鎖HITした敵が2HITになっていなかったバグ修正
・インティミデイトが発動しないバグ修正
・剣士の転職試験で穴に落ちても落下しないバグ(スクリプトミス)修正

----------------------------------------
//1634 by End_of_exam

・attachrid の戻り値が違うバグを修正(script.c thanks to フェルシアさん)
・status_calc_pc を似非リエントラントに修正(status.c)
・1631-fix で婚礼衣装バグ対策として、エンチャントポイズンの属性ダメージ
　増加が消されていたのを元に戻す(status.c)

　status_calc_pc_process, no_status_calc_pc ですが、今回のパッチで変数の
　使用法を変更しました。status_calc_pc の実行中にさらにstatus_calc_pc が
　呼ばれた場合、途中まで計算し終わったパラメータを捨てて再計算しないと
　計算結果が狂ってしまう為です。実質1632のstatus_no_calc_pc_*** の
　巻き戻しという形になりますが、ご了承ください。

----------------------------------------
//1633 by ＡＡＡ
・makefile修正

----------------------------------------
//1632 by ＡＡＡ
・ガンスリンガーと忍者を正式に内部実装
・@viewclassデバッグ用
(status.c)
	-status_no_calc_pc_begin()
	-status_no_calc_pc_end()

----------------------------------------
//1631 by ＡＡＡ
・装備品にsc_startを使った場合無限ループに陥る現象を修正

----------------------------------------
//1630 by End_of_exam
・1628の多数の穴塞ぎ
・1628でbattle_config.heal_expの対象にMOB が含まれていた罠を修正

----------------------------------------
//1629 by ＡＡＡ
・bonus2 bEternalStatusChange,n,x;
  ステータス異常nがstatus_change_timerが呼ばれる度にxミリ秒追加し継続する
　例:装備している間アスムプティオ状態
  ,{},{ bonus2 bEternalStatusChange,110,1000; sc_start 110,1000,0; }

----------------------------------------
//1628 by フェルシア

・アルケミストにペット支援攻撃系のスキルが追加されるそうなので、モンスターやＰＣがペットを攻撃できるようにした。
  (can_pet_attackをyesにするとペットがダメージを受けるようになります)
・battle_athena_confにcan_pet_attackとpet_damage_dely,pet_damage_dely_rateの追加
・pet_unlocktargetの外部公開化　及び pet_setdead,pet_setstand,pet_heal,pet_damage,pet_revive関数の追加

----------------------------------------
//1627 by End_of_exam

・csvdb に行入れ替え作業の追加(db.c db.h)
・スクリプトにcsvsort, csvinsert, csvdelete, sleep, sleep2 関数の追加
・メモリリーク修正(script.c db.c)
・1585の修正漏れを修正(mob.c)

----------------------------------------
//1626 by n/a
・mob_skill_db.txt
・デビルリングのcasttimeとdelayが逆だったのを修正

----------------------------------------
//1625 by ＡＡＡ
・ガンスリンガーと忍者の仮内部実装
　ガンスリンガー: 28 (view_class 24)
  忍者          : 29 (view_class 25)
  baseexp スパノビ流用
  jobexp  １次職を流用
　判明次第変更予定
　
----------------------------------------
//1624 by yukito
・クローンした三段掌が発動しないバグを修正

----------------------------------------
//1623 by ＡＡＡ
・map.hの修正
・docにsc_start.txt追加
  bAutoStatusCalcPcと併用すれば色々と出来そうです

----------------------------------------
//1622 by yukito
・const.txtからSC_RaceUnknown(326)〜SC_RaceDragon(336) が抜け落ちていたのを修正
　これの弊害で返魂のお札の効果が出なくなっていました。
・エンチャントデッドリーポイズンのダメージ増加効果が出なくなっていたのを修正

----------------------------------------
//1621 by ＡＡＡ
・MAX_VALID_PC_CLASS修正
　あれの仕込み
・skill.hにガンスリンガーと忍者のスキル暫定追加
　このまま来ると限りませんがexeを解析できる人は番号解析お願いします

----------------------------------------
//1620 by うんぽこ
・猛毒修正
・アスムプティオ修正

----------------------------------------
//1619 by End_of_exam

・スクリプトのisstr の誤判定を修正(script.c)
・スクリプトからcsv を読み書き出来る関数を追加(script.c db.*)

----------------------------------------
//1618 by Sapientia
・scriptに flagname, getnpcposition 関数追加
・GvG 関連スクリプト修正.
・castle_db にアジト名前修正.
・script_ref.txt に関数説明追加.
・GvGでガーディアンにギルド情報を表示するように修正.
・エンチャントデッドリーポイズンがボスには適用されないように修正.

----------------------------------------
//1617 by ルナ
・本鯖では武器精錬はスキル名を叫ぶので叫ぶように修正。
----------------------------------------
//1616 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1616
---------------------------------------
//1615 by yukito
・アイテム鑑定と武器精錬でスキル名を叫ばないように修正(質問スレ３[109]報告分)
・ディテクティングとスプリングトラップに鷹チェック追加
・鷹が必要なスキルを鷹なしで使おうとした時にスキル使用失敗が出るように修正
・組織の団結力を使用した時にギルド経験値(500k〜1Mでランダム)が増えるように修正
・雑談スレ４[116]フェルシア氏のscript_ref.txtに加筆修正をしたものを同梱

----------------------------------------
//1614 by yukito
・battle_athena.confのitem_rate_detailsが2の時、
　mob_db.txtでドロップ率が10000に設定されているアイテムのドロップ率が
　強制的に0になってしまうバグを修正
・mob_db.txtのExpPerが使われていなかったので使うように修正

----------------------------------------
//1613 by yukito
・グランドクロス・闇グランドクロスの3HIT化処理方法を変更(skill_cast_db.txt upkeep_time)
・グランドクロス・闇グランドクロス使用後の移動不可時間を修正(900ms)
・サンクチュアリで不死・悪魔を攻撃した時に回復2回分としてカウントするように修正
・ファイアーピラーをモンスターが使った時のダメージ修正
・カプラ空間転送のバグ修正(ルナ氏報告thx!)

----------------------------------------
//1612 by Rayce
・scriptにguildgetexp追加（from eA）
・scriptのhideonnpc,hideoffnpcをNPC名なしでも作動するように拡張
・金剛が詠唱なかったのを修正
・doc追記

----------------------------------------
//1611 by ルナ
npc_function.txt
・空間転送のワープ指定がずれていたのを修正？
※setarray @placename$,となっていたのですが、
  setarray @placename$[1],と前まではなっていたみたいなのですが、
  これでもまだずれるのでsetarray @placename$[2],としたら、
  直ったっぽいです。
npc_town_ayothaya.txt
・アユタヤクエストの自分にエモーションが出ずに床やNPCの方に
エモーションが出ていたのを自キャラに出るように修正。
----------------------------------------
//1610 by 名無い
npc_town_einbroch.txt
・鯖落ちの原因となっていたmonster位置ランダム指定をareamonsterに変更

----------------------------------------
//1609 by yukito
・mapflag noicewallのマップでIWを出すとエフェクトだけ出ていたのを修正
・上記のときに　スキル使用失敗　と出るように変更

----------------------------------------
//1608 by ＡＡＡ
・bonus bAutoStatusCalcPc,n;
  nの状態異常が終了するたびに強制的にステータスの計算
　※使い方
　　例:装備している間アスムプティオ状態
    ,{},{ bonus bAutoStatusCalcPc,110; sc_start 110,1000,0; }
　　(メモリ消費より速度を取ることに)

----------------------------------------
//1607 by yukito
・馬牌を使うと移動不能になるのを修正
・返魂のお札の効果時間が30分ではなく3分になっていたのを修正
・アユタヤパッチ追加時のmap追記
・攻撃MISSでもカードの状態異常が発動していたのを修正
・FW、IWが位置によっては斜めに出なかったのを修正(本鯖相違スレ２[25]End_of_exam氏投稿分)

----------------------------------------
//1606 by yukito
・プロンテラ大聖堂の修道女が2人いたので削除(プリースト転職)
・町内限定アナウンスにアインブロック、アインベフ追加
・転生二次転職共通処理の名前部分を修正
・イズルードとプロンテラのみペットフードの売価が高かったのを修正
・ウンバラの属性石クエストで結合キャンセルすると固まるのを修正
・その他、細かな修正など

----------------------------------------
//1605 by ＡＡＡ
・status_change_endで必要のないステータス計算削除
・bonus bAutoStatusCalcPc,n;
  status_change_endが呼ばれるたびに強制的にステータスの計算
　※使い方
　　例:装備している間アスムプティオ状態
    ,{},{ bonus bAutoStatusCalcPc,0; sc_start 110,1000,0; }
    ステータス計算がもともと入る処理はbAutoStatusCalcPcは必要ありません。
　　スロポ、アスム、特定の魂状態などを維持したい場合使用してください
　※2.
　　切れるたびに装備スクリプトを呼び出して永続効果を得ているように見せかけているだけです。
　　今までに無い効果を簡単に実現するために追加したもので、
　　専用に用意したものに比べて重く、思ったとおりの動作にならないこともあるかもしれません。
　　あくまで補助とわりきって使用してください。
    これを用いて不具合、再現できないものが出てもこちらは関知しません。
・リバースオーキッシュ、月明かりの中で修正
・マヤパープルカードの効果がPC,MOB,PETのみ有効になるように修正
　隠れたNPCは見えなくなりました

----------------------------------------
//1604 by Rohypnol
・ピラ前→モロクのポータルの出口がモロク→ピラ前のポータルと重なっていたのを修正
----------------------------------------
//1603 by End_of_exam

・1600の穴塞ぎ
・露天閉じ処理をpc_setpos から unit_remove_map へ移動(unit.c pc.c)

----------------------------------------
//1602 by yukito
・フルストリップに詠唱時間があったのを修正

----------------------------------------
//1601 by ＡＡＡ
・PCの周囲エフェクト修正
	opt3 4096 太陽、月、星の温もり
　　　　　　 8192 カイト
            16384 (設定なし？)
	    32768 〜の魂
・タロットカード修正
・プロヴィデンス修正

----------------------------------------
//1600 by exile
・カード効果の状態異常に関して
　- ダメージ発生後に発動するよう修正。
　- miss時も発動するよう修正。
　- addeff_range_flagの処理を修正
・カード効果のコーマ・即死をダメージ発生後に発動するよう修正。
・カード効果の状態異常・コーマ・即死がエンペリウムに発動しないよう修正。
・フロストノヴァが凍結している敵にはHITしないよう修正。
・mod1571でフリージングトラップのダメージが発生していなかったのを修正。
・アイスウォールにnoicewallが機能していなかったのを修正。

(src/map)
	battle.c	- battle_damage, Damage battle_calc_weapon_attack,
				  Damage battle_calc_misc_attack,
				  battle_weapon_attack, battle_skill_attack 修正
	map.h		- struct unit_dataにlinkdb_node *statuspretimer追加
				  struct status_pretimer 追加
	skill.c		- skill_additional_effect, skill_castend_pos2 修正
	status.c	- status_pretimer, status_clearpretimer, status_change_pretimer追加
				  do_init_status 修正
	status.h	- status_change_pretimer 追加

----------------------------------------
//1599 by yukito
・skill_unit_db.txt修正

----------------------------------------
//1598 by ＡＡＡ
・グランドクロスのHIT数修正(taiさん感謝)
・map_check_normalmap fix (thx to DonnySasa)
・霧のHIT関係修正
・command group修正
・skill_unit_db.txt修正

----------------------------------------
//1597 by yukito
・ladminでbanした時に「アカウントブロック」と出るように
・ギルドスキルツリーの修正
・枝からミストレス(MVP)が出ないように
・バイオプラントの効果時間、Mob定義修正
・武器修理の詠唱時間、消費SP修正
・mob_group_db.txtで一部のコメントアウトを外す
・気奪がダメージで詠唱キャンセルされるように
・マインドブレーカーの習得条件をソウルバーンLv2に
・mapの不足分を追加、その他テキスト整形

----------------------------------------
//1596 by yukito
・露店を出したままマップ移動した時に露店を閉じるように
(src/map)
	pc.c
		-pc_setpos()

----------------------------------------
//1595 by ＡＡＡ
・Gv時の設置系スキル範囲修正
・PK時にも自分にスキルが当たるフラグ追加
  inf2 8192
・魂の周囲エフェクト修正
　昔のアスムのようにマップ移動時に現れる
　エフェクトがあれば報告お願いします

----------------------------------------
//1594 by ＡＡＡ
・ウォールオブフォグ修正
(src/map)
	-int map_check_normalmap(int m);追加
	通常フィールド(pvp,gvg,pk以外)か調べる

----------------------------------------
//1593 by End_of_exam

・VC用の鯖落ち情報ファイル作成方法の変更(vc07_make.bat crashdump.pl)

　VCでもシンボル名が正常に得られない場合があるっぽいので、保険として
　bcc と同じ方法を使えるようにしました。VCでunknown と表示された場合は、
　crashdump.plを実行して、crashdump_report.txtの内容を報告してください。

　※ crashdump_bcc.pl は、VCに対応した関係上ファイル名を変更しました。
　　次のSSで削除をお願いします。

・TXT: BCC のみaccreg.txt の読み込みに失敗する可能性のあるバグを修正(inter.c)

　sscanfのBCC 特有の仕様として、%nの箇所にNUL, \n, 行末から続くスペースが
　ある時の動作が、想定していたのと異なるみたいです。

void main(void) {
	int tmp, r1 = -1, r2 = -1, r3 = -1, r4 = -1;
	sscanf("1 "   , "%d %n", &tmp, &r1); // %n : NUL
	sscanf("1 \n" , "%d %n", &tmp, &r2); // %n : \n
	sscanf("1  \n", "%d %n", &tmp, &r3); // %n : ' '
	sscanf("1 _\n", "%d %n", &tmp, &r4); // %n : '_'
	printf("r1 = %d, r2 = %d r3 = %d r4 = %d\n", r1, r2, r3, r4);
}

gcc: r1 =  2, r2 =  3 r3 =  4 r4 = 2
vc : r1 =  2, r2 =  3 r3 =  4 r4 = 2
bcc: r1 = -1, r2 = -1 r3 = -1 r4 = 2 // r1, r2, r3 に値が代入されてない

----------------------------------------
//1592 by ＡＡＡ
・クローンスキルの保存タイミング変更
・カード効果のアイテムドロップをスキルにも適用

----------------------------------------
//1591 by ＡＡＡ
・sql関係修正
・@go修正
  アインブロック構造が面倒なので北口追加
  help修正

----------------------------------------
//1590 by Blaze
・アインブロッククエスト4種実装
・飛行船NPC修正
・ダンジョンwarp修正
・map_athena.confをアインブロック対応
・The Sign追加


----------------------------------------
//1589 by yukito
・battle_athena.confのdead_branch_activeがyesの時に、古木の枝で召喚した敵の
　ルート・リンク・詠唱反応・ボス・1ダメージ固定の属性が消失する不具合の修正
(src/map)
	mob.c
		-mob_once_spawn()

----------------------------------------
//1588 by ＡＡＡ
・クローンスキルを本鯖仕様に修正
　クローンスキルのID,LVを保存
　スキルツリーのクローンスキルを保存しないように変更
・装備オートスペルの修正
　遠距離の発動率半減
　クローンスキル適用の有無
・カウプ修正
  一度回避した場合切れるように修正
　スキル以外の必中攻撃も回避

----------------------------------------
//1587 by exile

・クローンスキルのサーバー保存に関する修正。
　　クローンされたスキルとそのレベルを、char鯖を再起動しても保持するよう修正。
　　char鯖再起動後に、再起動前にクローンしていたスキルがクローンできなくなるのを修正。

　クローンされたスキルのセーブ方法が変更されていますので、
　以下のようにしてセーブデータ内のクローンされたスキルを消去して下さい。

　[共通]
　　mmo.hの CLONE_SKILL_FLAG を、skill_db.txtで設定された
　　最高スキルレベルより大きな値に設定。（通常は13で問題ないはず）

　[TXT]
　　念のため、セーブデータのバックアップを取っておいて下さい。
　　1. version.h の ATHENA_MOD_VERSION を 1586以下 にしてchar鯖をmake。
　　2. char鯖を一旦起動し終了。（既存のクローンされたスキルが消去されます）
　　3. ATHENA_MOD_VERSION を 1587以上 にしてchar鯖をmake。

　[SQL]
　　MySQLにログインしてskillテーブルのlv=11に該当するレコードを消去。
	( DELETE FROM `skill` WHERE `lv`='11'; )

・[SQL] inter.logをSQLに保存するよう修正。

	(src/char)
		char.c			- mmo_char_tostr, mmo_char_fromstr,
						  mmo_charstatus* char_sql_load, char_sql_save修正
		int_guild		- mapif_parse_CreateGuild, mapif_parse_BreakGuild, 
						  mapif_parse_GuildCastleDataSave修正
		inter.c			- inter_log修正
	(src/common)
		mmo.h			- #define CLONE_SKILL_FLAG追加
		version.h		- mod version 1587
	(src/map)
		skill.c			- skill_clone修正

----------------------------------------
//1586 by yukito
・item_mask.txtが正常に読み込まれない不具合の修正(バグ報告スレ6[94] Koara氏報告分)
・チャットルーム重複チェックのフラグ処理をclif.cからchat.cに移動
・重複チェックの処理を僅かに改善

(src/map)
	itemdb.c
		-itemdb_read_randomitem()
	chat.c
		-chat_createchat()
		-chat_joinchat()
		-chat_leavechat()
	clif.c
		-clif_joinchatok()
		-clif_leavechat()

----------------------------------------
//1585 by End_of_exam

・動作にほとんど影響ないメモリリーク２カ所修正(npc.c int_pet.c)
・unit_remove_map の警告メッセージを削除(unit.c)
・npc_convertlabel_db のバグを修正(npc.c)
・メモリマネージャの書き換え(malloc.c)

　以下メモリ使用量削減パッチ(1583より13.4MB程節約)

・mob_dbの先頭1000の領域を確保しないように修正(mob.c mmo.h)
・block_free_max, BL_LIST_MAX が大きすぎたのを減らす(map.c)
・MAX_SKILL_LEVELを100から20に変更(map.h skill.c)

----------------------------------------
//1584 by Rohypnol
・一次上位職業の魂を、転生後のキャラなら職業を問わず対象にできたのを、一次職に限定するように修正。
----------------------------------------
//1583 by ＡＡＡ
・マヤパープル、組み合わせ、条件付カード効果の修正
　速度変化ポーション、箱系統、日光の箱、器具の効果
・making makeid,base_sucess_per;
	 makeid		 
	 base_sucess_per 成功率上昇用
・ランダムアイテム用にtxt追加

----------------------------------------
//1582 by Stinger
・@idsearchでアイテム名を表示させた場合、アイテム名が24バイトあるもの（フェイクエンジェルカードなど）
の後ろに文字化けが一緒に表示されていたのを修正

----------------------------------------
//1581-fix by Blaze
・転生スクリプトを本鯖仕様に変更
・アインブロック、飛行船NPC追加
・一部ワープ修正

----------------------------------------
//1580 by ＡＡＡ
・ランダムアイテムが鑑定済みで出るように修正
　※箱系統は getitem -1,1,0;のように修正お願いします

----------------------------------------
//1579 by ＡＡＡ
・The Sign関係のアイテムを捨てられないように修正
・The Sign関係のアイテムを倉庫に入れられるように修正
  -int itemdb_isstorageable(int nameid);追加
・The Sign関係のアイテムを倉庫からカートに入れられないように修正
  -int itemdb_iscartable(int nameid);追加
  ※本鯖では露店販売できるようですが、バグかもしれないので追加しました
・sc_start用	SC_Soul追加
　使用者の職にあった魂がかかります
  sc_end用	SC_SoulClear
		SC_RaceClear 追加
・ソウルリンカーの魂修正(breakが不足していた)

----------------------------------------
//1578 by ＡＡＡ
・レディムプティオ修正
　スキル条件のEXPに倍率を適用
　使用者のペナルティ修正
  デスペナの発生しない条件場所ではEXP条件無視
・changeoption_packet_type: 0に変更
・サインを渡したり捨てられないように修正

----------------------------------------
//1577 by ＡＡＡ
・オーラバグ修正
　clif_changeoption_clear(&sd->bl);
　これが削除されたのでこっちを追加して初期化ました
　clif_changeoption(&sd->bl);
　新パケットが正常なら選択処理は削除します

----------------------------------------
//1576 by ＡＡＡ
・武器製造の選択バグを修正
・clif_changeoptionのパケットを選択できるように修正
  //clif_changeoptionのパケットを選択
  //1:0x229(新)
  //0:0x119(旧)
　changeoption_packet_type: 0
・パケットの変更に伴い新パケットでも看破できるように修正
・allow_create_scroll 削除

----------------------------------------
//1575 by End_of_exam

・mob がクラスチェンジを行うと落ちるバグを修正(mob.c)
・extended_abracadabra判定をskill_upperskill(), skill_mobskill() を
　使うように修正(skill.c)

----------------------------------------
//1574 by exile

・アブラカダブラに関する修正。
	発動スキルデータベース読み込みに関して。
		skill_abra_dbの使われていなかったnameidに発動するスキルのIDを格納。
		per=0のスキルは読み込まない。
	アブラカダブラの使用スキル決定に関して。
		転生スキルが発動できるように修正。
	battle_athena.confに以下を追加。
		extended_abracadabra	セージがアブラカダブラで転生スキルを使用できるか
・item_bonus.txtでbonus4の説明に不備があったのを訂正

	(conf)
		battle_athena.conf
	(doc)
		conf_ref.txt
		item_bonus.txt
	(src/map)
		battle.c	- battle_config_read 修正
		battle.h	- Battle_Config 修正
		skill.c		- skill_castend_nodamage_id, skill_abra_dataset, skill_readdb 修正

----------------------------------------
//1573 by End_of_exam

・1571の修正
・@option にopt3を変更出来る機能を追加(atcommand.c)
・mob から経験値が得られないバグを修正(mob.c)
・mob_skill_db 読み込みでclear を誤判定するバグを修正(mob.c)
・clif_changeoptionを新パケットに置き換えてみる(clif.c)
・ペットの移動速度修正(status.c pet.c thanks to 通りすがりの人さん)

----------------------------------------
//1572 by ＡＡＡ
・アスムのアイコンとエフェクト同時に出るように修正
アスムの謎（バグ？）の詳細
１opt3系列のスキルはアイコンにエフェクトが出る処理が含まれている
２opt3系列のエフェクトはアイコンで判定されている(自クライアントのみ)
３アスムアイコンにはエフェクトを消す処理が含まれていた
４アスムのアイコンを出さないときにはなぜかエフェクトが出ていたのは
　アスムのみclif_skill_nodamageにエフェクトを出す処理が含まれていたため
　(３の効果のためエフェクトが打ち消されていた）

----------------------------------------
//1571 by exile
・battle_athena.conf に以下を追加。（詳細はconf及びconf_ref.txt参照）
		natural_heal_weight_rate_icon		重量50%アイコン表示
		max_marionette_str〜max_marionette_luk		マリオネットコントロール上限
		allow_me_rokisweil		ロキを使用者に適用するか
・bonus4 bAutoSpell を拡張。（詳細はitem_bonus.txt参照）
	特に以下の点にご注意下さい。
		EAS_LONG_ATTACK,EAS_LONG_REVENGE 廃止
		確率を 万分率 に変更（bonus3の方は百分率です）
・bonus3 の反撃オートスペルにbattle_athena.confの〜attack_autospellが影響するように修正。
・battle_athena.confで同じカードのオートスペルが不可のとき、
　1つのカードに定義された条件の異なるオートスペルは許可するように修正。
・以下の item bonus を追加。（詳細はitem_bonus.txt参照）
		bonus bGetZenyNum2
		bonus bAddGetZenyNum2
		bonus bAtkRangeRate
		bonus bAtkRange2
		bonus bAtkRangeRate2
		bonus2 bAddEffShort
		bonus2 bAddEffLong
・mapflag noicewall 追加。
・mapflag noportal,noabraを@mapflagで変更できるように修正。
・スクリプト関数 getpkflag 追加。（詳細はscript_ref.txt参照）
・フリージングトラップがmiscスキルとして処理されるように修正。
・スピアスタブがシーズモード時に吹き飛ばさないよう修正。
・item_bonus.txtを整理

	(conf)
		battle_athena.conf
	(db)
		const.txt
	(doc)
		conf_ref.txt
		item_bonus.txt
		script_ref.txt
	(src/map)
		atcommand.c	- atcommand_mapinfo 修正
					- atcommand_mapflag 修正
		battle.c	- battle_calc_damage 修正
					- Damage battle_calc_weapon_attack 修正
					- Damage battle_calc_magic_attack 修正
					- Damage battle_calc_misc_attack 修正
					- battle_weapon_attack 修正
					- battle_config_read 修正
		battle.h	- Battle_Config 修正
		map.h		- EQUIP_AUTOSPELL_FLAG 修正
					- map_session_data 修正
					- map_data 修正
		mob.c		- mob_damage 修正
		npc.c		- npc_parse_mapflag 修正
		pc.c		- pc_checkweighticon 修正
					- pc_bonus 修正
					- pc_bonus2 修正
					- pc_bonus3 修正
					- pc_bonus4 修正
					- pc_bonus_autospell 修正
		pc.h		- pc_bonus4 修正
					- pc_bonus_autospell 修正
		script.c	- buildin_bonus4 修正
					- script_function buildin_func[] 修正
					- buildin_setmapflag 修正
					- buildin_removemapflag 修正
					- buildin_getpkflag 追加
		skill.c		- skill_additional_effect 修正
					- skill_castend_damage_id 修正
					- skill_trap_splash 修正
					- skill_castend_pos2 修正
					- skill_unit_onplace 修正
					- skill_use_bonus_autospell 修正
					- skill_bonus_autospell 修正
		skill.h		- #define AS_ATTACK 修正
					- #define AS_REVENGE 修正
					- skill_use_bonus_autospell 修正
					- skill_bonus_autospell 修正
		status.c	- status_calc_pc 修正

----------------------------------------
//1570 by ＡＡＡ
・アイコン修正
　SC_SENDMAXを使わなくなりました
　1〜128までで使っていない数字を使うことが出来ます

----------------------------------------
//1569 by ID:7QLFJSM

・grf-files.txt を読むか読まないか指定できるように(map_athena.conf)
　このファイルを読まないように指定すると、map_athena.conf での指定に従って
　data.grf などを探します。
・httpd の Digest 認証の nonce を捨てる方法を似非クロックアルゴリズムに変更
・httpd の認証に使うアカウント情報をコールバックで自由に返せるようにした
　(開発者向け、httpd.h に簡単な説明あり)
・ログインサーバーにおける httpd の認証で Athena のアカウント情報を
　利用できるようにした(httpd.conf)

(doc/)
conf_ref.txt
(conf/)
map_athena.conf
	read_grf_files_txt, data_grf, sdata_grf, adata_grf 追加
(src/common)
grfio.c
	grfio_init() 修正
httpd.*
	httpd_set_auth_func() など追加
	httpd_check_access_user_digest(), httpd_check_access_user_basic() など修正
(src/login)
login.c
	login_httpd_auth_func() 追加、do_init() 修正
(src/map)
map.c
	map_config_read() 修正

----------------------------------------
//1568 by End_of_exam

・mob の思考ルーチンの微調整(mob.c)
・mob_skill_db 読み込み時のエラーチェック強化(mob.c mob.h)
・mob_skill_db チェックに弾かれる行が２つ出たのでコメントアウト(mob_skill_db.txt)
　　mob_skill: invalid combination (mystatusoff,0) line 45 // 0 = プロボック
　　mob_skill: invalid combination (friendstatusoff,30) line 400 // 30 = ラウドボイス
　　↑現物を再現すると何だか違う気がするので、dbに詳しい方修正お願いします。

・PC以外がファンタスミックアローを使うと落ちるバグを修正(battle.c)
・ダメージログ、タイマースキルにlinkdbを使うように変更(mob.c skill.c pc.c map.h)
・MVP 判定が与ダメージ順の大きい順にならないバグを修正(mob.c)
・ニーベルングの指輪の追加ダメージを修正(150~350 -> 75~175) (status.c)
・自分勝手なダンスの攻撃が発動しないバグを修正(status.c)
・gcc のWFIFORESERVE内部の警告を修正(socket.c)
・1566でMOB がダメージ食らった時に２重にパケット送信してたのを修正(unit.c)
・charサーバー終了時に落ちるバグを修正(char.c)
・ファイアーピラーを踏んだ時に落ちるバグを修正(skill.c)

----------------------------------------
//1567 by 三味線
・atcommand_athena.confのstatallコマンド更新

----------------------------------------
//1566 by ICO
・monster_damage_delay修正
・カートターミネーションのスタン発動率を修正(vitでの減算が効くように)
・メルトダウンの継続時間修正

----------------------------------------
//1565 by 逆毛鰻

・サンプルスクリプト’以前のミス修正
・アーモンド、宝石箱からアイテムがゼロピしかでなかったので修正
db/const.txt
script/sample/npc_original_revive.txt

----------------------------------------
//1564 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1564
---------------------------------------
//1563 by yukito
・ジャワイ差し替え
・アインブロク一部修正
・飛行船一部修正
・アインブロクmapflag追記

(script/npc/town)
	npc_town_jawaii.txt
	npc_town_einbroch.txt
	npc_town_airport.txt
(script/warp)
	npc_warp_town.txt
(conf)
	mapflag.txt

----------------------------------------
//1562 by Blaze

・アインブロックNPC修正と追加
・飛行船システム実装
・1559のパッチ内容を巻き戻し

----------------------------------------
//1561 by ルナ

・npc_warp_fild.txtの一部座標がおかしかったのを修正。
・npc_town_einbroch.txtの見晴台から戻ると、戻り先で止まってしまう
　バグを修正（暫定かも？)しました。

・npc_warp_fild.txt
下記の座標を修正。
yuno_fild01.gat,30,244,0	warp	einbrochwarp5005	1,1,yuno_fild12.gat,366,244
を
yuno_fild01.gat,26,246,0	warp	einbrochwarp5005	1,1,yuno_fild12.gat,366,244
と修正。
yuno_fild02.gat,59,23,0		warp	einbrochwarp5007	1,1,yuno_fild08.gat,75,372
を
yuno_fild02.gat,69,22,0		warp	einbrochwarp5007	1,1,yuno_fild08.gat,75,372
と修正。

・npc_town_einbroch.txt
		set @rand,rand(3);
		if (@rand == 0) warp "einbroch.gat",178,167;
		if (@rand == 1) warp "einbroch.gat",216,188;
		if (@rand == 2) warp "einbroch.gat",170,229;
		warp "einbroch.gat",216,188;
上記の部分の
warp "einbroch.gat",216,188;
が入ってると固まってしまうみたいなのでコメントアウトしておきました。

----------------------------------------
//1560 by Blaze

・アインブロックNPC追加
・warpをアインブロックに対応
・NPCスキル、属性攻撃や状態異常攻撃を遠距離に対応

----------------------------------------
//1559 by 海苔

既存のコマンドの不具合を修正しました。

----------------------------------------
//1558 by ID:7QLFJSM

・パッチ当てを楽にするための Perl スクリプト (patchup) 追加
・受信帯域制限機能を復活＆有効/無効を切り替えられるように修正 (socket.conf)
　　CPU 使用率 100% にならないように対策はしてあるはずです。
・送信バッファの最大サイズを指定可能にした (socket.conf)
　　（サーバーのメモリを圧迫できる脆弱性の修正）
・httpd で処理を許可する秒間リクエスト数を設定できるようにした (httpd.conf)
・httpd で処理可能な URI の長さを制限できるようにした (httpd.conf)
・httpd でログを書き込む際にフラッシュするか選択できるようにした (httpd.conf)
　　フラッシュしないと鯖落ちの際にログが壊れる可能性がありますが軽くなります。
・httpd で Accept-Ranges ヘッダをファイルコンテンツでのみ返すように修正

(bin/tool)
patchup
	新規追加。パッチ当て用の Perl スクリプト。使い方はこのファイルの中を参照。
(src/common)
httpd.c
	httpd_send_head(), httpd_parse(), httpd_send_file() など修正
socket.c
	do_sendrecv(), WFIFORESERVE(), socket_config_read2() 修正
(conf/)
socket.conf
httpd.conf
(doc/)
conf_ref.txt


----------------------------------------
//1557 by End_of_exam

・Windows 用バイナリで鯖落ち情報ファイルを出力する機能を追加(core.c)

　鯖を安定させるのに重要な情報が含まれていますので、coredump_report.txtを
　参考に協力をお願いします。以前のバージョンにこのファイルを上書きしても
　大丈夫だとは思いますが、vc07_make.bat のバイナリ出力先を一階層上に変更
　している点に注意ください。

----------------------------------------
//1556 by End_of_exam

・gcc-4.0 用の警告抑制オプションを追加(Makefile)
・玄箱@vine でコンパイル出来ないのをたぶん修正(db.* map.c mob.c)
・リンクMOB の反応を仲間の攻撃試行時に変更(mob.c thanks to Blazeさん)
・clif_parse_LoadEndAck でpvp timer をクリアし忘れていたバグを修正(clif.c)

----------------------------------------
//1555 by ICO
・ボスモンスターに対するEDPの効果修正

----------------------------------------
//1554 by 甘栗
・連柱崩撃使用後に気球一個でディレイ発生するように変更
・連柱崩撃のコンボディレイを300から600+floor(skilllv/5*200)に変更
・連柱崩撃から伏虎拳にコンボがつながるように変更

----------------------------------------
//1553 by Blaze
・アサシン転職試験実装
・ローグ転職試験実装
・ハンター転職試験修正
・龍之城毒薬王クエスト実装
・mapflag、water_height、warp修正

----------------------------------------
//1552 by ＡＡＡ
・製造関係強化
  produce_dbに要求スキルLVを追加
　コンバーター製造からスクロール製造機能削除
  cooking削除
　making 1000; //料理
　making 1001; //スクロール

----------------------------------------
//1551 by ICO
・取り巻き呼び戻しのワープ先を本体周辺に修正
・不死属性付与、インビジブル(NPCスキル)実装
・ハンマーフォールLv5以降のスタン付与確率を修正

(db/)
	skill_db.txt
	skill_cast_db.txt
(src/map)
	guild.c
	mob.c
	pc.c
	skill.*
	status.c

----------------------------------------
//1550 by ＡＡＡ
・阿修羅修正、他

----------------------------------------
//1549 by ＡＡＡ
・スパノビの魂修正
  4レベル片手剣、短剣、斧、鈍器、杖を装備可能
・ソウルドレインを修正

----------------------------------------
//1548 by ＡＡＡ
・1546でpc.cが巻き戻っていたのを修正
　PKモード時鯖が落ちる可能性があったので修正
  ついでにPK ナイトメアドロップ修正
  PCに倒されたときに装備品を落とします
・matk修正

----------------------------------------
//1547 by ＡＡＡ
・skill_clone修正
・guild_check_member修正
・battle_check_target修正
　PK対象にならないPCは、他のPCをPK出来ないように修正
　他のPCをPK出来ないPCは、PK対象にならないように修正

----------------------------------------
//1546 by ICO
・一部NPCスキルの名称改正、効果修正
・メテオストーム、ユピテルサンダーのlv10以降のHITを定義
・ホールドウェブ(NPCスキル)実装 //効果終了後エフェクトが消えないバグ有

(db/)
	skill_db.txt
	skill_cast_db.txt
(src/map)
	battle.c
	clif.c
	mob.c
	pc.c
	skill.*
	status.c

----------------------------------------
//1545 by yukito
・ギルドメンバーの髪型・髪色・性別が変化してもメンバー表に反映されなかったのを修正
・MobのAI "areaslavelt"を"areaslavegt"に修正
・生命力変換を修正
・武器精錬の不正対策

(src/map)
	skill.c
		-skill_castend_nodamage_id()
		-skill_weapon_refine()
	guild.c
		-guild_check_member()
	mob.c
		-mobskill_use()
		-mob_readskilldb()

----------------------------------------
//1544 by ＡＡＡ
・PK関係のconfが読み込まれていなかったのを修正
・クローンスキル修正・連打掌をクローンしていたのを修正

----------------------------------------
//1543 by unpoko
・ブラギの詩の計算式を修正
・PvP順位計算時クライアント側でエラーが出るのをたぶん修正

----------------------------------------
//1542 by ＡＡＡ
・タロットカードのアイコン追加
・タロットカードの効果修正
・クローンスキル修正・三段掌可能に？
・MATK表示変更
・AI追加
// 条件: (条件タイプ)		(条件値は指定する値)
//	areaslavelt		範囲内(値1)の手下数が指定数超えていたら
//	areaslavele		範囲内(値1)の手下数が指定数以下になったら
例：範囲15*15内の取り巻きが0以下になったら呼び戻し
1038,取り巻き召喚＠オシリス,always,354,1,1000,0,10000,no,self,areaslavele,0,7,,,,,

----------------------------------------
//1541 by End_of_exam

・buildin_warpwaitingpc() で落ちる可能性を修正(script.c)
・切断時にblock_listに登録されたままになる可能性を修正(clif.c)
・db_final()内で２重freeする可能性のあるバグを修正(db.c)

----------------------------------------
//1540 by Blaze
・ハンター転職試験実装
・一部NPCが混同していたのを修正
・ハンター転職関係と龍之城のwarpの修正

----------------------------------------
//1539 by ＡＡＡ
・テコンのコンボディレイ関係を修正
・テコンミッション実装
　※ランカーは４つのスキルを任意の順番に出すことが出来ます
　　一度のコンボ中には同じものは使えません。
・料理作成を仮実装
  スクリプト cooking;
　現在成功率100%、エフェクト製薬です
・ランキング表示関係の調整
　独自ランキングが追加しやすいように
　/blacksmith と @blacksmith を分離
  ※サンプルPVPランキングをコメントアウトで追加
    map.h #define MAX_RANKING 4 -> 5
    ranking.h PVP関係のコメントを外す
    ranking.c PVP関係のコメントを外す
    mob.c     PVP関係のコメントを外す
・赤エモ防止処理(仮)
　※事故多発中により赤エモ処理防止強化
　　仮になってもリログすれば消えるはずです
・ランカーポーション効果実装
・ローグの魂修正
・アサシンの魂修正
・クルセイダーの魂修正
・PK仮実装
  mapflag
	pk
	pk_nightmaredrop
  ※map_athena.confにて一括変更可能
・ダーククロス実装

----------------------------------------
//1538 by yukito
・Mob配置スクリプトの整形
・初心者修練場のスクリプトを新しいものに差し替え
(script/mob)
	npc_monster.txt
(script/npc/job)
	npc_job_00newbie.txt

----------------------------------------
//1537 by ＡＡＡ
・正式に二次クエストスキル開放

----------------------------------------
//1536 by yukito
・1457で混入していたログイン処理の無駄を修正
・武器精錬パケットの変更で不要になった処理の削除
(src/login)
	login.c
		-parse_login()
(src/map)
	clif.c
		-clif_item_identify_list()
		-clif_weapon_refine_list()
		-clif_vendinglist()
		-clif_parse_WeaponRefine()
		-clif_parse_ItemIdentify()
	map.h
		-map_session_data

----------------------------------------
//1535 by ＡＡＡ
・二次クエストスキルのアイコン追加
・チャージアタックのダメージ計算修正

----------------------------------------
//1534 by Blaze
・script見直し
	・npc/job/npc_job_00newbie.txt
	　1532でmob配置が2倍になってしまうのを修正。メッセージ修正。
	・npc/town/npc_town_ayothaya.txt
	　メッセージと座標を修正。
	・npc/town/npc_town_louyang.txt
	　クエスト追加。
	・npc/town/npc_town_umbala.txt
	　バンジーのHP計算修正。
	・npc/quest/npc_event_mobtim.txt
	　ボンゴンテイム交換NPCを追加。
	・warp/npc_warp_dun.txt
	　アビスレイクのワープがおかしいのを修正。
・ジュノー後からのマップの水面を設定(conf/water_height.txt)
・転生職の98→99の必要経験値を修正(db/exp.txt)
・枝でMVPが出てしまうのを修正、アユタヤまでのMobに対応(db/mob_branch.txt)

----------------------------------------
//1533 by huge
・ペットとの親密度が0になったらすぐに消えるかどうか設定できるように修正
・1532のdoc変更し忘れ分

	(conf/)
		battle_athena.conf
		help.txt
	(doc/)
		conf_ref.txt
		help.txt
	(src/map/)
		battle.*
		pet.c

----------------------------------------
//1532 by huge
・gccコンパイル時の警告消し
・ランキング表示とポイント表示を専用パケットを使用するように修正
・ランキング関連 /blacksmith,/alchemistの応答。/taekwonはクライアントで止められてる？
・武器精錬を専用パケットを使用するように修正
・植物栽培で、50%で失敗した際にメッセージを出すように修正
・場所指定スキルを使った際、特定条件下で鯖が落ちるのを修正
・カートの容量を増やしている場合、カートターミネーションの威力がすさまじくなるのを防止修正
・ペットのルートタイプをNPCで変更できるように(保存はされません)
		changepettype <type>;	type=0,1,2;
		0:ルートしない	1:ペットが所有	2:自動で飼い主のインベントリへ
	※この変更に伴って、battle_athena.conf petowneditemが一部修正されています。
・@rankingpoint追加、「@rankingpoint 0〜2 <point>」	0:BS 1:ケミ 2:テコン
・@giveitemで、アイテムをIDで指定したときも、アイテム名を表示するように修正
・@packetの仕様を変更(詳しくはソースを)
	※今までの@packetは@iconで代用できる模様
・2005-10-06aSakexeで調査したパケット長追加
	※パケットが0x259まであるようなので、clif.h MAX_PACKET_DB 修正
・ちょっぴり書き加えたclient_packet.txtを添付
・mob_boss.txtの修正(ハティが抜けてた）
・npc_monster.txt/npc_monster_future.txt添付(10/11 06:40時点での編集データ)

	(conf/)
		atcommand_athena.conf
		battle_athena.conf
	(db/)
		mob_boss.txt
		packet_db.txt
	(doc/)
		client_packet.txt
	(script/mob/)
		npc_monster.txt
		npc_monster_future.txt
	(src/map/)
		atcommand.*
		battle.c
		clif.*
		map.h
		pet.c
		ranking.c
		script.c
		skill.c

----------------------------------------
//1531 by 甘栗
・GMコマンドを追加
 @emotion、エモーションを表示
 @statall、全ステータスMAX、数値指定で指定分だけ全ステータス増減

----------------------------------------
//1530 by ＡＡＡ
・コンバーター製造にスクロール製造機能追加(ネタ)
・mob_boss.txtの修正

----------------------------------------
//1529 by ＡＡＡ
・二次クエストのデバック用NPC修正

----------------------------------------
//1528 by nameless
・bcc32時のコンパイルオプションの最適化追加(AMD32/AMD64/Pentium4C)
以下統計値集計結果

通常のCPU種 [Pentium4]のままのコンパイルと各オプションのCPU負荷軽減値
※値が大きくなっているほど軽くなります(その%分CPU負荷が減るということ)

Athlon    10%
AthlonXP  16%
Sempron   18%
AMD32     26%(新コア・シングル用)
AMD64     48%(新コア・デュアル用)
Pentium4  --%
Pentium4C 21%(内部規格が違うということで追加)
Pentium4X 24%

----------------------------------------
//1527 by ＡＡＡ
・霧による不発効果が対象が霧の中に入っている場合に修正
・battle.cの見直し
・mob_boss.txtの修正
・skill_db関係修正

----------------------------------------
//1526 by ＡＡＡ
・植物栽培実装
・ウォールオブフォグの不発スキル修正(wiki参考+MOBskill全て)
・inf2:8192 レベル毎のアイテム消費追加(LV=itemid)
・ボスはノックバックしない
　boss_no_knockbacking: no
・skill.cの見直し

----------------------------------------
//1525 by ルーチェ

・MOBがMOBの支援に対して詠唱反応するバグを修正(#1)
・MOBがMOBにヒール等を行った場合、対象が不死でも回復するように修正(#2)

#1: unit.c  [803-804] unit_skilluse_id2
#2: skill.c [4861]    skill_castend_id

----------------------------------------
//1524 by ＡＡＡ
・アドリブ修正
・アンコールで覚えていないスキルを使用出来たのを修正
  ※魂状態で対応するスキルを使った場合
・マリオネットの判定修正

----------------------------------------
//1523 by ＡＡＡ
・貪欲実装
・クローズコンファイン修正
・気注入実装？
・気爆発実装
・チャージアタックのダメージ修正
  SP40と詠唱から考えて適当に200+距離*50%くらいで
・サイトブラスター実装(option不明のため見た目はサイトのまま)
・二次クエストスキルのデバック用NPC添付
　二次クエストスキルを使いたい人は
　１．mmo.h #define MAX_SKILL 1020 を追加すること
　２．skill_tree.txtのコメントアウトを外す

----------------------------------------
//1522 by End_of_exam

・協奏スキルが使えなくなっていたバグの修正(skill.c)
・unit_usekill* のチェック部分をskill_check_conditionへ移動(skill.* unit.c)
・gcc の警告潰し(atcommand.c)

　skill_check_condition　ですが、PC用の判定が多くの場所に分散してるので、
　これからMOB, PET と共に１つにまとめていきます。これからスキル使用前の
　判定を追加する時は、skill_check_condition2***に追加して頂けると助かります。

----------------------------------------
//1521 by ＡＡＡ
・MAXHP/MAXSPの制限修正

----------------------------------------
//1520 by ＡＡＡ
・武器精錬実装
・武器精錬に武器研究を適用する
　allow_weaponrearch_to_weaponrefine: no

----------------------------------------
//1519 by 逆毛鰻
・今度こそ修正（ちゃんと動作確認しました）1516のちゃんとした奴です
(src/map)
	status.c
	//HPMAXMINの制限
	if(sd->status.max_hp < 0 || sd->status.max_hp > battle_config.max_hp){
	sd->status.max_hp = battle_config.max_hp;}
	if(sd->status.max_hp < 0){
	sd->status.max_hp = 1;}

	//SPMAXMINの制限
	if(sd->status.max_sp < 0 || sd->status.max_sp > battle_config.max_sp){
	sd->status.max_sp = battle_config.max_sp;}
	if(sd->status.max_sp < 0){
	sd->status.max_sp = 1;}

	1行目の||はいらないような気がしたんですが、無いと機能してくれなかった
	気がしたので。今後問題が出るようであれば
	sd->status.max_sp < 0 ||の部分は消去して頂いて結構です…。

----------------------------------------
//1518 by yukito
・ボウリングバッシュのダメージ値修正(150〜600%→140〜500%)
・アイスウォール、クァグマイアに射線チェック追加
(src/map)
	battle.c
		-battle_calc_weapon_attack()
	skill.c
		-skill_unitsetting()
(db)
	skill_unit_db.txt

----------------------------------------
//1517 by ＡＡＡ
・呪い,沈黙,暗闇の解除修正

----------------------------------------
//1516 by 逆毛鰻

・以前の問題の最終解決版。これで0以下の場合全て1となります。多分
・デリート追記

----------------------------------------
//1515 by 甘栗

・skill_get_unit_系関数(unit_id,layout)を変更
　これによりGu1、Gu2、Glayの効果が出るように

----------------------------------------
//1514 by ＡＡＡ
・本鯖っぽいFW?

----------------------------------------
//1513 by ＡＡＡ
・@goに街を追加
・@goの有効数字をconfで変更できるように修正
・クローン可能スキルの修正
・追加スキルのクローンについて変更できるように修正
・飛び蹴り修正
・ソニックブローのダメージ修正
・ソニックアクセラレーションの修正
・チャージアタック修正
・アサシンの魂修正(wikiでも不明らしいので800+100%にしています)
・べナムナイフをカード無効に修正(倍率不明)
・サクリファイスがエンペリウムに効かないように修正
・太陽と月と星の融合のHIT計算を修正(perfect_hitで計算)
・三段とテコン準備系スキルが発動した時100%HITしていたのを修正
・マップの上限を少し拡張
・レディムプティオ実装(人数の関係からペナルティは未検証)
  ※術者５人以上でデスペナ無し
    対象者は蘇生時にデスペナの20%分経験値増加
    ただし経験が0の場合軽減分は戻ってきません。
　　(本鯖じゃないのだから多めに見てください)
・constにSC_REDEMPTIO追加
  30分間デスペナ30%減少
  sc_start SC_REDEMPTIO,180000,30;
　マイナス指定をするとデスペナ増加できます
----------------------------------------
//1512 by lkm

add new item bonus

bonus bHPGainValue,n
bonus bSPGainValue,n

kill the monster add n hp/sp

----------------------------------------
//1511 by 逆毛鰻

・たむさんのＮＰＣに合わせて　athena-start　win32_start.bat　更新
　(過去のSSから「Saveフォルダが何処で作成されているか」を見てください）　
　　(次回のSSにてややこしくなるSaveフォルダを削除希望)

・普通のＮＰＣに変更
script/sample/npc_original_revive.txt

・VC++でもコンバータがコンパイル出来るように変更(Docも更新)
vc07_make.bat

・たむさんのＮＰＣ更新
//砦投資周りを本鯖準拠に修正 by tam

・商業値と防衛値の最低値を1に修正
・マスタールームの宝箱が部屋の外に出現する可能性がある問題を修正
・宝箱の出現が、投資が反映されるより先に処理されていた問題を修正

script/npc/gvg/ev_agit_common.txt
save/castle.txt

castle.txtを置き換えると砦情報が初期化されます。
独自に修正する場合、左から3,4セルを1で埋めて下さい。
修正しない場合、現城主ギルドの砦破棄、ギルド解体、
または該当砦の落城時に、値が1に修正されます。

----------------------------------------
//1510 by Blaze

(script/npc)
・龍之城、アユタヤ、新フェイヨン、新初心者修練所のNPC追加（一部不完全）
・旅館、髪型変更、離婚、矢筒作成、案内板NPC追加
(script/warp)
・warp_town、アリーナに対応
(script/gvg)、(save/castle.txt)
・SSで巻き戻ったev_agit_common、castle.txtを修正
(conf)
・mapflag追記
・map_athena新NPC追記と修正
(battle.c)
・NPCスキル 多段攻撃の攻撃力を25%→50%に修正

----------------------------------------
//1509 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1509
----------------------------------------
//1508 by 逆毛鰻

変更・追加箇所：
conf/map_athena.conf
doc/sqllogin.txt
script/sample/npc_original_romalia.txt
bcc32_consqlmake.bat

・SQLのススメの為の説明追加(thx Ricard氏)
・最新版を使用するサーバ及びプレイヤーへの救済の為の
　スキルポイント初期化サンプルＮＰＣ追加
　Winでのbtの報告のやり方はまた今度・・・

----------------------------------------
//1507 by ＡＡＡ
・月明りの下で　実装
・mob_can_moveに合奏,グラビテーションフィールド追加
・ウォールオブフォグ実装
・バイオレントゲイル上でFWを出すと持続時間が1.5倍になるように修正
・skill_unit_db.txt修正

----------------------------------------
//1506 by Blaze

・NPCスキル 属性攻撃の攻撃力計算を変更(battle.c)
　変更前）100%-125%-150&-175%-200%
　変更後）100%-175%-250&-325%-400%
・NPCスキル 多段攻撃の攻撃力計算を変更(battle.c)
　変更前）100%×HIT数
　変更後） 25%×HIT数
・warp 龍之城以降のwarp修正、おかしいwarp修正（時計塔2F、ハンターギルド等）
　コメントアウトにて旧ジュノーフィールドのwarp追加。

----------------------------------------
//1505 by End_of_exam

・特殊な条件下でヒドラが移動するバグを修正(unit.c)
・発動後のアンクルスネアをリムーブトラップ出来るバグを修正(skill.c)
・1504で1502の修正が巻き戻っていたのを戻す(skill.*)
・1502のskill_unitsettingでnullpo判定前にsrcを参照していたのを修正(skill.c)

----------------------------------------
//1504 by ＡＡＡ
・月明りの下で　はノックバックがあるので単独移動可でも移動できないように修正
・罠、スフィアーマインがPvP・GvGで無差別に効果があるように修正
・ランドマインのスタン時間修正
・skill_dbで設定できるのでGu1、Gu2、Glay、Gr、Gintr、Gtarget、Gflagを削除

----------------------------------------
//1503 by ルーチェ

・battle_conf に sole_concert_type を追加(#1)。
  単独合奏時の移動(#2)及びミュージカルストライク、矢撃ちの使用可否(#3)が設定できます。

  <conf/battle_athena.conf>
  //単独合奏可能時の設定 (player_skill_partner_check が yes なら無意味)
  // +1: 歌・踊りと同じように移動可能
  // +2: 歌・踊りと同じようにミュージカルストライク・矢撃ち使用可能
  sole_concert_type: 3

#1: battle.c [4119,4445]
    battle.h [239]
    conf/battle_athena.conf [502-505]
#2: clif.c   [7423-7441] clif_parse_WalkToXY
#3: unit.c   [801-818]   unit_skilluse_id2

----------------------------------------
//1502 by 甘栗

・1500でskill_unit_db.txtを付け忘れていたのでup
・skill_get_unit_系関数(interval,range,flag)を変更
　これによりGinterval、Grange、Gflagの効果が出るように
----------------------------------------
//1501 by ルーチェ

・私を拘束するなの移動可能範囲が不正だったバグを修正(#1)

#1: unit.c [225-226] unit_walktoxy_timer

----------------------------------------
//1500 by 甘栗

・地面設置系魔法の効果を通常時とシーズモードで
　変えられるように変更
・↑に伴いskill_unit_db.txtに
　Gu1、Gu2、Glay、Gr、Gintr、Gtarget、Gflagを追加
　効果はシーズモード時のスキル内容設定で
　設定方法等は同名の項目と同じ(現在はGtarget以外効果なし)
・skill_get_unit_target関数を変更
・create_arrow_db.txtを現在仕様に調整
----------------------------------------
//1499 by ＡＡＡ
・カウンター蹴りを修正
・テコン系が小型になっていたのを修正
・MAXHP/MAXSPがマイナスになる現象を修正
・MAXHP/MAXSPの上限チェックがなくなっていたのを修正

----------------------------------------
//1498 by 逆毛鰻

src/map/status.c
・　HP,SPが−値になると0ではなくMaxHP(Battleconf定義)
　になってしまうバグ修正(1年近く前のご隠居様が残した俺TUEEEE罠？を削除)
　(thx,Key ◆yZiFyq.UBg & End_of_exam)

----------------------------------------
//1497 by End_of_exam

・キャストキャンセルが出来なくなっていたバグを修正(unit.c)
・MOB 以外のクリティカルが出なくなっていたバグを修正(battle.c)
・linkdbにlinkdb_replace関数(重複を考慮した代入)を追加(db.*)
・1496の修正が汚なすぎたのを修正(map.h unit.c skill.c)
・Fix: カード補正効果がMOBの攻撃に効いていないバグを修正(battle.c)

----------------------------------------
//1496 by End_of_exam

・ストームガスト等のスキルが一人にしかヒットしないバグを修正(map.h skill.c unit.c)

----------------------------------------
//1495 by End_of_exam

・linkdb_delete() -> linkdb_erase() に名称変更(db.c skill.c)
・linkdb_final() のバグ修正(db.c)
・battle_config.enemy_criticalの設定が反映されていないバグを修正(battle.c)

----------------------------------------
//1494 by ＡＡＡ
・mobのAI修正
・特殊系AI(command,modechange)にディレイ追加
・グラヴィテーションフィールドの修正(昔に戻す)

----------------------------------------
//1493 by End_of_exam

・1490の警告を修正(mob.c)
・dbにリンクリストを追加(db.*)
・スキルユニット関連のメモリを動的に確保するように変更(skill.c 他)
・ペットスキルに場所指定スキルを実装(pet.c)

リンクリストdbについてですが、numdbよりも小規模のデータを扱うのに
適しています。高速化の為使い方にある種の癖があるので注意してください。
また、データが大規模になりそうな場合は、numdbの方が適しています。

----------------------------------------
//1492 ＡＡＡ
・mob.c修正

----------------------------------------
//1491 by tam

・商業値と防衛値の最低値を1に修正
・マスタールームの宝箱が部屋の外に出現する可能性がある問題を修正
・Readme1446の1489の修正点が消えていたので復活

script/npc/gvg/ev_agit_common.txt
save/castle.txt

castle.txtを置き換えると砦情報が初期化されます。
独自に修正する場合、左から3,4セルを1で埋めて下さい。
修正しない場合、現城主ギルドの砦破棄、ギルド解体、
または該当砦の落城時に、値が1に修正されます。

----------------------------------------
//1490 ＡＡＡ
・ターゲット：selfandslave 自分と取り巻きの削除
・ターゲット：master,command,modechange追加
・ステート: command　追加
　※命令専用スキルであることを明示的に表示(確率0%と同等)

// STATE: command
// ターゲット: master,command,modechange
// 条件: (条件タイプ)		(条件値は指定する値)
//	masterhpgtmaxrate	マスターのHPが指定％を超えていたら
//	masterhpltmaxrate	マスターのHPが指定％未満になったら
//	masterstatuson		マスターがステータス異常(条件値)に掛かっていたら
//	masterstatusoff		マスターがステータス異常(条件値)に掛かっていたら

ターゲット:
例 ＨＰ３０％を切ったら8%の確率で自分と取り巻きが爆裂状態になる
　 ※取り巻きにスキルを使わせたい場合は発動率0%の爆裂波動スキルを作ってください
1046,爆裂波動＠ドッペルゲンガー,attack,270,5,800,0,100000,no,command,myhpltmaxrate,30,group,7,self,0,,
1061,爆裂波動＠ナイトメア,command,270,5,0,0,100000,no,self,always,0,,,,,,
例２　ナイトメアに10%の確率でソウルストライクの一斉攻撃を命令
　　※命令相手が攻撃中の場合はそのターゲットに、待機状態なら命令主と同じターゲットにスキル攻撃(のはず)
1046,ソウルストライク命令＠ドッペルゲンガー,attack,13,10,1000,0,10000,no,command,always,0,slaves,7,target,7,,
1061,ソウルストライク＠ナイトメア,command,13,10,0,0,10000,no,target,always,0,,,,,,

commandについて
使用スキルはSKILL_ID
値1,値2,値3,値4,値5
命令対象,命令対象検索範囲,スキル対象,スキル対象検索範囲,未使用
命令対象 self,slave,slaves,friend,friends,group ※group=self+slaves
スキル対象 target,commander,master,self,slave,slaves,friend,friends

modechangeについて
SKILL_ID：未使用
値1,値2,値3,値4,値5
命令対象,命令対象検索範囲,変化後のmode,未使用,未使用
命令対象: self,slave,slaves,friend,friends,group
例:(時間適当)
1131,モードチェンジ＠ジョーカー,idle,0,0,500,0,30000,no,modechange,always,0,self,0,149,,,
1131,モードチェンジ(ルート)＠ジョーカー,idle,0,0,500,0,30000,no,modechange,always,0,self,0,151,,,

----------------------------------------
//1489 by End_of_exam

・アイスフォールを攻撃すると落ちるバグを修正
・MOB のリフレクトシールドのダメージが跳ね返らないバグを修正
・スキル関連のソース整理
　skill_attack を battle.c へ移動
　skill_encchant_*, skill_change_* をstatus.c へ移動
　skill_status_change_clear を status_change_clear に名前変更

----------------------------------------
//1488 ＡＡＡ
・グラヴィテーションフィールドの修正
・タロットカードの効果修正
・ヘルモードの杖修正(味方のみ魔法ダメージ無効に)

----------------------------------------
//1487 by ルーチェ

・battle_conf の ***_attack_attr_none が適用されていなかったバグを修正(#1)
・EDPにカードの効果が乗っていなかったバグを修正(#2)
・アジトの執事メニューで、[アジトを放棄する]を選んで最初の選択肢でキャンセルを選ぶとアジトが放棄されてしまうスクリプトミスを修正(#3)

#1: battle.c [188]          battle_attr_fix
    battle.c [761-767,2061] battle_calc_weapon_attack
#2: battle.c [1823]         battle_calc_weapon_attack
#3: script/npc/gvg/ev_agit_common.txt

----------------------------------------
//1486 ＡＡＡ
・チャット関係の修正
　チャットに多重参加できないように修正
　chat.cの31行目削除でチャット参加時チャットを作成できないようになります
　(更新していなかったら新しいパッチが出ていたので一応残しておきます)

----------------------------------------
//1485 逆毛鰻
fix2
　変更点　src/map/chat.c

　・例の鯖落とすバグ修正出来てません;;
　再現する環境と言うか方法が無い為、わかる方テストお願いします
　{同時に同じキャラIDを持つキャラを他人の立てたChatに同時にインさせる　別々だと無意味？}

　・露店を立てている時に他人のＣｈａｔへ入れないようにした。（露店立てる時に一緒に立てられないのが仕様のはずなので）
　・チャットに入っている時にチャットを作成しようとすると、チャットから出るようにした
　（増殖防ぐ為）　変更場所は2ヶ所。Ｄｉｆｆってください〜。

----------------------------------------
//1484 by End_of_exam

・スフィアマインが爆発しないバグを修正(status.c)
・MOB, PETの追尾処理を改善(mob.c, pet.c)
・MOBの一部スキルが発動しなくなっていたバグを修正(mob.c)
・MOBの思考ルーチンの整理、最適化(mob.* unit.c map.h)
・pc用の使用していない関数をpc.h から削除(pc.h)
・その他細かい箇所の整理

----------------------------------------
//1483 by ＡＡＡ
・ガンバンテイン実装
・グラヴィテーションフィールド実装
・ヘルモードの杖実装
・ヘルモードの杖関係のconf追加
・ガンバンテインとグラヴィテーションフィールドのDB修正

----------------------------------------
//1482 by Stinger

・スキルツリーにガンバンテインとグラヴィテーションフィールド追加

【内容変更】
skill_cast_db.txt
skill_db.txt
skill_require_db.txt
skill_tree.txt
skill_unit_db.txt

----------------------------------------
//1481 by ルーチェ

・ミュージカルストライク、矢撃ち、アローバルカンに矢の攻撃力が乗っていたバグを修正
・アローシャワー、シャープシューティングで敵の数だけ矢を消費していたバグを修正(#1)
・シャープシューティングがCRI+20の確率で対象のDEFを無視するように修正(#2)

#1: skill.c  [1291-1294] skill_attack
#2: battle.c [1780-1785] battle_calc_weapon_attack

----------------------------------------
//1480 by ＡＡＡ
・MOBのAI追加・修正
// 条件: (条件タイプ)		(条件値は指定する値)
//	targethpgt	攻撃対象のHPが指定を超えていたら
//	targethplt	攻撃対象のHPが指定未満になったら
・魂を自分に使用できないように修正(confで使用可能に)
・-pc_check_skillup()の見直しとそれに伴い必要なくなった関数削除
・status_change_startの魂チェックを削除(skillの方のみ)
・battle_athena.confの修正

----------------------------------------
//1479 by ＡＡＡ
・MOBのAI追加
※stoneは完全石化状態のみ反応するように修正しました 石化ー＞FBコンボ用？
※selfandslaveは現在自己支援系のみです
　一斉に速度増加・爆裂波動などで使ってください
　気が向いたら同じターゲットにスキル攻撃を追加するかもしれません

// ターゲット: selfandslave 自分と取り巻き
// 条件: (条件タイプ)		(条件値は指定する値)
//	targethpgtmaxrate	攻撃対象のHPが指定％を超えていたら
//	targethpltmaxrate	攻撃対象のHPが指定％未満になったら
//	targetstatuson		攻撃対象がステータス異常(条件値)に掛かっていたら
//	targetstatusoff		攻撃対象がステータス異常(条件値)に掛かっていたら
// statuson/statusoff系で条件値に指定することが出来る文字列
//	stone		石化(完全に石化した状態に変更)
//	lexaeterna	LA状態

例 ＨＰ３０％を切ったら8%の確立で自分と取り巻きが爆裂状態になる
　 ※取り巻きにスキルを使わせたい場合は発動率0%の爆裂波動スキルを作ってください
1046,爆裂波動＠ドッペルゲンガー,attack,270,5,800,0,100000,no,selfandslave,myhpltmaxrate,30,,,,,,
1061,爆裂波動＠ナイトメア,attack,270,5,0,0,100000,no,self,always,0,,,,,,

----------------------------------------
//1478 by End_of_exam

・とりあえず吹き飛ばしパケットとして以前のバックステップと同じ
　パケットを送信するように変更(clif.c)

　JTを食らった時（？）の位置補正パケットが無視されるっぽいので、
　蔵関係に詳しい方いたら修正お願いします。

----------------------------------------
//1477 by Romalia

　clif.c:
	・気になったところのみ更新
　map_athena.conf:
	・MAP追加
　mapflag.txt:
	・追記のみ
　battle_athena.conf:
	・player_damage_delay_rate: 10に変更。本鯖と何度比べても100ではなく、10か20だった為

	田園都市フィゲルが実装されたので傭兵システムもすぐですね
	時期が時期なのでアヨタヤコメントアウト削除
	どなたか放置されているドキュメントの更新をお願いします

----------------------------------------
//1476 by ルーチェ

・アローバルカンに矢の属性が乗っていなかったバグを修正(#1)
・マリオネットコントロール関連のバグ(下記参照)を修正(#2)
・私を拘束するなの効果が現れなかったバグを修正(#3)

  ※マリオネットコントロールのバグ
  ・自分にもかけられる
  ・複数人にかけられる
  ・他のスキル等による再計算が行われるまで効果が消えない

#1: battle.c [1644-1648] battle_calc_weapon_attack
#2: skill.c  [3391-3397] skill_castend_nodamage_id
    status.c [1463-1479] status_calc_pc
    status.c [4688]      status_change_end
    unit.c   [834-866]   unit_skilluse_id2
#3: clif.c   [7647]      clif_parse_ActionRequest
    unit.c   [219]       unit_walktoxy_timer
    unit.c   [1262]      unit_skilluse_pos2

----------------------------------------
//1475 by ルーチェ

・MOBが射程外からの攻撃に対して反撃スキルを使わなかったバグを修正(#1)
・1473での不必要なマクロ、コメントを削除

  反撃スキルですが、例えば
  「天下大将軍とシーフが攻撃し合っている裏からアコがホーリーライト」
  といった場合、 battle_conf の mob_changetarget_byskill の値に従って次のように動作します。
  ・mob_changetarget_byskill が "no" : シーフにアーススパイクで反撃(本鯖仕様＆デフォルト)
  ・mob_changetarget_byskill が "yes": アコにアーススパイクで反撃
  アコしかいない場合はもちろんアコに反撃します。

#1: battle.cの402行目〜419行目(battle_calc_damage関数)を修正しました。

----------------------------------------
//1474 by End_of_exam

・1472で入れた自キャラの吹き飛ばしパケットを削除
・走り高跳びのclif_fixpos 削除

　吹き飛ばしパケットですが、自キャラとその他で内容が違うらしく、
　他キャラ用のパケットを自キャラに送信すると残像が残るっぽいです。
　以前はキャラの吹き飛ばしに歩行パケットを使っていたようですが、
　距離が長くなると正常に移動出来ないようです。

----------------------------------------
//1473 by ルーチェ

・ミュージカルストライク、矢撃ちに矢の属性が乗っていなかったバグを修正
・スキルによる攻撃に左手の攻撃力が(二刀流でなくても)乗ってしまっていたバグを修正
・ニヨルドの宴の獲得経験値公式を現日鯖公式(Lv1毎に11％増加)に修正
・攻撃力UP系状態(イムポ等)の効果が左手に乗らないように修正
・攻撃力変化系状態時、左手攻撃力を右手攻撃力を基に計算していたバグを修正

ニヨルドの宴を旧仕様(Lv1毎に25％増加)にしたい場合、 pc.c の先頭行に、
#define _SC_RICHMANKIM_OLD
↑の行を追加してmakeし直して下さい。

攻撃力UP系状態の効果を左手にも乗せたい場合、 status.c の先頭行に、
#define _LEFTHAND_SC_ENABLE
↑の行を追加してmakeし直して下さい。

----------------------------------------
//1472 by End_of_exam

・残像バグを修正
・吹き飛ばしパケットの改善
・ペットの攻撃やスキルが対象移動で止まるバグを修正
・mob_timer, pet_timer関連の整理

----------------------------------------
//1471 by End_of_exam

・歩行中に死んだMOB が残像として残るバグを修正
・非アクティブモンスターから離れると攻撃が止まるバグを修正
・走り高飛びの前に方向転換を追加

----------------------------------------
//1470 by End_of_exam

・バックステップが正常に機能しないバグを修正
・三段拳やテコンの一部のスキルが自分に発動するバグを修正
・ダメージ計算式・クリティカル計算式が違うバグを修正

----------------------------------------
//1469 by ルーチェ

・MOBとペットの与ダメージ計算を修正

----------------------------------------
//1468 by End_of_exam

・位置補正パケット関連の修正
・スキルディレイ中に移動出来なかったバグを修正
・条件により取り巻きMOB の残像が残るバグを修正

----------------------------------------
//1467 by 雷折

・ソウルブレイカーでカタール研究が適応されていたのを修正
・右手修練、左手修練がスキルに適応されていたのを修正
・ミュージカルストライクで矢のATKが加算されていたのを修正
・シールドチェインのHIT補正の修正
・速度強化のFLEE上昇値が異常だったのを修正
・アシッドデモンストレーションの計算式を変更

----------------------------------------
//1466 by Sela

・スタンバッシュがレベル５以下でもスタンしたのを修正
・カートターミネーションのスタン計算式を変更
・コンセントレーションのHIT増加の計算式を変更
・トゥルーサイトのクリティカル増加の計算式を変更
・養子ノビのbase・jobの経験値が転生２次の数字を参照していたのを修正
・ソウルブレイカーで属性が物理判定以外にも影響してたのを修正

----------------------------------------
//1465 by End_of_exam

・ペットスキル実装
・ペットが支援攻撃しないバグを修正(battle.c)
・モンスターがクリティカル攻撃すると落ちるバグを修正(battle.c)

----------------------------------------
//1464 by End_of_exam

・ダメージ０が出ると場合によっては落ちるバグを修正(mob.c)
・MAP移動時にNPC等が表示されない可能性のあるバグを修正(unit.c)
・battle_calc_***_weapon_attack を整理(battle.c unit.c 他)

----------------------------------------
//1463 by End_of_exam

・罠を回収できない、IWにスキルを使えないバグを修正(unit.c)
・アシッドデモンストレーション等のスキルが使えないバグを修正(unit.c)

----------------------------------------
//1462 by End_of_exam

・一部スキルの吹き飛ばしパケットが違うのを修正(skill.c)
・攻撃処理の整理(unit.c battle.c 他)

----------------------------------------
//1461 by ＡＡＡ
・マヤパープルカード効果が正常になりました
・マヤパープルカード効果をPC以外にも対応
・必要の無い処理の見直し

----------------------------------------
//1460 by End_of_exam

・スキル使用処理を１つにまとめる(unit.c skill.c mob.c 他)
・1458で吹き飛ばし系スキルを使うと落ちるバグを修正(unit.c)

----------------------------------------
//1459 by Koara

・NPCを少々追加
　新フェイヨンNPC、案内板NPCの追記。

----------------------------------------
//1458 by End_of_exam

・1457の場所指定スキルのバグを修正(unit.c)
・歩行関連処理を１つにまとめる(unit.c 他)
・MOB が長時間歩かなくなる可能性があるバグを修正(mob.c)
・移動中の方向転換が不完全だったのを修正(旧pc.c)

----------------------------------------
//1457 by End_of_exam

・PC, MOB, PET他の共通部分をまとめるために、unit.* を追加(unit.c unit.h mob.c)
・BL関連のキャストがバグの原因になるかもしれないので、BL_CASTマクロを追加(map.h)
・bcc32 使用時の警告抑制オプションを最低限にして、警告を潰す
　　(bcc32_make.bat mmo.h clif.* date.* script.c ranking.* script.c status.c)

　BL_CASTマクロについてですが、block_list関連の悪夢を阻止するためのものです。
　使用を強制する訳では有りませんが、これによりバグ抑制効果があると思います。

  // 使用例
  void hoge( struct block_list* bl) {
      struct map_session_data *sd;
      struct pet_data *pd;
      if( BL_CAST( BL_PC, bl, sd ) ) {
          // bl is PC
      } else if( BL_CAST( BL_PC, bl, pd ) ) {
          // bl is PET
      }
  }

以下の修正はdiff見て気づいたやつだけなので、他にもバグが潜んでいる可能性があります。

・cmp_authfifo()内部でCMP_AUTHFIFO_LOGIN2判定が50%の確率で失敗するバグを修正(char.c login.c)
・領域制限中にCPU が100%になる事例があったので、該当部分をコメントアウトする(socket.c)
・デバッグ用の送受信したパケットを表示する部分の書き換えを忘れていたので修正(socket.c)
・httpd のソケットコントロールパネルのXSS 対策が実は不完全なままだったのを修正(socket.c)
・アクセスコントロールリストをクリアするとメモリリークが生じるバグを修正(socket.c)
・1411のログイン処理改善が不完全(マッチするものを全削除しないと効果無し)だったのを修正(login.c)
・clif_send_sub() 内部で落ちそうなのを修正(clif.c)
・clif_parse_BabyRequest() にPC以外のIDを渡すと落ちるバグを修正(clif.c)
・pc_check_noequip() が製造武器、製造アイテムを誤判定するバグを修正(pc.c)
・TXT: かなり古い形式のキャラログの読み込みに失敗するバグを修正(char.c)

----------------------------------------
//1456 by ＡＡＡ
・skill_tree.txt修正

----------------------------------------
//1455 by Koara
・NPCを少々追加
「npc_town_louyang.txt」
「npc_town_ayothaya.txt」
「npc_town_board.txt」
は新しいtxtです。
----------------------------------------
//1454 by ＡＡＡ
・ランダムアイテム系DBのバグ修正
　初期化されるはずのカウンタが初期化されておらず累計になっていたのを修正
・バグ報告板のDBを追加

----------------------------------------
//1453 by ＡＡＡ
・マヤパープルカード効果の残り実装
　MOBにも対応

----------------------------------------
//1452 by ＡＡＡ
・倒した敵にスキルを使用し鯖が落ちるのを修正

----------------------------------------
//1451 by ＡＡＡ
・MAPが落ちるのを修正?

----------------------------------------
//1450 by ID:7QLFJSM

・友達リストの勧誘のときに相手がログアウトしているとサーバーが落ちるバグ修正
・2005-09-06gRagexe jRO のパケットデータ追加

(src/map)
friend.c
	- friend_add_request() 修正
(db/)
packet.txt
	- 2005-09-06gRagexe jRO のパケットデータ追加

----------------------------------------
//1449 by ＡＡＡ
・ハイド・クローキング・チェイス中にターゲティングスキルの対象にならないように修正
　敵が昆虫、悪魔の場合は成功します…たぶん。
  SC_RaceDevilで種族変更などちょっと意味を付けていました。
　よく考えると種族変更って特にペナルティが無いな…。
・マヤパープルカード効果が実装されました。(取り合えずPCのみ)
　見つけることは出来てもスキル攻撃は仕掛けられません。
※一応ツール対策も講じてみました、流石に看破はされますがターゲティングスキルの対象にはならないはずです。
　なお設置系スキルの効果はハイド・クローキング・チェイスに準じます。

----------------------------------------
//1448 by ＡＡＡ
・SC_RACECLEAR
・SC_RESISTCLEAR修正

----------------------------------------
//1447 by ＡＡＡ
・MAX_STATUSCHANGE修正
・アサシンの魂修正

--------------------

//1446 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1446

----------------------------------------
//1445 by ＡＡＡ
・キーピング・バリアー修正
・リバース、NPCのディフェンダー実装
　リバースはMAX_HPの10*LV%で復活
　経験値は元もまま。(元々数倍のathenaだから別に半減しなくても…)
・ソウルリンカーのJOBが51まで上がったのを修正
・移動速度ポーション用？ 
  ※重複しないと思われるのでIA,DAの利用で増減はレベルの増減で対応
sc_start SC_INCREASEAGI,180000,-2; ３分間移動速度上昇
sc_start SC_DECREASEAGI,180000,2;  ３分間移動速度減少
・太陽と月と星の温もり　実装
・カウンター準備の修正
・楽しい休息修正
・状態変化・種族 実装(無形〜竜)
  ※種族ボーナスがあるわけじゃないですが…
・bonus bRace,n; 追加
・返魂のお札 実装（30分間不死種族に）
・レジストポーションの製造追加(db)
・レジストポーションの効果実装(水・土・火・風・毒・闇・聖・念・不死)
・エレメントコンバーター製造実装
・ファーマシーの基本計算式修正
・アルケミストのランキングポイントの取得方法
  pharmacy_get_point_type: 0
・item_dbの修正
　拡張一次の装備関係(未実装wikiより)

----------------------------------------
//1444 by ＡＡＡ
・スキルDB修正
・クローズコンファインの修正
・不死属性付与追加 アイテム用
・エルレメンタルチェンジ(聖・闇・念・毒・不死)追加
　スキルではなくアイテム用です。const.txt参照
　聖体はレベル１しかないので、聖属性を別途用意しました。
例：
  sc_start SC_WaterArmor,1,180000; 30分間水属性1
  sc_start SC_WaterArmor,2,180000; 30分間水属性2

補足
属性変化が出てきたのでついでに実装しました。
スキルで出てきた場合は割り当てるか、リネームをお願いします。

----------------------------------------
//1443 by ＡＡＡ
・エルレメンタルチェンジをクエストスキルに修正

----------------------------------------
//1442 by ＡＡＡ
・FA・BBの鷹所持判定をPCだけに修正
・FA・BBの鷹所持判定をskill_check_conditionにも追加
・走り高跳び中、敵のターゲットが外れてダメージを受けないように修正
　また、アイテム、スキルなどを使えないように修正
・駆け足中は接触型NPCに反応しないように修正
・魅惑のウィンク暫定実装
・エルレメンタルチェンジ（水・土・火・風）
・クローズコンファイン
※二次職のクエストスキルを使いたい人はmmo.hの#define MAX_SKILL 1020の方を使ってください
　skill_dbでコメントアウトしていないものは使えると思います

(src/map)
mob.h
mob.c
	mob_get_mode()追加

(余談)
mob_dataのmode使わないことがあるなんてそりゃないだろ…。

modeがshortで宣言されているのに8つしか指定しないなんて勿体無いから増やしませんか？
ボス属性だけ効かないから、ボスに効かないと出来るのにな。
ボスとMVPというフラグは欲しいところです。
追加ボスをソース埋め込みで対応させるのはどうでしょうね。
DBとの兼ね合いから勝手には増やせないか。

----------------------------------------
//1441 by yukito
・NPCとの会話中に取引を行うとキャラがスタックするバグを修正
(src/map)
	clif.c
		-clif_parse_TradeRequest()
	trade.c
		-trade_traderequest()
		-trade_tradeack()

----------------------------------------
//1440 by ＡＡＡ
・シャープネスシューティング使用に矢が消費されるように修正
・クリエーターのスキルツリーに斧の修練が２つあったのを修正
・バードとダンサーの魂状態時、自分に演奏効果があるように修正
・演奏時の移動速度修正(レッスン10で1/2)
・バードとダンサーの魂状態時、演奏時の移動速度増加(数値不明なのでぺナ無し？)
・ダブルキャスティングのボルト発動率が使用ボルトのレベル依存だったのを修正
・ダブルキャスティングが一定確立で失敗していたのを修正
・演奏・踊りのスキル効果を自分にも適用する
  allow_me_dance_effect: no
・合奏スキルの効果を自分にも適用する
  allow_me_concert_effect: no
・ニョルドの宴の取得JOBEXP上限チェック修正

----------------------------------------
//1439 by ID:7QLFJSM

・flooder 対策に受信帯域制限の機能をつけた（設定方法は socket.conf を）
	デフォルト設定は 1KB/s ですが、特に問題なく遊べると思います。
・httpd 使用時、httpd 以外の非認証タイムアウトがうまく動作しないバグ修正
・httpd でファイルが存在しないとき Precondition failed を返していたバグ修正

(conf/)
socket.conf
(doc/)
conf_ref.txt
(src/common)
socket.*
	- struct socket_data に帯域制限用のメンバ追加
	- recv_to_fifo() 他
httpd.c
	- httpd_send_file() 修正

----------------------------------------
//1438 by yukito
・召喚Mobのドロップ、経験値、MVPを設定可能に(conf_ref.txt参照)
　NPC_SUMMONSLAVEとNPC_SUMMONMONSTERで設定が別々になりました
・バーサーク中はDEF0+0/MDEF0+0状態になるように修正
・売買NPCとの取引にPCの状態チェック追加
・露店アイテムの購入時にPCの状態チェック追加
・取引中はカードの挿入ができないように修正(ItemDupe対策)
(conf)
	battle_athena.conf
(doc)
	conf_ref.txt
(src/map)
	battle.c
		-battle_config_read()
	battle.h
		-extern struct Battle_Config
	clif.c
		-clif_parse_NpcBuySellSelected()
		-clif_parse_NpcBuyListSend()
		-clif_parse_NpcSellListSend()
		-clif_parse_InsertCard()
	mob.c
		-mob_summonslave()
	status.c
		-status_calc_pc()
	vending.c
		-vending_purchasereq()

----------------------------------------
//1437 by ＡＡＡ
・警告つぶし
・バーサーク修正
・養子・テコン系(upper=2)のスキルが振れなかった問題を修正

----------------------------------------
//1436 by ＡＡＡ
・飛び蹴り修正
・カイナの向上効果を実装
・走り高跳びで赤エモにならないように修正(念を入れて)
・走り高跳び修正(かなり強引)
　※クライアント側で障害物判定を行っているようです、
　　無視するパケットがあるかも知れません…。
・駆け足の移動速度調整(ペコ程度)
　走り高跳びで壁超えできるようになったので修正しました。
・プロフェッサーが応急手当を覚えられなかったのを修正
・スキルツリーに新項目追加
・本鯖のリセットモード追加
  skillup_type: 0

----------------------------------------
//1435 by ＡＡＡ
・駆け足状態で赤エモにならないように修正
・カアヒ修正
・ソウルリンカーのスキル条件を変更できるように修正
soul_linker_battle_mode
soul_linker_battle_mode_ka
・演奏と踊りの再計算は外れていたのを修正
・アシッドデモンストレーションの巻き戻り修正
・スタン時間を修正　基本３秒？
・鯖落ちするので子守唄を使えないように修正(暫定処理)

----------------------------------------
//1434 by yukito
・取引中に装備解除ができなかったのを修正
・フェイヨンのPVPガイド、PVPドアマンの位置を新フェイヨン仕様に修正
(src/map)
	clif.c
		-clif_parse_UnequipItem()
(script/npc/etc)
	npc_etc_pvp.txt

----------------------------------------
//1433 by ＡＡＡ
・SQL関係の修正

----------------------------------------
//1432 by ＡＡＡ
・ベナムナイフ修正
・パンボイス修正
・シュリンク修正
・駆け足と同時にスパート状態開始(音的に恐らく同時)
　障害物で止まった場合スパート状態終了
　(すぐには駆け足を止めた場合スパート状態になる記述より)
・二次職のスキルツリー修正
　クエストスキル追加(コメントアウト)
※追加クエストスキルを使いたい人は
  common/mmo.h MAX_SKILL 1017
  とすれば一応使えます

----------------------------------------
//1431 by ＡＡＡ
・clif.cの警告つぶし
・カ系の使用条件追加
・準備と飛び蹴りがソウルリンカーで使用できないように修正
・エスマのSP消費量を修正
・落法の取得条件修正

----------------------------------------
//1430 by ＡＡＡ
・私を束縛しないで　実装

----------------------------------------
//1429 by huge
・mob_db.txtを読み込む際の不具合を修正
	(src/map/)
		mob.c

----------------------------------------
//1428 by ＡＡＡ
・GMのスキルツリーから結婚養子関係のスキル除外
・スキルで矢を消費するように修正
・養子スキル関係の鯖側のエラー潰し
・適当にPCのみ混乱実装
・expand_autospell削除
・baby_status_max追加
・baby_hp_rate追加
・baby_sp_rate追加
・baby_weight_rate追加
・no_emergency_call追加
・save_am_pharmacy_success追加
・save_all_ranking_point_when_logout追加

----------------------------------------
//1427 by t
・装備品ドロップレート判定が、新装備系列に
　対応していなかったので修正。
・雑談スレッド３ICOさん作、疑似本鯖仕様の
　confを同梱
mob.c
	mob_readdb()

----------------------------------------
//1426 by ＡＡＡ
・養子縁組実装
・セーブデータ構造の更新
・暫定的に養子コンパニオンを追加
・養子判定関数のリネーム
	-pc_isbaby()
	-pc_adoption();
	-pc_adoption_sub();

----------------------------------------
//1425 by ＡＡＡ
・宝石箱・明治アーモンド(ネタ自由に使おう)用txt追加
・スキル判定関数追加
skill.h
skill.c
	skill_cloneable()
	skill_upperskill()
	skill_mobskill()
	skill_abraskill()

----------------------------------------
//1424 by ＡＡＡ
・分からない矢筒、ギャンブル用にtxt追加
・item_arrow_quiver.txt,item_diamond_weapon.txt,item_diamond_armor.txt,
item_diamond_hood.txt,item_diamond_helm.txt,item_diamond_shoes.txt,
item_diamond_shield.txt 追加
・const.txtに追加
ARROW_QUIVER	-7
DIAMOND_WEAPON	-8
DIAMOND_ARMOR	-9
DIAMOND_HOOD	-10
DIAMOND_HELM	-11
DIAMOND_SHOES	-12
DIAMOND_SHIELD	-13

----------------------------------------
//1423 by t
・ディフェンダーの攻撃速度減少処理を書き換え
　（他のスキル同様aspd_rateでの仕様へ）
・ダブルキャスティングの巻戻り修正
	(src/map/)
		status.c
		skill.c

----------------------------------------
//1422 by huge
・オンラインでないギルドメンバーを脱退させた際に、他のメンバーへ通知がいかないかもしれない問題を修正
・npc_monster.txtでのmonster命令でもIDをチェックするように修正
・mob_db2.txt読み込み時、MOB名を入れないと消えてしまう問題を修正
・@reloaditemdbを使用した後に、ランダムアイテムDBが壊れる問題を修正
・db_ref.txtのmob_dbに関する記述の修正
・warning修正
・その他整理など
・ついでのversion更新
	(doc/)
		db_ref.txt 修正
	(src/common/)
		version.h
	(src/map/)
		clif.c
			clif_marionette() 不要な関数宣言削除
		guild.c
			guild_member_leaved() 修正
		itemdb.c
			各ランダムアイテムのカウント初期化を
			itemdb_read_randomitem() でやるよう修正
		mob.c
			MOB_ID_MAXは、mmo.hから読まれるので消し
			mob_readdb() 修正
		npc.c
			npc_parse_mob() 修正
		pc.c
			pc_check_noequip(),pc_bonus3(),pc_bonus4() NULLチェック
			pc_bonus4() warning消し
		pc.h
			pc_check_noequip() 追記
		script.c
			buildin_monster() 修正
		skill.c
			skill_use_id() NULLチェックと、breakし忘れ？を修正
			skill_marionette() ディボーションへ飛ぶようになってたのを、マリオネットへ
			skill_marionette2() warning消し
			skill_am_twilight_sub(),skill_am_twilight1() NULLチェック
			skill_am_twilight2(),skill_am_twilight3() NULLチェックと、warning消し
		skill.h
			skill_blown() 追記

----------------------------------------
//1421 by ＡＡＡ
・ベナムナイフ修正

----------------------------------------
//1420 by ＡＡＡ
・シャープネスシューティングのSP修正
・マリオネットコントロール？
　パケット分からないためディボの線利用

----------------------------------------
//1419 by Rohypnol
・item_noequip.txtで設定する装備不可能アイテムに、カードも設定できるように修正。
----------------------------------------
//1418 by ＡＡＡ
・buildin_monsterの修正
・ローグの魂のDA２倍をコメントアウト
・ガーディアン強化のATK増加量を修正(LV*1000)
・シュリンク
・ソニックアクセラレーション
・ベナムナイフ
・ファンタスミックアロー
・アンフェアリートリック
恐らく動くと思われますが、スキル番号不明で動作確認出来てません。

----------------------------------------
//1417 by Rohypnol
・mob_db.txt, mob_db2.txtの読み込み時にMVP EXP以降の項目が二項目とばして読み込まれていたのを修正。

----------------------------------------
//1416 by ＡＡＡ
・アイテムドロップに300ミリ秒のディレイを追加

----------------------------------------
//1415 by こう
・1397で追加されてるトマホーク投げがdbから消えているのを修正。
・カートターミネーションもdbから消えているので暫定的に実装当初のに戻し。
  skill_require_db.txt
  skill_db.txt

----------------------------------------
//1414 by ＡＡＡ
・アルケミストのポイント計算方法を追加
  alchemist_point_type: 1
・トワイライトファーマシーのPT条件をチェックするか
  twilight_party_check: yes
・カイゼル修正
・カイト修正
・バーサークピッチャー修正

----------------------------------------
//1413 by ＡＡＡ
・プロボックが失敗した場合のスキル仕様失敗メッセージ追加
・トワイライトファーマシーの暫定実装
・ランドプロテクター上でテレポート出来ないように修正
・AthenaDevのDevForumに投げ込まれていた物を追加

----------------------------------------
//1412 by ＡＡＡ
・バーサークピッチャー
　トワイライトファーマシー
　ビーストストレイフィング
　フルアドレナリンラッシュ
　ワンハンドクイッケン
　の使用条件の魂削除
・バーサークピッチャー
　トワイライトファーマシー
　ビーストストレイフィング
　フルアドレナリンラッシュ
　ワンハンドクイッケン
　演奏と踊り(リンク用)
　はソースにスキルツリーを埋め込みました
　魂状態の時にスキルツリーに現れます
　※カードスキルとして追加、また覚えるスキルのスキルレベルが０の場合のみ覚えます
・ビーストストレイフィング　追加
　ダブルストレイフィングの後に対象が動物の場合のみ追加で使えます
　ダメージ公式が謎なのでダブルストレイフィングと同じに設定
・skill_tree.txtの修正
・skill_cast_db.txtの修正
・skill_require_db.txtの修正
・skill_db.txtの修正

----------------------------------------
//1411 by yukito
・login.cとchar.cのAUTH_FIFO_SIZEをmmo.hに移動
・ログイン処理の改善(バグ報告スレ4[79] Rayce氏報告分を修正)

(src/common)
mmo.h
(src/char)
char.c
char.h
(src/login)
login.c
	-cmp_authfifo()
	-parse_fromchar()
	-parse_login()

----------------------------------------
//1410 by Nameless

新型CPU (AMD 64x2 / SanDiegoコア)によりCPU命令セットが変わったようなので
-vi  インライン展開有効。
-tWM  マルチスレッド対応。
以上のオプションを該当CPUに補強

以下、HTTPDの影響で使用不可になってしまったコンパイルオプションを除去
-po  fastthis 呼出規約を使う。（C++ の this ポインタをレジスタで渡す）  
-pr  fastcall 呼出規約 (__fastcall) を使う。（引数をレジスタで渡す） 

※Intel系でCeleron 331以上を利用している方は"Pentium4X"を
※AMD系でVeniceコアより新しいモノを使っている人は"Athlon_X"を利用すると
サーバーに掛かる負荷を40〜50%軽減することが出来るようです。

	(/)
	bcc32_make.bat

----------------------------------------
//1409 by ＡＡＡ
・飛び蹴りの追加効果
・飛び蹴り解除用にバーサークピッチャーの状態変更
　SC_SPEEDPOTION2->SC_SPEEDPOTION3
・太陽と月と星の奇跡　追加(発動条件不明のため効果のみ)
・オートスペルを調整
・bonus4 bAutoSpell追加
・equip_autospell_nocost削除

----------------------------------------
//1408 by ＡＡＡ
・新仕様の属性場実装

----------------------------------------
//1407 by t
・ダブルキャスティングが巻戻っていたのを修正

----------------------------------------
//1406 by huge
・GCCやVC++でwarningが出ていた箇所を修正。
・/resetstate /resetskill が、制限無く使えていたのを修正。
・上の関係で、@resetstate / @resetskill を追加。
・@charjobで追加職を指定すると、鯖が落ちるのを修正。
・mob.cで、扱うMOB_IDの最大値をdefineで指定できるように修正。
・mob_db.txtの仕様変更。
	※使われていないItem1,Item2を削除し、Drop9,Card枠を新規に追加。つまりeAthena方式。
	   今までのをそのまま使用すると、MVP MOBに影響が出ます。
	※添付したmob_dbは、http://www.usamimi.info/~huge/にて編集を行っているDBの、jRO基準のを入れました。
・mob_db2.txtの扱いを変更
	※記述のある部分のみ書き換えるように。空白の場合は0にせず、mob_db.txtで読んだ時の値を使います。
・confで敵のドロップ率を0にしていた時にスティールすると鯖が落ちる問題を修正。(thx Rayceさん)
・練気功で溜めた気がタイマーで消えないのを修正。(timerは怖くて弄れないから誤魔化し；)
・指定キャラの居るマップ名を取得するスクリプトを追加。	getmapname("キャラ名");自分の名前は、strcharinfo(0)で。
	これを使って、指定マップのみのアイテム使用可否の設定もできそう。
・scriptの、killmonsterの範囲版をとりあえずで実装。
	areakillmonster <gatname>,x0,y0,x1,y1;
	gatnameにはマップ名を。x0,y0座標を中心に、x1,y1の範囲に居るmobを殲滅します。eventは指定できません。
・0x021dパケットに対する無反応。
・いくつかのNULLチェック。
・余計そうなTabやスペースなどの整理。
・前に自分で書いたbattle_athena.confのmvp_announceの説明文が恥ずかしいから修正。
・ついでにversion更新。

	(conf/)
		atcommand_athena.conf
		battle_athena.conf
	(db/)
		packet_db.txt
		mob_db.txt
	(doc/)
		script_ref.txt
弄った箇所が多いので、変更ファイル名のみ
	(src/common/)
		version.h
	(src/map/)
		atcommand.c
		atcommand.h
		battle.c
		clif.c
		friend.c
		guild.c
		map.c
		mob.c
		mob.h
		npc.c
		party.c
		pc.c
		ranking.c
		script.c
		skill.c
		vending.c

----------------------------------------
//1405 by ＡＡＡ
・駆け足　実装
  スパーク状態のアイコン実装(暫定)

----------------------------------------
//1404 by    
・warningの修正

----------------------------------------
//1403 by ＡＡＡ
・ランキング関係の関数整理

----------------------------------------
//1402 by ＡＡＡ
・「オートバーサーク！」が消えていたのを修正
・アルケミストのランキング実装
・ブラックスミスのランカーボーナス実装

----------------------------------------
//1401-fix by t
・下段効果修正。
・変更点の無いファイル(skill.h）が混ざっていたのを削除

・ダブルキャスティングの対象が３種ボルト系のみになるよう修正
・ライディングの所持重量増加判定をペコ騎乗時に移動
・オーラブレードの判定移動（とりあえずクリティカルでも適用しただけ）
・テコン旋風と下段効果追加（詳細不明に付き暫定）
・BBが2HIT
・その他細かい修正
・スキルツリーの修正
・スキル持続時間修正

AAAさん割り込み失礼します。
BCC環境でのみコンパイル確認。cygwinの方に申し訳ないが…。

----------------------------------------
//1400 by ＡＡＡ
・@skillall/@allskillで 太陽と月と星の悪魔を覚えないように修正
・オートバーサークのアイコン追加
・エスマ　LV10だった場合のみ(40+BaseLv)%×10発になるように修正
・スキルツリーの修正
・ランキング仮実装 ブラックスミス,アルケミスト,テコンランカー
　ポイントが上がるのはブラックスミスのみ
・atcommandをいくつか追加
ranking
blacksmith
alchemist
taekwon
resetfeel
resethate

----------------------------------------
//1399 by ＡＡＡ
・混乱を避けるために拳聖2が使えないように修正(huge氏のDBに合わせて)
・魂状態追加(画面が青っぽくなる)
・暖かい風のアイコン追加と修正
・太陽と月と星の悪魔の増加ASPD修正 Lv5で171->176らしいので4*lv%増加？
・太陽と月と星の悪魔のペナルティ実装
・オートバーサークがON・OFFできるように修正
・[エスマ]
ダメージ公式がキャラクターレベルに影響を受けるように修正されます。
レベル10エスマの場合既存では100%×10発だったものが
(40+BaseLv)%×10発に変わるようになります。
・[カイナ]
レベルが70以上になればカイナスキルレベル1当たりエスティン、エストン、エスマの
SP消費量が3％ずつ減るようになります。(マスター時21%減少)
レベル80以上になれば5％ずつ減って(マスター時35%)
レベル90以上になれば7％ずつ減ります。(マスター時49%)
・すべての"霊魂"系列スキル使用直後3秒間エスマキャスティング可能状態になります。
・[カイゼル]
　復活した後、10秒間キリエエレイソン状態が維持された部分が3秒間維持されるように修正されます。
・[太陽と月と星の融合]
覚醒状態で人を攻撃すれば10％ずつHPが減った部分が8％ずつ減るように修正されます。
・[落法]
スパート状態である時は遠距離物理攻撃以外の攻撃にも反応をするようになります。
(スパート状態：駆け足スキルを使用した時STRが上昇される状態)

----------------------------------------
//1398 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1398
----------------------------------------
//1397 by anoym
・ダブルキャスティング修正
・トマホーク投げ実装
・カートターミネーションのスタン時間修正
・イドゥンの林檎の回復量修正

battle.c
	トマホーク投げのフラグ追加 LONG
skill.c
	- skill_castend_nodamage_id()
	- int skill_attack()
	- int skill_additional_effect()
	- int skill_idun_heal()
	- int do_init_skill()
	ダブルキャスティング用のディレイ関数追加
	- int skill_castend_delay ()
	- int skill_castend_delay_sub ()
skill.h
	トマホーク投げの追加
	ITM_TOMAHAWK = 337
item_db.txt
	1368,トマホーク修正
skill_db.txt
skill_require_db.txt
	トマホーク投げ追加

----------------------------------------
//1396 by ＡＡＡ
・アイコン修正

----------------------------------------
//1395 by ＡＡＡ
>[86] Re:バグ報告スレッド４
の警告つぶし
・魔力増幅のアイコンを勘違いしていたようです
　属性場に修正
・その他のアイコンをいくつか追加修正
・ダブルキャスティング　追加

----------------------------------------
//1394 by ＡＡＡ
・魔力増幅のアイコンが出るように修正
・128以降のアイコンが出るように修正(甘栗さんに感謝)
・オーバートラストマックスを修正

※SC_XXXの追加に関して
　アイコンを出るようにするためにSI_XXX系を追加しました(Skill.h)
  アイコンがある場合はSI_XXXの追加をお願いします。
  skill.cにはStatusIconChangeTable[]を追加しています。
　これはSC_XXX -> SI_XXXに変換するためのものです。(スキル->SC_XXXのようなもの)
　こちらにもアイコンや見た目が変わる場合は追加してください。

余談
　今は新方式(SC_XXX=>SI_XXX)と旧方式(SC_XXX == SI_XXX)を混ぜて使っています。
　これが移行できれば 128までの使っていない分(50近く)を利用できるのですけどね。
　数メガのメモリ消費が減るらしいが…労力に見合わないかもしれない。

----------------------------------------
//1393 by BBB
ジプシー＆クラウンの運命のタロットカードが
アシッドデモンストレーションになっていたバグを修正。

----------------------------------------
//1392 by ＡＡＡ
・スクリプトのjobchangeに追加職対応
・サンプル転職NPC添付
・アシッドデモンストレーション
このスクリプトで出来ないのならよくMakeを見ること
2005-08-23aSakexeは付属の2005-06-28aSakexeで動いています

----------------------------------------
//1391 by ＡＡＡ
@icon 数字 数字 状態アイコンの表示/非表示(デバック用)
状態アイコンが不明なのばかりなので調べるために追加
wikiなどに追加されることを願う

----------------------------------------
//1390 by ＡＡＡ
・追加職の養子補正を修正
・養子(親判定無し)と転生判定関数追加
int pc_isupper(struct map_session_data *sd)
int pc_isadoptee(struct map_session_data *sd)

----------------------------------------
//1389 by saga
item_db.txt
・新カード組み合わせ効果実装
（カニカード、お化け貝カード、ヒトデカードの組み合わせは暫定処理）
（暴雨の箱などのドロップも設定されています。data.grfにデータがない方は注意してください。）
・最新頭装備の一部グラフィック設定
・神器組み合わせ実装
・料理実装
・データ追加
※アコライトを除く〜などのテコン系装備可、不可は保留

----------------------------------------
//1388 by ＡＡＡ
item_db.txt
全職業装備可能を置換
(doc)
db_ref.txt
テコン		:16777216
拳聖１		:33554432
拳聖２		:67108864
ソウルリンカー	:134217728
全職業装備可能	:262135807

----------------------------------------
//1387 by yukito
・Mobを11セル以上離れた位置から弓などで遠距離攻撃をした時に
　攻撃したPCがターゲットされないバグを修正(バグ報告スレ4[50] sbr氏thx!)
※1363でMobのワープ防止を施した際のエンバグです。ご迷惑をおかけしました。
(src/map)
mob.c
	-mob_can_reach()

----------------------------------------
//1386 by ＡＡＡ
・太陽と月と星の友達  三段掌の発動率修正
・太陽と月と星の日の判定を追加(conf)
・exp.txt修正　ソウルリンカーのJOBEXP追加(転生２次と同じ？)
・pc_nextbaseexp
・pc_nextjobexp　に新職の判定を追加
		BASE	JOB
テコン		一次職	一次職
ケンセイ	一次職	二次職
ソウルリンカー　一次職	転生二次職
・養子のEXP/JOBが転生二次になっていたのを修正
・pc_calc_base_classを修正
・転生前<->養子でJOBが維持されるように変更

----------------------------------------
//1385 by ＡＡＡ
・暖かな風	修正
・エスティン	追加
・エスタン	追加
・エスマ	追加
・落法		修正
・飛び蹴り	追加
・太陽と月と星の友達の効果実装
・安らかな休息 	追加
・楽しい休息 	追加
・ファイティング 追加
・太陽と月と星の知識の場所判定追加(やらない方が良いかも)
・太陽の祝福	追加
・月の祝福	追加
・星の祝福	追加

----------------------------------------
//1384 by ＡＡＡ
・スキルツリーが正しく表示されるように修正
----------------------------------------
//1383 by ＡＡＡ
・IWバグ修正
・ワンハンドクイッケン追加
・いくつかスキル修正
・make修正
以下をDBに追加
・一次上位職業の魂
・ワンハンドクイッケン
・トワイライトファーマシー1
・トワイライトファーマシー2
・トワイライトファーマシー3

----------------------------------------
//1382 by End_of_exam

1301辺りにある既知のバグの修正＋αです。それ以降の修正部分については、
協力してくれるサーバーのバージョンが古いので、特に調査等はしていません。

・@whoでオフラインキャラが表示される可能性のあるバグを修正(char.c)
・ギルド作成後すぐにマップサーバー間を移動するとギルドが消えるバグを修正(int_guild.c)
・db_foreach中に同じキーを２回erase すると落ちるバグを修正(db.c)
・VC++用のプロジェクトに friend.* が抜けていたので追加する(map.dsp)
・attr_fix.txtを読み込み後に閉じ忘れていたバグを修正(pc.c)
・タイマーが49.7日周期で正常に動作しなくなるバグを修正(timer.c)
・socket.c にgcc の警告が出てたのを修正(socket.c)
・SQL: 倉庫データのキャッシュ処理を追加(int_storage.c)
・SQL: 添付のコンバーターのバグを修正(char-converter.c thanks to exileさん)

----------------------------------------
//1381 by ＡＡＡ
・旋風蹴り　を追加
・下段蹴り　を追加
・回転蹴り　を追加
・カウンター蹴り　を追加
・落法　修正

----------------------------------------
//1380 by ＡＡＡ
・暖かい風修正
・IWバグ修正
・クァグマイアの修正(GvGで味方にも)
----------------------------------------
//1379 by yukito
・露店・取引・NPC対話の最中はペコ・鷹・カートが外せないように修正
(src/map)
clif.c
	-clif_parse_RemoveOption()

----------------------------------------
//1378 by yukito
・取引要請したあと相手がOKもCancelも押さないでいると
　リログかマップ移動するまで他の人に取引要請ができなかった不具合を修正
・取引ウィンドゥに入れたアイテムやZenyがtradeを押した時点で不足または存在しない時は
　取引が自動的にキャンセルされるように修正(ItemDUPE/ZenyDUPE対策)
(src/map)
trade.c
	-trade_traderequest()
	-trade_tradecommit()

----------------------------------------
//1377 by ＡＡＡ
・旋風準備	  を追加
・下段準備	  を追加
・回転準備	  を追加
・カウンター準備  を追加
・落法	  を追加
・カイト　を追加
メンテの修正
・バーサクピッチャー　アイテム消費数と持続時間を修正
・カウプ修正
・プーリストの魂 SP消費修正
・ローグの魂　	ディスペルの対象にならない
		STRが向上する状態が5分間維持
・太陽と月と星の融合　ペナルティ修正
・エスマの修正
・エスクの修正

----------------------------------------
//1376 by ＡＡＡ
・ペットのASPDが増加していた減少を修正
・暖かい風　を追加
・星の怒りを修正
・太陽と月と星の友達　を追加
・太陽と月と星の知識　を追加
・カイゼル　を追加
・カアヒ　を追加
・カウプ　を追加
・エスウ　を追加
・エスク　を追加
・エスカ　を追加

----------------------------------------
//1375 by ＡＡＡ
・〜の魂…状態変化を表示するように修正
・太陽と月と星の感情
・太陽と月と星の憎悪
・太陽の怒り
・月の怒り
・星の怒り
・太陽の安楽
・月の安楽
・星の安楽
※感情と憎悪は保存していません

----------------------------------------
//1374 by yukito
・取引要請の距離チェックのバグ修正
(src/map)
trade.c
	-trade_traderequest()
	-trade_tradeack()

----------------------------------------
//1373 by yukito
・VCでwarningが出ていたのを修正(バグ報告スレ4[51] anoym氏thx!)
（vending.cの方は1372でＡＡＡ氏が修正して下さっています。ありがとうございました）

(src/map)
battle.c
	-battle_calc_misc_attack()

----------------------------------------
//1372 by ＡＡＡ
・バーサクピッチャー
・フルアドレナリンラッシュ
※魂状態のみ使用可能
　普通にツリーに追加したほうが安全だと思われる。
　魂状態で現れるようにしてもよいがスキルポイント増加バグが出そうで保留
　(サクライでどういう扱われ方しているかも不明なので…)
・アルケミの魂
・スパノビの魂…斧が装備できなかったのと、
		死亡カウンタを一時的に０にする条件にレベルが無かったのを修正
・ブラックスミスの魂
・カイナ…MAX SPの増加のみ

----------------------------------------
//1371 by ＡＡＡ
・スパイダーウェブ…エンペ無効に修正
・食事用に以下を追加
SC_MSTR,SC_MAGI,SC_MVIT,SC_MINT,SC_MDEX,SC_MLUK
例:20分間STRを10上昇
sc_start SC_MSTR,120000,10;
(src)
skill.h
skill.c
map.h
pc.c
clif.c
battle.h
battle.c
status.c

(db)
const.txt
skill_db.txt
skill_cast_db.txt
skill_require_db.txt

(仮実装)
未実装wikiを参考に実装
不明な点多くてあてにならないです。

太陽と月と星の感情(ログイン毎に場所初期化中)
太陽と月と星の悪魔(暗闇ペナルティ未実装)
太陽と月と星の融合
//アルケミストの魂
モンクの魂…爆裂波動状態時もSPを回復のみ
ケンセイの魂
セージの魂
クルセイダーの魂
スーパーノービスの魂
//ナイトの魂
ウィザードの魂
プリーストの魂
//バードとダンサーの魂
ローグの魂…DA２倍のみ。
アサシンの魂…威力UPのみ。
//ブラックスミスの魂
ハンターの魂
//ソウルリンカーの魂
----------------------------------------
//1370 by yukito

・1369の暫定パッチを巻き戻し(倉庫と取引の不具合のため)
・ブラッドアックス、ウィングオブイーグル、月夜花カードの効果が重複しないように変更
・村正の呪いのみ、LUK＞BaseLvで呪い耐性100%になるように修正
・ファルコンアサルトのスキルレベルごとのダメージ値を修正
・鷹を連れていなくてもブリッツビート、ファルコンアサルトが使用できていたのを修正
・カートを付けていなくても露店開設スキルが使用できていたのを修正
・バーサーク中にアイテムが拾えなかったのを修正、およびDEF0、MDEF0になるように修正
・ボルケーノが正常に適用されていなかったのを修正(バグ報告スレ4[47] Zart氏報告分)
・石化進行中にアイテムが使用できなかったのを修正
・取引要請の距離チェックが機能していなかったのを修正、およびチェック強化
・取引中に所持金が減少すると、取引完了後に所持金が負の値になっていたのを修正(ZenyDUPE対策)
・取引窓が出ている状態では、アイテムを移動したり露店を開いたりできないように修正(ItemDUPE対策)
・露店を出している状態では、取引を要請したり露店を開いたりできないように修正(ItemDUPE対策)

(src/map)
battle.c
	-battle_calc_misc_attack()
clif.c
	-clif_parse_WalkToXY()
	-clif_parse_TakeItem()
	-clif_parse_DropItem()
	-clif_parse_UseItem()
	-clif_parse_EquipItem()
	-clif_parse_UnequipItem()
	-clif_parse_NpcClicked()
	-clif_parse_TradeRequest()
	-clif_parse_PutItemToCart()
	-clif_parse_GetItemFromCart()
	-clif_parse_MoveToKafra()
	-clif_parse_MoveFromKafra()
	-clif_parse_MoveToKafraFromCart()
	-clif_parse_MoveFromKafraToCart()
map.h
	-map_session_data
pc.c
	-pc_authok()
skill.c
	-skill_castend_damage_id()
	-skill_castend_nodamage_id()
status.c
	-status_calc_pc()
	-status_change_start()
trade.c
	-trade_traderequest()
	-trade_tradeack()
	-trade_tradecancel()
	-trade_tradecommit()
vending.c
	-vending_vendinglistreq()
	-vending_purchasereq()
	-vending_openvending()
(db)
item_db.txt

----------------------------------------
//1369 by (´ω｀)ヘモヘモ ◆2nOUodv7fI

・Storageを利用したitemdupeに暫定的な対応(あくまでざんてい的です)
・Zenyを無限に生産出来てしまうバグを修正('ω` )
・露店や他DUPEには未対応です(´ω｀)ヘモー

(src/map)
storage.c
trade.c

----------------------------------------
//1368 by ID:7QLFJSM

・タイムアウトした場合、アクセス違反する可能性があるバグをたぶん修正 ( thx to anoym )
・mob.c の不要なトークン連結子を削除 ( thx to ID:RIl4uoc )

(src/common)
socket.c
	- do_parsepacket() 修正
(src/map)
mob.c
	- mob_readdb() の SETRATE2 マクロ修正

----------------------------------------
//1367 by yukito

・デスペナ処理のバグ修正
(src/map)
clif.c
	-clif_parse_Restart()
pc.c
	-pc_makesavestatus()

----------------------------------------
//1366 by ID:7QLFJSM

・item_rate_details がうまく動かないバグをおそらく修正
・map.c の使用していない変数の警告が出ないように修正
・packet_db に日蔵 2005-08-02bRagexe のパケット追加
・battle_athena.conf の pet0078_hair_id を日蔵 2005-08-02bRagexe 用にした

(db)
packet_db.txt
	- 2005-08-02bRagexe jRO のパケットデータ追加
(conf)
battle_athena.conf
	- pet0078_hair_id の値を変更
(doc)
conf_ref.txt
	- pet0078_hair_id 追加
(src/map)
mob.c
	- mob_readdb() 修正
map.c
	- map_quit() 修正

----------------------------------------
//1365 by yukito

・ローグスキル「クローンスキル」で覚えたスキルが保存されるように修正
・死んだ後リスタート時にデスペナが適用になる設定の時に
　死亡->キャラセレ->ログインとするとデスペナ適用にならなかったのを修正
(src/map)
map.c
	-map_quit()
pc.c
	-pc_makesavestatus()

----------------------------------------
//1364 by ID:7QLFJSM

・最新日蔵でペットが移動すると、蔵がペットを mob として認識してしまう問題を修正
	旧蔵の人は設定の変更が必要です。
	battle_athena.conf の pet0078_hair_id を蔵に合う値に設定してください。
	日蔵の 2005-05-09eRagexe や、それ以前では 20 でいいはずです。
	日蔵の 2005-07-12bRagexe では 24 です。
	その他の日蔵や韓蔵、桜井蔵については未調査です。( 1366 で修正)

(conf)
battle_athena.conf
	- pet0078_hair_id 追加
(src/map)
clif.c
	- clif_pet0078(), clif_pet007b() 修正
battle.*
	- struct Battle_Config に pet0078_hair_id 追加
	- battle_config_read() 修正

----------------------------------------
//1363 by yukito
・地形の形状によってはMobがワープしていたのを修正(質問スレ2の104〜107の情報を反映)
・アクティブなMobがPCをターゲッティングする距離が短かったのを修正
・ウィザードスキル「サイトラッシャー」の効果範囲を15x15に修正
・スキルの射程設定が大部分のスキルに於いて間違っていたのを修正
(src/map)
mob.c
	-mob_can_reach()
skill.c
	-skill_castend_damage_id()
(db)
skill_db.txt
	-range修正

----------------------------------------
//1362 by ID:7QLFJSM

・友達リストの sql 部分実装
	（txt を使用している場合は関係ありません）
	・SQL のテーブルを更新するため、sql-files/1362_changetable.sql を
	　実行してください。
	・SQL は詳しくないので、変な部分があるかもしれません。
	　変な部分を見つけたら修正よろしくお願いします。

・友達リストをサーバー側で管理するかどうかを決められるように修正
	・battle_athena.conf の serverside_friendlist で設定します。
	・友達リストを蔵側で管理する古い蔵などでは no に設定してください。

・socket.conf の debug を off に修正
	・1354 で on にしたファイルをアップしてしまっていたので。

(src/char)
char.c
	- friend_db 変数追加
	- char_sql_load(), char_sql_save(), char_sql_delete_sub() 修正
(src/map)
battle.*
	- struct Battle_Config に serverside_friendlist 追加
	- battle_config_read() 修正
friend.c
	- battle_config.serverside_friendlist を調べるように修正
(sql-files)
1362_changetable.sql
	- 新規ファイル。1361 以前の友達リストのテーブルを更新する
main.sql
	- 友達リスト部分を更新
(conf)
battle_athena.conf
	- serverside_friendlist 追加
socket.conf
	- debug が on になっていたのを修正
(doc)
conf_ref.txt
	- serverside_friendlist 追加

----------------------------------------
//1361 by パンダ屋本店

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1361
----------------------------------------
//1360 by ＡＡＡ
・ギルドスキル関係のバグを修正
・運命のタロットカードを一部適当に実装
  ※確率はどれも一緒
　　演出は適当
　　ペナルティ効果の重複もなし
    (強い効果だけ残る Sun と Magician なら atk 50% matk 20% def 20%…)

battle.h
battle.c
pc.c
	-pc_check_guild_skill_effective_range()
skill.h
skill.c
	-skill_castend_damage_id()
	-skill_tarot_card_of_fate()
status.c
	-status_calc_pc()
	-status_get_atk()
	-status_get_atk2()
	-status_get_matk1()
	-status_get_matk2()
	-status_get_hit()
	-status_get_flee()
	-status_get_def()
	-status_get_def2()
	-status_change_start()
	-status_change_end()
(db)
skill_db
skill_require_db
skill_caset_db
----------------------------------------
//1359 by ＡＡＡ
・毒薬の瓶の効果時間を修正
・1356 atcommand.cを入れ忘れていたので追加
・密集地帯でのギルドスキル計算量減少と動作修正
  範囲内だった場合計算していたのを、変化があった時のみに修正
・偉大なる指導力,栄光の傷,冷静な心,鋭い視線の有効範囲
//(0:個別設定(SKILL_DB) 1:3*3 2:5*5 …)
//レベル毎に拡大させるなら0にしてskill_db.txtで設定
guild_skill_effective_range: 2

(src/map)
atcommand.c
	-atcommand_econ()
battle.h
battle.c
	-battle_config_read()
map.h
status.c
	-status_change_start()
guild.c
	-guild_send_memberinfoshort()
	-guild_recv_memberinfoshort()
pc.h
pc.c
	-pc_setnewpc()
	-pc_walk()
	-pc_check_guild_skill_effective_range()
(db)
item_db.txt
----------------------------------------
//1358 by トリガー
・version.hの更新。
・BCCとVCでのwarningに少し対処。
 問題があるポインタの変換の修正
 (src/common)
	socket.c	-connect_client()
			-make_listen_port()
			-make_connection()
 初期化されていない可能性がある変数の修正
 (src/map)
	pc.c		-pc_statusup()
 関数定義の矛盾を修正。
 (src/map)
	clif.c		-clif_friend_send_online()
			-clif_friend_add_ack()
	clif.h		-clif_friend_send_online()
			-clif_friend_add_ack()
 戻り値を定義
 (src/common)
	atcommand.c	-atcommand_mapexit()
 プロトタイプ宣言の修正
 (src/char)
	char.c
	inter.c
	inter.h
 (src/common)
	core.c
	grfio.c
	mmo.h
 (src/map)
	guild.c
	itemdb.c
	npc.c
	pet.h
	script.c
	script.h
----------------------------------------
//1357 by yukito
・聖体降福の不死判定にbattle_athena.confのundead_detect_typeが適用されていなかったのを修正
・不死が凍結・石化しない判定を、種族と属性の両方が対象となるように修正
(src/map)
skill.c
	-skill_castend_damage_id()
status.c
	-status_change_start()
----------------------------------------
//1356 by ＡＡＡ
・@econが正常に動作していなかったのを修正
・少し判定の追加と変更
・ギルド追放要求の判定がマスターだったのを対象に変更
・スパイラルピアースを遠距離に変更
(src/map)
battle.c
status.c
script.c
	-buildin_monster()
skill.c
	-GetSkillStatusChangeTable()
guild.c
	-guild_explusion()
----------------------------------------
//1355 by ＡＡＡ
・毒薬の瓶が正常に動くように修正？
(src/map)
status.c
(db)
item_db.txt
contst.txt

----------------------------------------
//1354 by ID:7QLFJSM

・友達リスト実装（sql は未実装）
	・sql はよくわからないのでセーブ/ロード部分がありません。
	　わかる人は実装をお願いします。
	・パケットなどは Web でわかる範囲で調べましたが、
	　実際に本鯖で取ってきたわけではないので間違ってるかもしれません。
	・txt 版のセーブ/ロードは ID だけで名前はセーブしていません。
	　セーブデータ上の事情なので sql の場合は名前も保存して良いと思います。

・socket コントロールパネルの html コード埋め込み攻撃に対する脆弱性を修正
	・攻撃自体は、表示するブラウザに対しての攻撃なので、
	　修正前の Ver でもサーバー側には特に影響はありません。
	・フォントサイズが 999 の文字を 1 文字表示しただけで落ちるならそれは
	　ブラウザ側の問題だとは思いますが、他にも <script> とか危ないタグを
	　書かれても困るので修正しました。

(db)
packet_db.txt
	- 友達リスト処理用のパケット追加
(src/common)
	- struct friend_data 追加, struct mmo_charstatus にメンバ追加
(src/char)
char.c
	parse_frommap() 修正
(src/map)
friend.*
	- 新規追加
clif.*
chrif.*
	- 友達リスト関係のパケット処理部分追加
map.c
	- do_init(), map_quit() 修正
pc.c
	- pc_remove_map(), pc_setpos() 修正
Makefile
	- friend.o 追加
(/)
bcc32_make.bat
	- friend.c 追加
(doc/)
client_packet.txt
serverlink_packet.txt
	- 友達リスト関係のパケット追加

----------------------------------------
//1353 by ＡＡＡ
//guild exp所得倍率（100で通常、200で倍…）
guild_exp_rate: 100
※低base倍率で運営してギルドレベルを上げるのが大変な場合使用してください
  base_exp_rate*guild_exp_rateになるので高倍率だと数値がおかしくなります

　item_db.txtの修正
　skill.hにSC_POISONPOTION追加
(src/map)
battle.h
battle.c
	-battle_config_read()
guild.c
	-guild_payexp()
(conf)
battle_conf.conf

----------------------------------------
//1352 by ＡＡＡ
・1351のitem_db.txtと統合
  bAtk(最大攻撃力増加)をbBaseAtk(基本攻撃力増加)に変更
・アユタヤパッチのアイテムの効果を少し記述
(src/map)
guild.c

----------------------------------------
//1351 by TTfun
・アサシンクロスが毒薬の瓶使用時の効果追加
・item_db.txtの修正
(src/map)
status.c

----------------------------------------
//1350 by ＡＡＡ
・ギルドメンバーのギルド情報にUPボタンが出なくなった？
・偉大なる指導力,栄光の傷,冷静な心,鋭い視線の距離判定修正
・判定場所の変更、高速化など
・追加していないのだが…再定義されるので変更
#define DEFAULT_AUTOSAVE_INTERVAL
	↓
#define DEFAULT_AUTOSAVE_INTERVAL_CS

(src/map)

skill.c
	-skill_castend_nodamage_id()
guild.h
guild.c
	-guild_recv_memberinfoshort()
status.c
	-status_calc_pc()
pc.c
	-pc_walk()
clif.c
	-clif_guild_skillinfo()
	-clif_parse_UseSkillToId()
script.c
map.h
mob.c
atcommand.c
(src/char)
char.h
char.c

----------------------------------------
//1349 by ＡＡＡ
・緊急招集の修正
・デモンストレーションがGVGで無差別に当たるように修正
・inf2に4096を追加 128のGVG版　(db_ref.txt参照)
・緊急招集の有効範囲を制限する
//yes: 同一マップのみ
//no:  どこにいても
emergencycall_call_limit: no
・緊急招集の対象にならない
※ギルドメンバー以外使っても効果なし
  ギルドマスターが面白がって使い面倒な時は拒否してください
  GMのレベルを設定0にしています
@econ  
@ecoff
・ギルドスキル(臨戦態勢,激励,治療,緊急招集)をGVG時間のみ有効にする
//yesにすると起動時にguild_skill_available: noに設定されます
//GvG時間になると切り替わるようになります
//GVG時間以外のADなどのシーズマップで使われると拙い場合に設定してください
allow_guild_skill_in_gvgtime_only: no
・PvPでギルドスキルを制限する
//通常フィールドとシーズマップでは使いたいがPvPでは制限したい場合:yes
guild_skill_in_pvp_limit: yes

※マップフラグは変更が手軽でないためやる気なし

・@goにアインブログ（@go 17）とリヒタルゼン（@go 19）追加しました(thanks to snowwing)

(src/map)

atcommand.h
atcommand.c
	-atcommand_go()
	-atcommand_econ()
	-atcommand_ecoff()
battle.h
battle.c
	-battle_check_target()
guild.c
	-guild_agit_start()
	-guild_agit_end()
map.h
skill.c
	-skill_check_condition()
	-skill_use_id()
(db)
skill_db.txt
(conf)
battle_athena.conf
atcommand_athena.conf
msg_athena.conf
help.txt
help1.txt
(doc)
db_ref.txt

----------------------------------------
//1348 by ＡＡＡ
・ギルドメンバーがギルドスキルを使用できたのを修正
・ギルドマスターが居ない時に動くと落ちたのを修正
(src/map)
skill.c
pc.c

----------------------------------------
//1347 by ＡＡＡ
・臨戦態勢,激励,治療,緊急招集　実装？
激励,治療は詠唱時間が判らないので４秒付にしました

(src/map)
skill.c
skill.h
status.c
pc.c
(db)
skill_cast_db.txt

----------------------------------------
//1346 by ＡＡＡ
・ソース内部でギルドスキルを通常スキルとして扱えるように修正
　※独自にギルドスキル作れるかも…
・臨戦態勢,激励 仮実装 ギルマスだけ効果あり ->テスト用
・//偉大なる指導力,栄光の傷,冷静な心,鋭い視線をギルマスに適用する
allow_me_guild_skill: no
・//ギルドスキル(臨戦態勢,激励,治療,緊急招集)を有効にする
・guild_skill_available:yes
//ギルドスキル(臨戦態勢,激励,治療,緊急招集)をシーズモードだけ有効にする
allow_guild_skill_in_gvg_only:yes

(src/map)
battle.h
battle.c
	-battle_config_read()
skill.h
skill.c
↓マクロ->関数化 ギルドスキルIDも渡せるようになりました
int skill_get_hit(int id);
int skill_get_inf(int id);
int skill_get_pl(int id);
int skill_get_nk(int id);
int skill_get_max(int id);
int skill_get_range(int id,int lv);
int skill_get_hp(int id,int lv);
int skill_get_sp(int id,int lv);
int skill_get_zeny(int id,int lv);
int skill_get_num(int id,int lv);
int skill_get_cast(int id,int lv);
int skill_get_fixedcast(int id ,int lv);
int skill_get_delay(int id,int lv);
int skill_get_time(int id ,int lv);
int skill_get_time2(int id,int lv);
int skill_get_castdef(int id);
int skill_get_weapontype(int id);
int skill_get_inf2(int id);
int skill_get_maxcount(int id);
int skill_get_blewcount(int id,int lv);
int skill_get_unit_id(int id,int flag);
int skill_get_unit_layout_type(int id,int lv);
int skill_get_unit_interval(int id);
int skill_get_unit_range(int id);
int skill_get_unit_target(int id);
int skill_get_unit_flag(int id);
↑

変数 GuildSkillStatusChangeTable[]追加 あれと同等
	-GetSkillStatusChangeTable(int)追加
	※SkillStatusChangeTable[]の代わりにこれを使うといいかも
	idからGuildSkillStatusChangeTable[]への変換も行っているので

	-skill_get_skilldb_id() 追加
	skillidをdb用のidに変換します(ギルドスキルを)
	skilldb[]を直接使用する場合、skill_get_skilldb_id()を用いてください
	case 文などで 通常スキルであることがわかっている場合のみskillidで使用してください
	-skill_use_id()
	-skill_use_pos()
	-skill_check_condition()

status.c
	-pc_hpheal()
	-pc_spheal()
	-status_calc_pc()
	-status_change_end()
	-status_change_end()
guild.h
guild.c
clif.c
	-clif_parse_UseSkillToId()
	※ギルドスキルレベルのデコードが上手くいってません
	　解る方修正お願いします
(src/common)
mmo.h
	GD_… -> skill.h　へ戻す
(src/char)
int_guild.c 
	#include "skill.h"

	その他多数…

(conf)
battle_config.conf

(db)
skill_db.txt
skill_require_db.txt
skill_cast_db.txt

----------------------------------------
//1345 by ＡＡＡ
・臨戦態勢,激励,治療,緊急招集を使えないように修正
※エラーが出たら拙いので修正
(src/map)
skill.h
skill.c
status.c
(db)
guild_skill_db.txt

----------------------------------------
//1344 by ＡＡＡ
・偉大なる指導力,栄光の傷,冷静な心,鋭い視線を実装
※計算回数が増えるのでデフォルトでは切ってます
//偉大なる指導力,栄光の傷,冷静な心,鋭い視線を有効にする
guild_hunting_skill_available: no
//ギルマスとの距離を計算するか？
//yes : 5*5マス以内なら有効
//no  : 同一マップであれば有効
guild_skill_check_range: no

(src/map)
map.h
status.c
	-status_calc_pc()
pc.c
	-pc_walktoxy_sub()
guild.c
	-guild_get_guildmaster_sd()
battle.h
battle.c
	-battle_config_read()
(conf)
battle_config.conf

----------------------------------------
//1343fix by ＡＡＡ
・新ギルドスキルのツリーが出るように修正
  IDはguild_skill_tree.txtkかguild_skill_db.txt参照
・ガーディアン強化実装？(暫定)
　MOBにギルドを指定できるのでMOBが強化されるように実装
  ギルド入りMOBの攻撃力20%*LV上昇(20%c並み)
  ギルド入りMOBのディレイ5+5%*LV減少(速度ポーション並み)
※現在、スキルを使うことは出来ません

実装/仮実装済
  正式ギルド承認
　カプラ契約
  ガーディアン研究
  ガーディアン強化
  ギルド拡張
スクリプトで実装可能
  永久的な発展(スクリプトで実現可能)
　・発展度を上げることによってランダムによる確率で発展度がさらに上がるようになります。
　　ランダムで商業値+1?

(src/map)
clif.c
	-clif_guild_skillinfo()
guild.h
guild.c
	-guild_skill_get_inf()
	-guild_skill_get_sp()
	-guild_skill_get_range()
	-guild_skill_get_max()
	-guild_skill_get_lv()
	-guild_read_guildskilldb()
	-do_init_guild()
status.c
	-status_get_atk()
	-status_get_atk2()
	-status_get_adelay()
	-status_get_amotion()
script.c
	-buildin_monster()
(src/char)
int_guild.c
	-guild_tostr()
	-guild_fromstr()
	-mapif_parse_CreateGuild()
(src/common)
mmo.h
(db)
skill_db.txt
guild_skill_tree.txt
guild_skill_db.txt(暫定)

----------------------------------------
//1342 by aki
・@go 3使用時、カプラ横に飛ぶように座標修正(atcommand.c
いらないかもしれませんがUPします。
(src/map)
atcommand.c

----------------------------------------
//1341 by ID:7QLFJSM

・gcc で警告が出ていたのを修正
・socket コントロールパネルの機能追加(接続リスト表示、強制切断)
・httpd のログに認証の情報が吐かれていなかったのを修正

(src/common)
httpd.*
	- httpd_log(), httpd_parse() 修正
	- httpd_check_access_user_digest() 修正
	- httpd_check_access_user_basic() 修正
	- struct httpd_session_data に user 追加
socket.*
	- socket_httpd_page_connection(), socket_httpd_page_access_settings() 追加
	- socket_httpd_page_dos_attack() 追加
	- socket_httpd_page() 修正
	- socket_set_httpd_page_connection_func() 追加など
(src/login)
login.c
	- login_socket_ctrl_panel_func() 追加
	- do_init() 修正
(src/char)
char.c
	- char_socket_ctrl_panel_func() 追加
	- do_init() 修正
(src/map)
map.c
	- map_socket_ctrl_panel_func() 追加
	- do_init() 修正
clif.*
	- clif_parse() を外部シンボルに
chrif.h
	- chrif_parse() プロトタイプ宣言追加

----------------------------------------
//1340 by ＡＡＡ
・ギルドスキルを上げれなかったのを修正
(src/map)
guild.c

----------------------------------------
//1339 by ID:7QLFJSM

・VC で battle.c のコンパイル時、値を返していない警告がでるのを修正
・マップ移動時に Ack が来るまでパーティー公平分配の対象にならないように修正
・socket.conf での httpd 関係の設定を削除（httpd.conf に移行済み）
・httpd に socket コントロールパネル追加
	・DoS ブロック中のアドレスを見られる(最大100件)、ブロック解除できる
	・アクセス設定が見られる
	URL は /socketctrl ですが、標準では無効になっているので、
	利用する場合は socket.conf で有効にしてください。
	また、httpd.conf で IP や認証のアクセス制限をかけることを強く推奨します。

	未実装ですが、接続中のユーザーのリスト表示や、強制切断、
	socket.conf のリロードなどをできるようにしたいと思ってます。

(src/common)
httpd.*
	- struct httpd_session_data を httpd.h に移動
	- do_init_httpd() 修正
socket.*
	- socket_httpd_page() 追加
(src/map)
battle.c
	- battle_attack_drain() 修正
party.c
	- party_exp_share() 修正
(conf/)
socket.conf
	- socket_ctrl_panel 追加
(httpd/)
index.html
	- socket contrl panel の部分を追加

----------------------------------------
//1338 by ＡＡＡ
・GVGマップでギルド勧誘できるか? yes:出来る no:出来ない
  allow_guild_invite_in_gvg: no
・GVGマップでギルドを脱退できるか? yes:出来る no:出来ない
  ※追放も出来ません
  allow_guild_leave_in_gvg: no
・help分割
　@help(今まで通り)
  @help1〜help4(一般公開できそうなもの/GM1/GM2(増減)/デバック関係)
　※helpが大きくなりすぎたので分割してみました
　　分け方は独断と偏見です。
・アスムプティオがGVGでも使用できるように再修正
　GVGでは効果が2/3になるように修正 ※damage*2/3
※仕様では使えるらしいが、本鯖はバグで使えないらしく(現在も使えないのか未確認)
　使えないように修正されたのを修正(1305)
allow_assumptop_in_gvg: yes
・@go 15/16 ジャワイ/アユタヤ
・ファルコンアサルトの計算を修正
  (ブリッツビートのレベルを使っていなかった)

バグ報告など参照↓
・アシッドデモンストレーションのHIT数を修正
・武器に刺さった状態変化系カードの効果がCRに乗るように修正
・アスムでブレイカーのINTダメージが減少するように修正
・ファルコンアサルトのHIT数がレベル依存だったのを修正
・ファルコンアサルトに武器の属性が乗るように修正
  ※手抜き実装、正確じゃないです。
 allow_falconassault_elemet: no
正確な仕様？(wikiより)
 （対人では）装備している矢や武器の属性が肩にかけるものに対して乗る。
  固定ダメージだが毒ナイフを装備すれば相手のイミュンを貫通することが可能。
  この際、装備品のペナルティを受ける。
  例えば、念矢装備で相手が木琴装備であれば50％のダメージ追加。
  矢の属性が乗るのは弓を装備している時のみ。
  ＢＳの属性武器はイミュンを貫通できません。Gvスレででも調べてください。

(src/map)
atcommand.c
	-atcommand_go()
battle.c
	-battle_pc_weapon_attack()
	-battle_mob_weapon_attack()
	-battle_pet_weapon_attack()
	-battle_calc_misc_attack()
	-battle_calc_pc_weapon_attack
	-battle_calc_mob_weapon_attack()
guild.c
	-guild_invite()
	-guild_leave()
	-guild_explusion()
skill.c
	-skill_additional_effect()
	-skill_use_id()
(db)
skill_db.txt
(conf)
help1.txt
help2.txt
help3.txt
help4.txt
battle_config.conf
atcommand_athena.conf

----------------------------------------
//1337 by yukito
・@mesのゲーム内での送信をオープン会話に切り替えられる機能を追加
・精錬関係スクリプトの整形
(src/map)
	battle.c
	-battle_config_read()
	battle.h
	-extern struct Battle_Config
(doc)
	conf_ref.txt
	-mes_send_type追加
(conf)
	battle_athena.conf
	-mes_send_type追加
(script/npc/town)
	npc_town_refine.txt
	-整形

----------------------------------------
//1336 by yukito
・Mobがidle時に移動する距離を調整
・商人転職クエスト途中で旧剣士ギルドのカプラに話しかけると無限ループすることがあったのを修正
・カプラの終了メッセージ関数が使われていなかったので使うように変更
・カプラの空間転送を関数化
(src/map)
	mob.c
	-mob_randomwalk()
(script/npc)
	npc_function.txt
	-function kftransport 新設
	town/npc_town_kafra.txt
	-空間転送、終了メッセージを関数呼び出しに変更

----------------------------------------
//1335 by ＡＡＡ
・転生スキルをクローン可能にする(差別化の為チェイサーのみ)
extended_cloneskill: no
・プレイヤーの各基本パラメータの最大値を設定。
max_parameterと比較して小さい方が有効
max_parameter_str: 999
max_parameter_agi: 999
max_parameter_vit: 999
max_parameter_int: 999
max_parameter_dex: 999
max_parameter_luk: 999
・PVP,GVG以外のフィールドでアイテム消費無しに該当スキルが使用できる
cannibalize_nocost: no
spheremine_nocost: no
demonstration_nocost: no
acidterror_nocost: no
aciddemonstration_nocost: no
chemical_nocost: no
slimpitcher_nocost: no

(src/map)

atcommand.c
	-atcommand_param()
battle.h
battle.c
	-battle_config_read
skill.c
	-skill_attack()
	-skill_castend_pos2()
	-skill_check_condition()
pc.c
	-pc_statusup()
(conf)
battle_athena.conf
(doc)
conf_ref.txt

----------------------------------------
//1334fix by ＡＡＡ
・ボスの取り巻き召還が行われていなかったのを修正
・アリスとジルタスのpet_dbを修正
・item_avail.txt (fixにて追加)

(src/map)
mob.c
	-mobskill_use_id()
(db)
pet_db.txt
item_avail.txt (fixにて追加)

----------------------------------------
//1333 by ＡＡＡ
・リフレクトシールドなど反射ダメージで
オートスペルと吸収が発動するように修正
weapon_reflect_autospell:no
magic_reflect_autospell: no
weapon_reflect_drain: no
weapon_reflect_drain_per_enable: no
magic_reflect_drain: no
magic_reflect_drain_per_enable: no
・1331のconfの記述が間違っていたのを修正

(src/map)
skill.c
	-skill_attack()
battle.h
battle.c
	-battle_calc_weapon_attack()
	-battle_calc_magic_attack()
	-battle_calc_misc_attack()
	-battle_config_read
	-battle_attack_drain() 追加
(conf)
battle_athena.conf

----------------------------------------
//1332 by ID:7QLFJSM

・緩慢な非認証タイプの DoS 攻撃に対する脆弱性を修正
　httpd 処理以外は、接続してから 10 秒以内に認証しないと切断するようにした。
　認証後は10分以内に一度もデータを受信(処理)していない場合切断するようにした。
・httpd の巨大 POST リクエスト攻撃に対する脆弱性を修正
　関連して、POST リクエストで 32KB 以上のデータを受信できなくなりました。

(src/common)
socket.h
	- struct socket_data に auth, tick メンバ追加
socket.c
	- do_parsepacket()
httpd.c
	- httpd_parse() 修正
(src/login)
login.c
	- parse_login() 修正
(src/char)
char.c
	- parse_tologin(), parse_char(), mmo_char_send006b() 修正
(src/map)
pc.c
	- pc_authok() 修正
chrif.c
	- chrif_connectack() 修正

----------------------------------------
//1331 by ＡＡＡ
・物理スキル魔法MISCでオートスペルとHP/SP吸収が発動する
　＆そのコンフィグ
  weapon_attack_autospell: no
  magic_attack_autospell: no
  misc_attack_autospell: no
  magic_attack_drain: no
  magic_attack_drain_per_enable: no
  misc_attack_drain: no
  misc_attack_drain_per_enable: no
 ※バイオプラントのASは未実装
   (実装する価値があるのか…,動も意図した実装じゃないだろうな)
・NPCスキル　錯覚を無効にする。
  hallucianation_off: no
・スパノビのJOB経験値サンプル(仮実装用)
　※50以降の増加を適用したものです。
    GH地下水路B3F(gl_sew03)で狩り続けた結果90/99になりました

(src/map)
battle.h
battle.c
	-battle_calc_weapon_attack()
	-battle_calc_magic_attack()
	-battle_calc_misc_attack()
	-battle_config_read
mob.c
	-mobskill_use_id()

(conf)
battle_athena.conf

(db/sample)
exp.txt

----------------------------------------
//1330 by soria
・ローグ（チェイサー）スキル「クローンスキル」で、
  追加NPCスキル・転生スキルがクローンできていたのを修正。
・パラディンスキル「ゴスペル」で、全ステータス+20の処理が
  行われていなかったのを修正。
(src/map)
status.c
	-status_change_start()
skill.c
	-skill_attack()

----------------------------------------
//1329 by ＡＡＡ
・養子縁組された子供は、1つステータスを80以上に上げることができません。
  但し、養子縁組前に80以上上げていたステータスはそのまま維持されます。
・養子の製造スキルの成功率が70％に修正
・超強い武器 +15 -> +40
status.c
	-status_calc_pc()
pc.c
	-pc_statusup()
skill.c
	-skill_produce_mix()

----------------------------------------
//1328 by ＡＡＡ
・養子のサイズを小型に変更
・転生二次職->転生職のHP/SPを通常の125%に変更
・養子のHP/SPを通常の70%に変更
・joblvupで上がるスパノビの最大JOBを99に変更
・スパノビのJOB加重値を99まで追加(70以降全て0らしい)
※経験値はまだ判っていないので保留
　経験値を追加しないとレベルは上がりません
・bMobClassChangeが人間とボス(属性)に効かないように修正(未実装wiki)
・新結婚スキル効果 new_marrige_skill: no を追加
※item_db.txtの結婚指輪とskill_require_db.txtのWE_MALE,WE_FEMALEを変更すること。　賛否ありそうなので変更保留
・2005-07-12aRagexeのパケット (thanks to rr)
(src/map)
skill.c
	-skill_additional_effect()
atcommand.c
	-atcommand_joblevelup()
	-atcommand_character_joblevel()
status.c
	-status_get_size()
(db)
job_db2.txt
job_db2-2.txt
packet_db.txt

----------------------------------------
//1327 by yukito
・2-2職(転生前)のJob加重値を(Job50時点の合計30に)修正
(db)
job_db2.txt
	-17〜23行目

----------------------------------------
//1326 by yukito
・1324で混入したバグの修正
(src/map)
pc.c
	-pc_natural_heal_sub()

----------------------------------------
//1325 by ID:7QLFJSM

・NO_HTTPD の作用が逆だったのを修正
・vc07_make.bat / bcc32_make.bat のデフォルトを TEXT に修正
・httpd.c にコメント追加

(/)
vc07_make.bat
bcc32_make.bat
	- SQL/TEXT の選択部分のデフォルトを TEXT に修正
	- NO_HTTPD の選択を追加
Makefile
	- NO_HTTPD の選択を追加
(src/common)
httpd.c
	- コメント追加
socket.c
	- do_parsepacket() 修正

----------------------------------------
//1324 by 逆毛鰻
・「阿修羅を使った後にSPが回復しない」と言う機能が動作しなくなっていた
・コメントアウト？が変な所にあったのを修正
(src/map)
	pc.c　- if( sd->sc_data && 

----------------------------------------
//1323 by ＡＡＡ
・bonus2 bWeaponComaEle2, n, x;n属性に対して x%確率でコーマ(HP1)(xは万分率で+される)
・bonus2 bWeaponComaRace2, n, x;　n種族に対して x%確率でコーマ(HP1)(xは万分率+される)
・item_bonus.txtにbonus bBonusDamage,n;の記述追加(実装1234)

(src/map)
map.h
status.c
	-status_calc_pc()
pc.c
	-pc_bonus2()
battle.c
	-battle_weapon_attack()
(db)
const.txt
(doc)
item_bonus.txt

----------------------------------------
//1322 by ＡＡＡ
・equippeditem関数の追加
	equippeditem(<num>)
			
		num		数字
			
	numで指定したidを持つアイテムを装備しているか調べます。
	装備品、カードも判定します。
	見つかった場合1を。見つからなかった場合は0を返します。
(src/map)
script.c
	-buildin_equippeditem()
pc.h
pc.c
	-pc_equippeditem()
(doc)
script_ref.txt

----------------------------------------
//1321 by yukito
・マキシマイズパワー状態で自然SP回復が発動しないように修正（バグ報告スレ３No.67の方thx!）
・カートを装着した状態でカプラのカートサービスを選択すると止まっていたのを修正
・転職時に装備を解除するように修正(クライアントエラー防止のため)
・精錬NPCの関数化
(src/map)
mob.c
	-mob_damage()
pc.c
	-pc_natural_heal_sub()
(script/npc)
npc_function.txt
	-function refine1〜3(精錬NPC)追加
town/npc_town_refine.txt
	-精錬NPCは関数を呼び出すように変更
npc_job_01swordman.txt
npc_job_02magician.txt
npc_job_03archer.txt
npc_job_04acolyte.txt
npc_job_05merchant.txt
npc_job_06thief.txt
npc_job_07knight.txt
npc_job_08priest.txt
npc_job_09wizard.txt
npc_job_10blacksmith.txt
npc_job_14crusader.txt
npc_job_16sage.txt
npc_job_18alchemist.txt
npc_job_20dancer.txt
npc_job_23supernovice.txt
	-転職時に装備を解除するように修正

----------------------------------------
//1320 by ＡＡＡ
・bAddSkillBlowの修正
・新カードにcard_drop_rateが適用されるように修正
(src/map)
skill.c
	-skill_attack()
mob.c
	-mob_readdb()

----------------------------------------
//1319 by ルナ

・skill_tree.txtに騎士とロードナイトにBB出なかったり、プロフェッサーに
　本来無いはずのソウルドレインが付いていたのを修正
・battle_athena.confの以下の2つの項目が
　// モンスターがダメージを受けた時移動できないディレイを入れるかどうか
　monster_damage_delay: yes
　// モンスターがダメージを受けた時移動できないディレイの％比率（0でディレイ無し、100で通常、200で倍・・・）
　monster_damage_delay_rate: 100
　monster_damage_delay: no にするか、もしくは
　monster_damage_delay: yes で monster_damage_delay_rate: 0 にして
　モンスターがダメージを受けた時のディレイをなしにしていると
　取り巻きがゴースト化する問題が有ったので
  yukitoさんの検証により発覚した
  mob.cで
　//	mob_deleteslave(md);
　とコメントアウトされていたのを解除
　nullさんとyukitoさん感謝！

(db)
skill_tree.txt
	- 騎士とロードナイトのBBが外れ、プロフェッサーに
	- ソウルドレインが混ざっていたのを修正

(src/map)
mob.c
	- //	mob_deleteslave(md);
	- のコメントアウトを削除
  
----------------------------------------
//1318 by ID:7QLFJSM

・pc.c の使用されてない変数を削除
・ギルドで同アカウントの別キャラを除名すると、自分も脱退してしまうバグ修正
・カートの中身が表示されなくなっていたバグ修正（thx to ID:dXlop1o)
・1316 で packet_db.txt の内容が大量に削除されていたのを復旧＆少し整理

(db/)
packet_db.txt
	- jRO / kRO 等の削除されたパケットデータを復旧
	- 0x215 以降 を基本定義の方に移動
(src/map)
guild.c
	- guild_member_leaved 修正
pc.c
	- pc_readdb 修正
clif.c
	- clif_parse_LoadEndAck 修正
	- clif_changeoption_clear 名前変更

----------------------------------------
//1317fix by ＡＡＡ
・バーサークの取得条件変更
　(条件にBASE,JOBを設定可能にskill_tree.txt参照)
　独自ツリーの人は 0// を0,0,0//にでも置換してください
・エンペにbMobClassChangeが影響しないように修正
(src/map)
pc.c
	-pc_calc_skilltree()
	-pc_readdb()
skill.c
	-skill_additional_effect()
(db)
skill_tree.txt
skill_tree2.txt(fix 廃止)

----------------------------------------
//1316 by きあ
・null氏の解析を参考に packet_db.txt を修正
・アインブロクフィールド04〜03のＷＰを修正
　（パッチ1298で記載抜けしてました。申し訳ありません。）

	(script/warp/)
		npc_warp_fild.txt		フィールド

----------------------------------------
//1315fix2 by ID:7QLFJSM

・ladmin の searchaccount の修正

・擬似乱数の初期化方法変更

・擬似乱数の生成に使用する関数を切り替えられるように。
　以下のマクロを定義することで使用する関数を切り替えられます。

　　RANDOM32	32bit 線形合同法（24bit 出力）
　　RANDOM32X	32bit 線形合同法（24bit 出力、下位ビットの質向上）
　　RANDOM64	64bit 線形同合法（31bit 出力）
　　RANDOM64X	64bit 線形合同法（31bit 出力、下位ビットの質向上）
　　RANDOMMT	メルセンヌツイスター（31bit 出力 / 周期が非常に長い）
　　RANDOMSTD	標準の rand() （BCC/VC 15bit出力、gcc 31bit 出力）
　　RANDOMSTD2	標準の rand() 2回（30bit 出力）
　　RANDOMSTD2X 標準の rand() 2回（gcc 用、下位ビットの質向上）
　　RANDOMSTD3X 標準の rand() 3回 (BCC/VC 用、下位ビットの質向上 / 30bit出力）
　　なし		RANDOMSTD と同じ

　デフォルトだと、VC では RANDOM64、BCC では RANDOM32 が定義されます。

・(fix) BCC でのコンパイルエラーを修正

・(fix2) ログインサーバーで稀にアカウントリストを正常に取得できない問題を修正

・(fix2) 下位ビットの質を向上した RANDOM32X, RANDOM64X, RANDOMSTD2X,
　　　　 RANDOMSTD3X を追加

・(fix2) マクロ NO_HTTPD を定義すると httpd をはずせるように。
　　　　 コード自体はリンクされますが、httpd に処理は回りません。

(bin/tool)
ladmin
	- searchaccount 修正
(src/common)
mmo.h
	- マクロで擬似乱数を切り替えられるように
core.c
	- atn_int31_random64(), atn_int31_srandom64() 名前変更
	- atn_int31_randommt(), atn_srandommt() 追加
socket.c
	- (fix2) do_parsepacket() 修正
(src/login)
login.c
	- do_init() 修正
	- (fix2) parse_admin() 修正
(src/map)
map.c
	- do_init() 修正

----------------------------------------
//1314 by yukito
・パーティスキルの効果範囲を修正。(29x29→41x41)
・GvG制御、宝箱制御のGMメニューを使用した時にcloseが出るように修正。

	(src/map)
		map.h		- PT_AREA_SIZE 新設
		party.c		- party_foreachsamemap() 修正
	(script/npc/gvg)
		ev_agit_common.txt	- GvG Control,TBOX Control 修正

----------------------------------------
//1313 by ID:7QLFJSM

・ログインサーバーのアカウントリスト取得時、データ量が 64KB を超えると、
　データが正常に送受信できない問題を修正
　ladmin を修正したので利用者は注意してください。
　
・擬似乱数の精度の問題で、確率処理がおかしくなっている部分を多少緩和。
　（擬似乱数を自作の関数に変更）
　VC では内部計算 64bit で 31bit 出力の線形合同法、
　BCC では内部計算 32bit で 24bit 出力の線形合同法を使うように変更。
　その他の環境では標準の rand() を使います。
　
　有効ビット数は問題ないのですが、下位ビットの周期の問題から
　gcc でも自作関数に変えたほうがいいかもしれません。
　
　メルセンヌツイスターとかを使うまでも無いと思ったので線形合同法です。
　線形合同法のパラメータは Web を回って適当な値をとってきました。
　
開発者向け
　今後は rand() のかわりに atn_rand() を使ってください。
　VC / BCC で、戻り値の有効ビット数が多くなるので。
　また、RAND_MAX が必要なら、かわりに ATN_RAND_MAX を使ってください。

(bin/tool)
ladmin
	- listaccount 修正
(src/common)
core.c
	- atn_int24_random32(), atn_int24_srandom32() 追加
	- atn_int32_random64(), atn_int32_srandom64() 追加
(src/login)
login.c
	- parse_admin() 修正
(src/map)
map.c
	- do_init() 修正
	- rand() -> atn_rand() 置き換え
battle.c
itemdb.c
mob.c
pc.c
script.c
skill.c
status.c
	- rand() -> atn_rand() 置き換え

----------------------------------------
//1312 by carpe diem
・オーラ状態時の不具合修正
(src/map)
	clif.c		- changeoption_clear()追加, clif_parse_LoadEndAck()修正

----------------------------------------
//1311 by Exile
・1305 でスパイダーウェブの修正が誤っていたのを修正
(src/map)
	battle.c	- battle_calc_damage() 修正

----------------------------------------
//1310 by yukito
・アスムプティオの効果時間、メテオストームのディレイを修正。
・LUK＞BaseLevelの時に呪い耐性100%になるように修正。

	(db)
		skill_cast_db.txt	- アスムプティオ、メテオストーム 修正
	(src/map)
		status.c 	-  status_change_start() 修正

----------------------------------------
//1309 by Exile
・skill_dbで射線チェック（nk=4）を指定している場合に、
　スキルによるオートスペルが不発していたのを修正
・サンクチュアリの制限カウント数が誤っていたのを修正
　重ね置きで効果が重複しないように修正

	(db)
		skill_unit_db.txt	- サンクチュアリ() 修正
	(src/map)
		battle.c	- battle_weapon_attack() 修正
		skill.c 	- skill_unit_group *skill_unitsetting() 修正

----------------------------------------
//1308 by End_of_exam

・1307 で攻撃対象判定が消えていた罠を修正(battle.c)
・1307 でバイオプラントがmob に攻撃すると落ちるバグを修正(battle.c)
・@lvup @joblvup に異常な値が渡されると暴走するバグを修正(atcommand.c)

	(src/map/)
		atcommand.c		- atcommand_baselevelup() atcommand_joblevelup() 修正
		battle.c		- battle_weapon_attack() 修正

----------------------------------------
//1307 by ティセ
・@HIDE中の攻撃/スキルの使用可否をconfで指定可能に修正
(src/map)
	skill.c 	- skill_check_condition() 修正
	battle.c	- battle_weapon_attack() 修正
			- battle_config_read() 修正
	battle.h	- Battle_Config() 修正
(conf)
	battle_athena.conf
			- hide_attack 追加
			- gm_hide_attack_lv 追加

----------------------------------------
//1306 by うんぽこ
・バジリカ使用後ノックバックしなくなっていたのを修正
・マインドブレーカーを使用し効果時間終了後ステータス再計算すると再び効果がでていたのを修正

(src/map)
	skill.c 	- skill_blown() 修正
	status.c	- status_get_mdef()
                - status_get_matk2()
                - status_get_matk1()
                - status_calc_pc() 修正
----------------------------------------
//1305 by Exile
・以下のスキルを修正
　　コンセントレイション：基本ATKと減算DEFに効果が適用されていなかったのを修正
	リフレクトシールド：通常攻撃で実際にダメージが発生していなかったのを修正
	ストーンカース：スキルLv6以上でスキル失敗時に触媒を消費しないよう修正
	ファイアーピラー：スキルLv5以下は範囲3x3で触媒不要、6以上は7x7で触媒必要に修正
	フロストノヴァ：即発動型で、範囲を自分中心5x5に修正
	                詠唱時間、凍結時間、凍結率、攻撃力を修正
	アーススパイク：ディレイ修正
	クァグマイア：AGI,DEX減少量をスキルLvx10%、上限スキルLvx10に修正
	              移動速度2/3に修正
	              PvPで自分や味方にも影響が出るように修正
	              PvPでのAGI,DEX減少量半分に修正
	              SP消費量を修正
	クレイモアトラップ,サンドマン：範囲を5x5に修正
	ディフェンダー：ASPDの減少量を修正
	フレイムランチャー,フロストウェポン,
	ライトニングローダー,サイズミックウェポン：スキルLv5の場合30分持続に修正
	アスムプティオ：シーズモードで使用不可に修正
	シールドチェイン：射程4に修正
	スパイダーウェブ：クモの巣にかかった状態では火属性攻撃で2倍のダメージを受け、
	                  クモの巣が解けるように修正

(db)
	skill_db.txt         - フロストノヴァ,クァグマイア,シールドチェイン修正
	skill_cast_db.txt    - フロストノヴァ,アーススパイク,フレイムランチャー,
	                       フロストウェポン,ライトニングローダー,サイズミックウェポン修正
	skill_require_db.txt - クァグマイア修正
	skill_unit_db.txt    - フロストノヴァ削除
	                     - クレイモアトラップ,サンドマン修正
(src/map)
	battle.c	- Damage battle_calc_magic_attack() 修正
	        	- battle_calc_damage() 修正
	        	- battle_weapon_attack() 修正
	skill.c 	- skill_check_condition() 修正
	        	- skill_use_id() 修正
	        	- skill_additional_effect() 修正
	        	- skill_castend_nodamage_id() 修正
	        	- skill_castend_damage_id() 修正
	        	- skill_castend_pos2() 修正
	        	- skill_unit_onplace_timer() 修正
	status.c	- status_get_speed() 修正
	        	- status_calc_pc() 修正

----------------------------------------
//1304 by ID:7QLFJSM

・ログインサーバーでアカウントリスト取得時( ladmin など )に
　FIFO がオーバーフローする場合がある問題を修正
・ギルド倉庫の転送時に FIFO がオーバーフローする場合がある問題を修正
・httpd で 256KB 以上のファイルを転送する場合、分割して送るように修正
　かなり大きなファイルを置いてもメモリを圧迫しなくなりました。
　分割転送中にファイル内容が変更された場合、転送を中断して接続を切ります。
・httpd が Range ヘッダに対応（現在のところファイルコンテンツのみ）
　対応しているブラウザでレジューム（ダウンロードの再開）が可能になります。
　range-set が１つのみの対応です。複数あると Bad Request を返します。
・httpd が If-Range ヘッダに対応（現在のところファイルコンテンツのみ）
　対応しているブラウザで通信コストが減ります。
　日付のみの対応です。Etag を送られると Bad Request を返します。
・httpd が Accept-Range、Server ヘッダを返すようにした

開発者向け
　16KB以上 WFIFOSET する場合、先に WFIFORESERVE で
　必要なサイズの FIFO を確保するようにしてください。

(src/common)
socket.*
	- WFIFOSET() 修正, WFIFORESERVE() 追加
httpd.c
	- httpd_send_bigfile() 追加、その他いろいろ修正
(src/login)
login.c
	- parse_admin() 修正
(src/char)
int_storage.c
	- mapif_load_guild_storage() 修正
(src/map)
intif.c
	- intif_send_guild_storage() 修正

----------------------------------------
//1303 by ttkk
	(src/char)
		char.c	check login fd

----------------------------------------
//1302 by トリガー

・divorce()の一部にカッコが抜けていたのを修正。

	Readme				- 1300に巻き戻し。

	(src/map)
		script.c		- buildin_divorce() 修正(End_of_examさんに感謝)

----------------------------------------
//1301 by 　1293

・ランドプロテクターが重なった時、LP同士以外でも打ち消しあってたのを修正
（本鯖同様の、LP同士なら打消し、LP以外は削除、に）

(src/map)
	skill.c
		skill_landprotector() 修正

----------------------------------------
//1300 by トリガー

・サーバースナップショット
・version.hの更新。
・BCC32,Cygwin,VC++のテキストモードでのコンパイル確認。
・ファイルやフォルダの削除及び移動。

	battle_athena.confの追加.txt	- ファイルの削除
	changetable.sql			- 名前を変えて(sql-files)に移動
	install_guildcastle.sql		- 名前を変えて(sql-files)に移動
	readme_mysql.txt		- 名前を変えて(doc)に移動

	bench.bat			- 1281により(bin/tool)に移動
	bench.c				- 1281により(bin/tool)に移動

	(src/common)
		version.h		- mod version 1300
		Makefile		- http.oの前にmd5calc.oを移動 (soriaさんに感謝)

	(src/converter)
		Makefile		- grfio.cをgrfio.oに修正 (バグ報告スレッドより)

	(db)
		packet_db.txt		- (eigenさんに感謝)

	(src/login)
		md5calc.*		- ファイルの削除

	(おまけ)			- フォルダの削除
		*.*			- (db/sample)に移動

----------------------------------------
//1299 by トリガー

・divorce関数の仕様追加。
・ウェディングの継続時間(wedding_time)の設定追加。
・リログ後にウェディングを継続するかどうか(wedding_relog)の設定追加。
・一部の宣言修正。

	(conf)
		battle_athena.conf	- wedding_relog wedding_time の設定追加

	(doc)
		conf_ref.txt		- wedding_relog wedding_time の説明追加
		script_ref.txt		- divorce関数の説明修正

	(src/map)
		battle.c		- battle_config_read() 修正
		battle.h		- wedding_relog wedding_time の追加
		clif.c			- clif_parse_LoadEndAck() 修正
		script.c		- buildin_divorce() 修正
		status.c		- status_change_end() 修正
					- status_change_timer() 修正

		map.c		Fix	パッチあてミスにより巻き戻し。
		party.h		Fix	パッチあてミスにより巻き戻し。

----------------------------------------
//1298 by きあ

・下記にあるワープポイントの不具合を修正

	(script/warp/)
		npc_warp_dun.txt		ダンジョン
		npc_warp_fild.txt		フィールド
		npc_warp_town.txt		タウン

1290+でトリガー氏がMAPファイルの置き換えをした内容で
編集中、及び暫定配置していたものを再編集、調整しました（トリガー氏感謝です）

----------------------------------------
//1297 by ID:7QLFJSM

・質問スレッドにあがっていた strcasecmp の修正
・httpd で大きいファイルを扱う場合の効率を少し上げた
・noexp_hiding, noexp_trickdead が意味が反転していたのを修正
・battle_athena.conf で : の前にスペースが入っている行を修正

(conf/)
battle_athena.conf
	- " :" → ":" に置き換え
(src/common)
core.c
	-  strcasecmp() 修正
httpd.c
	- httpd_send_file() 修正
(src/map)
party.c
	- party_share_exp() 修正
mob.c
	- mob_damage() 修正

----------------------------------------
//1296 by tk

・単体スキル発動時の失敗判定を距離判定から射線チェックに修正
・ランドプロテクターなど対地スキルに射線判定追加

(src/map)
	skill.h
	skill.c
	mob.c

(doc)
	db_ref.txt

(db)
	skill_unit_db.txt (flagで対地スキルに射線判定指定)
	skill_db.txt (nkで単体スキル射線チェック指定)

----------------------------------------
//1295 by robert
.Revise char,char_final function 
.Revise battle.h, noexp_hiding & noexp_trickdead
----------------------------------------
//1294 by End_of_exam

・FreeBSD で警告が出るらしいので、pragma pack の形式を変更(mmo.h)
・bcc でahn_bignumber をdoubleに変更(thanks to namelessさん mmo.h)
・アシッドデモンストレーションの装備破壊確率を修正(skill.c)
・party_share_level が無効になっていたバグを修正(party.h inter.c)
・1291の修正に合わせて、sql-files/ 修正

	(src/commoon)
		mmo.h			- pragma pack, atn_bignumber 修正

	(src/char)
		party.h			- party_config_read() 追加
		inter.c			- inter_config_read() 修正

	(src/map/)
		skill.c			- skill_additional_effect() 修正

	(sql-files/)
		main.sql		- 1291の変更を追加

----------------------------------------
//1293 by 
・ランドプロテクターが重なった時打ち消しあうように修正
・教授スキルのディレイを修正

(db)
	skill_cast_db.txt
ライフ置換のディレイ修正
ソウルバーンのディレイをLv別を変化に修正

(src/map)
	skill.c
		skill_landprotector() 修正

----------------------------------------
//1292 by いど
・雑談スレッド２にアップされていた1290+を統合
　(あらかじめscript/warp/フォルダを空にした方がいいです)

	(script/npc/town/)
		npc_town_jawaii.txt	表記の修正(ザワイ→ジャワイ)
	(db/)
		packet_db.txt	コメントの誤記を修正(2005-05-27gRagexe その２→2005-05-27gRagexe)

----------------------------------------
//1291 by ID:robert

guild castle are stored in MySQL.

src/char	Add SQL function for guild castle

	int_guild.c	
			guildcastle_sql_init
			guildcastle_tosql
			guild_guildcastle_save
			update_castle_loop
			update_castle

NOTE:SQL TABLE `guild_castle`.Must use install_guildcastle.Sql is channelled into the data 

----------------------------------------
//1290+  by トリガー
・MAPファイルの置き換え
・(script/warp/)フォルダ内のファイルを全て削除して置き換えてください。
・npc_town_jawaii.txt の 22〜41行目 に同様のwarp部分があるので削除。
・リヒタルゼンフィールド01、企業都市リヒタルゼン、生体実験研究所のデータ(きあさんに感謝)
・エアポート、企業都市リヒタルゼンのデータ(かるさんに感謝)
・map_athena.conf に 1283で削除された項目を追加

	(script/npc/town/)
		npc_town_jawaii.txt		22〜41行目を削除
	(script/warp/)
		npc_warp_alpha.txt		Alpha
		npc_warp_dun.txt		ダンジョン
		npc_warp_fild.txt		フィールド
		npc_warp_town.txt		タウン
		npc_warp_vs.txt			GvG and PvP 
	(conf)
		map_athena.conf			1283で削除された項目を追加

----------------------------------------
//1290 by  ID:7QLFJSM

・無意味と言い切られたので精度チェックを削除(まあ確かに意味はない)
・1289 の s_int 未定義のエラー修正とファイル末尾の謎の文字列削除
・exp 計算式もう少し変更(ボーナスが非常に大きいときでもオーバーフローしにくく)

	(src/map)
		battle.c	
				- battle_calc_pet_weapon_attack() 修正
				- battle_calc_mob_weapon_attack() 修正
		map.c		
				test_atn_bignumber() 削除
				- do_init() 修正
		mob.c		
				- mob_damage() 修正

----------------------------------------
//1289 by ID:Sapientia

・アシッドデモンストレーションの家具県

(db)
skill_cast_db.txt
skill_db.txt
skill_require_db.txt
skill_tree.txt
(src/map)
battle.c
	- Damage battle_calc_pc_weapon_attack() 修正
	- Damage battle_calc_pet_weapon_attack() 修正
	- Damage battle_calc_mob_weapon_attack() 修正
skill.c
	- skill_additional_effect() 修正
	- skill_castend_damage_id() 修正

----------------------------------------
//1288 by ID:7QLFJSM

・共闘の計算式をもうちょっと変更
・念のため atn_bignumber の精度を確認するように
・1286 で忘れていた conf と conf_ref.txt 修正

・起動時に、"atn_bignumber precision error." と出た場合、
　64 bit整数が正しく扱えません。Makefile などで BIGNUMBER_DOUBLE を
　定義して再コンパイルしてください。double 型を使って計算します。

(doc/)
conf_ref.txt
	- noexp_hiding, noexp_trickdead 追加
(conf/)
battle_athena.conf
	- noexp_hiding, noexp_trickdead 追加
(src/map)
map.c
	- test_atn_bignumber() 追加, do_init() 修正
mob.c
	- mob_damage() 修正
party.*
	- party_exp_share() の引数変更

----------------------------------------
//1287 by End_of_exam

・ブラウザと@mes の間の相互チャットシステムを実装
・1286でmob がPC以外からの攻撃で死んだ時に落ちるバグを修正(mob.c)

	(conf/)
		atcommand_athena.conf		- mesweb 追加

	(doc/)
		conf_ref.txt				- mesweb 追加

	(httpd/)
		index.html					- チャット入室フォームの追加

	(src/map)
		map.c						- do_init() 修正
		clif.*						- clif_chat_addmes(), clif_chat_httpd() 追加
									  clif_onlymessage() 修正
		atcommand.*					- mesweb コマンド追加 atcommand_onlymes() 修正
		mob.c						- mob_damage() 修正

----------------------------------------
//1286 by ID:7QLFJSM

・SQL モードでコンパイルすると警告が出る問題を修正
・allowuseitem 命令に装備品を設定すると、NPC 会話中でも装備できるように。
・next_exp_limit の計算式が誤っていたのを修正
・公平分配の計算が一部間違っていたのを修正
・pc.c 内の double を atn_bignumber に置換

・(fix) 共闘の計算式修正
・(fix) 死んだふり、ハイディング中のキャラに EXP が入るかどうか選択可能に。

(src/char)
int_guild.h
	- guild_config_read() の定義位置
(src/map)
pc.c
	- pc_gainexp() 他、修正
mob.c
	- mob_damage() 修正
party.c
	- party_exp_share() 修正
clif.c
	- clif_parse_EquipItem() 修正
battle.*
	- config 関連

----------------------------------------
//1285 by End_of_exam

・1282でメタ文字のエンコードを忘れていたバグを修正(login.c char.c)
・1282の更新に合わせてsql-files/を修正(main.sql)

　SQL挿入攻撃 に対する脆弱性が生じているので、1282以降のSQL 版を
　お使いの方は、更新をお勧めします。

	(src/login)
		login.c		- login_log() 修正

	(src/char)
		char.c		- char_log() 修正

	(sql-files/)
		main.sql	- 1282に合わせて修正

----------------------------------------
//1284 by ID:7QLFJSM

・httpd が If-Modified-Since / If-Unmodified-Since に対応。
　対応しているブラウザで、転送コストが減ります。
　（ファイル以外のコンテンツではプログラム側の対応が必要です。）
・httpd が Date ヘッダを返すようにした。
・httpd が ファイルコンテンツに Last-Modified ヘッダを付加するようにした。

・ギルド拡張の拡張人数を指定できるように。
　inter_athena.conf の guild_extension_increment で指定します。
　デフォルトが 4 なので、桜井仕様にするには 6 を指定してください。

・inter 鯖周りの config の読み込みを少しスマートに。
　（各設定変数をファイルスコープに）

・パッチアップスレにあった packet_db.txt とりこみ

(fix) httpd.c でシンボル名 access がバッティングする問題を修正

(db/)
packet_db.txt
	- パッチアップスレにあったもの
(doc/)
conf_ref.txt
	- guild_extension_increment 追加
	- authuser に 1280 での変更を追加
(conf/)
inter_athena.conf
	- guild_extension_increment 追加
(src/common)
httpd.c
	- いろいろ
(src/char)
inter.*
int_guild.*
int_party.*
	- いろいろ

----------------------------------------
//1283 by いど

　・サーバースナップショット
　・マップ定義の整理(conf/map_athena.conf)
　・雑談スレッド２ 23のパケット定義を追加(db/packet_db.txt)
　・雑談スレッド２ 21のdb_ref.txtを採用(doc/ref_db.txt)
　　正確でない箇所があるかもしれないので注意

----------------------------------------
//1282 by ID:robert

.Change SQL version login,char log function.
	login.c	
		function:login_log
	char.c	
		function:char_log
.Change guild max member allow 76 member
	int_guild.c
		function:guild_calcinfo
	mmo.h
		MAX_GUILD -> 76
----------------------------------------
//1281 by ID:Nameless

　・Bcc32コンパイルオプション追加(サンプル数1500)
    従来に比べ10〜20%処理が向上します
    ※スイッチ:Prescott
      Pentium4のPrescottコア等に搭載されているHyper-Threadingに対応
    ※スイッチ:Prescott2
      Pentium4のPrescottコア等に搭載されているHyper-Threading&EM64Tに対応
    ※スイッチ:Smithfield
      PentiumXEのSmithfieldコア等に搭載されているHyper-Threadingに対応
    ※スイッチ:Prestonia
      Pentium XeonのPrestoniaコアに搭載されているHyper-Threadingに対応
    ※スイッチ:Manchester
      Athlon64 X2のManchesterコアでの最適化

    (bin/tool) CPUオプション判定用ベンチをtoolに移動しました
      bench.bat
      bench.c

----------------------------------------
//1280 by ID:7QLFJSM

・httpd の Digest 認証で nonce-count をチェックするように修正。
　「繰り返し攻撃」に迅速に対応することができます。
　
　nonce と nonce-count はサーバーのメモリ上に 256 個まで同時に記憶します。
　この関係上、256 人以上が同時に Digest 認証を行うと、stale が頻繁に発生して
　通信コストが激増します。（1回のアクセスに2回認証するようになる）
　同時に 256 人以上 Digest 認証エリアにアクセスする可能性のある
　ハードな環境で使う人は、httpd.c 内の nonce_log[256] を増やしてください。
　（なお、256 で 13KB 程度メモリを使います）

・httpd の Digest 認証で conf 読み込み時にあらかじめ A1 を計算するように修正。
　Digest 認証での計算コストが減ります。

・httpd で conf の authuser のパスワード欄に MD5 や、Digest 認証の A1 を
　指定できるように。
　ただ、困ったことにこれらを計算するツールを作っていない……。
　
　・MD5 を指定する場合は、ユーザー名、パスワードを : で区切ってつなげた
　　(user:name) 文字列の MD5 を求め、
　　authuser: testuser:$MD5$aa4a5443cb91ee1810785314651e5dd1
　　のように、パスワード欄に $MD5$ の5文字 ＋ MD5 の16進表現32文字を指定する。

　・A1 を指定する場合、ユーザー名、領域名、パスワードを : で区切ってつなげた
　　（user:realm:passwd）文字列(A1)の MD5 を求め、
　　authuser: testuser:$Digest$aa4a5443cb91ee1810785314651e5dd1
　　のように、パスワード欄に $Digest$ の8文字、MD5 の16進表現32文字を指定する。
　　
　・Digest 認証を使う場合、MD5 パスワードは指定できません。
　　プレーンか、A1 を使ってください。
　　Basic 認証ではどれでも対応しています。

　・MD5 は各自求めるツールを使ってください。ファイルの MD5 を求めるものが
　　多いので、テキストファイルにパスワードを（改行とか余計な文字を
　　一切含まずに）書いて、そのファイルの MD5 を求めるといいです。

	<例> % cat > passwd
	     testuser:testpasswd (パス入力＆ctrl+d)
	     % md5sum passwd
	     aa4a5443cb91ee1810785314651e5dd1 *passwd
	                          ↓
	     authuser: testuser:$MD5$aa4a5443cb91ee1810785314651e5dd1

・1273 で忘れていた conf の追加分（log を別々に保存する）

(src/conf)
login_athena.conf
char_athena.conf
map_athena.conf
	- httpd_log_filename: 追加
(src/common)
httpd.c
	- struct httpd_auth_nonce 追加, nonce_log, nonce_log_pos 追加
	- httpd_check_access_user_digest() 修正
	- httpd_config_read_add_authuser(), httpd_config_read() 修正

----------------------------------------
//1279 by End_of_exam

・gcc でコンパイルした時にhttpアクセスすると落ちるバグを修正(httpd.c)
・httpd にpostリクエストの受信待ちにタイムアウトを追加(httpd.c)
・httpd でエラーが起きたらすぐに切断するように変更(httpd.c)
・httpd_check_access() の最長一致が抜けていたのを修正(httpd.c)
・httpd_check_access_ip() の判定式が一部違っていたのを修正(httpd.c)
・httpd のスパゲティを少しほぐしてみる(httpd.c)
・converterのMakefileにmd5calc.o を追加(Makefile)

	(src/common/)
		httpd.c			- 色々修正

	(src/converter)
		Makefile		- md5calc.o を追加

----------------------------------------
//1278fix by no name

・本鯖にあわせて装備品の性別での装備可能かの判定の設定を可能に
・battle_athena.confから設定可能。
・デフォルトは判定しない(no)

・battle.cの変更をしていませんでした。
・1278を当てた方は上書き、1277までの方はこれを普段通りに上書きしてください。

	(src/map)
		battle.h
			struct Battle_Configに追加
		battle.c
			battle_config_read()に追加
		pc.c
			pc_isequip()の変更
	(conf/)
		battle_athena.conf
			equip_sexの追加


----------------------------------------
//1277 by End_of_exam

・1274の変更に合わせて、VC++用のdspファイルを更新(*.dsp)
・1276で削除されたReadme1275の末端を復元(Readme1275)
・SSで忘れられていたので、md5calc.* のコピーをcommon/ に追加(md5calc.*)

	(src/login)
		login.dsp login_sql.dsp		- md5calc.c の移動

	(src/char)
		char.dsp char_sql.dsp		- md5calc.c の追加

	(src/map)
		map.dsp						- md5calc.c の追加

	(src/converter)
		converter.dsp				- md5calc.c の追加

	(src/common)
		md5calc.*					- login/ からコピー

----------------------------------------
//1276 by no name

・本鯖準拠のGvG時Flee減少を取り込み
・Flee減少量及び動作範囲をConfigから設定可能
・追加Config
	gvg_flee_penaly
	gvg_flee_rate

	(src/map)
		battle.c
			battle_calc_pet_weapon_attack()
			battle_calc_mob_weapon_attack()
			battle_calc_pc_weapon_attack()
		battle.h
			Battle_Config()
	(conf/)
		battle_athena.conf
			gvg_flee_penalyを追加　デフォルト100　増減無し
			gvg_flee_rateを追加　デフォルト0　使用しない

----------------------------------------
//1275 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1275

BCC32,Cygwin共に動作確認。

----------------------------------------
//1274 by ID:7QLFJSM

*** コンパイル前の注意 ***
md5calc.c / md5calc.h を src/login から src/common に移動してください

・httpd のログ機能修正（リクエストラインが正しくないことがある）
・httpd にアクセス制御機能をつけた
　・IP アドレスをチェックできます。（ホスト名には未対応です）
　・認証ができます。（Basic 認証 / Digest 認証ともに対応しています）
　　認証にログインサーバーのアカウント情報は使えません。
　　あらかじめ設定ファイルに記述しておく必要があります。
　詳しくは conf_ref.txt を参照してください。
　また、 apache の .htaccess などの設定方法も参照するとわかりやすいです。
・httpd の URL に <!>*| などの記号を禁止するようにした
・BCC などの環境でもタイムゾーンを取得できるように。 （thx to End_of_exam）
・socket.conf の order の mutual-failure のスペルミス修正

(doc/conf_ref.txt)
	- httpd_conf.txt や socket_conf.txt 追加
	- 他のファイル一部修正
(src/common)
	- md5calc.c / md5calc.h  (src/login)から移動
	- httpd.c / httpd.h いろいろ追加
	- socket.c  mutual-failture -> mutual-failure 置き換え
各種 Makefile 修正

----------------------------------------
//1273 by ID:7QLFJSM

・httpd にログ機能をつけました( apache形式で吐きます )
・httpd がサブディレクトリを読めるようになりました
・config 関係の整理
　・socket.conf で設定していた httpd 関連の設定が httpd.conf に移動しました。
　　httpd.conf は socket.conf から読み込まれるので、全鯖共通です。
　・socket_conf.txt / httpd_conf.txt がインポート対象として追加されました。
　・map_athena.conf / char_athena.conf / login_athena.conf 内で個別の
　　httpd 関連の設定ファイルを読むことができます。(httpd_config: )
　
　これだけの説明じゃわかりづらいので今後 doc にでも整理していきます。

・httpd.* は 12xx-chat を元にしていますが、
　map.c は 12xx-chat を元にしていません。
　chat 機能を使う場合は各自差分をとってマージしてください。
　（多分 map_config_read() を差し替えればいいはずです）

・httpd.c 内部に怪しい未完成コードがたくさんありますが、
　これらの機能はまだ準備中です。しばらくお待ちください。

・BCC などの環境ではログにつかうタイムゾーンを自動的には取得できません。
　httpd_conf.txt で timezone: +9 という行を追加して保存してください。
　（自動取得できるように改造できる人は、パッチにしてくれると素敵です）

(conf/)
socket.conf
	- httpd 関連の設定削除、 httpd.conf を読むように
httpd.conf
	- 新規追加
(conf/import)
socket_conf.txt
httpd_conf.txt
	- 新規追加
(src/common)
httpd.c
	- いろいろ追加＆修正
httpd.h
	- httpd_set_logfile(), httpd_set_timezone() 追加
socket.c
	- socket_config_read()修正, socket_config_read2()追加
(src/map)
map.c
	- map_config_read() 修正
(src/char)
char.c
	- char_config_read() 修正
(src/login)
	- login_config_read() 修正

----------------------------------------
//1272 by ＡＡＡ
(src/map)
pc.c
	-pc_break_equip()
	-pc_break_equip2()
	・右手と左手を間違えていたのを修正
----------------------------------------
//1271 by ID:7QLFJSM

・AthenaDev wiki で話題にあったスクリプト命令を実装
　・武装解除 / unequip 命令
　・NPC 会話中のアイテム使用許可 / allowuseitem 命令
　詳細は doc/script_ref.txt を参照
・アイテムが使用できない状態のときにアイテムを使用すると、クライアント側の
　Ack 待ちのタイムアウトまでアイテムが使用できなくなるバグを修正

(src/map)
map.h
	struct map_session_data に npc_allowuseitem メンバ追加
script.c
	buildin_unequip(), buildin_allowuseitem() 追加
clif.c
	clif_parse_UseItem() 修正（なんか pc_useitem ですべき処理な気も……）
npc.c
	npc_click() 修正

----------------------------------------
//1270 by ID:7QLFJSM

・httpd でリクエストが長すぎる場合にエラーを返すことができないバグ修正
・httpd でリクエストにタイムアウトを設けた
・httpd の返すリターンコードを少し変更
・httpd の mime タイプを少し追加
・1267 で混入した core.c のテストコード除去（メモリリークを故意に起こすもの）

・(fix) リクエストタイムアウト時間を変更、また socket.conf で指定可能に修正
・(fix) リクエスト回数の制限を設けた。socket.conf で指定可能。
・(fix) Connection ヘッダを見るように修正

(src/common)
core.c
	- main()
httpd.c
	- httpd_get_error() 追加
	- httpd_send_error(),httpd_send_head() 修正
	- httpd_parse(),httpd_parse_header() 修正
	- httpd_mimetype() 修正
	-(fix) httpd_set_request_timeout(),httpd_set_max_persist_requests()追加
	-(fix) httpd_parse_header_sub() 追加
httpd.h
	-(fix) httpd_set_request_timeout(),httpd_set_max_persist_requests()追加
socket.c
	-(fix) socket_config_read() 修正

----------------------------------------
//1269 by Exile
・bonus bMagicDamageReturn修正

	(doc)
		item_bonus.txt 修正
	(src/map)
		skill.c
			skill_attack() 修正

----------------------------------------
//1268 by うんぽこ

・ディボーションがかかってる人を攻撃したとき動きがおかしかったのを修正
・スピアスタブ、アシッドテラーが遠距離判定になっていなかったのを修正
・夕陽のアサシンクロスで弓装備者のAspdが上昇していたのを修正

	(src/map)
		battle.c
			battle_damage()
			battle_calc_pet_weapon_attack()
			battle_calc_mob_weapon_attack()
			battle_calc_pc_weapon_attack()
		status.c
			status_calc_pc()

----------------------------------------
//1267 by ID:7QLFJSM

・httpd からアカウントを作成できるかどうか設定できるように修正。
　グラフ表示などに httpd を使いたいが、アカウントの作成はしたくない場合に。
・httpd のアカウントのIDチェックをユーザー名だけの入力で実行できるように修正。

・_WIN32 系のコンパイラで正常に終了できるように修正。
　Ctrl+C、コンソールウィンドウのクローズ、シャットダウン、ログオフなどに対応。

*** 注意点 ： Cygwin の bash 上で動かすと、謎現象 ***
　bash で普通にフォアグランドプロセスとして起動すると、
　正常に終了することができません。（bash がハンドラをトラップしている？？）
　バックグラウンドプロセスとして実行したときは正常に終了します。
　コマンドプロンプトがわりに bash を常用している人は注意しましょう。
　* 標準のコマンドプロンプトではきちんと動作しますので心配ありません。

(doc/)
conf_ref.txt
	1264 で忘れてた項目なども追加
(conf/db)
login_athena.conf 
	- httpd_new_account 追加
(src/common)
core.c
	- main() 修正
	- core_CtrlHandlerRoutine() 追加
	- <windows.h> を読むように修正
(src/login)
login.c
	- login_httpd_account() 修正

----------------------------------------
//1266 by End_of_exam

・TXT: ログイン鯖終了時にデータが保存されないバグを修正(login.c)
・httpd 用のセッションは session_data2 を使うように変更(socket.* httpd.c)

	(src/login)
		login.c		- do_final() 修正

	(src/common)
		socket.*	- session_data2 の追加
		httpd.c		- httpd_parse() 修正

----------------------------------------
//1265 by ＡＡＡ
(map/src)
pc.c
	-pc_break_equip()
	-pc_break_equip2()
	右手左手両方なにも持たないときに、
	シールドブレイクを受けるとサーバーが落ちるのを修正。

----------------------------------------
//1264 by ID:7QLFJSM

・スパイラルピアースの計算式修正
・1257 で戻った 1253 の修正を再適用 / 1256 は既に再適用済みの模様
・httpd の有効/無効がサーバー毎に切り替えられるように
・httpd のドキュメントルートがサーバー毎に設定できるように

(/conf)
login_athena.conf
char_athena.conf
map_athena.conf
	- httpd に関する設定項目追加
(src/common)
httpd.h
	- set_http_document_root() プロトタイプ追加
httpd.c
	- document_root[] / set_http_document_root() 追加
socket.h
	- socket_enable_httpd() プロトタイプ追加
socket.c
	- socket_enable_httpd() 追加
(src/login)
login.c
	- login_config_read()
(src/char)
char.c
	- char_config_read()
(src/map)
map.c
	- map_config_read()
battle.c
	- battle_calc_pc_weapon_attack() 修正
	- battle_config_read() 修正

----------------------------------------
//1263 by 鬼神
・1257のパッチで1250までbattle.cが巻き戻った模様...orz
・1253、1256の方再度パッチお願いします。
	(src/map)
		battle.c
			battle_config_read() 修正
----------------------------------------
//1262 by Exile
・bonus bAddShort/LongWeaponDamageが通常攻撃で効果なかったのを修正
・bonus2 bAddSkillDamageRateが武器スキルで機能してないのを修正
	(src/map)
		battle.c
			Damage battle_calc_pc_weapon_attack() 修正
----------------------------------------
//1261 by End_of_exam

・1256でmob に対するスキル攻撃が効かなくなっていたのを修正(battle.c)

	(src/map/)
		battle.c	- battle_calc_pc_weapon_attack() 修正

----------------------------------------
//1260 by ID:7QLFJSM

・vc07 でコンパイルすると double->int 警告が出る問題を修正
・vc07_make.bat を修正してみました。詳しくは中を見てください。

(/)
vc07_make.bat
	- いろいろ追加
(src/map)
battle.c
	- スパイラルピアースの計算式を int で計算するように修正

----------------------------------------
//1259 by End_of_exam

・終了時の処理を変更(core.c core.h login.c char.c map.c converter.c)

　今までは割り込みが起きた直後にexit()を呼び出していましたが、終了時に
　落ちたり、処理の流れが分かりにくくなっているので、変更しました。

・httpd の有効・無効を切り替えられるように変更(socket.c)
・httpd にPOSTリクエストを対応させる(httpd.c socket.c)
・httpd のアカウント作成でPOSTリクエスト以外を弾くようにする(login.c index.html)
・タイマーの最大インターバル(TIMER_MAX_INTERVEL)を設定(timer.c)
・センサーの値をu_intからdouble に変更(login.c malloc.c graph.c)
・センサーにuptime(起動時間)を追加(core.h core.c)
・センサーに現在値を表示するように変更(graph.c)
・1257で1256の修正が巻き戻っているのを修正(battle.c)

	(conf/)
		socket.conf		- DDOS対策有効、httpd 用のオプション追加

	(httpd/)
		index.html		- POSTリクエストに変更

	(src/common/)
		core.*			- uptime() 追加 main() sig_proc() 修正
		graph.*			- graph_create() graph_data() graph_addsensor()
						  graph_parse_httpd() 修正
		malloc.*		- memmgr_usage() 修正
		socket.c		- do_parsepacket() socket_config_read() 修正
		httpd.*			- httpd_strcasencmp() httpd_parse_request_ok()
						  httpd_get_method() 追加、httpd_parse_header()
						  httpd_parse() 修正
		timer.c			- do_timer() 修正

	(src/login)
		login.c			- login_users() do_final() do_init() 修正

	(src/char)
		char.c			- do_init() 修正

	(src/map)
		map.c			- do_init() 修正
		battle.c		- battle_calc_pc_weapon_attack() battle_calc_magic_attack()
						  battle_calc_misc_attack() 修正

	(src/converter)
		converter.c		- do_final() 追加

----------------------------------------
//1258 by 鬼神
・配置MOBの再出現までの時間の設定で、0にした場合即沸きするように修正
	(src/map)
		npc.c
			npc_parse_mob()修正
	(conf)
		battle_athena.conf
			// 配置MOBの再出現までの時間（0で即沸き、100で通常、200で倍の時間、…）
			mob_delay_rate: 100
			に修正
----------------------------------------
//1257 by Estas
・本鯖にあわせてスキル仕様変更
	-スパイラルピアースの計算式を修正
	-スパイダーウェブがくもの糸を消費するように修正
	-ウォールオブフォグ、スパイダーウェブの最大Lvを修正
	-ディスペルの必要アイテムが黄ジェム1個になったのを適用
	-ディボーションの詠唱が固定されてたのを修正
	-ルアフが11*11、サイトが15*15になってたのを5*5、7*7に修正

	(db)
		skill_db.txt
		skill_cast_db.txt
		skill_require_db.txt
	(src/map)
		battle.c
			battle_calc_pc_weapon_attack()
		status.c
			status_change_timer()
----------------------------------------
//1256 by Exile
・bonus bMagicDamageReturn追加（魔法ダメージ反射）
・bonus bAddShortWeaponDamage追加（近距離物理攻撃のダメージ追加）
・bonus bAddLongWeaponDamage追加（遠距離物理攻撃のダメージ追加）
・bonus2 bAddSkillDamageRateが機能していなかったのを修正
・bonus2 bItemHealRateが機能していなかったのを修正
・本鯖にあわせてスキル仕様変更
	-ダブルアタック：HITボーナス追加
	-シグナムクルシス：DEFの減少量増加、成功率上昇
	-スキンテンパリング：無属性攻撃の耐性追加
	-サンクチュアリ：制限カウント数変更（skilllv*6+20）
	-急所攻撃：スタン確率変更（(バッシュLv-5)*5+(ベースLv/3)）
	-クローンスキル：サンクチュアリでダメージを受けた場合、同Lvのヒールをコピーするように修正。
	 　　　　　　　　クローンスキルのLvよりも低いLvのスキルでダメージを受けた場合、
	 　　　　　　　　クローンスキルのLvでコピーしていたのを、受けたスキルのLvでコピーするように修正。

	(db)
		const.txt
	(doc)
		item_bonus.txt
	(src/map)
		battle.c
			Damage battle_calc_pc_weapon_attack() 修正
			Damage battle_calc_magic_attack() 修正
			Damage battle_calc_misc_attack() 修正
		map.h
			map_session_data 修正
		pc.c
			pc_bonus() 修正
			pc_useitem() 修正
		skill.c
			skill_additional_effect() 修正
			skill_unit_group *skill_unitsetting() 修正
			skill_castend_nodamage_id() 修正
			skill_attack() 修正
		status.c
			status_change_start() 修正
			status_calc_pc() 修正
----------------------------------------
//1255 by 鬼神
・配置MOBの再出現までの時間を調節可能に
・コンパイルで警告出ていたのを修正

	(src/map)
		npc.c
			npc_parse_mob()
		battle.c
			battle_config_read()
		battle.h
			Battle_Config()
		status.c
			status_change_start() 修正
	(conf)
		battle_athena.conf
			// 配置MOBの再出現までの時間（100で通常、200で倍の時間、…）
			mob_delay_rate: 100
			追加
----------------------------------------
//1254 by huge
・Gv中に弓ガーディアンが占領ギルドのメンバーも攻撃してくるのを修正。
・PC型mobにギルドIDを持たせた時に、同ギルドには攻撃はしないようにと、
	エンブレムとギルド名も表示させるようにした。
	役職は19番目(最後)のを表示。PT名にとりあえず"NonPlayerChara"と入れた。

	(src/map/)
		clif.c
			clif_parse_GetCharNameRequest() 修正
		mob.c
			mob_can_reach() 修正
			mob_ai_sub_hard_activesearch() 修正

----------------------------------------
//1253 by ＡＡＡ
battle.h
battle.c
	-battle_config_read()
	練気功のタイプを選択可能に
	演奏・踊りの持続時間を変更可能に
status.c
	-status_change_end()
skill.c
	-skill_castend_nodamage_id()
	-skill_check_condition()
	コンセントレイションにインデュア効果追加
	気球が5つ全てある状態でも練気功を使用可能に
(conf)
battle_athena.conf
 	dance_and_play_duration : 20000
	soulcollect_max_fail : no
(doc)
conf_ref.txt
----------------------------------------
//1252 by Mr.T
(db)
skill_unit_db.txt
	不協和音,	口笛,夕陽のアサシンクロス,ブラギの詩,イドゥンの林檎
	自分勝手なダンス,ハミング,私を忘れないで…,幸運のキス,サービスフォーユー
	のサイズを7x7に変更

----------------------------------------
//1251 by ＡＡＡ
status.c
status.h
skill.c
	-status_change_start()
	-status_change_end()
	演奏・踊りが20秒持続するように修正
pc.c
	-pc_break_equip()
	シールドブレイクで両手武器が壊れるのを修正
(db)
skill_require_db.txt
	猛虎硬派山が気を消費したのを修正

----------------------------------------
//1250 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1250

BCC32,Cygwin共に動作確認。

----------------------------------------
//1249 by End_of_exam

・httpd の追加
・FIFO関連の最適化
・メモリマネージャを標準で有効にする
・添付されていたzlibが不完全だったのを修正

　athenaのポートに直接HTTPアクセス( http://127.0.0.1:6900/ )することにより、
　サーバーの状態を見たり、アカウント作成（ログイン鯖のみ）が出来るように
　なりました。また、httpd/以下にファイルを置けば、アクセスした時に表示される
　内容を変更できますが、今のところ次の制限があります。

　・ファイルの大きさは1MB 程度まで(それを超えるとパフォーマンスが悪化します)
　・サブフォルダには未対応

　バグ入りかもしれないので、ご利用は計画的にお願いします。

	(/)
		bcc32_make.bat		- httpd.c graph.c の追加

	(httpd/)
		index.html			- 標準で表示されるページ

	(src/common/)
		graph.*		- 新規追加(png の動的作成ルーチン)
		httpd.* 	- 新規追加(httpd のコアルーチン)
		grfio.*		- grfio_load_zlib(), grfio_crc32() 追加
		malloc.*	- memmgr_usage() 追加、メモリマネージャ有効
		socket.*	- FIFO関連の最適化、httpd サポートの組み込み
		Makefile	- httpd.c graph.c の追加

	(src/common/zlib/)
		Makefile	- エラーが出ないように修正

	(src/login)
		login.c		- login_users(), login_httpd_account() 追加 do_init() 修正
		login.dsp login_sql.dsp Makefile	- httpd.c graph.c の追加

	(src/char)
		char.c		- char_txt_make(), do_init() 修正
		char.dsp char_sql.dsp Makefile		- httpd.c graph.c の追加

	(src/converter)
		converter.dsp Makefile				- httpd.c graph.c の追加

	(src/map)
		map.c		- do_init() 修正
		map.dsp Makefile					- httpd.c graph.c の追加

----------------------------------------
//1248 by ID:7QLFJSM

大きな数字の処理とかの修正です。
コンパイル時に BIGNUMBER_DOUBLE マクロが定義されていると、
 大きな数字に double 型を使い、定義されていないと 64bit整数を使います。

・exp の計算に atn_bignumber を使うように。
・BCC かどうかの判定に __BORLAND_C_ マクロを使うように。
・exp の int へのキャストでオーバーフロー判定を増やした。

・(fix) exp の計算式修正

(開発者向け)
  int を超える大きな数字を使うときは atn_bignumber 型を使ってください。
  vc で計測したところ、キャストを含む場合、double よりも __int64 のほうが
  高速でした。ただ、double のほうが高速な環境もあると思いますので、
  マクロで変更できるようにしました。
  なお、やってませんが、 pc_gainexp や party_exp_share の引数も
  atn_bignumber にしたほうがキャストが減るので高速かもしれません。

(src/common)
mmo.h
	- atn_longlong の定義(64bit整数) __int64 か long long 。
	- atn_bignumber の定義(64bit整数かdouble型) マクロで選択
	- BCC 判定
core.c
	- BCC 判定
(src/map)
mob.c
	- mob_damage()
party.c
	- party_exp_share()
pc.c
	- pc_gainexp()

----------------------------------------
//1247 by ＡＡＡ
(src/map)
	pc.c
		-pc_damage()
	bonus3 bRaise,n,x,y;でy<0にした場合にエラーが出るのを修正
(doc)
	item_bonus.txt
	記述が間違っていたので修正
	bonus2 bRaise,n,x,y;
		↓
	bonus3 bRaise,n,x,y;

----------------------------------------
//1246 by 逆毛鰻

	(script/warp/)
		warp_ain_yuno.txt		アインブロクワープ追加
	(conf)
		map_athena.conf
	//コメントアウトにてwarp_ain_yuno.txt、npc_monster_future.txt
	アヨタヤ・アインブロク・未使用ＭＡＰ等を追加
既存のワープと一緒に読み込めば、アルデバラン〜ジュノ〜アインベフ・ブロク
全て繋がります（一部ワープゾーンが２つになっちゃいますが）

----------------------------------------
//1245 by ID:7QLFJSM

とりあえず vc で延々と出てくる警告がでなくなりました。

・意味もなく double 型で計算している場所を修正（意味があったらすいません）
  鯖が軽くなりますし、 vc で double -> int 変換の警告がでなくなります。
  （もし四捨五入/切捨ての誤差が問題なら、誤差を考慮した整数計算式を
    作ったほうがいい気がします。）
・double -> int 変換の警告がでないように修正
・pc.c の参照されてない変数の警告が出ないように修正
・vc で仮引数と実引数の不一致の警告が出ないように修正
・vc で unsigned と signed の比較の警告を抑制した
・vc で strcasecmp は自作のものではなく _stricmp を使うようにした
・pet.h の struct pet_db で一部を int -> short に。
  （intif のパケットで WORD 転送されているものは int の意味が無いし、
    vc で仮引数と実引数不一致の警告が出るため）
・mob.h の struct mob_db の lv を int -> short に。上と同じ理由。

・(fix) BCC では自前の strcasecmp を使うように
・(fix) party.c の pc_gainexp を読んでいる部分
・(fix) 2005-05-09eRagexe の修正と、2005-05-27fRagexe の追加

(src/common)
mmo.h
	- #pragma で unsigned と signed の比較警告(4108)を抑制 
	- #define で strcasecmp を _stricmp にエイリアス
core.c
	- strcasecmp が必要ないので #if 0 で囲む
(src/map)
pet.h
	- struct pet_db class,itemID,EggID,AcceID,FoodID を short に。
mob.h
	- struct mob_db lv を short に。
battle.c
	- battle_calc_pc_weapon_attack() クリティカル *0.01 => /100
	- battle_calc_magic_attack() ソウルストライク *0.05 => /20
mob.c
	- mob_damage() exp部分 *0.01 => /100
party.c
	- party_exp_share() exp部分 *0.01 => /100
pc.c
	- pc_gainexp() 明示的に int に変換した
	- pc_break_equip() 参照していない i を削除
	- pc_damage() 装備破壊 pc_break_equip2 の第2引数の型
	- pc_setpos() chrif_changemapserver() の第6引数の型
pet.c
skill.c
	- skill_check_condition() マナリチャージ *0.04 => /25
	- skill_additional_effect() 装備破壊 pc_break_equip2 の第2引数の型
pet.c
	- pet_return_egg() const int → short 変換を明示的にした
	- pet_get_egg() const int → short 変換を明示的にした
status.c
	- status_calc_pc() *0.5 => /2
clif.c
	- clif_parse_SelectEgg() の pet_select_egg の第2引数の型
(db)
packet_db.txt

----------------------------------------
//1244 by ＡＡＡ
・回避時も反撃していたようなので修正
・アイテムボーナスをいくつか追加(item_bonus.txt)
・装備解除ペナルティで死亡しないように修正(death_by_unrig_penalty : no)

(src/map)
map.h
pc.h
pc.c
	-pc_break_equip2()追加
	-pc_bonus()修正
	-pc_bonus2()修正
	-pc_damage()修正
skill.c
	-skill_additional_effect()修正
status.c
	-status_calc_pc()修正
battle.h
battle.c
	-battle_config_read()修正
(conf)
(db)
const.txt
(doc)
item_bonus.txt
conf_ref.txt

----------------------------------------
//1243 by End_of_exam

・TXT: キャラを作成する時に悪い条件が重なると落ちるバグを修正
	(char.c thanks to 2ch の皆さん)

	(src/char)
		char.c		- char_txt_make() 修正

----------------------------------------
//1242 by ID:7QLFJSM

・packet_db.txt で負の位置を指定すると、パケットの後ろからの位置になるようにした
・packet_db.txt に jRO データの暫定追加（まじめにテストしてない）

・serverstatus.cgi にアクセスが集中するとサーバー負荷がひどいので、
  キャッシュできるようにした。
  といっても普通は各自オリジナルや別に配布されてるチェッカを使ってると思うので
  あまり意味無いかもしれない。

clif.c
	- packet_db の位置参照するとき GETPACKETPOS マクロを使うようにした
	- packet_db の位置を参照している場所を全て修正
	- actionrequest,useskilltoid に jRO 用のコード追加
(db)
packet_db.txt
(bin/tool/cgi)
serverstatus.cgi

----------------------------------------
//1241 by AAA
・ボーナス 村正の呪いを実装
・追加効果がPC,MOB,PET以外にかからないように修正
・赤エモにならないようにする (nomanner_mode : no)
map.h
pc.c
	-pc_bonus()
skill.c
	-skill_additional_effect()
status.c
	-status_calc_pc()
atcommand.c
	-atcommand_mannerpoint()
battle.h
battle.c
	-battle_config_read()
clif.c
	-clif_changestatus()
	-clif_parse_GMReqNoChat()
(conf)
battle_athena.conf
(db)
const.txt
(doc)
item_bonus.txt
conf_ref.txt
----------------------------------------
//1240 by End_of_exam

・チャット禁止コマンドに不正なIDが渡された時に落ちるバグを修正(clif.c)
・httpd の前準備として、clif_foreachclient() のチェックを強化(clif.c)

	(src/map)
		clif.c		- clif_foreachclient(), clif_parse_GMReqNoChat() 修正

----------------------------------------
//1239 by ID:7QLFJSM

・struct mob_data の nodrop,noexp,nomvp を struct state に移した
・pc.c の参照されてない変数の警告が出ないように修正

	(src/map)
	pc.c		- pc_bonus()修正
	map.h		- nodrop,noexp,nomvp を移動
	mob.c		- nodrop,noexp,nomvp を参照してる部分を修正
	script.c	- 同上
	skill.c		- 同上

----------------------------------------
//1238 by ＡＡＡ
・ボーナス 死亡時蘇生
・ボーナス 死亡時アイテムロスト
・HP/SP装備解除ペナルティが正常に機能するように修正
・conf_refの修正
(src/map)
map.h
pc.h
pc.c
	-pc_bonus()修正
	-pc_bonus2()修正
	-pc_bonus3()修正
	-pc_damage()修正
	-pc_lossequipitem()追加
status.c
	-status_calc_pc()修正
(doc)
item_bonus.txt
(db)
const.txt
conf_ref.txt
----------------------------------------
//1237_fix by Exile
・src/map/battle.cの修正（thanks to たさん）
ご迷惑おかけしました。
----------------------------------------
//1237 by Exile
・対mob時にbonus2 bSubSizeが機能していなかったのを修正（battle.c）
・対mob時にbonus2 bSubGroupが機能していなかったのを修正（battle.c）
・スクリプト関数readparamでstr,agi,vit,int,dex,lukを取得できるように修正（pc.c）

	(src/map)
		battle.c	- battle_calc_mob_weapon_attack修正
		pc.c	- pc_readparam修正
----------------------------------------
//1236 by End_of_exam

・親が倒された取り巻きがPCから離れると落ちるバグを修正(mob.c)
・コンパイラ間でパケット長の互換性を保つために、#pragma pack を追加(mmo.h)

　コンパイラ間で構造体のアライメント長が違う場合が考えられるので、mmo.h 内部の
　アライメントを 4に指定しました。login<->char、char<-> map など、サーバー間で
　構造体をやりとりする時、その構造体の定義はmmo.h 内部で行うようにしてください。

	(src/common)
		mmo.h		- #pargma pack の追加

	(src/map)
		mob.c		- mob_ai_sub_lazy() 修正

----------------------------------------
//1235 by 稀枝

script.c
	スクリプト命令、getguildrelation追加

--------------------
//1234 by AAA
	報告のあったバグ取り
	怨霊武士カードのペナルティ追加
	ボーナス　必中ダメージ追加
	(マミー+Aマミーの組み合わせ？ 星処理)
	天候が雨の場合、水場無しでWBが使える???
	バグ報告スレにあったヒットストップタイプ追加
	コンボ入力時間の最低保障追加
	取巻きの経験を戻す(battle_athena.txtで設定)
	DROP,EXP,MVP関係のCONFIG追加
	AS重複にカードID判定以外に武器IDも含める

map.h
	#define AREA_SIZE 20 -> 14 (thanks to yukitoさん)

	mob_data
	short nodrop	追加
	short noexp	追加
	short nomvp	追加
pc.h(thanks to 通りすがりさん)
	-pc_bonus_autospell() 宣言追加
	-pc_bonus_add_autospell_rate() 宣言追加
	-pc_bonus_ban_autospell() 宣言追加
	-pc_bonus()
pc.c
	-pc_damage()(thanks to 赤氏さん)

status.c
status.c
	-status_calc_pc()修正

script.c
	-buildin_agitcheck()  (thanks to End_of_examさん)
	-buildin_monster()修正
skill.c
	-skill_attack()修正
	-skill_add_blown()修正(thanks to 通りすがりさん)
	-skill_castend_pos2()修正
	-skill_check_condition()修正
	-skill_castend_damage_id()修正
battle.h
battle.c
	-battle_calc_damage()修正
	-battle_weapon_attack()修正
	-battle_config_read()修正
mob.h
mob.c
	-mob_once_spawn()修正
	-mob_spawn()修正
	-mob_damage()修正
	-mob_summonslave()修正
	-mob_class_change_id()修正
(battle_config)

//コンボ入力時間の最低保障追加
//ステータスの上限が大きい場合入力時間がなくなるので追加
combo_delay_lower_limits 0

//反撃状態異常に武器の状態異常を上乗せする
reveff_plus_addeff : no

//DROP EXP MVPの有無 conf_ref.txt参照
summonslave_no_exp :  no
summonslave_no_drop :  no
summonslave_no_mvp :  no
cannibalize_no_exp :  no
cannibalize_no_drop :  no
cannibalize_no_mvp :  no
branch_mob_no_exp : no
branch_mob_no_drop : no
branch_mob_no_mvp : no
branch_boss_no_exp : no
branch_boss_no_drop : no
branch_boss_no_mvp : no
(db)
const.txt
(doc)
item_bonus.txt
conf_ref.txt
(conf)
battle_athena.conf
----------------------------------------
//1233 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1233

BCC32,Cygwin共に動作確認。

--------------------
//1232 by AAA
・ボーナス アイテム回復効果増幅(特定グループ用)　※
・ボーナス スキル使用時吹き飛ばし追加　※
・ボーナス スキルダメージアップ　※
・ボーナス 近接攻撃時n%の確率で敵(PC)の現SPをx%消失 (nとxは加算)
	※ダークプリーストｃの妄想実装
・ハイド,クローク,チェイス状態でWPに近づいても転送しないように修正
・グランドクロスなどで自分に反撃があったのを修正
・装備効果のオートスペル強化 攻撃・反撃合わせて16個まで　※
  複数の所持可能に	(expand_autospell : no)
  1回に１度だけ発動  	(once_autospell :  yes)
  同じカードのオートスペルを許可  (allow_same_autospell : no)
※オートスペル、アイテムＭＯＢグループなどの許容量はmap.hの
  #define MAX_〜を変更してください
(src/map)
map.h
itemdb.h
	struct item_data
	#define	itemdb_group(n) (itemdb_search(n)->group)
itemdb.h
	-itemdb_readdb()
battle.h
battle.c
	-battle_config_read()
status.h
status.c
	-status_get_sp() 追加
	-status_calc_pc()修正
	-status_calc_pc_autospell() 追加
	-status_calc_pc_cardeffect_init()   追加
	-status_calc_pc_cardeffect_finish() 追加
skill.c
	-skill_attack()　修正
	-skill_use_bonus_autospell()　追加
	-skill_bonus_autospell()　追加
pc.h
pc.c	-pc_bonus()	修正
	-pc_bonus2()	修正
	-pc_bonus3()	修正
	-pc_itemheal()	修正
	-pc_bonus_autospell()		追加
	-pc_bonus_add_autospell_rate()　追加
	-pc_bonus_ban_autospell()	追加
npc.c
	-npc_touch_areanpc()	修正
mob.h
mob.c
	-mob_isdead()	追加
(db)
mob_group_db.txt
item_group_db.txt
--------------------
//1231 by yukito
アコライトスキル「ワープポータル」の効果時間が5秒短かったのを修正しました。
ウィザードスキル「クァグマイア」の同時設置制限（3枚まで）を反映しました。
アコライトスキル「ワープポータル」、ハンタースキル「スキッドトラップ」「ランドマイン」
「アンクルスネア」「ショックウェーブトラップ」「サンドマン」「フラッシャー」
「フリージングトラップ」「ブラストマイン」「クレイモアトラップ」、
ウィザードスキル「ファイアーピラー」の足元置き不可を反映しました。
マジシャンスキル「サンダーストーム」の効果範囲を5x5に修正しました。（Exileさんご指摘分）
	(db)
		skill_db.txt
		skill_cast_db.txt
		skill_unit_db.txt

カプラ倉庫の利用で、所持金が利用料金に満たなかった場合に処理が流れてしまう不具合を修正しました。
（kfstorage関数のreturn前のendが抜けていたため）
	(script/npc)
		npc_function.txt

GvG時間中に砦を放棄、またはギルドを解体した時にエンペリウムとMobが再出現するように修正しました。
この修正に伴い、ev_agit_common.txt内の関数resetcastledataとresetcastledata3の引数を増やしています。
一部デバッグコードが入っていたものや関数呼び出しが使われていなかったものを修正しました。
（動作自体は何も変わっていません。）
	(script/npc/gvg)
		aldeg_cas01.txt
		aldeg_cas02.txt
		aldeg_cas03.txt
		aldeg_cas04.txt
		aldeg_cas05.txt
		ev_agit_aldeg.txt
		ev_agit_common.txt
		ev_agit_gefg.txt
		ev_agit_payg.txt
		ev_agit_prtg.txt
		gefg_cas01.txt
		gefg_cas02.txt
		gefg_cas03.txt
		gefg_cas04.txt
		gefg_cas05.txt
		payg_cas01.txt
		payg_cas02.txt
		payg_cas03.txt
		payg_cas04.txt
		payg_cas05.txt
		prtg_cas01.txt
		prtg_cas02.txt
		prtg_cas03.txt
		prtg_cas04.txt
		prtg_cas05.txt

スクリプトでagitcheck関数を呼び出すとエラーが出るので抑制しました。
（1行コメントアウトしただけですが、問題があれば戻して下さい。）
	(src/map)
		script.c
--------------------
//1230 by フレイ
1228のパッチでmob.cにsnprintf関数が導入されたのに対応して、VCTK(vc07)でコンパイルできるように回避策を入れました。

	(src/map)
		mob.c
--------------------
//1229 by Exile
ワープポータルの使用を制限するmapflag“noportal”を追加しました。
ただし、完全に仕様を書き換えてしまうと不都合が出るかもしれませんので、
battle_athena.conf/noportal_flagで新旧の仕様を切り替えられるようにし、
指定がない場合は旧仕様（noteleportで制限）で動作します。

	(conf)
		battle_athena.conf		(noportal_flag追加)

	(doc)
		conf_ref.txt		(noportal_flagについて加筆)

	(src/map)
		atcommand.c		(atcommand_mapinfoにnoportal追加)
		battle.c battle.h		(confにnoportal_flag追加)
		map.h		(map_dataにnoportal追加)
		npc.c		(npc_parse_mapflagにnoportal追加)
		script.c		(MF_NOPORTAL追加)
		skill.c		(ワープポータル修正)

--------------------
//1228 by huge
・MOBを沸かす際に、一度しか沸かない場合はスタック位置でも出すように変更
・遠距離攻撃を行うmobが、崖撃ちをしてくるように修正
・アイテムを拾う際に距離をチェックするように修正
・赤エモが出ている間は、チャットもNPCとの会話もできないように修正
・露店に名前をつけたペットの卵を出した時、愛されている〜と出るように修正
・ギルドIDを持ったPC型MOBがエンブレムを表示するようにした
・ギルドIDを持たせたMOBを沸かせられるようにした
	<gatname>,<x>,<y>,<xs>,<ys><tab>monster<tab><displayname><tab><npcid>,<number>,<spawn_delay1>,<spawn_delay2>[[,<guild_id>],<event>]
	例）payg_cas01.gat,0,0,0,0	monster	--ja--	1701,1,360000,180000,10001,0
	注)guild_idを入れる場合は、eventに何らかの記述が入っていないと、guild_idがeventとして誤認識されてしまいます。
	   既に登録されているeventを変更する手間を考えての仕様です。
・NPCのグローバルメッセージの修正
・時間沸きするMOBがクラスチェンジした場合、名前とspeedが戻らなかったのを修正
・取り巻きmobの主が死んだ時の処理を変更（バイオプラントなどの場合で、召喚したPCが死んだ時も消えるように）
・バイオプラントの数規制
・MOBが寒いジョーク・スクリームを使った時に、スキル名を叫ぶようにしてみた
・召喚された(取り巻き・バイオプラントなど)mobを倒しても経験値が入らないように修正
	※転生パッチが着てから、取り巻きの経験値が無くなったということで。でもイクラは経験値があるとの噂…
・経験値分配計算に用いるIDをblからchar_idへ変更
・武器修理スキルの仮実装
	まだパケット情報が確かではありませんが・・・。
・mapflag追加
	noabra	(アブラ禁止フラグ)
	nodrop	(ドロップ無し)
	base_exp_rate	(Map単位のBaseExp倍率設定)
	job_exp_rate	(Map単位のJobExp倍率設定)
・Atcommand	詳細はhelp.txt参照
	charitemreset,mapflag,mannerpoint,connectlimit 追加
	charpetrename	表示メッセージの修正
	alive	死んでいる時にしか使えないように修正
	makepet	IDではなく、名前を入れても卵ができるよう修正
・battle config
	・露店で、購入者の名前を通知できるように
	・MVPmobを倒した時に、announceできるように
	・ペットがアイテムをルートした際、そのまま飼い主がアイテムを入手できるように
	※next_exp_limitの扱いを変更
	　一度に上がるレベルアップの制限を、%表記するように。
	　100で1レベル分。200で2レベル分。デフォルトは150。
	　例)250に設定時、Lv1で経験値が30%のキャラが、どんなに多くの経験値を取得したとしても、Lv3の80%までしか上がらない。
・scriptのgmcommand,checkequipedcardに細かい修正

	(conf)
		atcommand_athena.conf
		battle_athena.conf
		help.txt
		msg_athena.conf
	(db)
		packet_db.txt	(武器修理パケット及び、2005-05-09aSakexe分追記)
		skill_cast_db.txt	(武器修理・石拾い修正)
	(doc)
		client_packet.txt
		conf_ref.txt
		script_ref.txt
	(src/char)
		char.c
		char.h	mapif_parse_CharConnectLimit() 追加
		inter.c
			inter_send_packet_length{} 修正 0x3070使用
			inter_parse_frommap() 修正
	(src/common)
		version.h	versionの更新
	(src/map)
		atcommand.c
		atcommand.h 修正
			charpetrename,alive,makepet 修正
			charitemreset,mapflag,mannerpoint,connectlimit 追加
		battle.c
		battle.h 修正
			Damage battle_calc_pc_weapon_attack() 微修正
			confのnext_exp_limit 修正
			confにmpv_announce,petowneditem,buyer_name 追加
		clif.c
		clif.h
			clif_mob0078() 修正
			clif_mob007b() 修正
			clif_GlobalMessage() 修正
			clif_item_repair_list() 修正
			clif_item_repaireffect() 追加
			clif_vendinglist() 修正
			clif_openvending() 修正
			clif_send_petdata() nullpoチェック
			clif_parse_NpcClicked() 修正
			clif_parse_CreateChatRoom() 修正
			clif_parse_RepairItem() 追加
		intif.c
		intif.h
			intif_char_connect_limit() 追加
		map.h
			mapflag 追加
			map_session_dataにrepair_target 追加
		mob.c
			mob_spawn_dataset() 修正
			mob_spawn() 修正
			mob_ai_sub_hard_activesearch() 修正
			mob_ai_sub_hard_slavemob() 修正
			mob_ai_sub_hard() 修正
			mob_damage() 修正
		npc.c
			npc_globalmessage() 修正
			npc_parse_mapflag() 修正
			npc_parse_mob() 修正
		pc.c
			pc_authok() 修正
			pc_takeitem() 修正
			pc_walk() 修正
			pc_gainexp() 修正
		pet.c
			pet_ai_sub_hard() 修正
			pet_ai_sub_hard_lootsearch() 修正
		script.c
			buildin_monster() 修正
			buildin_gmcommand() 修正
			buildin_checkequipedcard() 修正
		skill.c
		skill.h
			skill_additional_effect() 修正
			skill_castend_nodamage_id() 修正
			skill_castend_pos2() 修正
			skill_check_condition() 修正
			skill_can_repair() 追加
			skill_repair_weapon() 追加
		vending.c
			vending_purchasereq() 修正

※自分の環境ではSQLを利用していないので、SQLをご利用の方に支障が出るかもしれません。
--------------------
//1227 by ＡＡＡ
(map/src)
battle.c
	-battle_calc_pc_weapon_attack()
status.h
status.c
	-status_change_start()
pc.c
	-pc_bonus()
	-pc_unequipitem()
skill.c
	-skill_attack()
	
	不死属性が石化を無効にしていなかったのを修正
	装備解除時のHP/SPペナルティ実装
(doc)
item_bonus.txt
--------------------
//1226 by ＡＡＡ
・殴ると一定の確率で別のMOBに変える効果
・特定グループ(ゴブリン,オークなど)にダメージ増加
・特定グループ(ゴブリン,オークなど)からのダメージ減少他
item_bonus.txt参照

(map/src)
map.h
	#define MAX_MOBGROUP 10
mob.h
	-mob_class_change_randam()
mob.c
	-mob_class_change_randam()
	-mob_readdb()
battle.c
	-battle_calc_pc_weapon_attack()
status.h
	-status_get_group()
status.c
	-status_get_group()
pc.c
	-pc_bonus2()
	-pc_bonus3()
skill.c
	-skill_attack()

(doc)
item_bonus.txt
(db)
const.txt
mob_group_db.txt	グループ定義ファイル 0:未定義　１〜MAX_MOBGROUPまで定義可能
			


--------------------
//1225 by 鬼神
・詠唱があってディレイのないスキルに攻撃速度影響のディレイがついていたのを、つかないように修正。(気功など)
・モンクの三段掌が連打掌を覚えていなくてもコンボディレイがついていたのを、つかないように修正。
	(scr/)
		battle.c	- battle_weapon_attack()を修正
		
		skill.c		- skill_delayfix()を修正
				- skill_use_id()を修正
				- skill_use_pos()を修正
				- skill_attack()を修正
				
		skill.h		- skill_delayfix()を修正
			
--------------------
//1224 by トリガー
・IDから名前を返すgetcharname関数を追加。
・charid2nickの定義をmap.cからmmo.hに移動。
・script_ref.txtにgetcharname関数の説明を追加。
・朝凪 氏 の変更を追加。
	・FreeBSD4.X(+gmake)環境でコンパイル出来るように修正(login.c char.c)
	・結婚衣装の時に、1時間経つ前にリログすると衣装が元に戻ってしまう点を修正(clif.c pc.c status.c)
	・結婚衣装の時は、通常攻撃不可、アイテム使用不可に変更(clif.c)
	・相方が結婚指輪を装備している時にだけ「あなたに逢いたい」スキルで相手を呼び出せるように変更(intif.c)
	・「あなたに逢いたい」スキル使用時、相方を呼び出す位置を修正(intif.h intif.c skill.c)
	・離婚時に相方が未接続の場合、正常に離婚できない点を修正(char.c chrif.h chrif.c pc.c)
	・離婚処理の方法を見直したことに伴い、char<->map鯖間のパケットを変更(2b12変更 2b20追加)
	・script_ref.txtにmarriage関数とdivorce関数の説明を追加

	(conf/)
		battle_athena.conf	1222の変更を追加。

	(doc/)
		serverlink_packet.txt	- 2b12を変更
					- 2b20を追加

		script_ref.txt		getcharname関数とmarriage関数とdivorce関数の説明を追加

	(src/common)
		mmo.h		struct charid2nick 追加

	(src/login)
		login.c		- sys/types.h を先にincludeするように変更

	(src/char)
		char.c		- arpa/inet.h をincludeする順番を変更
				- char_divorce() 修正
				- char_delete() 修正
				- parse_frommap() 修正 (2b20を追加)

	(src/map)
		chrif.c		- packet_len_table[] 修正 (2b12)
				- chrif_reqdivorce() 追加 (2b20の処理)
				- chrif_divorce() 修正
				- chrif_parse() 修正 (2b12)

		chrif.h		- chrif_reqdivorce() 追加

		clif.c		- clif_parse_LoadEndAck() 修正
				- clif_parse_ActionRequest() 修正
				- clif_parse_UseItem() 修正

		intif.c		- intif_charmovereq2() 追加
				- intif_parse_CharMoveReq() 修正

		intif.h		- intif_charmovereq2() 追加

		map.c		struct charid2nick 削除
				char_search() 追加

		map.h		char_search() 追加

		pc.c		- pc_remove_map() 修正
				pc_divorce() 修正

		script.c	buildin_getcharname() 追加
				buildin_marriage() 修正
				buildin_divorce() 修正

		skill.c		- skill_castend_nodamage_id() 修正
				- skill_unit_onlimit() 修正

		status.c	- status_change_start() 修正
				- status_change_end() 修正

--------------------
//1223 by ＡＡＡ
	(scr/map/)
		battle.c
		map.h
		status.c
		pc.c
		n種族に対してクリティカル+nのボーナスが正常に動くように修正
		IWを殴ると状態異常に掛かるのを修正
	(doc/)
		item_bonus.txt
		bonus2 bAddCritical,n,x;	n種族にクリティカル+x
			↓
		bonus2 bCriticalRace,n,x;	n種族にクリティカル+x
	(db/)	
		const.txt

--------------------
//1222 by ＡＡＡ
	(scr/map/)
		skill.c
		battle.c
		battle.h
		装備効果のオートスペルのSP消費有無追加
		pc.c
		-pc_attack_timer()
		クローキング状態で通常攻撃できなかったのを修正(thanks to 赤氏)
		クローキングからハイディングできるように修正(thanks to 赤氏)
	(conf/)
		//装備効果のオートスペルのSP消費
		//0:する 1:しない
		equip_autospell_nocost : no

--------------------
//1221 by End_of_exam

・石拾いを使うと落ちる可能性のあるバグを修正(skill.c)

	(src/map)
		skill.c		- skill_castend_nodamage_id() 修正

--------------------
//1220 by 鬼神
	(scr/char/)
	char.c
		2005-05-09Sakexeより追加された新髪型対応で
		dat[33]>=20
		　　↓
		dat[33]>=24
	
	(scr/common/)
	mmo.h
		2005-05-09Sakexeより追加された新髪型対応で
		#define MAX_HAIR_STYLE 20
		　　　　　↓
		#define MAX_HAIR_STYLE 24
	
	(scr/map/)
	battle.c
		battle_config.no_spel_dex1 = 0;
		battle_config.no_spel_dex2 = 0;
		battle_config.pt_bonus_b = 0;
		battle_config.pt_bonus_j = 0;
		と
		{ "no_spel_dex1",			&battle_config.no_spel_dex1	},
		{ "no_spel_dex2",			&battle_config.no_spel_dex2	},
		{ "pt_bonus_b",			&battle_config.pt_bonus_b	},
		{ "pt_bonus_j",			&battle_config.pt_bonus_j	},
		追加
	battle.h
		int no_spel_dex1;
		int no_spel_dex2;
		int pt_bonus_b;
		int pt_bonus_j;
		追加
	party.c
		PTボーナス、一人増えるごとに経験値+50% ohhsaba限定変更athena wiki より
		を改造してbattle_athena.confから読み込めるように
		pc_gainexp(sd,base_exp/c+1,job_exp/c+1);
		　　　　　　　　↓
		pc_gainexp(sd,(base_exp/c)*(1+battle_config.pt_bonus_b*0.01*(c-1))+1,(job_exp/c)*(1+battle_config.pt_bonus_j*0.01*(c-1))+1);
	skill.c
		無詠唱DEX値をbattle_athena.confから読み込み
		time=time*castrate*(150- dex)/15000;
		　　　　　　　　↓
		if(battle_config.no_spel_dex1 && battle_config.no_spel_dex2) time=time*castrate*(battle_config.no_spel_dex1- dex)/battle_config.no_spel_dex2;
		else if(battle_config.no_spel_dex1) time=time*castrate*(battle_config.no_spel_dex1- dex)/15000;
		else if(battle_config.no_spel_dex2) time=time*castrate*(150- dex)/battle_config.no_spel_dex2;
		else time=time*castrate*(150- dex)/15000;
		
	(conf/)
	battle_athena.conf
		//無詠唱DEX値(0でデフォルトの150に)
		no_spel_dex1: 0

		//無詠唱DEX値をいくらで割るか(0でデフォルトの15000に)
		no_spel_dex2: 0
	
		//PTボーナス、一人増えるごとに経験値+n% ohhsaba限定変更athena wiki よりのを改造(本鯖は0)
		//base経験値ボーナス
		pt_bonus_b: 0
		//job経験値ボーナス
		pt_bonus_j: 0
		を追加
--------------------
//1219 by no name
(src/map/)
battle.c
	 433行目 int rate,luk;
		    ↓
		 int luk;
	 443行目 int skilllv=sd->revautospell_lv,i,f=0,sp = 0;
		    ↓
		 int skilllv=sd->revautospell_lv,f=0,sp = 0;

mob.c
	2439行目 int class,count = 0;
		    ↓
		 int count = 0;

	上記3箇所、未使用変数であり、make時にwarnigが出るため変数削除


skill.c
	アルケミストスキル「バイオプラント」,「スフィアーマイン」を
	アイスウォール設置セルに対して使用すると制限無しで召還、
	また召還MOBがアクティブ化(自キャラを攻撃)するバグがあるため、
	アイスウォールがあると召還できないように修正。

----------------------------------------
//1218 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1218

BCC32,Cygwin共に動作確認。

--------------------
//1217 by ＡＡＡ
(scr/map/)
skill.c
	7194行目 if( src->type==BL_PC && (sd = (struct map_session_data *)src) ){
battle.c
	2890行目付近
	if( bl->type==BL_PC && (sd = (struct map_session_data *)bl){
	
	End_of_examさんの指摘どおり等価になってませんでした
	改悪してましたすみませんでした

pc.c
	-pc_damage()
	//ドロップするアイテムID
	bone_drop_itemid: 0 でドクロをドロップするように修正

--------------------
//1216 by 鬼神
	(scr/map/)
	battle.c
	battle.h
	pc.c
	//PC死亡時に、ドクロをドロップするか
	をドクロ限定ではなくbone_drop_itemidで指定したアイテムをドロップするように変更。
	(conf/)
	battle_athena.conf
	//ドロップするアイテムID
	bone_drop_itemid: 0
	追加
--------------------
//1215 by 逆毛鰻
	(src/map/)
	vending.c
	skill.c
	ゼニーデュープ防止策：vending.cの
	if(pc_cartitem_amount(sd,sd->vending[i].index,sd->vending[i].amount)<0){
	を、以下に修正
	if(sd->vending[i].value<0 || sd->vending[i].amount<0 || pc_cartitem_amount(sd,sd->vending[i].index,sd->vending[i].amount)<0){
	する事で、過去のどのAthenaもどのクライアントでもデュープ行為は防げます
	＊バグ報告スレッドの(no name) No.301 / ID:7QLFJSMさんthxでした〜
	露店のコメントアウト前のskill.cもつけておきます

--------------------
//1214 by ＡＡＡ
(src/map/)
skill.h
battle.c
mob.c
mob.h
	-mob_class_change(struct mob_data *,int *value);
		↓
	-mob_class_change(struct mob_data *,int *value,int value_count);
	-mob_class_change_id(struct mob_data *md,int mob_id);追加
	チェンジポリンの修正
	チェンジクラスの修正
	露店のコメントアウト(ゼニーバグがあるため)
	他細かいバグ修正と最適化

--------------------
//1213 by End_of_exam

・不正なレベルのギルドを読み込もうとすると落ちるバグを修正(int_guild.c)
・メモリマネージャのチェック機能を強化する(malloc.c)

　メモリマネージャーの機能強化ですが、不正なポインタをfreeしたり、
　確保した領域を超えたメモりの書き込みを検出できるようにしました。
　デバッグに協力して頂ける方は、メモリマネージャを有効にして、
　出てきたログを貼り付けてくれれば、さらに安定するかもしれません。

	(src/common/)
		malloc.c		- メモリのエラーチェックを強化

	(src/char)
		guild.c			- guild_nextexp() 修正

--------------------
//1212 by ＡＡＡ
(src/map/)
map.h
battle.c
pc.c
status.c
mob.c
	カードを装備していないときは計算しないように修正
	他細かいバグ修正と最適化

--------------------
//1211 by yukito
(script/)
	mob/npc_monster_gvg.txt
	主のいないギルド砦で、攻城戦終了時にエンペリウムが消滅して
	その後（攻城戦開始時になっても）二度とエンペリウムが出現しなくなっていた不具合を修正。

	npc/gvg/ev_agit_common.txt
	砦を所有しているにもかかわらずギルドダンジョンに入れない場合があった不具合を修正。
	商業投資と防衛投資を1日に2回を越えて実行しようとした時に出る投資不可能のメッセージの
	NPC名の部分が「執事ビオル」に固定されていたのを変数を正しく参照するように修正。

--------------------
//1210 by ＡＡＡ
(src/map/)
mob.c
	マップが落ちるのを修正

--------------------
//1209 by no name
(conf/)
	atcommand_athena.conf
	help.txt

	※上記2個のファイルは個々で設定が違うと思うので各々の設定に合わせてください。
(doc/)
	script_ref.txt
		マップフラグの綴り間違い訂正及び、記入漏れがあったマップフラグを追加説明
	help.txt
		GMコマンドの漏れがあったので追記



(src/map/)
	clif.c
		clif.cがgccにてコンパイル時に警告を吐くため修正


		clif.cをいじってる人は下記の部分のみ訂正で可

	8718行目を演算子の優先順位のままにカッコを追加
	if((tid == bl->id && type == 2 && !pc_isGM(sd)) || (pc_isGM(sd) > pc_isGM(dstsd)) && pc_isGM(sd)>50){
					↓
	if( (tid == bl->id && type == 2 && !pc_isGM(sd)) || ((pc_isGM(sd) > pc_isGM(dstsd)) && pc_isGM(sd)>50) ) {

--------------------
//1208 by ＡＡＡ
(src/map/)
battle.c
skill.c
	盗作スキルでスキルを複数覚えれるバグを修正

--------------------
//1207 by ＡＡＡ
(src/map/)
battle.c
mob.c
skill.c
pc.c
	-pc_bonus
	-pc_bonus2
	-pc_bonus3
	-pc_spheal
	-pc_hpheal
status.c
	-status_calc_pc
map.h

(db)
const.txt
(doc)
item_bonus.txt
	アイテム効果色々実装
--------------------
//1206 by yukito
(src/char/)
	int_guild.c
	inter.c
	inter.h
	ギルドに同一アカウントの別キャラの加入を制限するかどうかを設定可能にしました
	(conf)
	inter_athena.conf
		guild_join_limit
			ギルドに同一アカウントの別キャラの加入を制限するかどうかを設定します。
			0:制限しない 1（0以外）:制限する
			省略可能で、デフォルトは1（制限する）です。
	(doc)
	conf_ref.txt

--------------------
//1205 by ＡＡＡ
(src/map/)
	battle.c
	map.h
	pc.c
	skill.c
	status.c
	オートスペルの修正
	・攻撃対象、スキルレベル固定
	・攻撃対象、スキルレベル変動（高レベルへ）
	・自分、スキルレベル固定
	・自分、スキルレベル変動（高レベルへ）
	※サクライの仕様がわからないのでLV10じゃなくても高ければ優先するようにしました
	(db)
	const.txt
	(doc)
	item_bonus.txt

--------------------
//1204 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1204

BCC32,Cygwin共に動作確認。

--------------------
//1203 by AAA
(src/map/)
	pc.c
	skill.c
	status.c
	・クローキングがダメージを喰らっても解けなかったのを修正

--------------------
//1202 by End_of_exam

・モンスターが自爆したときに落ちる可能性があるバグを修正(status.c)
・SQL: 1185でアイテムが保存されなくなっていたバグを修正(char.c)
・SQL: 1185のギルド初期レベル修正が不十分だったのを修正(int_guild.c)

　MySQL では複数ステートメントで構成されているクエリーを実行すると、
　エラーが起きるようです（ｗ。PostgreSQLの方は対応しているので、
　平気かなと思っていたら、見事にこけてくれたようですorz

　某匿名掲示板に「巻き戻さないの？」という書き込みがありましたが、
　巻き戻し機能はMySQL v4.1から追加されたらしく、未だに多くの場所で
　利用されているv4.0のサポートを打ち切る訳にはいかないと思ってます。
　現状のままだとSQL <-> char間のデータロスト問題(delete から insert
　するまでの間に強制終了すると発生します)を解決する方法は見つかって
　いません。詳しい方いたら助けてください。

	(src/char/)
		char.c			char_sql_saveitem() 修正
		int_guild.c		guild_sql_new() 修正

	(src/map/)
		status.c		status_change_end() 修正

--------------------
//1201 by AAA
	(src/map)
	skill.c
	pc.h
	-skill_use_pos
	チェイスウォーク中でも地面設置系魔法なら撃てるのを修正

--------------------
//1200 by AAA
	(src/map)
	skill.c
	・バイオプラント
	名前は術者の名前が表示される。 
	MHP=1500＋(召喚するもののSkillLv?×200)＋(ケミのBaseLv×10)適用
	・スフィアーマイン
	名前は術者の名前が表示される。 
	MHP=1500＋SkillLv×200
	※通常Mobを呼ぶように修正(仕様みたのですがドロップ経験ともにあるので)
	(db)
	skill_db.txt
	フルストリップの射程修正
	mob_avail.txt
	mob_db.txt
	mob_skill_db.txt
	マリンスフィアのダミーを削除。
--------------------
//1199 by Deme
GvGの24時終了に対応。翌0時開始の場合、中断することなくGｖGできます。
実質1日中とか、日をまたいでのGvGが可能になります。
	(db/)
		const.txt		GvGの曜日・時間の説明の修正
	(script/npc/gvg)
		ev_agit_common.txt	GvGの24時終了に対応
--------------------
//1198fix by nono
	(src/map)
		skill.c
			スフィアーマインの再修正。
	(db/)
		mob_avail.txt
		mob_db.txt
		mob_skill_db.txt
			マリンスフィアのダミーを作成。
--------------------
//1198 by nono
	(src/map)
	skill.c
		スフィアーマインがダミーMobでなく
		通常のMobを呼んでいたのを修正。
--------------------
//1197 by AAA
	(src/map)
	pc.c
	・チェイスウォーク修正
	(隠れたまま敵を攻撃できたのを修正)
--------------------
//1196 by Deme
GvGの曜日設定をわかりやすく修正。
	(db/)
		const.txt		GvGの曜日・時間の修正
	(script/npc/gvg)
		ev_agit_common.txt	GvGの曜日・時間の修正に対応

--------------------
//1195 by AAA
	(src/map)
	pc.c
	pc.h
	・チェイスウォーク修正
	移動すると他人から姿が見えていたのを修正
--------------------
//1194 by ('-'*
ミョルニールのランダム属性追加
	(src/map)
		battle.c
			装備属性判定にランダム属性判定追加
	(db)
		item_db.txt
			ミョルニールのbonus bAtkEle,n;の属性番号変更と、
			装備可能職業を剣士系と商人系に修正
	(doc)
		item_bonus.txt
			ランダム属性追加に伴う、bonus bAtkEle,n;の説明修正

--------------------
//1193 by AAA
	(src/map)
	status.c
	skill.h
	skill.c
	pc.c
		チェイスウォーク追加
	pc.c
		-pc_setpos
		ワープ先でハイド、クローク、チェイス状態解除
		本鯖だとWPで移動できないが解らないので移動後解除
		WARPで行っているから判別不可能？
		(pc_setposでスキル判定してreturn行えばWPに乗れるがカプラ転送で不具合が)
	(db)
	skill_cast_db.txt
		チェイスウォーク修正
		
--------------------
//1192 by 逆毛鰻

・GM(ゲームマスター)レベルにより赤エモ付与が使えるか使えないかの機能(thx kisaragiさん)
	ＧＭレベルによる赤エモ制限が可能。デフォルトでLv50以上でなければ使えない
	pc_isGM(sd)>50の「50」の部分を変更すれば好みのＧＭレベルに合わせる事が出来ます
	赤エモ使えるＧＭと使えないＧＭを区別する為に追加。（逆毛鯖で2ヶ月テストしましたが異常無し）
・高倍率鯖での上納値あふれが原因のギルドデーター破損バグ回避
・GvGの細かい曜日・時間設定を可能にしました。（毎日決まった時間しかＧｖＧできないのを解消）

*修正箇所
	(src/map)
		clif.c
		修正箇所：		if((tid == 〜〜〜　))　の２行。内容は上記参照

	(db/)
		exp_guild.txt		最後に０を加えて上納経験値ギルド破壊バグ回避
		const.txt		GvGの細かい曜日・時間設定が可能に
	(script/npc/gvg)
		ev_agit_common.txt	GvGの細かい曜日・時間設定が可能に
					いずれも宝箱の出現個別指定には未対応です。
			詳しくはコメントアウト部分参照
			GVGの開始設定辺り〜時間チェック〜時間中再起動時の再開処理まで編集

--------------------
//1191 by Sapientia

・ギルドとパーティー加入の時同じ勘定内のキャラクターで重複加入を防止
(int_guild.c, int_party.c)

--------------------
//1190 by Deme
	(script/npc/job)
	npc_job_07knight.txt
		騎士ウインザーのmob試験中にタイマーがとまってしまうのを防ぐ修正
	npc_job_20dancer.txt
		ダンス試験終了時のwaitを設定
--------------------
//1189 by End_of_exam

・スフィアマインが自爆タイマー中に自動消滅した時に落ちるバグを修正(status.c)
・guild_gvg_eliminate_timer() のメモリリークを修正(guild.c thanks to Shinomoriさん)

	(src/map)
		guild.c		guild_gvg_eliminate_timer() 修正
		status.c	status_change_end() 修正

--------------------
//1188 by AAA & 赤氏
	(src/map)
	skill.c
		-skill_castend_nodamage_id()
		-skill_castend_pos2()
		-skill_check_condition()
		スリムポーションピッチャーの移植

	・クローキング移動速度修正(thanks to 赤氏さん)
	pc.c
		-pc_walktoxy_sub()
	status.c
		-status_calc_pc
--------------------
//1187 by フレイ
zlibのソースを全て最新(zlib 1.2.2)のものに差し替えておきました。
特に重要な更新でもありませんが、LOCALZLIBをonにしている方には多少は有用でしょう。
（更新の必要のないファイルも一部ありますが、一緒にパッケージングしています。）

vc07_make.batに対応したvc07_clean.batを新たに作成しました。
vc07_make.batではデフォルトでLOCALZLIBがonになっている点や、
サーバーのexeファイルの作成される位置が違っている点をカバーしています。
vc07_make.batにbcc32_make.batと同等のコンパイルオプションを付ける事も検討しましたが、
それが自分でできないようなレベルならば、せめてbccでコンパイルするべきだろうという考えから見送りました。

また、db系ファイルを幾つか更新し、npc_monster_future.txtも一応追加しています。独自の拡張をなさっている方はご注意下さい。
dbファイルはhuge氏のサイト、「huge cgi」(http://www.usamimi.info/~huge/)のものです。
huge氏、またそこで編集をなさっている皆様方に感謝します。

また、巻き戻しもかかった1182を欠番とし、Readme1180からも内容を削除し、Readme1180の文字コードをShift-JISに戻しています。

	vc07_clean.bat
	Readme1180

	(src/common/zlib/)
		全ファイル(20個)

	(db/)
		item_bluebox.txt
		item_cardalbum.txt
		item_db.txt
		item_violetbox.txt
		mob_db.txt
		mob_skill_db.txt

	(script/mob/)
		npc_monster.txt
		npc_monster_future.txt	-新規に追加
--------------------
//1186 by AAA
	(src/map)
	skill.c
		-skill_check_condition()
		・爆裂状態で気功無しの状態で残影可能
--------------------
//1185 by End_of_exam

・1182の修正を巻き戻し(login.c char.c login_athena.conf char_athena.conf)
・マップキャッシュの細かいバグを修正(map.c thanks to Shinomoriさん)
・npc_event_dequeue() が正常に機能しないバグを修正(npc.c thanks to Shinomoriさん)
・char<->mapの切断時に、倉庫のキャッシュを消すように変更(chrif.c)
・guild_recv_memberinfoshort() で落ちるバグを修正(guild.c)
・VC.NET で do_init_npc() 内部で実行エラーが起こるバグを修正(npc.c)
・ギルドの初期レベルが０になっていたバグを修正(int_guild.c)
・SQL: 暫定的なロスト対策として、アイテム保存方法の見直し(char.c)

	(src/conf)
		login_athena.conf	1182の修正を巻き戻し
		char_athena.conf	1182の修正を巻き戻し

	(src/login)
		login.c		1182の修正を巻き戻し

	(src/char)
		char.c		1182の修正を巻き戻し、char_sql_saveitem() 修正
		int_guild.c	mapif_parse_CreateGuild() 修正

	(src/map)
		map.c		map_cache_open(), map_cache_read() 修正
		npc.c		do_init_npc(), npc_event_dequeue() 修正
		chrif.c		chrif_disconnect() 修正

--------------------
//1184 by AAA
	(src/map)
	pc.c
	skill.c
	status.c
		・クローキングの修正(平地移動速度のみ実装)
	(db)
	skill_cast_db.txt
		・クローキング修正
	job_db2.txt
		・スパノビのJOB補正追加(1183のものは転生用でした)
--------------------
//1183 by AAA
	(src/map)
	status.c
		-status_calc_pc()
		・ドラゴノロジーによるINT増加追加
		・アドバンスドブックによるASPD増加追加
	battle.c
		-battle_calc_pc_weapon_attack()
		・指弾を遠距離に
		-battle_calc_damage()
		・ニューマの処理変更
		  ブリッツビート、ファルコンアサルト貫通に
		-battle_calc_pc_weapon_attack()
		・サイドワインダー武器で攻撃時、ダブルアタックの確率に影響されるように変更

	(db)
	job_db2-2.txt
	・スパノビのJOB補正追加
	　それに伴いスパノビのJOB70ボーナスを+10に
--------------------
//1182 欠番
--------------------
//1181 by 雷折

・オーバートラストマックス、カートターミネーション、プリサーブ、フルストリップ、フルケミカルチャージ実装。
・ストリップスキルの修正、オーバートラストの修正
	(src/map)
		battle.c
		skill.c
		status.c
		skill.h
	(db)
		skill_db.txt
		skill_cast_db.txt
		skill_require_db.txt
		skill_tree.txt

text環境でしか動作確認はしていません。
--------------------
//1180 by 逆毛鰻

・サーバースナップショット
・version.hの更新
	(src/common)
		version.h		- mod version 1180

--------------------
//1179 by End_of_exam

・eAthena のフォーラムに乗っていた不正につながる深刻なバグを修正。
　http://www.eathena.deltaanime.net/board/index.php?showtopic=28144

　このバグは、全ての装備品にそれと同じ種類の装備をカードのように差せるバグです。
　例えば、ブローチ入りのクリップ(Clip in to Brooch) や、ミョルニール入りのナイフ
　(Mjolnir in to Knife) などが作成できます。pc_insert_card() に次の行を追加する
　ことで、修正できます。

  if( nameid <= 0 || sd->inventory_data[idx_equip] == NULL ||
  	(sd->inventory_data[idx_equip]->type!=4 && sd->inventory_data[idx_equip]->type!=5)||	// 装 備じゃない
  	( sd->status.inventory[idx_equip].identify==0 ) ||		// 未鑑定
  	( sd->status.inventory[idx_equip].card[0]==0x00ff) ||		// 製造武器
  	( sd->status.inventory[idx_equip].card[0]==0x00fe) ||
  	( (sd->inventory_data[idx_equip]->equip&ep)==0 ) ||					// 装 備個所違い
  	( sd->inventory_data[idx_equip]->type==4 && ep==32) ||			// 両 手武器と盾カード
+ 	(sd->inventory_data[idx_card]->type!=6)|| // Prevent Hack [Ancyker]
  	( sd->status.inventory[idx_equip].card[0]==(short)0xff00) || sd->status.inventory[idx_equip].equip){

  	clif_insert_card(sd,idx_equip,idx_card,1);
  	return 0;
  }

　eAthenaを使っている方は、svn1552 以上に更新することをお勧めします。

	(src/map/)
		pc.c		- pc_insert_card() 修正

--------------------
//1178 by Nameless

　新型CPUへの最適化コマンドを追加
　最適化補助用ベンチを更新しました。64bitCPUの最適化を見つけることができます。
　Itanium64 / Turion64 / MobileP2 / MobileP3 / MobileP4 / Crusoe
　(/)
		bcc32_make.bat
		bench.bat
		bench.c

--------------------
//1177 by tom

　いい加減な追加変更+見づらいソースである点については、どうぞご容赦下さい。

・シールドチェイン、マナリチャージの実装
・ソウルストライク、オートガード、ディフェンダー、バイオプラント、オーラブレード
　不死身のジークフリード　一部修正
　（対不死追加ダメージ・レベル毎の硬直時間・呪い・被速度減少時でも移動速度低下しない・
　　召還数・必中ダメージではない・全ての耐性増加）
・スキル追加に伴い、skill_db関連の追加修正。

	(src/map)
		battle.c	-battle_calc_damage()
					-Damage battle_calc_pet_weapon_attack()
					-Damage battle_calc_mob_weapon_attack()
					-Damage battle_calc_pc_weapon_attack()
					-Damage battle_calc_magic_attack() 修正
		skill.c		-SkillStatusChangeTable[]　スキル予約追加
					-skill_castend_damage_id() , skill_castend_pos2() , skill_castend_id()
					-skill_check_condition() スキル追加に伴う変更及び一部修正
		skill.h		-スキル追加
		status.c	-status_calc_pc() , status_get_speed() 変更
				-最低限の動作検証しかできない環境ですので、
				ご利用に当たってはバックアップ必須にてお願いします。
	(db)
		skill_db.txt
		skill_cast_db.txt
		skill_require_db.txt
		skill_tree.txt
				-スキル追加に伴い追加修正。アルケミストツリーより剣修練コメントアウト
				（新スキルのツリーはコメントアウトにて予約）

--------------------
//1174 by End_of_exam

・TXT: ギルド作成不可、ギルドデータが壊れるなどのギルド関連のバグを修正
	(int_guild.c thanks to 名無しさん)

	(src/char)
		int_guild.c			- guild_txt_save() , guild_txt_new() 修正
--------------------
//1176 by End_of_exam

　worisyさんやプレイヤーの協力により、だいぶバグが取れてきたようです。
　匿名掲示板で協調性に欠けている、SQL に関して未熟すぎるなど多くの意見を
　頂きましたが、特に言いたいことは無いのでひとまず終焉を迎えたいと思います。
　また、何か良い勉強材料が見つかれば、不安定路線突っ込むかもしれませんが…

・キャラリスタートで現在位置が巻き戻るバグを修正(clif.c)
・アイスウォールにヒールを使うと落ちるバグを修正(skill.c 1167〜)
・SQL: charのリスタートでギルドエンブレムが白くなるバグを修正(int_guild.c)
・SQL: ギルドメンバーのいないギルドを読み込もうとすると失敗を返すように変更(int_guild.c)

	(src/char)
		int_guild.c		- guild_sql_save() guild_sql_load() 修正

	(src/map)
		clif.c			- clif_parse_Restart() 修正
		skill.c			- skill_unit_onplace_timer() skill_castend_nodamage_id() 修正

--------------------
//1175 by End_of_exam

・save/castle.txt が無い状態で起動すると、砦のデータの保存に失敗する
　バグを修正(int_guild.c thanks to とおるさん)
・TXT: 1174の修正が不完全だったのを修正(int_guild.c)

	(src/char)
		int_guild.c			- guild_txt_new() , guildcastle_init() 修正

--------------------
//1174 by End_of_exam

・TXT: ギルド作成不可、ギルドデータが壊れるなどのギルド関連のバグを修正
	(int_guild.c thanks to 名無しさん)

	(src/char)
		int_guild.c			- guild_txt_save() , guild_txt_new() 修正

--------------------
//1173 by かる

・weatherコマンドに花火と雲3種を追加。既存の霧(fog)をアインブロクのものに変更。

	(conf)
		msg_athena.conf	-コマンド追加分のメッセージを追加
		help.txt	-メッセージ追加

	(src/map)
		atcommand.c	-line3928 Weather control のfog変更、fireworks、cloud1、cloud2、cloud3追加
		clif.c		-line1223以下 同様の変更および追加
		map.h		-コマンド追加分のフラグを追加
--------------------
//1172 by End_of_exam

・SQL: ギルドスキルが正常に保存されないバグを修正
	(int_guild.c char-converter.c thanks to worisyさん)
・SQL: パーティメンバーからリーダーが見えなくなるバグを修正
	(int_party.c thanks to worisyさん)

　上のバグの影響でギルドスキルがロストしていますが、MySQL クライアント上から次の
　クエリーを実行すれば、ギルドスキルをリセット出来ます。クエリーを実行するときは、
　*必ず*charサーバーを止めてください。charを起動中に実行すると、予期せぬエラーが
　発生する可能性があります。

DELETE FROM `guild_skill`;
UPDATE `guild` SET `skill_point` = GREATEST(`guild_lv` - 1 , '0');

	(src/char)
		int_guild.c			- guild_sql_save() 修正
		int_party.c			- party_sql_new() 修正

	(src/converter)
		char-converter.c	- guild_tosql() 修正
--------------------
//1171

　欠番

--------------------
//1170 by Sheep

・スキル「速度減少」を弄った時に、通常の移動速度がやけに遅くなっていたバグの修正。
・スキル「砂まき」のダメージ倍率/暗黒付与倍率を本鯖準拠(130%/20%)に。
・スキル「回避率増加」によるアサシン/アサシンクロスの移動速度をSkillLv*0.5 → *1.0に修正。
・スキル「グランドクロス」/「ダーククロス」をmobが使用した場合、反動ダメージが自身に返らないように。
　自分が本鯖で見る限り、mobスキルとしてのG/DXは反動無く使ってるので…。
（GXをPCが使用した場合の 反動4回&単体相手だと4Hit 現象はどこを弄れば良いのか解らず断念しました。）

	(src/map)
		battle.c	-砂まきのdamage計算、グランド/ダーククロスの反動計算 修正。
		status.c	-回避率増加による移動速度増加の倍率修正
				 速度減少の致命的ながらしょーもないバグ潰し。orz
		skill.c		-砂まきの暗黒状態付与の確率を変更。
--------------------
//1169 by End_of_exam

・SQL: ギルドのレベルが上がらないバグを修正(int_guild.c thanks to worisyさん)
・SQL: charサーバーの再起動でカートの中身が消えるバグを修正(char.c)
・SQL: 特殊な文字の保存に失敗するバグを修正(login.c char.c converter.c char-converter.c)
・存在しない設定ファイルを読み込もうとすると落ちるバグを修正(char.c)

	(src/login)
		login.c				- strecpy() 修正

	(src/char/)
		char.c				- strecpy(), char_load_sql(), char_config_read() 修正
		int_guild.c			- guild_sql_init() 修正

	(src/converter)
		converter.c			- strecpy() 修正
		char-converter.c	- mmo_char_tosql() 修正

--------------------
//1168 by Sheep

・NPCスキル「不死属性攻撃」実装。
・NPCスキル「速度強化」実装。 SkillLv*50のFleeを加算、移動速度変化は速度増加と同一。
　特定スキル使用時には無効/解除されるように修正。本鯖ではMVPの一部が(Flee+200(SkillLv4)らしいですが)使ってきます。
・スキル「速度減少」を、SkillLv次第で-50とか出来るように。
・スキル「シグナムクルシス」を、ボスにも有効になるよう修正。
・スキル「ボウリングバッシュ」のキャスティング時間、「アローシャワー」の使用後ディレイを本鯖準拠に。
・変に弄ってしまったスパイラルピアース/シャープシューティングのダメージ計算を戻し。

　to Theiaさん　Sピアース/#Sについてのご指摘、有難う御座いました。

	(src/map)
		battle.c	-NPC_UNDEADATTACK 追加。
		skill.c		-NPC_UNDEADATTACK、NPC_INCREASEFLEE 追加。
		skill.h		-NPC_UNDEADATTACK、NPC_INCREASEFLEE 追加。
		status.c	-status_get_fleeに加算率を追加。status_get_speedに移動速度変化を追加。
				-その他、関連ソースを修正/追加。
	(db)
		skill_db.txt
		skill_cast_db.txt
				-347|不死属性攻撃、350|速度強化 追加。

--------------------
//1167 by Theia

・スキル「バーサーク」の欠けている部分を実装(攻撃速度,回避,HP回復,ヒール量,消費HP)
・猛虎硬爬山,伏虎拳,連柱崩撃,グリムトゥース,矢撃ち,ミュージックストライクのダメージ計算式を本鯖基準に修正
・グリムトゥースが近距離攻撃扱いになっていたのを修正
・バーサーク,連柱崩撃,猛虎硬爬山の消費SPを本鯖基準に修正
・ダブルストレイフィング,ボウリングバッシュ,ブランディッシュスピア,シャープシューティングの使用後ディレイを本鯖基準に修正
・メテオアサルトの詠唱中断を本鯖基準に修正
	(db)
		skill_db.txt
		skill_cast_db.txt
		skill_require_db.txt

	(src/map)
		battle.c
		skill.c
		status.c

--------------------
//1166 by Nameless

・1165以降でのbcc32によるTEXT版のコンパイルオプションを追加(End_of_exam 感謝)
・以前からbench.batにより収集していたCPU最適化オプションをパターン化 (サンプル数320)

	bcc32_make.bat
		22行目 SQL版⇔TEXT版切り替え用
		25行目 CPU最適化スイッチ(set _model_=)

	CPU切り替えスイッチとして利用できる名称は以下の通り
	　Athlon     Athlon_XP    Athlon_MP    Athlon_64
	　Duron      Sempron      Opteron      586
	　686        Pentium2     Pentium3     Pentium4
	　PentiumM   P2_Celeron   P3_Celeron   P4_Celeron
	　P3_Xeon    P4_Xeon      CeleronD
	※Alpha、Crusoe、C3は686にしてください。

--------------------
//1165 by End_of_exam

・map_calc_dir() の方向判定が狂っているバグを修正(map.c)
・MySQL に対応(詳細は readme_mysql.txt を参照してください)

　login/ char/ のほとんど全てのファイルや、char<->map の一部のパケットなど、
　気になった場所を好き放題書き換えています。バグが潜んでいる可能性が極めて
　大きいので、このパッチを当てる際には注意してください。

　テストして頂いた皆様、バグ報告を頂いた皆様、ご協力して頂きありがとうございました。

	(src/*)
		変更点が多いので略。diffするなりして調べてください。

--------------------
//1164 by End_of_exam

・1148の「ダンサーバードの演奏スキル範囲外に出ても効果が20秒持続するよう変更」が
　サーバー不安定の原因になっているので、勝手に巻き戻す(skill.c)
・セージの同じ属性場が２つ重なると落ちるバグを修正(thanks to リーユさん)
・スクリプトのswitchの一時変数をキャラ依存一時変数からマップサーバー依存一時変数
　に変更(script.c thanks to 名無しさん)
・シャープシューティングを本鯖準拠に修正(map.c map.h skill.c thanks to Shinomoriさん)

＊＊　その他細かいバグ修正　＊＊

・clif_foreachclient() が切断待ちクライアントにも反応していたバグを修正(clif.c)
・キャラセレクト時のパケットの送信順序を変更(clif.c)
・char->map のキャラデータ送信時のエラーチェックの強化(pc.c)
・キャラのオートセーブ時に、ギルド倉庫も保存するようにする(pc.c storage.c/h)
・pet_removemap() が原因でサーバーが落ちる可能性のあるバグを修正(pet.c)
・HPが高いモンスターにキリエをかけた後に攻撃を加えると、膨大なダメージを
　与えられるバグを修正(status.c)

	(src/map)
		clif.c		- clif_foreachclient() , clif_parse_Restart() 修正 
		map.c		- map_foreachinarea() 追加
		map.h		- map_foreachinarea() 追加
		pc.c		- pc_authok() , pc_autosave_sub() 修正
		pet.c		- pet_remove_map() 修正
		script.c	- parse_syntax(), parse_syntax_curly_close() 修正
		skill.c		- skill_unit_onout() , skill_unit_onplace() 修正
		status.c	- status_change_start() 修正
		storage.c	- storage_guild_storagesave() 追加
		storage.h	- storage_guild_storagesave() 追加

--------------------
//1163 by いど

・サーバースナップショット

--------------------
//1162 by pizza
・スパイラルピアース・ソウルブレーカー・発勁・ファルコンアサルトについて本鯖準拠に修正

	(db)
		skill_db.txt
			スパイラルピアース・ソウルブレーカーの射程
			ソウルブレーカーが詠唱妨害可
		skill_cast_db.txt
			ソウルブレーカーの詠唱時間
			
	(src/map)
		battle.c	
			発勁・ファルコンアサルトの計算式
			スパイラルピアースがニュマで無効化

--------------------
//1161 by Nameless

・バイオプラントによる召還mobのIDとスキルを本鯖準拠に修正
　※呼び出せる数についてはまだ未実装…

	(db)
		mob_avail.txt
			クライアントによって発生する可能性のあるグラ問題の
			暫定対応
		mob_db.txt
			バイオプラント用mobのステを一部修正
		mob_skill_db.txt
			バイオプラント用mobにスキルを修正

	(src/map)
		skill.c			- case AM_CANNIBALIZE: 修正

--------------------
//1160 by Nameless

・1158のfix
　フェアリーフの非移動化と呼び出されたMOBのHPを下方修正

	(src/map)
		skill.c			- case AM_CANNIBALIZE: 修正

--------------------
//1158 by もっさり
・mob後退実装 　自分が向いてる方とは逆にskilllvの分ぐらい動きます
 離れすぎる呼び戻されないので取り巻き呼び戻しを修正
 IWの斜め位置がおかしかったのを修正（バグ報告スレッド part8 >>110)

	(src/map)
		skill.c			呼び戻し修正、後退追加、IW修正
		skill.h	
		mob.c
		map.h
	(db)
		skill_db.txt
--------------------
//1158 by Nameless

・アルケミのバイオプラントを修正
　各LVにあわせて、マンドラゴラ、ヒドラ、フローラ、フェアリーフ、ジオグラファー
　を呼び出すようにした

	(src/map)
		skill.c			- case AM_CANNIBALIZE: 修正

--------------------
//1157 by eigen

・バードダンサースキルの使用でMAP鯖が落ちる不具合を修正

	(src/map)
		skill.c			- skill_unit_onout() 修正

--------------------
//1156 by eigen

・聖体降福使用時、モンクが人数カウントされていなかった不具合を修正
（thanks to 本鯖相違スレpart3 >>121氏）
・バードダンサースキルの効果が切れなかった不具合を修正

	(src/map)
		skill.c			- skill_unit_onout(), skill_check_condition_char_sub() 修正

--------------------
//1155 by latte
・ディボーションに詠唱時間付与
・サクリファイス：倍率修正とボスに有効に。
・グランドクロスのエフェクトの修正

	(db)
		skill_cast_db.txt
		skill_db.txt
	(src/map)
		battle.c

--------------------
//1154 by eigen

・バードダンサースキル使用でMAP鯖が落ちる問題を修正
・ゴスペルの実装
・マグナムブレイクの仕様を本鯖に合わせて変更(火属性追加ダメージは未実装です)

	(db)
		skill_cast_db.txt	- ゴスペル, マグナムブレイクに関する修正
		skill_require_db.txt	- マグナムブレイクに関する修正
		skill_unit_db.txt	- ゴスペルに関する修正
	(src/map)
		battle.c		- battle_calc_pet_weapon_attack(), battle_calc_mob_weapon_attack(),
						battle_calc_pc_weapon_attack(), battle_calc_magic_attack() 修正
		clif.c			- clif_parse_UseSkillToId(), clif_parse_UseSkillToId(),
						clif_parse_WalkToXY(), clif_parse_ActionRequest(),
						clif_parse_UseSkillToId(), clif_parse_UseSkillMap() 修正
		map.h			- MAX_STATUSCHANGEの増加
		pc.c			- pc_natural_heal_sub() 修正
		skill.h			- マグナムブレイク, ゴスペルに関する状態異常テーブル追加
		skill.c			- skill_castend_damage_id(), skill_castend_nodamage_id(),
						skill_unit_onout(), skill_unit_onplace_timer(),
						skill_init_unit_layout() 修正
		status.c		- status_change_start(), status_change_end() 修正

--------------------
//1153 by ぽえ

・ヒール、サンクの修正
　(イビルドルイドC装備中にPv,Gv以外だとダメージが出ないように修正)
　(該当PCにヒールを使用した場合SPだけ消費)
・放置されてるversion.hの更新
	(src/map)
		skill.c			- skill_castend_id(),skill_unit_onplace_timer() 修正
	(src/common)
		version.h		- mod version 1153
--------------------
//1152 by p

・鉱石発見修正
	(db)
		item_db.txt			- 古い巻物の getitem 番号を戻し
	(src/map)
		itemdb.c			- 鉱石発見時生成処理の変更
		mob.c				- 鉱石発見処理の変更
--------------------
//1151 by p

・ブラックスミススキル鉱石発見の実装(仮)
	(conf)
		battle_athena.conf	- 鉱石発見率の指定
	(db)
		item_findingore.txt	- 鉱石ドロップ率の指定
		item_db.txt			- 古い巻物の getitem 番号変更
	(src/map)
		itemdb.c			- db/item_findingore.txt の読み込みと発見時生成
		battle.h			- 設定保持用の項目追加
		battle.c			- 設定読み込み処理追加
		mob.c				- 鉱石発見処理追加

--------------------
//1150 by Theia

・ベノムスプラッシャーをjRO仕様に変更
　(完全ではないので補完希望)
・シャープシューティングの計算式を変更
　(今までの計算式だと必中していた)
	(db)
		skill_cast.txt
		skill_require_db.txt
	(src/map)
		skill.c			- ベノムスプラッシャーの発動条件を変更
		battle.c		- ベノムスプラッシャー,シャープシューティングの倍率を変更

--------------------
//1149 by eigen

・一部のダンサーバードスキルの演奏スキル上から出るとMAP鯖が落ちる不具合を修正

	(src/map)
		skill.c			- skill_unit_onout() 修正

--------------------
//1148 by eigen

・ストリップスキルが詠唱中断されないよう変更
・ストリップスキル成功率のスキルレベル比重を5に変更
・バックスタブの射程を武器に関係なく1に変更
・バックスタブ使用時、弓を装備しているならダメージ半減に変更
・アシッドテラーとデモンストレーションが詠唱中断されるよう変更
・アシッドテラー使用後、相手の鎧を破壊することに成功した場合ショックエモを出すよう変更
・メルトダウンで破壊できる箇所を武器と鎧のみに変更
・ダンサーバードの演奏スキル範囲外に出ても効果が20秒持続するよう変更
（ただし私を忘れないでと合奏スキルは除く）
・倉庫の最大収容量を300に変更
（以上thanks to 本鯖相違スレPart3 >>115氏）
・メルトダウン鎧破壊確率を0.7〜7%に変更

	(db)
		skill_db.txt		- cast_cancel、rangeの修正
		skill_unit_db.txt	- (1148-fixの取り込み)
	(src/common)
		mmo.h			- MAX_STORAGEを300に
	(src/map)
		battle.c		- battle_calc_pc_weapon_attack() 修正
		skill.c			- skill_additional_effect(), skill_castend_nodamage_id(),
						skill_castend_damage_id(), skill_unit_onout() 修正

--------------------
//1147 by eigen

・インデュア使用後、10秒経たないと再使用できないよう変更
・シーズモードではインデュアを使用するとMDEFが上がるだけに変更
・残影使用後、2秒経たないと阿修羅を使用できないよう変更

	(src/map)
		map.h		- #define MAX_SKILL_ID, unsigned int skillstatictimer[MAX_SKILL_ID] 追加
		clif.c		- clif_parse_UseSkillToId(), clif_damage() 修正
		skill.c		- skill_castend_nodamage_id(), skill_castend_pos2(), skill_use_id() 修正
		pc.c		- pc_setnewpc(), pc_authok() 修正
		status.c	- status_get_dmotion() 修正
		battle.c	- battle_calc_damage() 修正

--------------------
//1146 by eigen

・インデュア使用時Lvに応じてMDEFが上がるように変更
・インデュア使用中7回ダメージを受けると解除するよう変更
・石投げの固定ダメージを50に変更

	(src/map)
		battle.c	- battle_calc_damage(), battle_calc_misc_attack() 修正
		status.c	- status_calc_pc(), status_change_start(), status_change_end() 修正

--------------------
//1145 by End_of_exam

・start のチェック間隔が短すぎたのを修正(start)
・skill_unit_effect() から無限ループに突入して、スタックオーバーフローで落ちる
　可能性があるバグを修正(skill.c)
・ペットの読み込みに失敗した時に落ちるバグを修正(pet.c)
・２重ログインの切断処理が違っていたバグを修正(map.c)

・1142のマグヌスエクソシズムの修正を元に戻す(skill.c)
・メディタティオのSP回復量修正の取り込み(skill.c thanks to ななしさん)

	(/)
		start		- チェック間隔を修正

	(src/map)
		map.c		- map_quit() 修正
		pet.c		- pet_recv_petdata() 修正
		skill.c		- skill_unit_onplace_timer() , skill_unit_effect() 修正
		status.c	- status_calc_pc() 修正

--------------------
//1144 by 聖

・VCでコンパイルしたとき警告が出るのを修正。
・簡易アイテム・モンスター召還コマンド@imを追加。
・@im追加に伴いAEGISで使われている/item,/monsterを実装。
　(AEGISの仕様に則り装備は1個単位・未鑑定で
　ほかのアイテムは30個単位・鑑定済みで出ます。)
・@monsterを召還匹数入力なしで召還できるようにした。
・コマンド入力の際とある条件を満たすと
　バッファオーバーフローが発生するバグを修正。
	(src/map)
		atcommand.h 修正。
		atcommand.c
			atcommand_monster() 修正。
			atcommand_itemmonster() 追加。
		clif.c
			clif_parse_GMkillall() 修正。
			clif_parse_GMsummon() 修正。
			clif_parse_GMitemmonster() 追加。
		status.c
			status_change_start() 修正。
	(db)
		packet_db.txt 修正。
	(conf)
		msg_athena.conf 修正。
		atcommand_athena.conf 修正。

--------------------
//1143 by End_of_exam

・map_quit(), pc_setpos() を色々整理(map.c pc.c)
・モンスターがバシリカを使うと落ちるバグを修正(skill.c)
・ボスモンスターにロキの叫びが効いていたのを修正(mob.c)
・ダンス途中にサーバー内の別のマップに移動した場合、スキルユニットが消えない
　（転送前のマップに残っている）バグを修正。(pc.c)
・1134でサーバー間のワープポータルを使った時に、スキル使用者が乗ったらサーバーが
　落ちるバグを修正(skill.c)
・1134でハエの羽を使ってサーバー間を移動した場合、アイテムが減らないバグを修正(pc.c)

	(src/map)
		map.c		- map_quit() 修正
		mob.c		- mobskill_castend_id() , mobskill_castend_pos(),
					  mobskill_use_id(), mobskill_use_pos() 修正
		pc.c		- pc_useitem(), pc_setpos() 修正、pc_remove_map() 追加
		pc.h		- pc_remove_map() 追加
		skill.c		- skill_castend_nodamege_id(), skill_unit_onplace() 修正

--------------------
//1142 by づん
・マグヌスエクソシズムで種族にアンデットを持つモンスターに当たらなかったのを修正
	(src/map)
	skill.c		- && race!=1を追加

--------------------
//1141.1 by BDPQ銀 [ 2005/02/21 ]
・1141の添付忘れの追加です。申し訳ありませんでした。
・GMコマンドを行った時のメッセージを追加しました。

	(conf)
		msg_athena.conf	- 113〜117		追加	(@reload〜 を行った時のメッセージを追加)

--------------------
//1141 by BDPQ銀 [ 2005/02/20 ]
・GMコマンドを追加
	@reloadatcommand	- atcommand_athena.conf を再読込する
	@reloadbattleconf	- battle_athena.conf を再読込する
	@reloadgmaccount	- gm_account_filename (デフォルト GM_account.txt ) を再読込する
	@reloadstatusdb		- job_db1.txt / job_db2.txt / job_db2-2.txt / refine_db.txt / size_fix.txt を再読込する
	@reloadpcdb			- exp.txt / skill_tree.txt / attr_fix.txt を再読込する
・GMコマンド「@reloadmobdb」でペットのデータベースも再読込するように変更
		* @reload〜 にはクライアントのリログが必要な場合も有ります。
・GMコマンド「@who+」でレベルも表示するように変更
・ヒールを何レベル以上で9999固定にするかのオプション(heal_counterstop)追加

	(conf)
		atcommand_athena.conf	- reloadatcommand reloadbattleconf reloadgmaccount reloadstatusdb reloadpcdb	追加	(デフォルト99)
		battle_athena.conf		- heal_counterstop		追加	(デフォルト11)
		help.txt				- reloadatcommand reloadbattleconf reloadgmaccount reloadstatusdb reloadpcdb who+ の説明を追加

	(doc)
		conf_ref.txt	- 5. conf/battle_athena.conf	編集	(heal_counterstop の説明とサンプルを追加)
						- 6. atcommand_athena.conf		編集	(説明とサンプルに再読込関連を追加)

	(src/map)
		atcommand.c		- AtCommandInfo atcommand_info	編集	(構造体定義)
						- atcommand_whop()				編集	(プレイヤーのレベルも表示するよう変更)
						- atcommand_reloadatcommand()	追加	(atcommand_athena.conf 再読込)
						- atcommand_reloadbattleconf()	追加	(battle_athena.conf 再読込)
						- atcommand_reloadgmaccount()	追加	(gm_account_filename 再読込)
						- atcommand_reloadstatusdb()	追加	(ステータス関連DB 再読込)
						- atcommand_reloadpcdb()		追加	(プレイヤー関連DB 再読込)
						- atcommand_reloadmobdb()		編集	(ペットのデータベースも読込むよう変更)
		atcommand.h		- AtCommandType					編集	(構造体定義)

		battle.c		- battle_config_read()			編集	(heal_counterstop の追加)
		battle.h		- Battle_Config					編集	(heal_counterstop の追加)

		skill.c			- skill_castend_nodamage_id()	編集	(9999ヒール部を battle_athena.conf を参照するよう変更)
		
		pet.h			- int read_petdb();				追加	(ペット関連DB 再読込用)

		pc.h			- int pc_readdb(void);			追加	(プレイヤー関連DB 再読込用)

		status.h		- int status_readdb(void);		追加	(ステータス関連DB 再読込用)

--------------------
//1140 by eigen
・一部の環境でathena-startとstartが正常に動作していなかったバグを修正

	athena-start		- 改行コードを0Aに統一
	start			- 改行コードを0Aに統一

--------------------
//1139 by もっさり
・NPC取り巻き呼び戻しスキル実装
・コメントされてる9999ヒール(skilllv>10の時)、広範囲メテオ(skilllv>10の時)、広範囲ハンマーフォール(skilllv>5の時)のコメント取り外し。
・広範囲lovの付け加え(skilllv>10の時)
例
1312,取り巻き呼び戻し＠タートルジェネラル,attack,354,1,3000,0,0,no,self,always,0,,,,,,10
1063,9999ヒール＠ルナティック,idle,28,11,10,2000,60000,yes,self,always,0,,,,,,　
	
	(src/map)
		skill.c	  npc_recallスキル追加,上記のコメント取り外し
		skill.h   NPC_RECALL = 354を追加
		mob.c     スキル追加のために「取り巻きモンスターの処理」部分に付け加え
		mob.h     int mob_countslave(struct mob_data *md);を追加
		map.h     struct mob_dataにrecall_flagとrecallmob_countメンバー追加
	(db)
		skill_db.txt	スキル追加

--------------------
//1138 by End_of_exam

・1132のsocket.cに紛れ込んでいたかなり深刻なバグ（送信データがランダムに
　書き換わる可能性があるバグ）を修正(socket.c)
・1134で組み込んだアイテムdupe対策が不完全だったのを修正(pc.c party.c guild.c)

	(src/common/)
		socket.c		- send_from_fifo() 修正

	(src/map)
		pc.c			- pc_setpos() 修正
		party.c			- 色々修正
		guild.c			- 色々修正

--------------------
//1137 by いど

・サーバースナップショット

--------------------
//1136 by by eigen

・1135で消えていたbattle_athena.confの項目とデフォルト値を復活
・conf_ref.txtにnext_exp_limitの説明を追加

	(conf)
		battle_athena.conf	- 消えた項目とデフォルト値を復活
	(doc)
		conf_ref.txt		- next_exp_limitの説明を追加

--------------------
//1135 by by Toshi^2
・パッチ1125で修正された、経験値の上限設定を従来方式の制限無しも選べるように変更

	(db)
		battle_athena.conf	- next_exp_limitを追加。
	(src/map)
		battle.c	- battle_config_read() 修正
		battle.h	- struct Battle_Config{}に int next_exp_limit; を追加。
		pc.c		- pc_gainexp() 修正

--------------------
//1134 by End_of_exam

・1132で#undef closeを忘れていたバグを修正(socket.c)
・1133のアイテムdupe対策が不完全だったのを修正(map.c)
・athena-start stop , kill の順番をmap -> char -> login に変更
　　　　(athena-start thanks to eigenさん)

	(/)
		athena-start	- athena-start stop , kill の順番修正

	(src/common)
		socket.c		- #undef close 追加

	(src/map)
		map.c			- map_quit() 修正

--------------------
//1133 by End_of_exam

・mapflag nosave が指定されたマップで死んでリスタートする時に、セーブポイントが
　別マップサーバーにあると、(nul,0,0)に飛ばされていたバグを修正(pc.c)
・マップサーバーを分配している時に、細工をした特殊なツールを使うことによって、
　アイテムがdupeできたバグを修正。(pc.c)
・buildin_menu, buildin_select() がバッファオーバーフローを起こしていた
　バグを修正(script.c)

	(src/map)
		pc.c			- pc_makesavestatus(), pc_setpos(), pc_autosave_sub() 修正
		script.c		- buildin_menu(), buildin_select() 修正

--------------------
//1132 by End_of_exam
・@users コマンド(サーバー内の人数マップを表示)を追加(atcommand.c / h)
・guild_check_alliance() を呼び出すときのチェックを追加(mob.c battle.c)
・マップサーバー分配時にギルドのメンバーが抜けた時、そのギルドメンバーが
　一人もログインしていないマップサーバーが落ちていたのを修正(guild.c)
・1130で見切りの回避率上昇が消えていたのを戻す(status.c)
・pid 対応版のstart, athena-start を統合(start , athena_start)
・田代砲対策、Shinomoriさんの do_sendrecv() 高速化を組み込む
　(socket.c socket.conf Makefile)
・socket の高速化
　　1. FIFOFLUSH が実行される頻度を下げる(socket.c char.c)
　　2. 不正なfdを0 に変更(socket.c socket.h chrif.c char.c)

	(/)
		start			- pid ファイルに対応するように修正
		sthena-start	- pid ファイルに対応するように修正
		Makefile		- "-D_XOPEN_SOURCE -D_BSD_SOURCE" 追加

	(conf/)
		help.txt		- @users 追加、@mes の修正
		socket.conf		- アクセス制限の設定ファイル

	(src/common/)
		socket.c		- アクセス制限の追加、色々高速化
		socket.h		- FIFO命令の高速化

	(src/char/)
		char.c			- parse_tologin(), parse_char() 更新

	(src/map/)
		atcommand.c		- @users 追加
		atcommand.h		- @users 追加
		battle.c		- battle_calc_damage() 修正
		chrif.c			- 不正なfdを0 に変更したのに伴う修正
		guild.c			- guild_member_leaved() 修正
		mob.c			- mob_gvmobcheck() 修正
		status.c		- status_calc_pc() 修正

--------------------
//1131 by eigen
・ギルド拡張の人数増分を+2/Lvから+4/Lvに変更
・メテオストームにスタンがかかるよう修正
・ロードオブヴァーミリオンに暗闇がかかるよう修正
・ヒルトバインディングを取っていればSTR+1 ATK+4が付くよう変更
・ヒルトバインディングを取っていればAR・OT・WPがの効果時間が10%長くなるよう変更
・AR・OTのパーティーメンバー効果時間減少を撤廃
・フロストダイバーで凍結する際、凍結時間がMDEFに影響されるよう変更
・skill_db.txt、skill_require_db.txt、skill_cast_db.txtをOWNや各職Wikiなどを参考に修正

	(src/map)
		skill.c
		status.c
	(db)
		skill_db.txt
		skill_cast_db.txt
		skill_require_db.txt

--------------------
//1130 by eigen
・所持限界量増加の+100/Lvを+200/Lvに修正
・シーフの上位職に於いて回避率増加のFlee上昇率+3/Lvを+4/Lvに修正
・アサシン系が回避率増加を取得している場合、移動速度が+0.5%/Lvになるよう修正
・プレッシャーのSP攻撃を実装
・プリザーブ、フルストリップ、武器精錬、スリムピッチャー、フルケミカルチャージ
をdbに追加

	(src/map)
		skill.c			- skill_additional_effect() 修正
		status.c		- status_calc_pc() 修正
	(db)
		skill_db.txt
		skill_cast_db.txt
		skill_require_db.txt
		skill_tree.txt

--------------------
//1129 by En_of_exam

・NPC イベントが重複した場合のメモリ解放手順が違っていたバグを修正
　　(npc.c thanks to TOSHI^2さん)

	(src/map)
		npc.c		- npc_parse_script() 修正

--------------------
//1128 by 悩める人
・アイテムを消費せずに使用するかのオプション追加
・カード、装備品、エル・オリのドロップ率を別に設定出来るようにオプション追加
・battle_athena.confの初期設定で矢・聖水等を作成時に名前を付けないように変更
　（本鯖ではまだ来てないと思ったので初期設定を変えました）
	(src/map)
		battle.c
		mob.c
		pc.c
		battle.h
	(conf)
		battle_athena.conf

--------------------
//1127 by End_of_exam

・getarraysize() が正しい値を返さないバグを修正(script.c)
　このバグの影響で、deletearray() 命令の動作が正常なものと異なっていました。

・buildin_deletearray() の最適化(script.c)
・シグナル処理中に再度シグナルが呼ばれる可能性に対処する(core.c)
・委託販売を追加してみる(npc_test_seller.txt)

	(src/map)
		script.c	- getarraysize() , buildin_deletearray() 修正

	(src/common)
		core.c		- sig_proc() 修正

	(script/sample)
		npc_test_seller.txt		- 委託販売NPC

--------------------
//1126 by eigen
・メモライズの効果回数と詠唱短縮比率をそれぞれ5回、1/2に修正

	(src/map)
		skill.c		- 1/3になっているのを1/2に修正
		status.c	- 3回になっているのを5回に修正

--------------------
//1125 by lizorett
・ブランディッシュスピアのノックバックを3セルにし、ミス時にはノックバックしない
よう変更
・スピアスタブを対象から自分に向かって4マスの範囲攻撃に変更(本鯖仕様)
・鷹/投石をニュマで防げるよう変更
・ボウリングバッシュが対象にミスした場合にはノックバックしないよう変更
・ソウルブレイカーのダメージ計算、ニュマでミスになるよう変更
・獲得経験値の上限(現レベルの必要経験値-1)を設定
・バジリカ展開時に展開者はノックバックしないよう変更
・メテオアサルトを即時発動、使用者中心、詠唱500ms固定、エフェクト有に変更
・ストリップウェポン時のmobの攻撃力低下を10%に変更
・掛けられているものより低レベルのブレスにより呪い/石化が解除できるよう変更
・ソウルバーン/マインドブレーカー/ソウルチェンジ実装
・シャープシューティングを射線にいる敵にもダメージを与えるよう変更、クリティカル
確率+20%で防御無視ダメージに変更
・投石など一部のスキルが草などに1ダメージにならない問題を修正

	(db)
		skill_db.txt- BDS/メテオアサルト変更、スキル追加
		skill_cast_db.txt
					- スキル追加
		skill_require_db.txt
					- スキル追加
	(src/map)
		battle.c	- ソウルブレイカーのダメージ計算を変更
					- シャープシューティングのクリティカル確率修正
					- 鷹/投石をニュマで防げるよう変更
		skill.h		- SC_MINDBREAKER追加
		skill.c		- BDS/BBのノックバックを修正
					- スピアスタブを範囲攻撃に変更
					- メテオアサルト修正
					- ソウルバーン/マインドブレーカー/ソウルチェンジ実装
		path.c		- シャープシューティングの射線計算を追加
		pc.c		- 獲得経験値の上限(前のレベルの経験値-1)を設定
		status.c	- マインドブレーカーのmatk上昇/mdef減少の実装
		map.h		- シャープシューティングの射線計算用構造体を追加

--------------------
//1124 by もっさり
敵が使う爆裂波動実装
効果
atk1,atk2 1000*skilllv加算
hit 20*skilllv加算

	(src/map)
		skill.c
		skill.h 	NPC_EXPLOSIONSPIRITS関係を追加
		status.c　　　　
	(db)
		skill_db.txt
		skill_cast_db.txt	

		

--------------------
//1123 by Nameless
・Athenaサービス化キットを追加しました。(NT/2000/XP/2003/LH)
　詳しい方法はdoc内のinstasv.txtを参照してください

	(bin/tool)
		instasv.bat	- サービス登録用バッチ
		delasv.bat	- サービス抹消用バッチ
	(doc/)
		instasv.txt	- 説明書(テキスト版)

--------------------
//1122 by End_of_exam

・1120のstrdb のキーを保存し忘れていたバグ修正（db.c）
・念のため1121、1120のreadme をマージして、両方に含まれていたファイルを添付する

	(src/char)
		char.c		- 1121のものを添付

	(src/common)
		mmo.h		- 1121のものを添付
		db.h		- 1120のものを添付
		db.c		- strdb のキーを保存するようにする

	(src/map)
		battle.c	- 1121のものを添付
		guild.c		- 1121のものを添付
		guild.h		- 1121のものを添付
		mob.c		- 1121のものを添付
		skill.c		- 1121のものを添付
		skill.h		- 1121のものを添付

--------------------
//1121 by _

・ロードナイト/パラディンのログイン時のエラー対策
・Gvでの同盟の扱いを修正
　エンペリウム攻撃不可、ガーディアンから攻撃されないように修正
・新追加スキル用の定数追加修正

	(src/char)
		char.c
			修正	mmo_char_send006b()
	(src/common)
		mmo.h
			修正	MAX_SKILL=500
			追加	新ギルドスキル(コメントアウトしてます)
	(src/map)
		battle.c
			修正	battle_calc_damage()
		guild.c
		guild.h
			追加	guild_check_alliance()
		mob.c
			修正	mob_gvmobcheck()
		skill.c
			修正	SkillStatusChangeTable[] (420-490)
		skill.h
			修正	MAX_SKILL_DB=500
			追加	475以降の新スキルID

--------------------
//1120 by End_of_exam

・db_foreach()の呼び出し先でdb_erase()が呼び出されているされている場合、
　複数回同じキーで関数を呼び出す可能性があるバグを修正(db.h db.c)

　cygwin上で２重freeをした場合、プログラムが暴走する可能性があります。
　char鯖との接続が切れたmap 鯖が暴走するバグは、これに起因しています。

	(src/common)
		db.c		- db_eraseを一時的にロックする機能追加
		db.h		- db_eraseを一時的にロックする機能追加

--------------------
//1119 by ICO

・NPCスキル(ブレイクウェポン、ブレイクアーマー、ブレイクヘルム、ブレイクシールド)の実装
・battle_athena.confにmonster_damage_delayを追加。
　noを指定するとFW等のノックバックスキルの挙動が多少本鯖に近づくかも…？

	(db)
		skill_db.txt
		skill_cast_db.txt
	(conf/)
		battle_athena.conf
			monster_damage_delay 追加
	(map/)
		battle.c
		battle.h
		mob.c
			monster_damage_delay関連を追加
		skill.c
		skill.h
			skill_additional_effect,skill_castend_damage_id 修正

--------------------
//1118 by BDPQ銀 [ 2005/02/10 ]
■データベースが変更されています。導入時には御注意ください■
・スキルの固定詠唱時間を skill_cast_db.txt に移動。
  詠唱時間の計算は、 (通常詠唱 + 固定詠唱)*メモライズ補正 となります。
  skill_cast_dbの書式は
    [ID],[cast_list(通常詠唱)],[fixed_cast_list(固定詠唱)],[delay_list(ディレイ)],[upkeep_time(維持時間)],[upkeep_time2(維持時間2)] です。
・アブラカタブラをディレイにASPDによるディレイを付加しないよう修正(即発動スキル用)
・新2次職のskill_cast_dbに関する項目の修正

	(src/map)
		skill.c			-	skill_use_id()			修正	(詠唱時間計算部 ・ メモライズ/魔法力増幅 固定詠唱時間部削除)
															(アブラカタブラの修正)
							skill_use_pos()			修正	(詠唱時間計算部)
							skill_readdb()			修正	(cast_db 読込部)
		skill.h			-	skill_db				修正	(fixedcastの追加)
							skill_get_fixedcast()	追加	(dbから固定詠唱時間の取得)

	(db)
		skill_cast_db.txt-	fixed_cast_list			追加	(固定詠唱時間) 
															魔法力増幅-700、メモライズ-5000に設定

							361(アスムプティオ)		修正	( R.O.M 776を参考に詠唱/ディレイを修正 )
							365(マジッククラッシャー)修正	( R.O.M 776を参考に詠唱/ディレイを追加 )
							373(ライフ置き換え)		修正	( R.O.M 776を参考にディレイを修正 )
							375(ソウルバーン)		追加	( R.O.M 776を参考にディレイを追加 ) ( スキル効果は実装していません )
							381(ファルコンアサルト)	修正	( R.O.M 776を参考にディレイを修正 )
							383(ウィンドウォーク)	修正	( R.O.M 776を参考に詠唱/ディレイ/効果時間を修正 )	
							384(メルトダウン)		修正	( R.O.M 776を参考に詠唱/ディレイを修正 )	
							387(カートブースト)		修正	( R.O.M 776を参考に効果時間を修正 )	
							398(ヘッドクラッシュ)	修正	( R.O.M 776を参考にディレイ持続時間を修正 )
							406(メテオアサルト)		修正	( R.O.M 776を参考に詠唱/ディレイを追加 )

	(doc)
		db_ref.txt		-	1. db/skill_cast_db.txt	修正	(fixed_cast_listの項目を追加)

--------------------
//1117 by End_of_exam

・ベナムスプラッシャーを毒状態の敵に使用したが、失敗した時（敵モンスターの
　HPが2/3 以上だった時）に深刻なメモリリークが起きていたバグを修正(skill.c)
・あなたに逢いたいが失敗した時に深刻なメモリリークが起きていたバグを修正(skill.c)

　上２つは、共にmap_freeblock_unlock() が抜けている為に発生していました。
　ドロップアイテム、スキルユニット、取り巻きなどで確保されたメモリが、
　以降全く開放されなくなるというかなり深刻なメモリリークのバグです。
　map_freeblock_lock() を呼ぶルーチンを修正する場合、ルーチンを抜けるときに、
　map_freeblock_unlock() が呼ばれるように気を付けてください(return に注意!)。

・map_freeblock_unlock() を忘れても良いように、定期的にblock_free_lockを
　クリアするように修正(map.c)
・Debian好き さんのMPVモンスターのHP計算がオーバーフローするバグ修正の取り込み(status.c)

	(src/map)
		skill.c		- skill_castend_nodamage_id() 修正
		map.c		- map_freeblock_timer() 追加、 do_init() 修正
		status.c	- status_get_max_hp() 修正

--------------------
//1116 by End_of_exam

・copyarray で同じ配列を指定した時、コピー先の要素番号がコピー元の要素番号より
　大きい時の動作が不定になっていたバグを修正(script.c npc_test_array.txt)
・関数宣言せずに関数定義したユーザー定義関数を呼び出そうとすると、エラーが出る
　バグを修正(script.c)
・スクリプトのオーバーフロー判定基準を緩和させる(script.c)
・ギルドの告知に\nが使えるバグを修正(int_guild.c)
・イベントdbのメモリリーク修正が不完全だったのを修正(npc.c)
・db_foreachのチェック方法を変更(db.c)
・起動時に*.pid (プロセスIDのファイル)を作成するようにする(core.c)
・経験値所得が全体発言になっているバグを修正(clif.c)
・叫ぶを全体発言に変更(clif.c)
・testerさん作成のVC++ Toolkit2003 用のバッチファイルを同伴(vc07_make.bat)

	(/)
		vc07_make.bat	- testerさん作成のバッチファイルを同伴

	(src/common)
		db.c			- db_foreach() 修正
		core.c			- main() 修正 , pid_create() , pid_delete() 追加

	(src/char)
		int_guild.c		- mapif_parse_GuildPosition() 修正

	(src/map)
		clif.c			- clif_disp_onlyself() , clif_onlymessage() 修正
		npc.c			- npc_parse_script() 修正
		script.c		- buildin_copyarray() , parse_syntax() 修正

	(script/sample)
		npc_test_array.txt	- チェック項目の追加

--------------------
//1115 by いど

・サーバースナップショット

--------------------
//1114-fix1 by 稀枝

・zlibをmap-server内部に取り込めるオプションを追加
・makeがMinGW+Msysで正常に通るよう修正
・win32_start.batにチェック追加

	(src/common/zlib)
		trees.h		- anybody's guess上のzlib_1_2_1_staticlibより取り込み
		inffixed.h	- 同上
		inffast.h	- 同上
		crc32.h		- 同上
		compress.c	- 同上
		deflate.h	- 同上
		inftrees.h	- 同上
		zutil.c		- 同上
		crc32.c		- 同上
		inflate.h	- 同上
		inffast.c	- 同上
		trees.c		- 同上
		inflate.c	- 同上
		zconf.h		- 同上
		deflate.c	- 同上
		inftrees.c	- 同上
		zutil.h		- 同上
		zlib.h		- 同上
		adler32.c	- 同上
		Makefile	- LOCALZLIBが指定されている時のみコンパイルします。

	(src/map/)
		Makefile	- MinGWの場合、引数-wsock32を追加します。
				- LOCALZLIBが指定されている場合リンクします。
				- LOCALZLIBが無い場合だけzlib.aをリンクします。
	(src/char/)
		Makefile	- MinGWの場合、引数-wsock32を追加します。
	(src/login/)
		Makefile	- MinGWの場合、引数-wsock32を追加します。
	(src/common/grfio.c)	- Zlibを内包した際に_WIN32と競合しないよう変更
				- zlib_win32.h zconf_win32.hを廃止

	(./)
		Makefile	- #Link Zlib(NOTrecommended)、zlibを内包します。
		win32_start.bat	- athena-startの半クローン化。初期起動でこけなくなるはずです。

--------------------
//1113 by End_of_exam

・linux 環境で大量のwarning が出ていたのを修正(malloc.h)
・map_quit() でcharid_db のデータを削除しないように変更(map.c thanks to lemitさん)
・pc_eventtimer(), npc_event_timer() のfree()で警告が出ていたのを修正(pc.c npc.c)
・map_eraseipport() がメモリリークしていたバグを修正(map.c)
・addtimer 命令に指定するイベント名が２３文字に制限されていたのを無制限にする(pc.c)
・pc_cleareventtimer() , pc_deleventtimer() がメモリリークしていたバグを修正
　(pc.c thanks to Shinomoriさん)

	(src/common/)
		malloc.h	- "#undef strdup" を追加

	(src/map/)
		npc.c		- npc_event_timer() 修正
		pc.c		- pc_eventtimer() , pc_addeventtimer() , pc_cleareventtimer(),
					  pc_deleventtimer() 修正
		map.c		- map_quit() , map_eraseipport() 修正

--------------------
//1112 by lizorett
・PCがマップ移動中に、そのPCが設置したスキルユニットのskill_unit_onoutが呼ばれ
ない問題(map-severが落ちる可能性あり)を修正
・バジリカを仕様に併せて修正
・正常終了時にchar-serverがコアダンプする問題を修正
・mobがウォータボール使用時のヒット数を修正(skill_db.txtに指定した数ヒット)
・コーティングされている場合にはストリップできないよう変更
・属性場を使用した際、前に出していた属性場が消えないことがある問題を修正

	(db)
		skill_db.txt
				- mobのウォータボールのカウント数をDBにいれた
		skill_unit_db.txt
				- バジリカを修正
	(char)
		char.c	- do_final()のchar_datのメモリ開放位置を変更
	(map)
		clif.c	- バジリカ時に攻撃などができないよう変更
		map.c	- バジリカ位置をセルのフラグに入れるよう変更
		map.h	- バジリカ用のセルフラグ追加
		mob.c	- バジリカに進入できないように変更
		pc.c	- 移動時(蝿など)にバジリカを消すよう修正
		skill.c	- バジリカ修正
				- ウォータボール修正
				- skill_unit_onoutの呼び出しを修正
				- コーティングされている箇所はストリップ不可に変更

--------------------
//1111 by Toshi^2
・pc系mobに転生＆養子を指定できるように変更。
　db/mob_avail.txtに説明文を追加したので、それを参照してください。

	(db)
		mob_avail.txt	- 引数の説明を追加。
	(src/map)
		clif.c	- clif_mob0078() clif_mob007b() clif_pet0078() clif_pet007b() 修正
		mob.c	- mob_readdb_mobavail() 修正
		mob.h	- 構造体mob_dbに「short trans」を追加、mob_availのtransフラグを格納。

--------------------
//1110 by lizorett
・ユニット系スキル(ニュマ、ダンス等)でmap_server.exeが落ちる問題を修正
 (トレースではskill_unit_onplace/skill_unit_onoutで落ちる)
・サンクチュアリの人数カウント方法を変更(本鯖仕様)
・マグヌスの範囲を広げ、使用したユニットが削除されるようにする(本鯖仕様)
・デボーションの距離が短くなる問題を修正(バグ報告スレッド part8 >>15)
・デボーションでnullpoが出る問題を修正
・mobのインティミデイトが成功するとmap-serverが落ちる問題を修正(バグ報告スレッ
ド part8 >>42)
・ウォーターボールの仕様を本鯖に近づける(水場が少ない場合にはhit数が減る、
デリュージ上で実行するとユニットが欠ける)
・ファーマシーの製造成功確率のコードを変更

	(db)
		skill_unit_db.txt
				- ユニットID/配置などをdb化しています
	(src/map)
		map.h	- skill_unit_groupのメンバ変更
		mob.c	- 移動時にスキルユニット判断(skill_unit_out_all/skill_unit_move)
				を追加
				- 足元置き/重複置き判断を変更
		pc.c	- 移動時にスキルユニット判断(同上)を追加
				- 無敵時間が終わる際にスキルユニット判断(同上)を追加
		skill.h	- skill_dbの参照関数をdefineに変更
				- スキル配置を入れるskill_unit_layout構造体を定義
				- SC_WATERBALL削除
		skill.c	- unit_idをdb化(skill_unit_db.txt)
				- スキルユニットのレイアウトを起動時に定義
				- 移動時にスキルユニット判断(同上)を追加
				- 足元置き/重複置き判断を変更
				- スキルユニットの移動処理を変更
				- デボーションの修正
				- mobのインティミデイトで落ちる問題を修正
				- ウォータボールの仕様変更
		status.c- SC_WATERBALLの処理を削除

--------------------
//1109 by End_of_exam

1108に引き続きメモリリークのバグ修正です。２つ共に深刻なバグなので、
最新版に更新しない方でも修正することをおすすめします。

・ペットが床にアイテムを落とす時、ペットを卵に戻す時にメモリリークが発生
　していたバグを修正。(pet.c)

・キャラクター依存一時変数の利用したキャラがログアウトするとメモリリークが
　発生していたバグを修正(map.c)

	(src/map)
		map.c	- map_quit() 修正
		pet.c	- pet_remove_map(), pet_return_egg() pet_lootitem_drop() 修正

--------------------
//1108 by End_of_exam

・以前作ったメモリマネージャーを統合。(malloc.c core.c)
　有効にするには、malloc.c内部のコメントを外す必要があります。開発に協力して
　頂ける方は、メモリマネージャを有効にして、チェック結果(map-server.logなど)を
　アップロードしてくれると助かります。

　　1. guild.c がコンパイルエラーになったので修正(guild.c)
　　2. pet.c がメモリ解放し忘れていたので、do_final_pet() を追加(pet.c)
　　3. do_final_socket を追加して、終了時に全ての接続を切断する(socket.c)
　　4. deplicate の元スクリプトが終了時にfreeされないバグを修正(npc.c)
　　5. do_final_script で開放されないメモリがあるバグを修正(script.c)
　　6. do_init_*** の呼ばれる順番がおかしかったのを修正(map.c)
　　7. イベント名が重複したときにメッセージを出すように変更(npc.c)
　　8. map_quit() 内部でcharid_db をfreeし忘れているバグを修正(map.c)

　特に8.は最重要で、キャラがログアウトする度にメモリリークが発生するという、
　最悪な結果になっていました。気になる方は修正しておきましょう。

・delete_session でNULLチェックを怠っていたバグを修正(socket.c)
・chrif_disconnect_sub でdelete_session を呼ぶように変更(chrif.c)
・マルチラインコメント（/* 〜 */）の解析を忘れていたバグを修正(npc.c)
・銀行などのNPC でZenyがMAX_ZENYにならないバグを修正(pc.c)
・1107の製造確率が一部消されていたのを修正(skill.c thanks to lizorettさん)
・セージ転職試験のイベントが衝突を起こしていたのを修正(npc.c)
　　npc_parse_script : dup event jobsage_2nd::OnTimer150000
　　npc_parse_script : dup event jobsage_2nd::OnTimer30000
　　npc_parse_script : dup event jobsage_success::OnTimer7000
　　npc_parse_script : dup event jobsage_success::OnTimer3000

	(src/common)
		core.c		- do_init_memmgr() 追加
		malloc.c	- メモリマネージャの追加
		malloc.h	- メモリマネージャの追加
		socket.c	- delete_sessionのバグ、do_final_socketの追加

	(src/map)
		chrif.c		- chrif_disconnect_sub() を修正
		guild.c		- guild_recv_info(), guild_castledataloadack() 修正
		map.c		- map_quit() のメモリリーク、do_final,do_init 修正
		npc.c		- npc_parse_script_line() , npc_parse_script() 他修正
		pc.c		- pc_setparam() 修正
		pet.c		- do_final_pet() 追加
		pet.h		- do_final_pet() 追加
		script.c	- do_init_script(), do_final_script() 修正
		skill.c		- skill_produce_mix() 修正

--------------------
//1107 by code
・@npctalk, @pettalkコマンド追加
・ダメージの遅延を実装
・@mesを全体発言に修正
・ファーマシーの製造成功確率修正
・@storageで倉庫が二重で開くことがないよう修正
・scriptに globalmes, getmapmobs 関数を追加

	(/src/map)
		atcommand.c
		atcommand.h
		battle.c
		clif.c
		clif.h
		npc.c
		npc.h
		script.c
		skill.c
		storage.c

--------------------
//1106 by sylpheed

・item_rate_details:1が動かなかったのを修正

	(src/map/)
		mob.c

--------------------
//1105 by End_of_exam

・1101のマップの再分配が上手くいかないバグを修正(char.c thanks to Mystleさん)

	(src/char/)
		char.c		- parse_frommap() 修正

--------------------
//1104 by nameless
・BCC32のコンパイルオプションなどの最適化
・BCC32/VC++で最適な最適化オプションを見つけるためのベンチ
・bcc32_clean.batとbcc32_make.batを統合、クリーンビルドの失敗をしないように。

※P4だからとかOpteronだから特定オプションで早いということではないようです。
※P4でもロットによっては-5が最適だったり-3 -O2が最適だったりするものがあるようです
※思い込みでオプションをつけないようにするために作りました。
※少しでもレスポンスを上げて運用したいという人は活用してください。

	(/)
		bcc32_make.bat

		最適化オプションの追加と警告メッセージで深刻ではないものを
		完全に表示しないように設定、bcc32_clean.batをmakeに統合した
		ので確実にクリーンビルドできるようになりました

		bench.bat
		bench.c

		最適なコンパイルオプションを見つけるためのベンチです。
		bench.batでコンパイル＆実行が行われます。
		結果はbench.txtに格納されますので数値の一番小さいものを選ん
		でbcc32_make.batの23行目に追加・修正してあげてください。
		※初期状態ではbcc32用になっていますので
--------------------
//1103 by End_of_exam

・char_athena.conf のdefault_map_typeが0 になっている時に、PVPガイドで
　セーブした後、PVPエリア内でログアウトしたキャラがログインできなくなる
　バグを修正。(npc_etc_pvp.txt) 多くの方々からの情報提供感謝します。
　（npc_etc_pvp.txt 内部の ".gat" の付け忘れと、このミスに対応していない
　　pc.c のバグです。このパッチを当てないでこのバグを修正したい場合、
　　添付した修正ファイルを参考にしながら、npc_etc_pvp.txtに".gat"を
　　付加してください。）

・do_final内部で不正な処理を行う場合があるのを修正(map.c thanks to lizorettさん)
・マップキャッシュの読み込みに失敗したときにメモリリークしていたバグを修正(map.c)

	(src/map)
		pc.c	 - pc_setsavepoint() 修正
		map.c	 - do_final(), map_cache_read() 修正

	(src/char)
		char.c	 - search_mapserver() , parse_char() 修正

	(script/npc/etc)
		npc_etc_pvp.txt - ".gat" を付加する

--------------------
//1102 by 人柱さんA
・バグ報告スレ >>35-37にあった修正版
　詳しいことはスレを見てください
	(src/map)
		pc.c

--------------------
//1101 by End_of_exam

・socket関連の修正(socket.c socket.h)

　1. FIFO関連をfd が不正(fd<=0)の時にも正常に動作するように変更
　2. socket.h の内部を色々と整理
　3. make_connection() が接続に失敗した時にエラーを返さないバグを修正
　　　その変更に合わせて、chrif.c check_connect_char_server() , char.c
　　　check_connect_login_server() を修正。これでサーバーゾンビ化のバグは
　　　解決したと思いますが、再発したら報告をお願いします。

・char - map 間のコネクションを見直し(char.c chrif.c map.c map.h)

　1. char - map 間のコネクションが切れたら、map 鯖に接続しているキャラを
　　全て切断するようにする。これは、同期を取るのが難しいのと、char鯖との
　　通信が必要な処理（パーティ、ギルド、ペット他）ができなくなるためです。
　2. 複数のmap 鯖で同じマップを担当することがあるバグを修正
　3. map 鯖の割り当て方法の見直し
　　複数のmap 鯖で同じマップを読み込めば、どれか１つが落ちている時でも、
　　正常なmap 鯖にログインできるようになりました。例えば、同じマップを
　　map鯖AとBに読み込ませておけば、Aが落ちている時にはBに、Bが落ちている
　　時にはAに転送されます。ただし、優先順位の指定はまだ出来てないので、
　　１つのmap 鯖に人数が集中しすぎる可能性があります。

	(src/map)
		chrif.c		- map 鯖の割り当て方法の見直し
		map.c		- map 鯖の割り当て方法の見直し
		map.h		- map 鯖の割り当て方法の見直し

	(src/char)
		char.c		- map 鯖の割り当て方法の見直し

	(src/common)
		socket.c	- 色々修正（上記参照）
		socket.h	- 色々修正（上記参照）

--------------------
//1100 by nyankochan
・1098の修正
	(src/map)
		pc.c

--------------------
//1099 by End_of_exam

・mapflag nosave が不正な時に起動を中断させるようにする(npc.c)
・pc_autosave が呼ばれる回数が異常に高くなるバグを修正(pc.c)

pc_autosave() の内部が、

> interval = autosave_interval/(clif_countusers()+1);
> if(interval <= 0)
> 	interval = 1;

という風になっているので、１マップサーバーに200人のキャラが接続してると、
autosave_interval(def:15 * 1000) / 200 = 0.075 秒ごとに関数が呼ばれます。
さすがにこの状態だとchar鯖が厳しくなるので、関数を呼び出す最小間隔を
0.2 秒に変更しました。

	(src/map)
		pc.c		- pc_autosave が呼ばれる回数が異常に高くなるバグを修正
		npc.c		- mapflag nosave が不正な時に起動を中断させる

--------------------
//1098 by nyankochan
・入手装備品の個数1固定
	(src/map)
		pc.c

--------------------
//1097 by End_of_exam

主にバグ修正です。バグ報告してくれた皆様に感謝、感謝。

・Zeny増殖対策(pc.c trade.c script.c)
	1. 交換、pc_setparam でMAX_ZENY を超える場合があるバグを修正
	2. スクリプトにオーバーフロー対策を追加

・ログイン成功時・アカウント変数更新時に無条件にmmo_auth_sync を
　呼んでいたのをタイマーを使用した定期更新に変更(login.c login_athena.conf)

・db関係にバグが潜んでいる模様なので、チェック機構を追加する(db.c db.h)
　一部アカウントのみログイン不可、倉庫ロスト、@whoで表示されるキャラが
　一部消えるなどのバグの原因がdb関連にある模様です。
　「db_foreach : data lost %d of %d item(s)」というメッセージが表示
　された場合はバグがある（dbに入っているはずのデータが消えた）ので、
　報告をお願いします。

・ある方法で通常より強いキャラが作れてしまうバグの修正(char.c)
・ギルドの役職名に不正な文字が使えるバグを修正(int_guild.c)
・スクリプト内で０での除算時が起こった時にINT_MAXを返すようにする(script.c)

	(conf/)
		login_athena.conf - autosave_time の追加

	(src/common)
		db.h		- チェック機構の追加
		db.c		- チェック機構の追加

	(src/login)
		login.c		- mmo_auth_sync にタイマーを適用

	(src/char)
		char.c		- 通常より強いキャラが作れてしまうバグの修正
		int_guild.c	- ギルドの役職名に不正な文字が使えるバグを修正

	(src/map)
		trade.c		- MAX_ZENY を超える場合があるバグを修正
		pc.c		- MAX_ZENY を超える場合があるバグを修正
		script.c	- オーバーフロー対策、０での除算時の処理を追加

--------------------
//1096 by lizorett
・壁越しにスキルが撃ててしまうバグを修正(バグ報告スレッド part8 >>28)

	(src/map)
		path.c	- 壁越しにスキルが撃ててしまうバグを修正

--------------------
//1095 by lizorett
・スクリプトのエスケープ判断を変更
・スキルユニットグループのgroup_idの範囲を変更
・skill_unitsetting()で全てのスキルでskill_get_time()を使用するよう変更
・サイトラッシャーをユニットスキルから範囲攻撃魔法に変更(本鯖仕様)

	(src/map)
		skill.c	- skill_unitgrouptickset_* で skill_id/group_idが重ならないよう
				にgroup_idの範囲を制限
				- SkillStatusChangeTableにSC_SAFETYWALL,SC_PNEUMA追加
				- skill_unitsetting()で全てのスキルでskill_get_time()を使用する
				よう変更
				- サイトラッシャーを範囲攻撃魔法に変更
		npc.c	- エスケープ判断をparse_simpleexpr()と同様にし、全角判断を削除
	(db)
		skill_cast_db.txt
				- TS/MS/LoV/FN/SG/HD/GXにupkeep_timeを設定

--------------------
//1094 by End_of_exam

・サブルーチン呼び出し構文の追加(script.c npc.c npc_convertlabel_db())
・逆アセンブル処理の追加(script.c , DEBUG_DISASM を有効にしてください。)
・switch の一時変数消去位置を変更(script.c)
・RERUNLINEの衝動が怪しかったので修正(script.c / h , map.h)
・ソースを読みやすくするためにbuildin_*をファイル最後に移動(script.c)
・新しく加わった構文のサンプルとして「ハノイの塔」を追加(npc_test_hanoi.txt)
・buildin_getitemname 修正(script.c , 質問スレッド Part14 >>129-130)

・bcc でコンパイルした時に落ちるバグを修正(map.c map_id2bl 内部)
・Windowsでコンパイルした時に、gettick()のキャッシュが無効になっていたのを
　修正(timer.c , thanks to Shinomori)

	(src/common)
		timer.c			gettick() のバグ修正

	(src/map)
		script.c		色々変更（上記参照）
		script.h		struct script_state 修正
		npc.c			npc_convertlabel_db() で落ちるのを修正
		map.c			map_id2bl() を修正(落ちるのはbcc だけ？)
		map.h			map_session_data 修正

	(doc/)
		script_ref.txt	function 構文の追加
	
	(script/sample/)
		npc_test_hanoi.txt	ハノイの塔

--------------------
//1093 by いど

・サーバースナップショット

--------------------
//1092 by lizorett
・遠距離攻撃のパス検索アルゴリズムを本鯖と同じになるよう変更
・ストームガスト、ロードオブヴァーミリオンを重ねた場合、片方からだけダメージを
受けるよう修正(仕様が不明なので先に見つけたユニットから攻撃するようにしています)
・アイテムが一つしかない場合、アイテムを使用してもエフェクトが表示されない問題
を修正
・セーフティーウォール使用時にアドレス不正となる場合がある問題を修正
・map_getcell/map_setcellの仕様変更
・1085のビットマップ対応の痕跡の消去
・1088のアイスウォールの変更を巻き戻し(本鯖に合わせる)
・全角判断(npc.c)を修正(For English User Forum >>54)

 (注意) map_athena.confのマップキャッシュ指定を行うパラメータ名を変更しています

	(conf)
		map_athena.conf	- read_map_from_bitmapをread_map_from_cache に変更
						- map_bitmap_pathをmap_cache_fileに変更
	(src/map)
		map.h			- セルタイプ名称変更(CELL_CHKHIGH,CELL_CHKTYPE)、
						削除(CELL_SET*)
						- skill_unit_group_ticksetメンバ名変更(group_id -> id)
						- ビットマップ関連の記述の痕跡を削除
		map.c			- map_getcell() セルタイプ名称変更と若干のコード変更
						- map_setcell()を1084以前の仕様に戻し、CELL_SETNPCの
						フラグを追加
						- map_cache関連の細かな修正
		npc.c			- 全角判断(is_zenkaku)を正確に行うよう変更
						- map_getcell()のセルタイプ名称変更に追従
		pc.c			- アイテムが一つしかない場合、使用時のエフェクトが表示
						されない問題を修正
						- map_getcell()のセルタイプ名称変更に追従
		skill.c			- ストームガスト、ロードオブヴァーミリオンを重ねた場合
						片方からだけダメージを受けるよう修正
						- セーフティーウォール使用時にアドレス不正となる場合が
						ある問題を修正
						- map_getcell()のセルタイプ名称変更に追従
		skill.h			- 関数定義変更
		path.c			- 遠距離攻撃のパス検索処理を追加(path_search_long)
						- map_getcell()のセルタイプ名称変更に追従
		battle.c		- 遠距離攻撃のパス検索を使用するよう変更

--------------------
//1091 by End_of_exam

＊＊　注意　＊＊

　今回のパッチは改造内容が複雑なので、導入は慎重に行ってください。
　status.c / h への分離は、関数名の置き換えだけに留めたつもりですが、
　思わぬバグが潜んでいる可能性があります。

・スパゲティ対策の一環として、ステータス計算、状態異常に関わる部分を
　status.c / h として分離。battle.c から39KB程 , skill.c から41KB程 ,
　pc.c から38KB程移動できました。少々強引ですが、スキル使用や攻撃などの
　処理の流れをつかみやすくするためには、battle.c / skill.c の中身を
　減らす必要があると考えたためです。

	battle_get_*          => status_get_*
	skill_status_change_* => status_change_*
	pc_calcstatus         => status_calc_pc
	pc_calc_sigma         => status_calc_sigma
	pc_getrefinebonus     => status_getrefinebonus
	pc_percentrefinery    => status_percentrefinery

・battle.c , script.c の巻き戻りを戻す
・npc.c の怪しい変更を戻し、きちんとNUL を付け加えるようにする
・script.c のミスを直す（jump_non_zero => jump_zero　意味が逆になってました…）
・skill.c の武器修理 のコメントミスを修正
・WIN32でコンパイルした時、最大接続人数が60人程に制限されていたバグを修正

	(/)
	athena.dsw , athena.dsp , bcc32_make.bat , src/login/login.dsp
	src/char/char.dsp , src/map/map.dsp
		コンパイル条件の変更

	(src/map/)
		上の分離に合わせてコンパイルエラーの出ないように修正

--------------------
//1090 by Sapientia
・チャットの便利さのために叫ぶ追加 (ギルドチャットと区分するためにウェチギシの前に [叫ぶこと]が付き)
・atcomand_athena.conf で onlymes を 0で設定して皆使うように活性化
  オリジナルなのでデフォルトで GMだけ使うことができるように設定しました.
・@mes [言うこと] で使用

	(src/map)
		atcommand.c	atcommand_charkami 追加
		atcommand.h
		clif.c		clif_onlymessage 追加
		clif.h
	(src/conf)
		atcommand_athena.conf	onlymes 追加
		help.txt	@mes 説明追加


--------------------
//1089 by 聖
・VC.NET2003でコンパイルすると大量に警告が出るのを修正
・その他バッファオーバーフロー等の細かいバグ修正

	(src/char)
		int_guild.c 警告箇所を修正

	(src/map)
		atcommand.c, battle.c, clif.c, itemdb.c, pc.c, pc.h, script.c, skill.c
			警告箇所を修正
		npc.c 警告箇所とバッファオーバーフロー修正

--------------------
//1088 by Sapientia
・ウィザドスキル Icewall このキャラクターやモンスター足もとに設置されることを防止
・ロードナイトスキル Berserk 使用の時 HPが 1/3になれば回復するバグ修正

	(src/map)
		pc.c	Berserk 修正
		skill.c	Icewall 修正

--------------------
//1087 by End_of_exam

・マップキャッシュに圧縮機能を追加(1MB程に縮まるようです)
・npc.c の巻き戻りを修正(質問スレッド Part14 , 111)
・map_athena.conf のコメントアウトを修正(Athena雑談スレッドPart7 , 146)
・Windows 用の起動スクリプトを追加してみる(eAthena のを元に改造）

	(/)
		win32_start.bat		Windows 用の起動ファイル

	(src/map)
		map.c	圧縮機能の追加
		npc.c	巻き戻りを修正

	(src/common)
		grfio.c		decode_zip , encode_zip のエクスポート
		grfio.h		decode_zip , encode_zip のエクスポート

	(conf/)
		map_athena.conf		修正

--------------------
//1086 by End_of_exam

主に1085のバグ修正だったりもします。
「てめー、１から書き直しやがって」という突っ込みだけは勘弁してくださいませ。

・データ構造の大変更(map.c)
	マップを削除＆追加しても正しく動くように変更
	マップキャッシュ作成中に強制終了すると再起動時に不安定になるバグを修正
	圧縮フラグの追加（需要あるのか不明。compressを真にすると、現在のソースで
	読めなくなります。）

・なんか衝動があやしすぎるので、ビットマップ処理を撤廃する(map.c map.h)
	npc_touch_areanpc : some bug　がたくさん出てくる -> 原因不明？
	恐らく通行可能判定が正しく設定されていないっぽいんですが謎です。
	＃read_map_from_bitmap の設定を省くとログイン時に落ちるバグを修正

・キャッシュ内に全てのマップがあれば、grf 無しでも動作するように変更。(grfio.c map.c)

	(src/map)
		map.c	バグ修正他
		map.h	バグ修正他

	(src/common)
		grfio.c		ファイルが見つからない時にexit を呼ばないように修正

--------------------
//1085 by zalem
・マップデータの読み込みはビットマップファイルから行なえるような機能追加

		grfファイルから一度ビットマップファイルを作成して以後はその
	作成されたビットマップフォーマットのファイルからマップ情報を読み込む
	という方法を採ることによって、map-serverが立ち上がる時マップ情報を読み取る
	のに掛かる時間がほとんどなくなる、また1intに32個のセル情報が格納できるの
	で、map情報に関するメモリ使用量も３割り近くまで減るので(そのかわりに
	ある程度CPUの負担が大きくなる)、追加してみた。
		conf/map_athena.confのread_map_from_bitmapオプションで利用する
	かどうかを指定でき、その下にあるmap_bitmap_pathでファイル名を変更する
	(デフォルトでdb/map.info)
		まだテスト段階なので、導入はご慎重に(一応Linuxで、いろいろと
	テストしてみたが...)

・map_getcell()に4番目引数の追加とmap_setcell()の4番目引数の変更
		
		関数の利用意図がわかりやすいように、そしてこれからの変更を容易にする
	ために、map_getcell()とmap_setcell()のそれぞれ4番目の引数を追加、変更してみた、
	map_getcell()の4番目の引数はmap.hで定義されてるCELL_CHK列挙型、map_setcell()
	の4番目の引数はmap.hで定義されてるCELL_SET列挙型をとるように変更.また、上の
	Featureに対応するため、map_getcell()をポインタに変更した。
		
	主な変更点：

	src/map/map.h   read_gat(),read_gatp()マクロの変更
			列挙型 CELL_CHK,CELL_SETを追加,map_getcell(),map_setcel()用
			map_data構造体にメンバーint* gat_fileused[MAX_CELL_TYPE+2]追加
	src/map/map.c	map_getcell()を関数型ポインタに変更,map_getcellp()をread_gatp()
		     のために追加,実際に下の四つの関数のどっちに指すかはmap_read_flagによる
		     	map_getcell_gat(),map_getcell_bitmap()	追加
		     	map_getcellp_gat(),map_getcellp_bitmap()	追加
		     	map_setcell()	変更
			map_createbitmap()	追加
			map_readmapfromfile()	追加
			map_readallmap()	変更
			map_config_read()	変更
			do_final()	変更
	以下の*.cファイル内のmap_getcell(),map_setcell(),read_gat(),read_gatp()を呼出した部分をすべて変更
	src/map/atcommand.c
	src/map/mob.c
	src/map/npc.c
	src/map/path.c
	src/map/pc.c
	src/map/pet.c
	src/map/skill.c
			
	conf/map_athena.conf	read_map_from_bitmap,map_bitmap_path	追加

--------------------
//1084 by lizorett
・経験値獲得のバグ修正(バグ報告スレッド part7 >>134)
	(src/map)
		mob.c	経験値計算修正

--------------------
//1083 by End_of_exam special thanks to lizorettさん
・ソケットのデストラクタ処理の追加
		(common/socket.c common/socket.h login/login.c char/char.c map/clif.c map/chrif.c)
	ソケットを閉じる時の処理の流れが変更になります。今までソケットを閉じる場合は、
	まずsession[fd]->eof を真にした後、パーズルーチン内で後処理（メモリ解放など）
	していました。ですが、close(fd); が２重に実行されてサーバーが落ちるなどの
	バグが発生していたり、処理の流れがつかみにくいといった理由から、socket.c 内部で
	全て処理するように変更しました。ソケットを閉じる時の主な流れは次の通りです。

	1. ソース内からsession[fd]->eof = 1; をする
	2. socket.c 内からsession[fd]->destruct() が呼ばれる
	3. メモリの解放＆後処理(socket.c delete_session内部)

	close(fd) は、session[fd]->eof = 1; に置き換えました(#define)。
	また、delete_session() を明示的に呼ぶ必要はありません。

・マップ鯖分配時のアイテムdupe問題修正(map/map.c map/pc.c map/chrif.c)
	ソケット切断時に倉庫データのキャッシュを消すように変更
	２重ログイン時にマップサーバーが違った場合にも切断できるように修正

・古いバージョンでログインした時にmap鯖が落ちるバグを修正(map/clif.c)
	clif_parse() 内部

	if(packet_db[cmd].len==0) {
	-> if(cmd<MAX_PACKET_DB && packet_db[cmd].len==0) {

・gcc でコンパイルした時にtimer.c でwarning が出たのを修正(common/timer.c)
	timer.c:116: warning: `check_timer_heap' defined but not used

	(src/common/)
		socket.c	ソケットのデストラクタ処理を追加
		socket.h	ソケットのデストラクタ処理を追加
		timer.c		warning 修正

	(src/map/)
		clif.c		ソケットのデストラクタ処理を追加
		chrif.c		ソケットのデストラクタ処理を追加
		map.c		マップ鯖分配時のアイテムdupe問題修正
		pc.c		マップ鯖分配時のアイテムdupe問題修正

	(src/char/)
		char.c		ソケットのデストラクタ処理を追加

	(src/login/)
		login.c		ソケットのデストラクタ処理を追加

--------------------
//1082 by lizorett (2004/12/18) special thanks to 名無し様@ｇ＠ｍｅ
・白刃取りをボスに無効に変更
・1079の変更部分にNULLチェックを追加
・カードの効果が乗らないスキルにエンチャントデッドリーポイズン効果が乗らないよ
 うに変更
・エンチャントデッドリーポイズンの効果に左手が載らないように変更
・サクリファイスを実装
・ストームガストのノックバックがスキル指定位置を中心とするよう変更
・スキルの射程距離から1セル離れた場所を指定してスキルを使うと何も起こらない問題
 を修正
・経験値の配分を修正(ダメージを与えた人がいない場合や、毒ダメージがある場合に経
 験値が少なくなっていた)
・装備していない箇所へのストリップスキルが失敗するよう変更
・パッチアップスレッド Part 6？の>>116,>>125,>>126 のファイルを念のためマージ

	(db/)
		skill_db.txt, skill_cast_db.txt, skill_require_db.txt
					- サクリファイスの記述を修正/追加
	(src/map/)
		battle.c	- エンチャントデッドリーポイズンの変更
					- サクリファイスの実装
					- ストームガストのノックバック方向を変更
					- 白刃取りをボスに無効に変更
		skill.h		- SC_SACRIFICEを追加
		skill.c		- サクリファイスの実装
					- skill_castend_damage_id()のMG_FROSTDIVER/MG_STONECURSEに
					 NULLチェックを追加
		mob.c		- 経験値の配分を修正
		script.c	- 個別に出されていたファイルをマージ(>>125)
		npc.c		- 個別に出されていたファイルをマージ(>>126)
	(src/common)
		core.c		- 個別に出されていたファイルをマージ(>>116)

--------------------
//1081 by End_of_exam
・「ループ構文の方も実装してください」という要望を貰ったので、
　for , while , do - while 構文を導入。個人的に余り需要は無いと思うのですが…。

・elseが完全に解析できてなかったバグを修正。
・switch のbreak; が場所によってはコンパイルエラーになるバグを修正。

	(src/map/)
		script.c : 構文を拡張。色々整理。

	(doc/)
		script_ref.txt : 上の修正に合わせて変更。

--------------------
//1080 by End_of_exam

・スクリプトを if - else if - else 構文 , switch 構文に対応させました。
　多重ネストが可能ですので、今までより見やすいスクリプトが書けると思います。
　if(aa) { aaa(); } else if(bb) { cc; if(dd) { ee() } else { ff(); } }
　それに伴い、__ から始まる変数やラベルを用いると、不都合が生じる可能性があります。

・スクリプトに新しい関数(select関数・menu命令の関数版)を追加しました。

	(src/map/)
		script.c : 構文を拡張
		npc.c : npc_perse_script の修正( { , } のネストに対応 )

	(script/)
		npc/town/npc_town_alberta.txt : 一カ所 goto が抜けてたので修正
		sample/npc_debug_pota.txt     : switch , select を使って書き直し
		                                (デバッグに使わせて貰いました)

	(doc/)
		script_ref.txt : 上の修正に合わせて変更
--------------------
//1079 by Yuuki
・石化中にストーンカースを使うと石化解除
・FDでスキル追加効果を使うと氷化中ダメージ判定で先に割れてもう一度氷化判定がくるのでスキル追加効果つかわず 
・BBで睡眠石化氷化が割れないバグの修正(独自のダメージ判定使ってたので消して正規のダメージ判定に戻した) 
・ディレイ0のスキルにadelay/2追加(G鯖でTS使って検証した結果最もこれが近かった通常攻撃よりはやかったので) 

	(src/map)
		skill.c

--------------------
//1078 by End_of_exam

・Visual C++ 6.0 / bcc32 でコンパイル出来るように修正(別途zlib.dll が必要)
・1074は欠番にします。色々とご迷惑をかけた事をお詫びします。

＊＊　注意　＊＊
	今回のバージョンの完全な動作確認はしていません（人柱版扱いにしてください）。
	本格的な運用に踏み切る前には、必ず動作確認をするようにしてください。
	場合によっては、コンパイル出来ない、不正な動作になる…等々の問題が起こるかも
	しれませんが、そのときは、騒がず、慌てずに、ネ申の降臨を待つようお願いします。

＊＊ お願い ＊＊
	このパッチを完全版にしてくれる方、使用感レポートを投稿してくれる方を募集します。
	パッチを公開するついでに、大量のwarning を修正してくれたら嬉しいな〜、と思ってみたり。

   (/)
		bcc32_make.bat , bcc32_clean.bat
			bcc32 でコンパイル / クリーン　を簡単にするためのバッチファイル。

		athena.dsp , athena.dsw , src/login/login.dsp , src/char/char.dsp , 
		src/map/map.dsp
			Visual C++ 用のプロジェクトファイル & ワークスペース

	(src/)
		コンパイル出来るように色々修正。

	(src/common/timer.c)
		独自の手抜きアルゴリズム（２分ソート）を採用したバージョン。

--------------------
//1077 by sylpheed
・サーバースナップショット
・下記二つを取り込み
質問スレッド Part14-41 Plalaさん
バグ報告スレッド part7-68 ...さん

1074は取り込んでいません。

--------------------
//1076 by mare
・韓国公知の通りアリスとジルタスのエサの変更。
・GMのアブラカタブラ専用スキルのフラグが消えてたので復活。
・ブラックスミスギルド員にプリーストの場合のセリフを追加。
・クラスチェンジで全ての指定IDボスが出るように（なってるといいなぁ）
	(db)
		pet_db.txt
	(conf)
		battle_athena.conf
	(script/npc/job)
		npc_job_10blacksmith.txt
	(src/map)
		mob.c
--------------------
//1075 by kag
・弓手用の指貫の効果実装の布石
・効果がはっきりとしないのでitem_dbの修正はいれていません。
・1075番でいいのかなぁと思ったり。

    (db)
		const.txt
			bWeponAtk=1073とbWeponAtkRate=1074を追加

    (src/map)
        battle.c
			int battle_get_baseatk()修正
			static struct Damage battle_calc_pc_weapon_attack()修正
		map.h
			int weapon_atk[16],weapon_atk_rate[16];
			SP_WEPON_ATK,SP_WEPON_ATK_RATE, // 1073-1074を追加
        pc.c
			memset(sd->weapon_atk,0,sizeof(sd->weapon_atk));
			memset(sd->weapon_atk_rate,0,sizeof(sd->weapon_atk_rate));を追加
			
			pc_bonus2() 修正
	(doc)
		item_bonus.txt
			bWeponAtk,bWeponAtkRate,bHPDrainValue,bSPDrainValue　追加。

--------------------
//1073	by LP@@
・アコスキルの一部及びサイトスキルの修正(日本には今月末に来る筈？@2004/12/06)
速度減少は移動速度減少量が、シグナムクルシスは成功率、DEF減少量の増加量が
はっきりしなかったので弄っていません。
   (src/map)
		battle.c
			デーモンベイン、ディバインプロテクション計算式を修正。
		skill.c
			ルアフ、サイトの有効範囲を修正（両方10x10→ルアフ5x5,サイト7x7）。

   (db)
		skill_cast.db
			アクアベネディクタの詠唱及びディレイを修正。

//1072	by kag
・転生スキルを中心に修正
    (src/map)
		battle.c
			魔法力増幅をスキルレベル*5%に修正。
			矢撃ちに矢のATKが乗らなくなるように修正。
			オーラブレードの追加ダメージを100に修正。
			バーサークの与ダメを２倍になるように修正。
			ヘッドクラッシュの計算式を修正。
			スパイラルピアースの計算式だけ修正。
			プレッシャーの計算式を修正。
			連柱崩撃の計算式を修正。
			ソードリジェクトの反射率をスキルレベル*15%に修正。
			アローバルカンの計算式を修正。矢の属性が乗るように修正。
			ファルコンアサルトの計算式を修正。頑強フラグで１ダメになるように修正。
			ブリッツビートを頑強フラグで１ダメになるように修正。
			デモンストレーションを必中、カードを乗らないように修正。
			アシッドテラーを防御無視、必中、無属性、カードを乗らないように修正。
		skill.c
			魔法力増幅に0.7秒の固定詠唱追加。
			LP@@ さんのアスムキリエ重複不可を追加。

	(db)
		skill_db.txt
			狂気孔を詠唱妨害できるように修正。
		skill_cast_db.txt
			プレッシャーの詠唱、ディレイを追加。
			猛虎硬派山のディレイを追加。
			ライフ置き換えのディレイを追加。
			ファルコンアサルトの詠唱、ディレイを追加。
			ウインドウォークのディレイ、持続時間を変更。
			アローバルカンの詠唱、ディレイを追加。
			クリエイトデッドリーポイズンのディレイを追加。
		skill_require_db.txt
			オーラブレードの消費SPを修正。
			コンセントレーションの消費SPを修正。
			魔法力増幅の消費SPを修正。	
			ナパームバルカンの消費SPを修正。
			プレッシャーの消費SPを修正。
			サクリファイスの消費SPを修正。
			猛虎硬派山の消費SPを修正。
			リジェクトソードの消費SPを修正。

//1071 by ICO
・npc_job_09wizard.txt,npc_job_16sage.txtを修正
・取り巻きが召喚系スキルを使用する際の挙動を修正

    (src/map)
		mob.c
			取り巻きの召喚系スキルを規制するタイミングを変更
		skill.c
			召喚系スキルの発動条件を修正

//1070 by sylpheed
・ドロップ率のレートごとの調整を追加
  ドロップ設定1〜9 10〜99 100〜999 1000〜10000で個別に倍率と最低/最高値の設定が可能です
・@weather 0 が動かないのを修正
・転生二次職のHP/SP25％上昇実装
ドロップ倍率はeAthenaのアイテム種類毎の設定を移植しても良かったのですが
種類毎だとレートの開きが大きい場合があり、あまり意味がないため
このような形でレート詳細設定を追加してみました。
mob_dbを弄るより楽にドロップ率の変更ができると思います。

weather 0が動かないのは理由が良くわからなかったので
動くように修正するついでに、雨フラグ消去時に
虹が出るように追加してみました。

転生のHP/SPに関しては、転生していても二次職になってない場合
増加はしないようなので、そのように実装してみました。
wedding_modifydisplay: yes の時にドレス/タキシードを装備解除すると
増加分が消えてしまいます・・・
わかる方いたら修正お願いしますorz

	(src/map)
		atcommand.c
			@weather関連の修正(case 0を実行するように修正)
			雨フラグを消した場合虹が出るようにしてみました(JP蔵で使えるか不明)
			(マップ移動しないと天候が消えないのはragexeの仕様かな？)
		battle.c
		battle.h
		mob.c
			item_rate_details関連を追加
		pc.c
			転生二次職時のHP/SP最大値25%増加を追加
			転生していても二次職でない場合はHP/SP増加は無しのようです
	(conf)
		help.txt		修正
		msg_athena.conf	112追加

	(doc)
		conf_ref.txt	修正
		help.txt		修正

//1069 by lizorett (2004/11/26) special thanks to 名無し様@ｇ＠ｍｅ
・メルトダウンの実装
・魔法力増幅が詠唱のある魔法で有効にならなかった問題を修正
・map-serverがダウンする問題の修正(質問スレッド Part13 >>55)
・map-serverに不正IDでログインするとchar-serverがダウンする問題の修正
・サフラギウムが無詠唱スキルで取り消されない問題を修正
・重複して猛毒状態とならないよう修正
・マグナムブレイクのダメージを修正
・バーサク中にHP/SP吸収、毒などのダメージを受けるよう修正
・月光剣のSP吸収量が増加していく問題を修正(暫定)
・@helpにキーワード検索機能を追加

	(src/map)
		battle.c	- マジックパワーによるMATK増加の実装
					- 武器鎧破壊をpc_break_equip()に書き換え
					- HP/SP吸収を修正
		map.h		- 装備破壊の定義を追加
		pc.c		- pc_break_armor()/pc_break_weapon()を、新規の装備破壊の
					関数pc_break_equip()に統合
					- 魔法力増幅のコードを削除(battle.cで行う)
					- HP/SP吸収関係の変数の初期化を追加
		pc.h		- 関数定義を修正
		skill.c		- メルトダウンによる装備破壊を実装
					- 魔法力増幅に関する修正
					- 重複して猛毒状態とならないよう修正
		clif.c		- map-serverがダウンする問題の修正
		atcommand.c	- @helpにキーワード検索を追加("@help jobchange"など)
	(src/char)
		char.c		- char-serverがダウンする問題の修正
	(db)
		const.txt	- bUnbreakableHelm, bUnbreakableShield追加
		skill_cast_db.txt
					- メルトダウンの状態異常時間を設定

//1068 by huge
・atcommandをいくつか追加と、eAthenaからいくつか移植。(help.txt参照)
・非GMキャラが@で始まる発言をした時、そのまま表示するようにした。(GMレベル0のコマンドは実行)
・天気コマンドに合わせて、mapflag設定できるように。
・scriptをいくつか追加と、eAthenaから一つ移植。
・初期HP倍率とSP倍率をbattle_athenaで設定できるようにした。
・全キャラが、GMには位置・HPを通知させるようbattle_athenaで設定できるようにした。
・ドクロドロップについて、battle_athenaで設定できるようにした。
・GMのアイテムドロップや交換についてGMレベルを制限できるようにした。
・ディテクティングスキル修正。
※デフォルトの日本クライアントだと、雨で落ちます。

	(conf/)
		atcommand_athena.conf	修正
		battle_athena.conf	修正
		help.txt	修正
		msg_athena.conf	修正

	(doc/)
		help.txt	修正
		script_ref.txt	修正
		conf_ref.txt	修正

	(src/map/)
		atcommand.c
		atcommnad.h
			guild.h party.hを読む様に修正
			is_atcommand() 修正
			atcommand() 修正
			※移植・新規コマンドについては help.txt を確認して下さい。
		battle.c
		battle.h
			hp_rate,sp_rate,hp_meter,bone_drop 追加
		clif.c
		clif.h
			clif_spawnpc() 修正
			clif_hpmeter() 追加
		guild.c
		guild.h
			guild_searchname() 追加
			guild_searchname_sub() 追加
		map.h
			天候に関するflag追加
		npc.c
			npc_parse_mapflag() 修正
		party.c
		party.h
			party_searchname() 追加
			party_searchname_sub() 追加
		pc.c
		pc.h
			pc_calcstatus() 修正
			pc_damage() 修正
			pc_walk() 修正
			pc_can_drop() 追加
		script.c
			gmcommand	移植追加
			dispbottom		追加
			getusersname		追加
			recovery		追加
			petinfo		追加
			checkequipedcard		追加
			getexp	削除(setを使うようにして下さい)
		skill.c
		skill.h
			skill_castend_pos2() 修正

	＋Athena雑談スレッドPart7 >>54 もっさりさんの分
	記述漏れがあったらすいません。
--------------------
//1067 by kai
・メディテイティオによるヒール回復量増加の効果を修正
・アドバンスドカタール研究の修正
・PvP時におけるアスムプティオの効果を修正

	(src/map)
		skill.c
			2120行　heal += heal*(skill*2)/100; //メディテイティオの修正

		battle.c
			1723行　damage += dmg*(10+(skill * 2))/100; //アドバンスドカタール研究の修正

			2598〜2599、3580〜3582行　アスムプティオの修正
				if(map[target->m].flag.pvp)としダメージ計算を2/3に修正

--------------------
//1066 by lizorett (2004/11/17) special thanks to 名無し様@ｇ＠ｍｅ
・デッドリーポイズン作成実装
・エンチャントデッドリーポイズン実装
・ソウルブレイカー実装
・battle_weapon_attackで未初期化の値が戻されるバグ修正
・他使用SPの変更等の細かい修正

	(db)
		const.txt       - 猛毒(SC_DPoison)を追加
		item_db.txt     - 緑ハーブ,緑ポーション,万能薬に猛毒を治す効果を追加
		produce_db.txt  - デッドリーポイズンの材料の定義を追加
		skill_cast_db.txtエンチャントデッドリーポイズン、ソウルブレイカー
						の定義を修正/追加
		skill_db.txt    - ソウルブレイカー/エンチャントデッドリーポイズン/
						デッドリーポイズン作成の定義を修正
						- ナパームバルカンのヒット数修正
		skill_require_db.txt
						- エンチャントデッドリーポイズンが毒薬の瓶を使用する
						ように修正
						- ソウルブレーカー/メテオアサルトの使用SPを修正
	(src/map)
		battle.h		- battle_config.cdp_rateを追加
		battle.c        - ソウルブレーカー実装
						- メテオアサルトにカード効果がかからないよう変更
						- 4213行の条件で未初期化の値が戻されるバグ修正
						- battle_config.cdp_rateを追加
		skill.h			- デッドリーポイズン作成の材料が7つなので、テーブル
						を追加。材料の最大数をdefineで変更できるよう修正
						- SC_DPOISON(182)/SC_EDP(183)を追加
		skill.c			- 猛毒効果を追加
						- デッドリーポイズン作成を実装
--------------------
//1065 by End_of_exam

・サーバーゾンビ化に暫定対処
・calc_index(path.c)の不都合を修正

	(common/)
	timer.c
		TIMER_MIN_INTERVEL(タイマーの最小インターバル）を追加しました。
		それに伴い、do_timer() の戻り値の最低を 10ms から 50ms に変更しました。

		selectが10ms以内に終わらない環境だと、モンスターを大量召還した時などに、
		クライアントからのパケットに反応しなくなる模様です。
		ローカルテスト（モンスター大量召還）をしてみたところ、25msに変更した時点で
		改善しましたが、環境によっては50msでも不十分かもしれません。
		その場合は、TIMER_MIN_INTERVELを増やして様子を見てください。

		同様の現象として、多数のクライアントが接続するとサーバーが反応しなくなる
		というのがありますが、このパッチによってある程度改善されるかもしれません。

	(map/)
	map.h : MAX_WALKPATH
		path.c 内の calc_indexが不都合を起こす(48*48-1 = 1000 1111 1111(b)) ため、
		MAX_WALKPATHを 48 から 32 に変更しました。(32*32-1 = 0011 1111 1111(b))

		#define calc_index(x,y) (((x)+(y)*MAX_WALKPATH) & (MAX_WALKPATH*MAX_WALKPATH-1))
--------------------
//1064 by nameless
・GCC 3.3.0/3.3.1が内包する0/0=変数最大値の問題対策(int:65535/long:4294967294)
・魔法防御・防御・属性防御が正しく適用されない問題を修正
・ナパームバルカンを単体魔法のコードに修正し、呪い効果を実装

	(src/map)
		skill.c
			442〜448行 不等号[<]を[>]に修正
			512〜519行 不等号[>]を[<]に修正
			529〜538行 コンパイラバグの訂正方法と例/*〜*/の部分を
			           gccのバージョンに合わせて生かしたり殺したり
			           してください。3.3.2からは直っているようです
			1857行     ナパームバルカンを追加
			660〜664行 ナパームバルカンの呪い効果を追加
	(src/char)
		char.c
			修正しきれていなかった部分を修正しました。

--------------------
//1063 by 七誌
・月光剣の効果実装
・左手カードによる、武器攻撃時のHP/SP吸収効果が右手に影響する様に修正(本鯖仕様)
  (left_cardfix_to_rightがyesの時のみ。noだと従来通り)

    (db)
        const.txt
            bHPDrainValue=1071とbSPDrainValue=1072を追加
        item_db.txt
            月光剣のEquipScriptにbonus2 bSPDrainValue,100,3を追加

    (src/map)
        battle.c
            battle_weapon_attack() 修正
        map.h
            short hp_drain_value,sp_drain_value,hp_drain_value_,sp_drain_value_;を追加
            SP_HP_DRAIN_VALUE,SP_SP_DRAIN_VALUE, // 1071-1072を追加
        pc.c
            pc_bonus2() 修正

--------------------
//1062 by nameless
・パケット送受信での誤送信修正
・バグ報告スレッド part7 からの取り込み・修正 >> 56,57,58
・fix1059の取り込み
・ハイウィズのネイパームバルカンの実装(eA取り込み)
・CPU最適化コードの修正(athlon系)・追加(玄人箱/Linux Zaurus)

    (/)
		Makefile
			athlon系最適化の修正
			玄人箱(Kuro-Box 200MHz版[PPC 603x])
			玄人箱(Kuro-Box 266MHz版[PPC 604x])
			Linux Zaurus (SL-C7xx)
			の最適化コードを記述

    (db)
		skill_cast_db.txt
			400,500,1200:1600:2000:2400:2500,0,0 //HW_NAPALMVULCAN#ナパームバルカン#
    (src/map)
		clif.c
			clif_parse() 修正
    (src/char)
		char.c
			1367行 cmd = RFIFOW(fd,0);追加
    (src/map)
		skill.c
			switch(skillid)にcase HW_NAPALMVULCAN:以下20行ほど追加
--------------------
//1061 by lizorett (2004/11/9)
・不正なギルドスキルパケットを受けた場合にmap/charサーバが落ちる現象を修正
・不正なパケットを受けた場合にcharサーバが落ちる現象を修正
・結婚したキャラを削除するとcharサーバが落ちる現象を修正
・青箱を一つだけ持った状態で青箱から青箱がでると、青箱が消えるたように見える
 (リログすると見える)問題を修正
・スナッチャーのスキル失敗を表示しないようにできる設定を追加
・デボーションのレベル制限(10レベル差)を変更できる設定を追加

    (src/common)
		mmo.h
			ギルドスキルのenumを追加(src/map/skill.hから移動)
    (src/map)
		skill.h
			ギルドスキルのenumを削除(src/common/mmo.hに移動)
		guild.c
			guild_checkskill スキルの範囲チェックを追加
			guild_skillup スキルの範囲チェックを追加
		skill.c
			skill_additional_effect display_snatcher_skill_failの処理を追加
			skill_castend_nodamage_id devotion_level_differenceの処理を追加
		battle.c
			display_snatcher_skill_fail,devotion_level_differenceの初期化を追加
	(src/char)
		int_guild.c
			guild_checkskill スキルの範囲チェックを追加
			mapif_parse_GuildSkillUp スキルの範囲チェックを追加
		char.c
			parse_char 不正なパケットを受けた場合にはダンプするよう修正
			char_divorce i<MAX_INVENTORYをj<MAX_INVENTORYに変更
	(conf)
		battle_athena.conf
			display_snatcher_skill_fail,devotion_level_differenceを追加
--------------------
//1060 by mosya
・モンスターがスキル詠唱中に座標ズレを起こす問題を修正
・MOBのAI変更。前衛がタゲを取っているのに、後衛に攻撃をしにゆくのを修正
	(src/map)
		mob.c
			mob_ai_sub_hard() 変更
			mobskill_castend_id() 変更
			mobskill_castend_pos() 変更
			mobskill_use_id() 変更
			mobskill_use_pos() 変更
--------------------
//1059 by SPDFMember
・eAthenaを参考にリロードDB系統を追加しました。
	(conf/)
		atcommand_athena.conf
			reloaditemdb
			reloadmobdb
			reloadskilldbを追加
		help.txt
			reloaditemdb
			reloadmobdb
			reloadskilldbの説明を追加
		msg_athena.conf
			89
			90
			91を追加		
	(src/map)
		atcommand.c
			reloaditemdb
			reloadmobdb
			reloadskilldbを追加。
		atcommand.h
			AtCommand_ReloadItemDB,
			AtCommand_ReloadMobDB,
			AtCommand_ReloadSkillDB,を追加
		itemdb.c
			static int itemdb_readdb(void);追加
		itemdb.h
			void itemdb_reload(void);追加
		mob.c
			void mob_reload(void)追加
		mob.h
			void mob_reload(void);追加
		skill.c
			void skill_reload(void)追加
		skill.h
		 	void skill_reload(void);追加
--------------------
//1058 by lizorett
・ギルド倉庫アイテムがMAX_STORAGE個以上あると取り出せないものがある問題を修正
	(src/map)
		clif.c
			clif_parse_DropItem item_index/item_amountの範囲チェックを削除 
								(pc_dropitem でチェックする)
			clif_parse_MoveToKafra item_amountのチェックを削除
								(storage_*storageaddでチェックされている)
			clif_parse_MoveFromKafra item_index/item_amountのチェックを削除
								(storage_*storagegetでチェックされている)
		pc.c
			pc_dropitem n/amountの範囲チェックを追加
--------------------
//1057 by BDPQ銀
・ウォーターボールのダメージを本鯖告知値→実測値に修正。
  [ MATK+SkillLv*30 → MATK*(1+SkillLv*0.3) ]

	(src/map)
		battle.c
			battle_calc_magic_attack 変更 [ 3848行目あたり ]

--------------------
//1056 by robert
順番を検査するのは不法かどうか
	(src/map)
		clif.c	
			clif_parse_DropItem
			clif_parse_MoveToKafra
			clif_parse_MoveFromKafra
--------------------
//1055 by Nameless
・各種CPUに対するコード最適化オプションを設定(全27種) ※GCC 3.3.1 準拠
・Pentium 3のオプションがSSE2になっていたのを訂正
・稀枝さん、robertさんのPacket情報の取り込み(お二人に感謝)

	(/)
		makefile
			i486/586/p54c/mmx/P3/P4/Cele
			k6/k6-2/k6-3/athlon系
			Via C3(Eden)
			PowerPC/G4系

	(src/map/)
		clif.c
			clif_parse_MoveToKafra{}
			コード取り込み

--------------------
//1054 by Nameless
・Cygwinでコンパイルしたathenaが接続53〜58人付近で接続不能になるバグを解消

	(src/common/)
		socket.h
			#ifdef CYGWIN
			#undef FD_SETSIZE
			#define FD_SETSIZE 4096
			#endif
		以上の行を削除
	(/)
		makefile
			OS_TYPE = -DCYGWIN
				↓
			OS_TYPE = -DCYGWIN -DFD_SETSIZE=4096
		に修正

		#optimize for Athlon-4(mobile Athlon)
		#CFLAGS += -march=athlon -mcpu=athlon-4 -mfpmath=sse

		#optimize for Athlon-mp
		#CFLAGS += -march=athlon -mcpu=athlon-mp -mfpmath=sse

		#optimize for Athlon-xp
		#CFLAGS += -march=athlon -mcpu=athlon-xp -mfpmath=sse

		#optimize for pentium3
		#CFLAGS += -march=i686 -mcpu=pentium3 -mfpmath=sse -mmmx -msse2

		各種CPUの最適化を追加gcc3.1以上を使っている場合は#を外し
		て最適化を行うことができると思います。

	※makefileでセットしておかないと、コンパイルの際に一部
	  FD_SETSIZEが小さくなってしまうバグ(?)があるらしく、接続人数が
	  60人弱で接続不能が発生してしまいます。

--------------------
//1053 by TEILU
・パケットパーサーをタイマー呼出しに変更できる設定の追加
・精錬の可否判定でＤＢにどのような設定を入れてもアクセサリは
  精錬できなかった不具合を修正

	(conf/)
		map_athena.conf
			packet_parse_time: 0 追加
	(src/common/)
		core.c
			packet_parse_time 追加
			main() 変更
		socket.c
			parsepacket_timer() 追加
		socket.h
			parsepacket_timer() 追加
	(src/map/)
		map.c
			packet_parse_time 追加
			map_config_read() 変更
		script.c
			buildin_getequipisenableref() 変更

--------------------
//1052 by
居場所つきで検索コマンド追加。
	GMコマンド追加
	@who+	居場所つき検索

	(conf/)
		atcommand_athena.conf
			who+: 1 追加
	(/src/common/)
		version.h
			Ver 1051->1052 変更
	(/src/map)
		atcommand.c
			ATCOMMAND_FUNC(whop);  追加
			{ AtCommand_WhoP,"@who+",0, atcommand_whop }, 追加
		atcommand.h
			AtCommand_WhoP, 追加
--------------------
//1051 by Plala
・ペコペコ騎乗時MAX Weightを増やせるようにしました。
battle_athena.confで設定可能です。

	(conf/)
		battle_athena.conf
			riding_weight 追加
	(map/)
		battle.c
			battle_config.riding_weight 追加
		battle.h
			int riding_weight; 追加
		clif.c
			clif_parse_RemoveOption 変更
		pc.c
			int pc_calcstatus 変更
				1415にsd->max_weight +=battle_config.riding_weight; を追加
	(common/)
		version.h
			Ver 1050->1051 変更
--------------------
//1050 by code
・各種天候操作コマンドの見直し
※いちいち@misceffectで呼び出さずに簡単に天候操作を行えるように
※クライアント依存は落ち葉ではなく雨でした、間違いました(^-^;

	(src/common/)
		version.h
			Ver 1049->1050 変更
	(/src/map)
		atcommand.c
			AtCommand_Rain{} 変更
			AtCommand_Snow{} 変更
			AtCommand_Cherry{} 変更
			AtCommand_Fog{} 変更
			AtCommand_Maple{} 変更

--------------------
//1049 by code
・霧、落葉の2つの天候操作コマンドを追加しました。
※落ち葉に関してはクライアント依存なのでjROだと落ちるかも…

	GMコマンド追加
	@fog       霧
	@maple     落葉

	(conf/)
		atcommand_athena.conf
			fog: 1 追加
			maple: 1 追加

		msg_athena.conf
			87: 霧が立ち込めました。 追加
			88: 落ち葉が降ってきました。 追加
	(/src/common/)
		version.h
			Ver 1048->1049 変更
	(/src/map)
		atcommand.c
			ATCOMMAND_FUNC(fog);  追加
			ATCOMMAND_FUNC(maple);  追加
			{ AtCommand_fog,"@fog",0, atcommand_fog }, 追加
			{ AtCommand_maple,"@maple",0, atcommand_maple }, 追加

		atcommand.h
			AtCommand_Fog, 追加
			AtCommand_Maple, 追加

--------------------
//1048 by code
・雨、雪、サクラ吹雪の3つの天候操作コマンドを追加しました。
※衝動的に追加してしまったのでバグがあるかも知れません(汗

	GMコマンド追加
	@rain       雨
	@snow       雪
	@cherry     サクラ吹雪

	(conf/)
		atcommand_athena.conf
			rain: 1 追加
			snow: 1 追加
			cherry: 1 追加

		msg_athena.conf
			84: 雨が降り出しました。 追加
			85: 雪が降り出しました。 追加
			86: サクラ吹雪を降らせます。 追加
	(/src/common/)
		version.h
			Ver 1047->1048 変更
	(/src/map)
		atcommand.c
			ATCOMMAND_FUNC(rain);  追加
			ATCOMMAND_FUNC(snow);  追加
			ATCOMMAND_FUNC(cherry);  追加
			{ AtCommand_rain,"@rain",0, atcommand_rain }, 追加
			{ AtCommand_snow,"@snow",0, atcommand_snow }, 追加
			{ AtCommand_cherry,"@cherry",0, atcommand_cherry }, 追加

		atcommand.h
			AtCommand_Rain, 追加
			AtCommand_Snow, 追加
			AtCommand_Cherry, 追加

--------------------
//1047 by SVN
・製造アイテムの製作者の名前を引くmap←→charのパケットが間違っていたのを修正
・二重ログインをした時にchar-serverが落ちる可能性があったのを修正
・ガーディアンをGv時間外に殴れた、ID指定のスキルが当たった、skill_unitなスキル攻撃が当たったのを修正
・グラフィティのRangeをとりあえず3にしてみた
	(db/)
		skill_db.txt
	(char/)
	char.c
		parse_frommap()
	(map/)
	clif.c
		clif_parse_ActionRequest() 変更
		clif_parse_UseSkillToId() 変更
	mob.c
		mob_gvmobcheck() 追加
	mob.h
		mob_gvmobcheck() 定義追加
	skill.c
		skill_attack() 変更

--------------------
//1046 by SVN
※db/packet_db.txtは2004-09-06aSakexe用なので、jROクライアントで使用する際は「//jROはここまで」以下をコメントアウトするか削除してください

・変更点が多いので詳細はファイル、関数ごとに記述しています
・1045にそのまま上書きしても動作しますが、使われないファイルがいくつか残ります
・script/以下は名前が変更されているファイルが大量にあるのでscript/の変更点を参考にしてください
・スクリプト用の関数や命令が増えたり仕様が変更されているものがあります
	基本的には互換性があるはずですが、getgdskilllv()だけは第二引数を数字ではなくスキル名(GD_APPROVALなど)に置き換える必要があります
	getgdskilllv()が使われている/script/npc/gvg_big5/*.* は中国語で必要ないので削除してください
	追加や変更に関しては概ねscript_ref.txtに反映してありますが、詳細はscript.cの変更点を読んでください
・追加された@コマンドについては@helpとatcommand.cの変更点を読んでください
・追加された設定はconf_ref.txtを参照してください
・記述漏れの変更点もあるかもしれません

追加したファイルは「A」
変更したファイルは「C」
削除したファイルは「D」
移動したファイルは「M」
	/
		C athena-start
			./conf/import 以下を起動時に自動作成するように変更
			seqコマンドを使わないようにしてFreeBSDでも動作するように変更
			start
				すでにAthenaが起動している時は何もしないように変更
				execで ./ がダブっていたので削除
			stop
				FreeBSDでもシェルに戻るように変更
			kill
				同上
		C Makefile
			PACKETDEF に PACKETVER=6 を追加
			FreeBSDを判定して make と gmake を切り替えるように変更
			CFLAGS を分解して弄りやすいように変更
		C start
			1行目のシェル指定が正しくなかったのを変更
			すでにAthenaが起動している時は何もしないように変更
			起動確認の条件式を athena-start と同じ物に変更
		bin/tool/
			シェルスクリプトの改行コードを CRLF から LF のみに変更
			C getlogincount
				ログインバージョンを $loginversion として変更できるように変更
			C ladmin
				アカウント名に「-」を使えるように変更

		conf/
			D import/
				配布物から削除(athena-start start で自動作成される)
			C atcommand_athena.conf
				shuffle maintenance misceffect 追加
			C char_athena.conf
				default_map_type default_map_name 追加
			C help.txt
				説明追加
			C login_athena.conf
				login_version login_type 追加
			C map_athena.conf
				npc map 色々変更
			C mapflag.txt
				最新版に更新
			C msg_athena.conf
				81以降追加
			C water_height.txt
				最新版に更新
		db/
			C castle_db.txt
				ギルド解体時に発生する OnGuildBreak イベントのために <Event_Name> 追加
			C const.txt
				GvGの開始時間等を設定できるように追加
				マップフラグ mf_notrade mf_noskill 追加
				パラメータ PartnerId Cart 追加
				ボーナス bBreakWeaponRate bBreakArmorRate bAddStealRate bUnbreakableWeapon bUnbreakableArmor 追加
				ステータス変化 SC_WEDDING 追加
				スクリプト命令 getgdskilllv 用に GD_APPROVAL など追加
			C exp.txt
				転生二次職がBaseLv12になるときに必要な経験値を41→481に修正
			C item_db.txt
			C mob_db.txt
			C mob_skill_db.txt
			C skill_cast_db.txt
			C skill_db.txt
			C skill_require_db.txt
			C skill_tree.txt
				最新版に更新
			A packet_db.txt
				パケット定義ファイル追加
		doc/
			C client_packet.txt
				新しく判明したパケットをいくつか追加
			C conf_ref.txt
				新しく追加した設定の説明を追加
			C db_ref.txt
				skill_cast_db.txt の list_hp_rate list_sp_rate で負数を指定した時の挙動を追加
			C help.txt
				conf/help.txt 同様に変更
			C inter_server_packet.txt
				新規で追加したパケットを追加と実態とあっていなかった部分を修正
			C item.txt
				最新版に更新
			C item_bonus.txt
				新規で追加されたボーナスを追加
			C script_ref.txt
				新規命令の追加と既存命令の変更など
			C serverlink_packet.txt
				新規で追加したパケットを追加と既存で書かれていなかったパケットの追加
		script/
			mob/
				C npc_monster.txt
					最新版に更新
					ニブルヘイムのMobはnpc_parse_mob()の変更サンプルになってます
			npc/
				ほぼすべてのNPCをnpc_function.txtを使ったユーザー定義関数と複製などで書き換え
				移動したファイルに関しては移動後のファイルが含まれているので移動前のファイルのみ削除してください
				例) etc/npc_etc_cTower.txt は含まれているので npc_cTower.txt を削除
				M npc_cTower.txt
					→etc/npc_etc_cTower.txt
				A npc_function.txt
				M npc_pota.txt
					→../sample/npc_debug_pota.txt
				M npc_pvp.txt
				M npc_pvproom.txt
					2ファイル合体
					→etc/npc_etc_pvp.txt
				M npc_resetJ.txt
					→../sample/npc_debug_reset.txt
				A etc/
					A npc_etc_gefenia.txt
				C gvg/
					すべてev_agit_common.txtを使ったユーザー定義関数で書き換え
					すべて削除してからこのパッチを当ててください
					ギルド解散時に砦を放棄するためにev_agit_砦.txtにOnGuildBreakイベントを追加
					D test/
					A ev_agit_common.txt
					D ev_agit_event.txt
					D TEST_prtg_cas01_AbraiJ.txt
					D TEST_prtg_cas01_mob.txt
				D gvg_big5/
				C job/
					転職スクリプトの名前をnpc_job_[JOB番号][ジョブ名].txtに変更
					すべて削除してからこのパッチを当ててください
				C quest/
					M npc_event_arrow.txt
						→../../sample/npc_debug_arrow.txt
					A npc_event_hat2.txt
						ニブル同時実装の新頭装備スクリプトを追加
		src/
			calloc() realloc() を極力各型にキャストするように変更
			calloc() 後に memset() で \0 を埋めていたのを削除
			calloc() なのに(サイズ*個数,1)で指定していたのを(個数,サイズ)に変更
			メモリ確保をエラー処理をまとめた関数に書き換え
				malloc() → aMalloc()
				calloc() → aCalloc()
				realloc() → aRealloc()
			strcpy() を strncpy() に極力変更

			char/
				C char.c
					スペースでインデントされていたところをタブで統一
					A isGM()
					A read_gm_account()
						GMアカウントが必要になったので追加
					C mmo_char_tostr()
					C mmo_char_fromstr()
						nullpoチェック追加
					C count_users()
						必要ない{}を削除
					C char_delete()
						nullチェック追加
						削除メッセージをコンソールに表示するようにした
						削除時に接続しているキャラを切断するようmap-serverに通知(0x2b19パケット)するようにした
					C parse_tologin()
						C 0x2713
							char-serverメンテナンス設定時はGM以外入れないようにした
							接続数制限で最大値でもGMは接続できるようにした
						C 0x272a
							0x2730を0x272aに変更して番号を詰めた
							アカウント削除した時にキャラが一部消されない問題を修正
						A 0x272c
							受信時にlogin-serverに通知(0x2b15パケット)してメンテナンス状態になるようにした
					A char_erasemap()
						map-server切断時に他map-serverにマップの削除を通知(0x2b16パケット)するようにした
						これにより他map-server管轄のマップに移動しようとして、そのmap-serverが切断されていたら、
						pc_setpos()で存在しないマップということで移動しようとしなくなるので、
						クライアントが「永遠にお待ちください状態」にならないようになります
					C parse_frommap()
						map-server切断時にchar_erasemap()を実行するようにした
						map-server切断時に管轄のマップにキャラが残っていたら切断を他map-serverに通知(0x2b17パケット)するようにした
						C 0x2afc
							認証失敗時に char_dat[].mapip/mapport を 0 にするようにした
							認証成功時に char_dat[].mapip/mapport をmap-serverのIPアドレスとポートにするようにした
							認証成功時に他map-serverにキャラがログインしたことを通知(0x2b09パケット)するようにした
						C 0x2b02
						C 0x2b05
							コンソールへの出力にパケット番号を記述するようにした
						C 0x2b08
							パケット仕様を変更して account_id mapip mapport も通知するように変更
							map-serverに接続していない時はすべて 0 が入ります
						A 0x2b13
							map-server起動途中などでキャラがログインできないようにする server[].active フラグを操作する
							active = 0 でキャラはログインできずに切断される
							map-serverが起動を完了したときに active = 1 にするパケットが送られてくる
						A 0x2b14
							char-serverをメンテナンス状態にする char_maintenance フラグを操作する
							login-serverにも通知(0x272bパケット)してワールド選択画面でメンテナンス表示をする
							メンテナンス状態ではGM以外のユーザーはログインできません
						A 0x2b18
							キャラクターの切断を他map-serverに通知(0x2b17パケット)するようにした
					C search_mapserver()
						引数に struct mmo_charstatus *cd を追加
						cdが渡された＆探しているマップが接続しているmap-serverに無かったときに、最初に見つけたmap-serverの最初に見つけたマップに接続するようにした
						これは char_athena.conf default_map_type: 2 の時の挙動です
					C parse_char()
						C 0x65
							メンテナンス状態の時にGM以外を切断するようにした
							最大接続数が設定されていて最大接続数のときもGMは接続できるようにした
						C 0x66
							char-serverに接続しているmap-serverにlast_pointが見つけられなかったときに、
							default_map_type&1 の時は default_map_name に接続する
							default_map_type&2 の時は 最初に見つけたmap-serverの最初に見つけたマップに接続する
							それでも見つからない時は切断するようにした
							コンソールへの出力にパケット番号を記述するようにした
						C 0x2af8
							他マップに接続しているキャラ情報を通知(0x2b09パケット)するようにした
						C 0x187
							S 0187パケットを返信するようにした
					C check_connect_login_server()
						char_portをWFIFOLで送っていたのをWFIFOWに修正
						80と82の間が空いていたのを詰めてパケット長を86→84に変更
					C char_config_read()
						default_map_type default_map_name を読み込むようにした
					A gm_account_db_final()
						確保した gm_account_db のメモリを終了時に開放するようにした
					C do_final()
						inter.c など他ファイルの終了処理(do_final_*)を追加した
						exit_dbn() でdb用のメモリを開放するようにした
						接続されているmap-serverのセッションを削除するようにした
						do_final_timer()でtimerを終了させるようにした
					C do_init()
						server[].active = 0 で初期化
						read_gm_account() でGMアカウントファイルを読み込むようにした
				C char.h
					mmo_map_server に active フラグを追加した
				C int_guild.c
					C mapif_parse_GuildSkillUp()
						ギルドポイントを消費しないでギルドスキルを上げるために int flag を追加
					C inter_guild_parse_frommap()
						0x303C
							パケット定義を変更してflagを追加した
					A guild_db_final()
					A castle_db_final()
					A do_final_int_guild()
						終了時にメモリを開放するようにした
				C int_guild.h
					A do_final_int_guild()
						定義を追加
				C int_party.c
					A party_db_final()
					A do_final_int_party()
						終了時にメモリを開放するようにした
				C int_party.h
					A do_final_int_party()
						定義を追加
				C int_pet.c
					A pet_db_final()
					A do_final_int_pet()
						終了時にメモリを開放するようにした
				C int_pet.h
					A do_final_int_pet()
						定義を追加
				C int_storage.c
					A storage_db_final()
					A guild_storage_db_final()
					A do_final_int_storage()
						終了時にメモリを開放するようにした
				C int_storage.h
					A do_final_int_storage()
						定義を追加
				C inter.c
					パケット長定義を変更
					A mapif_parse_CharPosReq()
						0x3090パケットへの対応
						キャラの位置要求をmap-serverに通知(0x3890パケット)する
					A mapif_parse_CharPos()
						0x3091パケットへの対応
						キャラの位置要求をしたキャラに位置情報を通知(0x3891パケット)する
					A mapif_parse_CharMoveReq()
						0x3092パケットへの対応
						要求したキャラまで対象のキャラを飛ばす要求を通知(0x3892パケット)をする
					A mapif_parse_DisplayMessage()
						0x3093パケットへの対応
						キャラにメッセージを送信(0x3893パケット)する
					C inter_parse_frommap()
						各追加パケットへの対応を追加した
					A wis_db_final()
					A accreg_db_final()
					A do_final_inter()
						終了時にメモリを開放するようにした
				C inter.h
					A do_final_inter()
						定義を追加
				C Makefile
					A nullpo.o nullpo.h を追加
					A malloc.o malloc.h を追加
			common/
				C db.c
					A exit_dbn()
						終了時にメモリを開放するために追加
				C db.h
					A exit_dbn()
						定義追加
				A malloc.h
				A malloc.c
					メモリ確保関数のまとめ
				C mmo.h
					C mmp_charstatus
						mapip mapport 追加
					C guild_castle
						castle_event 追加
				C Makefile
					A malloc.o malloc.h malloc.c を追加
				C nullpo.h
					古いgccでコンパイルできるように\を削除
				C socket.c
					C recv_to_fifo()
						汎用性を高めるために read() を recv() に変更
					C send_from_fifo()
						汎用性を高めるために write() を send() に変更
				C timer.c
					A do_final_timer()
						終了時にメモリを開放するようにした
				C timer.h
					A do_final_timer()
						定義追加
			login/
				C login.c
					A login_version login_type
						clientinfo.xmlで指定する login_version login_type でログインを規制するときに使います
					C parse_fromchar()
						A 0x272b
							server[].maintenance フラグを変更する
							変更した内容をchar-serverに返信(0x272cパケット)する
					C parse_admin()
						C 0x7932
							0x2730→0x272a に変更
					C parse_login()
						C 0x64 0x01dd
							login_version login_type を判定するようにした
						C 0x2710
							パケット長の定義が正しくなかったのを修正した
							char.c check_connect_login_server の変更を反映
					C login_config_read()
						login_version login_typeの読み込みを追加
					A gm_account_db_final()
					C do_final()
						終了時にメモリを開放するように変更
				C Makefile
					A malloc.o malloc.h を追加
			map/
				C atcommand.c
					コンパイルオプションでmemwatchを読み込めるようにした
					C atcommand_where()
						他map-serverにいるキャラの居場所も表示できるようにした
					C atcommand_jumpto()
						他map-serverにいるキャラにも飛べるようにした
					C atcommand_who()
						ワールド内のすべてにいるキャラを表示するようにした
					C atcommand_go()
						ニブルヘルムの移動ポイントを変更
					C atcommand_recall()
						他map-serverにいるキャラも呼び出せるようにした
					A atshuffle_sub()
					A atcommand_shuffle()
						PCとMOBのシャッフルを行う @shuffle を追加
					A atcommand_maintenance()
						char-serverをメンテナンス状態にする @maintenance を追加
					A atcommand_misceffect()
						実行したキャラから0x1f3パケットを発信してエフェクトを表示する @misceffect を追加
					A atcommand_summon()
						コールホムンクルスと叫んで指定したMobを召喚する @summon を追加
						召喚されたMobは他のMob(Pv等では敵対PC含む)を攻撃します
						召喚されたMobに攻撃されたMobは召喚主を攻撃します(バイオプラントのフローラと同じ挙動)
						召喚されたMobは1分後に消滅します
						ネタなので隠しコマンドとしてhelp.txtには記述してません
				C atcommand.h
					追加した@コマンドを AtCommandType に追加
					C msg_table[] を外から使えるようにするためにexternした
				C battle.c
					コンパイルオプションでmemwatchを読み込めるようにした
					A battle_config.castle_defense_rate
						本鯖で防御値がどのように影響するか具体的には分からなかったので、砦の防御値を反映させる率を設定できるようにした
					C battle_get_opt1()
					C battle_get_opt2()
					C battle_get_option()
						NPCのオプションも返すようにした
					A battle_get_opt3()
						opt3を返すように追加
					C battle_calc_damage()
						砦内のMobへのダメージは防御値で減算(ダメージ*(防御値/100)*(castle_defense_rate/100))されるようにした
						ガーディアンにはスキルが効くようにした
					C battle_calc_pet_weapon_attack()
					C battle_calc_mob_weapon_attack()
					C battle_calc_pc_weapon_attack()
						ベナムスプラッシャーのダメージ計算をするようにした
					C battle_weapon_attack()
						武器攻撃による即死の仕様を変更
						武器、鎧破壊の確率計算をするように変更
						ベナムスプラッシャーが解除されるように変更
					C battle_check_target()
						src じゃなくて ss からparty_id guild_idを取得するように修正
						target=BCT_NOENEMY なスキル 口笛、ハミングなどがPvP、GvGの時にも他PCに影響するようにした
						Mobがspecial_aiならMobを敵とみなすようにした
					C battle_config_read()
						castle_defense_rate を読み込むようにした
				C battle.h
					A battle_get_opt3()
						定義追加
					C Battle_Config
						castle_defense_rate 追加
				C chat.c
					C chat_createnpcchat()
						引数に int pub を追加
						pub=3 ではチャットの看板に(0/20)のような表示がされなくなります
					A do_final_chat()
						何もしてないけどとりあえず追加
				C chat.h
					C chat_createnpcchat()
						定義を変更
					A do_final_chat()
						定義を追加
				C chrif.c
					パケット長テーブルを拡張
					C chrif_connect()
					C chrif_changemapserver()
						WFIFOLでポートを送っていたのをWFIFOWに修正
					A chrif_recverasemap()
						他map-serverが切断されたことがchar-serverより通知された時に、そのmap-serverが管理していたマップの情報を削除するようにした
					A chrif_mapactive()
						map-server起動準備中に0、完了時に1をchar-serverに通知(0x2b13)して起動途中にユーザーがログインできないようにした
					A chrif_maintenance()
						char-serverをメンテナンス状態にしたり解除したりを通知(0x2b14)する
					A chrif_maintenanceack()
						char-serverをメンテナンス状態にした時の応答
						メンテナンス状態にした旨をマップ内に通知する
					A chrif_chardisconnect()
						char-serverにキャラが切断されたことを通知(0x2b18)する
					A chrif_parse_chardisconnectreq()
						char-serverからのキャラ切断要求を受けて、対象キャラがいる場合には切断する
					C chrif_parse()
						C 0x2b09
							map_addchariddb() の引数増加に対応
						A 0x2b15
						A 0x2b16
						A 0x2b17
						A 0x2b19
							各新規パケットに対応
					C check_connect_char_server()
						接続時char-serverにmap-serverの準備が出来たことを通知するようにした
					A do_final_chrif()
						終了時にchar-serverとの接続を削除するようにした
				C chrif.h
					A chrif_mapactive()
					A chrif_maintenance()
					A chrif_chardisconnect()
					A do_final_chrif()
						定義を追加
				C clif.c
					すべてのパケット定義を packet_db から読み込むように変更
					packet_db.txtを変更することで、度々変更される韓国クライアントのパケット定義に対応しやすくなります
					packet_len_table[] は packet_db[].len に置き換わりました
					<time.h> をinclude
					clif_parse_*を先頭で宣言するようにした
					clif_parse_*内のRFIFO系で使われている第2引数は packet_db[cmd].pos[] で表記されるようになりました
					パケット番号の最大値を MAX_PACKET_DB で定義するようにした
					C clif_set0078()
					C clif_set007b()
						パケットの内容が本鯖と違っていたのでguild_emblem_id,manner,opt3を正しく送るように変更
					C clif_class_change()
						Mob以外のNPCでも使えるようにした
					C clif_mob0078()
					C clif_mob007b()
						ガーディアンにギルドエンブレムを表示するように変更
					C clif_npc0078()
						ワープポータルをギルドフラッグにするオプションを有効にした時にmap-serverが落ちる問題を修正
					C clif_spawnnpc()
						NPCが無効でもHide状態の時はパケットを送るように変更
					C clif_quitsave()
						キャラ終了時にchar-serverに切断を通知するようにした
					C clif_scriptmenu()
					C clif_dispchat()
					C clif_changechatstatus()
						lenに1バイト追加
					C clif_updatestatus()
						マナーポイントを送信するようにした
					A clif_changestatus()
						周囲に赤エモ状態であることを送信
					A clif_misceffect2()
						エフェクトを発生させるパケットを送信
						@misceffect, misceffect命令で使用
					C clif_changeoption()
						状態異常時以外は状態異常アイコン表示パケットを送らないようにした
						PCの時は clif_changelook() を送信するようにした(結婚衣裳表示用？)
					C clif_traderequest()
						取引パケットの 0xe5 → 0x1f4 に仮対応(本鯖での算出式は不明なのでとりあえず char_id を送信)
					C clif_tradestart()
						取引パケットの 0xe7 → 0x1f5 に仮対応(本鯖での算出式は不明なのでとりあえず char_id を送信)
					C clif_getareachar_pc()
						マナーポイントが負数の時には赤エモ表示パケットを送信するようにした
					C clif_getareachar_npc()
						NPCのHide状態に対応
					C clif_getareachar_skillunit()
					C clif_skill_nodamage()
						自爆の時はhealを負数にできるようにした
					C clif_skill_setunit()
						グラフィティに対応
					A clif_item_repair_list()
						武器修理スキルに対応しようとしたけどパケットが分からないので頓挫中
					C clif_produceeffect()
						map_addchariddb() の引数増加に対応
					C clif_guild_skillinfo()
						未実装ギルドスキル カリスマを表示しないようにした
					C clif_callpartner()
						あなたに逢いたい 使用時に相手の名前を叫ぶようにした
					C clif_sitting()
						引数 fd は不要なので削除
					C clif_GM_kick()
						フラグを0にするようにした
					A clif_wisexin()
						Wis拒否許可の応答を送信
					A clif_wisall()
						Wis全拒否許可の応答を送信
					A clif_soundeffect()
						SEを鳴らすパケットを送信
						soundeffect命令で使用
					C clif_parse_LoadEndAck()
						結婚後のウェディングドレスやタキシードの状態をログアウトしても1時間は継続されるようにした
						赤エモ状態はログアウトしてもログインした時からまた継続するようにした
					C clif_parse_QuitGame()
					C clif_parse_Restart()
						終了できない条件を pc_isquitable() にまとめた
					C clif_parse_GlobalMessage()
					C clif_parse_Wis()
					C clif_parse_PartyMessage()
					C clif_parse_GuildMessage()
						赤エモ状態では発言できないようにした
					C clif_parse_ActionRequest()
						ギルド未加入などの場合はガーディアンやエンペリウムを殴れないようにした
						clif_sitting()の引数変更に対応
					C clif_parse_UseItem()
						赤エモ状態ではアイテムを使えないようにした
					C clif_parse_EquipItem()
						アイテムが破壊されている時は装備できないようにした
					C clif_parse_TradeRequest()
					C clif_parse_TradeAck()
						notradeマップでは取引要請を送れないようにした
					C clif_parse_UseSkillToId()
					C clif_parse_UseSkillToPos()
					C clif_parse_UseSkillMap()
						noskillマップではスキルを使用できないようにした
						チャット中はスキルを使用できないようにした
						赤エモ中はスキルを使用できないようにした
						ウェディング状態ではスキルを使用できないようにした
					C clif_parse_MoveToKafra()
						itemdb_isdropable()==0 は倉庫に入れられないようにした
					C clif_parse_GMReqNoChat()
						GM右クリックで赤エモを付与・解除できるようにした
					C clif_parse_GMReqNoChatCount()
						本鯖での返答パケットがよく分からないので仮対応
						本当はアカウント名が返るのかな？
					C clif_parse_sn_explosionspirits()
						クライアントからパケットが来た時にコンソールにログを表示するようにした
						BaseLv99以上の時に0で除算する可能性があるのを回避
					A pstrcmp()
						clif_parse_wisexin()のqsort()で使用
					A clif_parse_wisexin()
						Wis拒否許可に対応
					A clif_parse_wisexlist()
						Wis拒否リスト表示に対応
					A clif_parse_wisall()
						Wis全拒否許可に対応
					A clif_parse_GMkillall()
						GMコマンド/killall(=@kickall)に対応
					A clif_parse_GMsummon()
						GMコマンド/summon(=@recall)に対応
					A clif_parse_GMshift()
						GMコマンド/shift(=@jumpto)に対応
					A clif_parse_debug()
						packet_db.txtのデバグ用に追加
						パケット内容をダンプします
					C clif_parse()
						clif_parse_func_table を削除(packet_db[cmd].funcに入るようになりました)
					A packetdb_readdb()
						packet_db.txtを読み込みます
						フォーマットは パケット番号,パケット長[,コマンド,コマンド引数の位置(:区切りで複数指定)]
						コマンド引数の位置は各コマンドに対応する関数内で設定されているのでclif.cを読まないと分からない難解なフォーマットです
						変更されたパケットはpacket_db.txtの末尾に追加します
						古いクライアントを利用する場合には不要な定義を末尾から削除すればよいようにします
					A do_final_clif()
						終了時にセッションを削除するようにした
					C do_init_clif()
						packet_dbを読み込むようにした
						終了時にセッションを削除できるように make_listen_port() の戻り値を map_fd に入れるようにした
				C clif.h
					A MAX_PACKET_DB
					A struct packet_db
					A clif_changestatus()
					A clif_misceffect2()
					A clif_callpartner()
					A clif_sitting()
					A clif_soundeffect()
					A clif_item_repair_list()
					A do_final_clif()
						定義を追加
					C clif_class_change
						clif_mob_class_change() から変更
				C guild.c
					C guild_read_castledb()
						castle_event を読み込むようにした
					C guild_skillup()
						引数を変更
						flag=1 でギルドポイントを使用しないようにした
					C guild_broken()
						ギルド解散時に所有砦を破棄するための OnGuildBreak イベントを追加
					A guild_db_final()
					A castle_db_final()
					A guild_expcache_db_final()
					A guild_infoevent_db_final()
					A do_final_guild()
						終了時にメモリを開放するようにした
				C guild.h
					C guild_skillup()
						定義を変更
					A do_final_guild()
						定義を追加
				C intif.c
					atcommand.h をinclude
					packet_len_table[] 拡張
					C intif_guild_skillup()
						引数 flag 追加
					A intif_charposreq()
						キャラの場所要求パケットを送信
						flag=1 @jumpto
						flag=0 @where
					A intif_jumpto()
						他map-serverのキャラに @jumpto 出来るようにした
					A intif_where()
						他map-serverのキャラに @where 出来るようにした
					A intif_charmovereq()
						キャラを呼び寄せる
						flag=1 @recall
						flag=0 あなたに逢いたい
					A intif_displaymessage()
						他map-serverのキャラにメッセージを送れるようにした
						(Wisではなくて送りっぱなし。@recall 成功時用)
					C intif_parse_WisMessage()
						Wis拒否の判定をするようにした
					A intif_parse_CharPosReq()
						キャラの居場所をInterへ返答
					A intif_parse_CharPos()
						キャラの居場所がInterから送られてきたので
						flag=1 キャラの場所へ移動(@jumpto)
						flag=0 キャラの場所を表示(@where)
					A intif_parse_CharMoveReq()
						キャラがいたら指定位置に移動させる
						flag=1 @recall なのでGMレベルを比較、メッセージを表示
					A intif_parse_DisplayMessage()
						指定キャラにメッセージを送信
					C intif_parse()
						新パケットを追加
				C intif.h
					C intif_guild_skillup()
						定義変更
					A intif_jumpto()
					A intif_where()
					A intif_charmovereq()
					A intif_displaymessage()
						定義の追加
				C itemdb.c
					A itemdb_isdropable()
						アイテムが捨てられるかどうかの判定をする
					A itemdb_read_cardillustnametable()
						grfファイルから num2cardillustnametable.txt を読み込む
						cutincard命令で使用
					C do_init_itemdb()
						itemdb_read_cardillustnametable() を追加
				C itemdb.h
					C struct item_data
						char cardillustname[64] 追加
					A itemdb_isdropable()
						定義の追加
				C Makefile
					A malloc.o malloc.h を追加
				C map.c
					C struct charid2nick
						@whoで他map-serverのキャラも表示できるように account_id ip port を追加
					C map_freeblock()
					C map_freeblock_unlock()
						二重free()対策でNULLを代入するようにした
					C map_delblock()
						見やすいように繰り返し使用される変数をまとめた
					C map_addchariddb()
						charid2nick の拡張にあわせて引数を増やした
					A map_delchariddb()
						charid_db からキャラを削除(実際にはip portを0に)する
					C map_quit()
						結婚状態中はログアウトしても1時間は状態が続くようにPCグローバル変数 PC_WEDDING_TIME に開始時間を記録するようにした
					C map_id2bl()
						見やすいように書き換え
					A map_eraseipport()
						他map-server管理のマップを map_db から削除する
					A map_who_sub()
					A map_who()
						他map-serverにいるキャラも @who で表示されるようにした
						表示上キャラが残ることがあるのは調査中
					A id_db_final()
					A map_db_final()
					A nick_db_final()
					A charid_db_final()
					C do_final()
						終了時にメモリを開放するように変更
				C map.h
					A MAX_WIS_REFUSAL
						Wis拒否リストの保存最大値
					C struct map_session_data
						C special_state
							A unbreakable_weapon
								武器が絶対に壊れない
							A unbreakable_armor
								鎧が絶対に壊れない
						A opt3
							画面外から入ってきたキャラの状態
						A areanpc_id
							OnTouchイベントを実行したNPCのID
						A wis_refusal[][]
							Wis拒否リスト
						A wis_all
							Wis全拒否フラグ
						A break_weapon_rate
							武器破壊率
						A break_armor_rate
							鎧破壊率
						A add_steal_rate
							追加スティール率
					C struct npc_data
						A opt1,opt2,opt3,option
							PCと同じ
						C u.scr
							A src_id
								終了時のメモリ開放用
					C struct mob_data
						A opt3
							PCと同じ
						A guild_id
							ガーディアンなどで使用
						D exclusion_*
							関連関数を消したので削除した
					C struct map_data
						C flag
							A notrade
								取引禁止マップフラグ
							A noskill
								スキル使用禁止マップフラグ
					定数の追加
						SP_PARTNER SP_CART
						SP_BREAK_WEAPON_RATE SP_BREAK_ARMOR_RATE SP_ADD_STEAL_RATE
						SP_UNBREAKABLE_WEAPON SP_UNBREAKABLE_ARMOR
					D talkie_mes[]
						定義削除
					C map_addchariddb()
						定義変更
					A map_delchariddb()
					A map_eraseipport()
					A map_who()
						定義追加
				C mob.c
					D mob_exclusion_add()
					D mob_exclusion_check()
						意味がある使用をされていないのとbattle_check_target()で代用できるので削除した
					C mob_stop_walking()
						type&4で目的の場所まで距離があれば1歩進んで止まるようにした
					C mob_attack()
						MobがMobを攻撃できるようにした
					C mob_target()
					C mob_ai_sub_hard_slavemob()
						mob_exclusion_check()を削除
					C mob_ai_sub_hard_activesearch()
					C mob_ai_sub_hard()
						special_mob_aiな場合はMobも索敵するようにした
						ルートモンスターが目標のアイテムを見失った時は目的の場所まで歩かないようにした
					C mob_damage()
						スフィアマインが殴られた時に自爆しなかったのを修正した
						スフィアマインが殴られて自爆する時に移動するようにした
						srcがMobの時はsrcのターゲットを外すようにした
					C mob_skillid2skillidx()
						インデックスが0から始まるのにエラーも0を返すしていたのを修正した
						スフィアマインが殴られても自爆しない原因はこれ
					C mobskill_use()
						自爆状態ではスキルを使用できないようにした
					C mob_spawn()
						ガーディアンとエンペリウムが砦で発生した場合は guild_id を設定
						opt3 を 0 で初期化
					C mob_can_reach()
						GvG以外ではガーディアンは何もしないようにした
					C mob_catch_delete()
						Mobが消えるときのエフェクトを type で指定できるようにした
					C mob_timer_delete()
						スフィアマインとバイオプラントが消えるときはテレポエフェクトで消えるようにした
					C mob_deleteslave_sub()
						nullチェック前に代入している部分を修正
					C mob_class_change()
						clif_class_change() の変更に対応
				C mob.h
					C mob_catch_delete()
						定義変更
					D mob_exclusion_add()
					D mob_exclusion_check()
						定義削除
				C npc.c
					C struct npc_src_list
						A prev
							終了時のメモリ開放用に追加
					C npc_checknear()
						イベントPCの場合に常にOKを返していなかったのを修正
					A npc_enable_sub()
						npc_enable() から呼ばれて周囲のPCにOnTouchイベントを実行する
					C npc_enable()
						flag による挙動を追加
						flag=2 NPCのHide状態を解除する
						flag=4 NPCをHide状態にする
						HideしているNPCは無効になります
						有効にした時に npc_enable_sub() を呼ぶようにした
					C npc_event()
						エラー時は1を返すように変更
						OnTouchイベントから呼ばれたときはイベントが見つからないエラーを返さないようにした
					C npc_touch_areanpc()
						PCがエリア内を通った時に何度も実行されるのを修正
						NPCにOnTouchイベントがあった場合には実行するようにした
						互換性を保つためにOnTouchイベントが無い場合は今までと同じように動きます
					C npc_parse_warp()
						option,opt1,opt2,opt3 を 0 で初期化
					C npc_parse_warp()
					C npc_parse_shop()
						IDをnpc_get_new_npc_id()で取得するようにした
						option,opt1,opt2,opt3 を 0 で初期化
					C npc_convertlabel_db()
						メモリ確保後にnullかどうか確認していないのを修正
					C npc_parse_script()
						bad duplicate name!エラー表示が改行されていなかったのを修正
						終了時メモリ開放用にduplicateで src_id を挿入
						IDをnpc_get_new_npc_id()で取得するようにした
						option,opt1,opt2,opt3 を 0 で初期化
					C npc_parse_mob()
						memwatch対策でメモリを一括確保しないようにした
						モンスター名に --ja-- --en-- を指定するとmob_dbの名前を使うようにした
						IDをnpc_get_new_npc_id()で取得するようにした
					C npc_parse_mapflag()
						notrade noskill を読み込むようにした
					A ev_db_final()
					A npcname_db_final()
					A do_final_npc()
						終了時にメモリを開放するようにした
					C do_init_npc()
						メモリを開放するようにした
				C npc.h
					A do_final_npc()
						定義の追加
				C party.c
					A party_db_final()
					A do_final_party()
						終了時にメモリを開放するようにした
				C party.h
					A do_final_party()
						定義の追加
				C pc.c
					A pc_numisGM()
						account_idでGMかどうか判断する
					A pc_isquitable()
						PCが終了できる状態にあるかどうか判断する
						1を返すときは終了できない
					C pc_counttargeted_sub()
						Mob状態によって値を正しく返さないような気がするので条件を仮変更
					C pc_makesavestatus()
						マナーポイントが正数の場合は 0 にする
					C pc_authok()
						wis_all を 0 で初期化
						map_addchariddb() の変更に対応と常に実行するようにした
					C pc_calcstatus()
						break_weapon_rate break_armor_rate add_steal_rate を 0 で初期化
						結婚状態では歩く速度が半分になるようにした
					C pc_bonus()
						SP_UNBREAKABLE_WEAPON SP_UNBREAKABLE_ARMOR SP_BREAK_WEAPON_RATE SP_BREAK_ARMOR_RATE SP_ADD_STEAL_RATE
						処理を追加
					C pc_dropitem()
						アイテムを捨てられるかどうか判定するようにした
					C pc_putitemtocart()
						アイテムをカートに移動できるか判定するようにした
					C pc_steal_item()
						スティール率に add_steal_rate を加算するようにした
					C pc_walk()
					C pc_movepos()
						範囲NPCがいないときには areanpc_id=0 にした
					C pc_checkbaselevelup()
						スパノビがレベルアップした時にかかるスキルのレベルを本鯖にあわせた
					C pc_skillup()
						guild_skillup() の変更に対応
					C pc_damage()
						スパノビがExp99%でHPが0になるとHPが回復して金剛状態になるようにした
					C pc_readparam()
						nullチェック前にsdを使っていたのを修正
						A SP_PARTNER
							結婚相手のchar_id
						A SP_CART
							カートを引いている場合は0以上が返る
					C pc_jobchange()
						マナーポイントが負数の場合は赤エモ表示するようにした
					A pc_break_weapon()
						武器破壊をする
					A pc_break_armor()
						鎧破壊をする
					C pc_natural_heal_sp()
						スパノビは爆裂状態でもSPが自然回復するようにした
					A gm_account_db_final()
					A do_final_pc()
						終了時にメモリ開放するようにした
				C pc.h
					A pc_numisGM()
					A pc_isquitable()
					A pc_break_weapon()
					A pc_break_armor()
					A do_final_pc()
						定義追加
				C pet.c
					C pet_data_init()
					C pet_lootitem_drop()
						メモリ確保できたかどうか確認していなかったので修正
					C pet_catch_process2()
						mob_catch_delete() の変更に対応
				C script.c
					追加した関数のプロトタイプを先頭に追加
					buildin_func[]に追加した命令や関数を追加
					演算子に C_R_SHIFT C_L_SHIFT を追加
					C parse_subexpr()
						演算子 >> << 追加
					C get_val()
						PC主体の変数でPCがアタッチされていなかったらエラーを出すようにした
						PC主体の変数でsd=NULLだった場合にはpc_read*で取得に行かないようにした
					A buildin_close2()
						スクリプトを中断してCloseボタンを表示します
					C buildin_areawarp_sub()
						RandomだけでなくSavePointにも飛ばせるようにした
					A buildin_cutincard()
						カードのアイテムIDを指定することでカード画像を表示します
					C buildin_getitem()
						引数を変更して鑑定した状態で渡すかどうかを指定できるようにした
						account_idを指定することで、そのPCにアイテムを渡せるようにした(結婚用拡張)
					C buildin_getitem2()
						account_idを指定することで、そのPCにアイテムを渡せるようにした(結婚用拡張)
					C buildin_readparam()
						キャラ名を指定することで、そのPCのパラメータを読み取れるようにした
					C buildin_getcharid()
						キャラ名を指定することで、そのPCの関係IDを取得できるようにした
					A buildin_getpartymember()
						指定IDのパーティ人数の取得とパーティーメンバーのIDを配列で取得できます
					A buildin_guildskill()
						ギルドスキルを覚えることができます
					C buildin_getgdskilllv()
						ギルドスキルIDをGD_APPROVALのようなスキル名で指定するようにした
					A buildin_hideoffnpc()
						Hide状態のNPCを表示する
					A buildin_hideonnpc()
						NPCをHide状態にする
					C buildin_sc_start()
						ID指定したキャラを状態異常にできるようにした
					A buildin_sc_start2()
						確率指定でキャラを状態異常にできます(アイス、おもち等で使用)
					A buildin_getscrate()
						状態異常耐性を計算した確率を返す
					C buildin_changebase()
						IDで指定したキャラの見た目を変更することができるようにした
					C buildin_waitingroom()
						limit=0の時は(1/10)を表示しないようにした
					C buildin_setmapflag()
						MF_NOTRADE MF_NOSKILL を追加
					C buildin_flagemblem()
						NPCが特定できなかったときにmap-serverが落ちる問題を修正
					A buildin_getinventorylist()
						配列で所持品を返します
					A buildin_getskilllist()
						配列で所有スキルを返します
					A buildin_clearitem()
						所持アイテムを削除します
					A buildin_getrepairableitemcount()
						壊れているアイテムを数えます
					A buildin_repairitem()
						壊れているアイテムをすべて修理します
					A buildin_classchange()
						NPCをクラスチェンジします
					A buildin_misceffect()
						エフェクトを表示します
					A buildin_soundeffect()
						指定したSEを鳴らします
					C op_2num()
					C run_script_main()
						シフト演算子を追加
					A mapreg_db_final()
					A mapregstr_db_final()
					A scriptlabel_db_final()
					A userfunc_db_final()
					C do_final_script()
						終了時にメモリを開放するようにした
				C skill.c
					<timer.h> intif.h をinclude
					コメントのスキル名をjRO仕様に書き換え
					C SkillStatusChangeTable[]
						ベナムスプラッシャー グラフィティ 自爆 自爆2 を追加
					C skill_additional_effect()
						ベナムスプラッシャー追加
						アンクルスネアを削除
					C skill_attack()
						チャット中にスキルが影響しないようにした(チャットキャンセル)
						ベナムスプラッシャーはSkillLv=-1でclif_skill_damage()するようにした
						自爆はダメージ表示しないようにした
					C skill_castend_damage_id()
						アシッドテラーで武器破壊をするようにした
						ベナムスプラッシャーが3*3の範囲攻撃をするようにした
						自爆の処理を変更した
					C skill_castend_nodamage_id()
						sdとdstsdでPCかどうかを判定するようにした
						スパノビの嫁がヒールを使うと回復量が2倍になるようにした
						clif_sitting()の変更に対応
						武器修理はパケットが分からないのでコメントアウト
						ストリップ〜、ケミカル〜をスキルユニットに使用した場合、map-serverが落ちる問題を修正
						君だけは護るよ、あなたの為に犠牲になりますの計算をMAX_HPまたはMAX_SPからするようにした
						あなたに逢いたい を相手の名前を叫ぶ、複数設置できない等、本鯖風にした
						アンクルスネアでPCが引っかかっている時にリムーブトラップしてもPCが動けるようにならなかったのを修正
						アンコールを叫ぶようにした
						ベナムスプラッシャーを実装した
						自爆で自爆状態を開始するようにした
					C skill_castend_pos2()
						バイオプラント、スフィアマイン
							パケット順番を変更
							指定した場所に設置するようにした
							効果時間をskill_cast_db.txtで指定するようにした
							mob_exclusion_add()を削除
						グラフィティを実装、1個しか置けません
					C skill_castend_map()
						ワープポータルは実際の設置時にブルージェムストーンを消費するようにした
					C skill_unitsetting()
						グラフィティのスキルユニットを1個に修正
						トーキーボックス、グラフィティの文字列は sd->message に格納するようにした
					C skill_unit_onplace()
						チャット時はスキルユニットが動作しないようにした(チャットキャンセル)
						アンクルスネアにかかる処理をskill_additional_effect()から移動
						ワープポータルに術者が乗ったら消えるようにした
						デモンストレーションによる武器破壊をするようにした
						アンクルスネア、スパイダーウェッブでメモリアクセス違反が起きる可能性があったのを修正
					C skill_unit_onout()
						アンクルスネアで「}」が足りなかったために近くを通りかかっただけで1秒後罠に戻ってしまったのを修正
					C skill_unit_onlimit()
						ワープポータル発動前の処理を削除
						あなたに逢いたいを他map-serverにいても呼べるようにした
					A skill_check_condition_mob_master_sub()
						マップ内で同じPCから出たバイオプラントやスフィアマインの数を数える
					C skill_check_condition()
						hp_rateとsp_rateに負数を指定すると消費計算をMax値からするようにした
						あなたに逢いたいを結婚していない状態で使ったら使用失敗を表示するようにした
						バイオプラントとスフィアマインの設置数をskill_cast_db.txtで設定できるようにした
						ファイアーウォールの数制限を skill_use_pos() から移動
					C skill_use_id()
						バジリカをGvGでは使用できないようにした
						ベナムスプラッシャーは対象が毒状態でなければ使用失敗
					C skill_use_pos()
						ファイアーウォールの数制限を skill_check_condition() に移動
					C skill_status_change_end()
						opt3の処理を追加
						結婚状態の終了を追加
						ベナムスプラッシャーを追加
						自爆を追加
					C skill_status_change_timer()
						結婚状態と赤エモ状態のタイマー再設定を追加
						自爆状態では1秒ごとに速度が変化するようにした
					C skill_status_change_start()
						opt3の処理を追加
						グラフィティは追加で置いたら前のは消えるようにした
						結婚状態と赤エモ状態を追加
						グラフィティは状態異常開始時にスキルユニットを設置するようにした
						ベナムスプラッシャーは特に何も追加はなし
						自爆は詠唱パケットをここで送るようにした
					C skill_status_change_clear()
						opt3の処理を追加
					C skill_unit_timer_sub()
						ワープポータル発動前が時間切れになるときに見た目を変更して本鯖のように効果音が出るようにした
						ブラストマイン以外の罠は時間切れで罠に戻るようにした
				C skill.h
					状態異常にスキル名をいくつかつけたり、新規の状態異常を増やした
				C storage.c
					A storage_db_final()
					A guild_storage_db_final()
					C do_final_storage()
						終了時にメモリを開放するようにした
				C trade.c
					C trade_tradeadditem()
					C trade_tradecommit()
						itemdb_isdropable()で交換できないアイテムを判定するようにした
				C vending.c
					vending_purchasereq()
						金額計算をdoubleでするようにしてintで桁あふれしないようにした

--------------------
//1045 by TEILU

・スティール、スティールコイン、スナッチャーの失敗メッセージが
  レベルが１〜９の時に変だったので修正。
	(map/)
	skill.c

・精錬の可否を情報サイトを元にＤＢに設定。（頭装備はrusiさん作成分を使用）
	(db/)
	item_db.txt

・ファイアーウォールが制限数を超えたときにスキル使用失敗が
  出るタイミングを変更。
	(map/)
	skill.c

・アブラカタブラ専用スキルをgm_all_skill設定時に表示できるように変更。
  battle_athena.confのgm_all_skill_add_abraにyesを設定すれば
  スキルリストに表示されるようになります。
	(conf/)
	battle_athena.conf
	(db/)
	skill_require_db.txt
	(map/)
	battle.c
	battle.h
	pc.c

--------------------
//1044 by TEILU

・1042で@itemidentifyの権限の設定を忘れていたので追加。
	(conf/)
	atcommand_athena.conf

・スティール、スティールコイン、スナッチャーの失敗時に
  失敗メッセージを表示するように変更。
	(map/)
	skill.c

・アイテムＤＢに精錬可否フラグのカラムを追加
  精錬の可否をＤＢを参照するように修正
	※とりあえず中段、下段、中下段の頭装備とアクセサリ以外の
	  装備品はすべて精錬可の設定でＤＢを作りました。
	  ＤＢは修正が必要になります。
	(db/)
	item_db.txt
	(map/)
	itemdb.c
	itemdb.h
	script.c

--------------------
//1043 by dusk
・docフォルダ・confフォルダ内のhelp.txtに1042(TEILUさん)の説明追加
	@itemidentifyの説明は７２行目の@itemresetの下に。

・Valkyrie Realms 5 (右上)の旗の修正
	Valkyrie Realms 5 (右上)の旗を見ると未取得状態コメントばっかり出ていたのを
	ちゃんと確認できるように。
	※ Valkyrie Realmsの各砦に戻る旗とは違います。
	prtg_cas05.txt内のギルドダンジョンに入るレバー以外の
	getcastledata "prtg_cas05.gat",1,@GIDp5;を
	set @GIDp5,getcastledata("prtg_cas05.gat",1);に修正。

--------------------
//1042 by TEILU

・@healコマンドに何も渡さないと完全回復するように変更。
	(map/)
	atcommand.c

・@itemitemidentifyコマンドの追加
  未鑑定の所持アイテムを全て鑑定します。
	(conf/)
	msg_athena.conf
	(map/)
	atcommand.c
	atcommand.h

--------------------
//1041 by mare
	FIX NPC Script Command - buildin_getgdskilllv()
        Add NPC Sctipt Command - buildin_agitcheck()
	(script/npc/job/)
	npc_job_wizard.txt
		ラウレルさんの台詞、ノビとプリの場合の分追加
-------------------
//1040 by 胡蝶蘭

・サーバー間接続のパケット表追加
	(doc/)
	serverlink_packet.txt
		inter<->map 以外のサーバー間接続のパケット表

・仕様スレの Login_ID2 関係でごにょごにょ
・サーバー間接続のパケット一部変更
	(login/)
	login.c
		auth_fifo に ip メンバ追加
		パケット変更に伴う変更他
	(char/)
	char.c
		auth_fifo に login_id2, ip メンバ追加
		パケット変更に伴う変更他
	(map/)
	chrif.c
		chrif_authok()追加
		パケット変更に伴う変更他

・自動再起動スクリプト start にコメントで簡単な説明追加
	start
		コメント追加

--------------------
//1039 by Ni+S
	・ギルド関係のスクリプト
	所有者の居ないアジトから、ギルドに所属してないキャラなら
	ギルドダンジョンに入れてしまうという不具合がありました

	これは、所有者の居ないアジトの値が0であり、
	getcharid(2)でギルドIDを返すのですが、
	ギルドに所属していないキャラはgetcharid(2)で0を返す為、
	値が一致してしまい起こっていた現象でした
	未所属キャラが入れないように修正しました

	・ファーマシー/ポーション作成DB
		レッドスリムポーション
		イエロースリムポーション
		ホワイトスリムポーション
	の材料を、空のポーション瓶から試験管に修正

--------------------
//1038 by Plala
・転職NPC関連の重大なバグ修正
	(script/npc/job)
	npc_job_aco.txt 修正
	npc_job_merchant.txt 修正
	npc_job_thief.txt 修正

	・上記NPCで途中までクエストを進めて他の職に転職すると、
	再び転職可能だった点を修正しました


--------------------
//1037 by 胡蝶蘭

** FOR ENGLISH DEVELOPERS **
DO NOT UPLOAD IF YOU DON'T USE JAPANESE ENCODE (SHIFT-JIS) !
WHY WE(JAPANESE) REPAIR ERROR CHARACTER AFTER EVERY YOUR UPLOADING ?
BREAKING IS EASY, REPAIRING IS VERY DIFFICULT !

** 英語圏の開発者の方へ(日本語訳) **
日本語エンコード(シフトJIS)を使う気が無いならアップロードしないてください！
なぜ我々（日本人）があなた方のアップロードのたびに文字化けを直さなければならないんですか？
壊すのは簡単ですが、直すのはとても難しいんです！

・文字化けを根性で修正
	(map/)
	script.c

・ladminがPOSIX必須に。Digest::MD5が無くても実行できるように修正
・serverstatus.cgiで、Net::Pingが無くても実行できるように修正
	(bin/tool/)
	ladmin
	(bin/tool/cgi/)
	serverstatus.cgi

・script_refで抜けてるものでわかるものを修正
	何故かscript_refから抜けてるもの(getargなど)の一部を再び追加
	** アップロードするときは最新パッチからの差分をアップロードしましょう **
	(doc/)
	script_ref.txt

・account_making.txt修正
	ladminスクリプトのパス
	(doc/)
	accoun_tmaking.txt

--------------------
//1036 by Michael
・追加 Script Command:
  getequipid(EquipPos);		EquipPos: 1-10
  gettimetick(Type);		Type: 0 SystemTick, 1 TimeSecondTick(0-86399)
  gettime(Type);		Type: 1 Sec, 2 Min, 3 Hour, 4 Weekday, 5, Monthday, 6 Month, 7 Year
  gettimestr("TimeFMT", Len);	TimeFMT: Time format strinf / Len: String Length

	(map/)
	script.c
		buildin_getequipid(); 追加
		buildin_gettimetick(); 追加
		buildin_gettime(); 追加
		buildin_gettimestr(); 追加

--------------------
//1035 by Michael
・追加 GVG Script NPC edit from Aegis NPC(Chinese-big5 version), Please someone translate to Japanese.
・修正 NPC Script Command - buildin_getgdskilllv()
  getgdskilllv(Guild_ID, Skill_ID);

	(map/)
	script.c
		buildin_getgdskilllv() 修正

--------------------
//1034 by (Pepermint)
	FIX NPC Script Command - buildin_getgdskilllv()
        Add NPC Sctipt Command - buildin_agitcheck()
	(map/)
	script.c
		buildin_getgdskilllv() 修正
		buildin_agitcheck() 追加

--------------------
//1033 by Michael
・追加 NPC Script Command - buildin_getgdskilllv()
  getgdskilllv(Guild_ID, Skill_ID);
  skill_id = 1:GD_APPROVAL,2:GD_KAFRACONTACT,3:GD_GUARDIANRESEARCH,4:GD_CHARISMA,5:GD_EXTENSION

	(map/)
	script.c
		buildin_getgdskilllv() 追加

--------------------
//1032 by (凸)
・1031で何故か削除されていたbuildin_getitemname()を復活
・バグスレなどに出た修正を反映
・その他細かい修正

	(map/)
	clif.c
		clif_disp_onlyself() NULLチェック追加
	map.c
		map_nick2sd() nickがNULLだとすぐNULLを返すように変更
	mob.c
		mob_setdelayspawn() NULLチェック変更
		mob_delete() 修正
	npc.c
		npc_parse_warp() 修正
	script.c
		buildin_getitemname() 復活

--------------------
//1031 by huge
・NPCのscriptに、makepetを追加。
    makepet 卵ID; で、ペットを作成します。
・NPCのscriptに、getexpを追加。
    getexp Base,Job; で、それぞれの経験値を増やします。
・ペットの卵をNPCのdelitemで消したりshopで売った時、ペットセーブデータから削除するよう修正。
・ディボーション成功条件修正。(未確認)
・経験値表示を可能にしてみました。confにて設定してください。

	(conf/)
	battle_athena.conf 修正
	(doc/)
	conf_ref.txt 修正
	script_ref.txt 修正
	(map/)
	battle.c
	battle.h
		disp_experience 追加
	clif.c
	clif.h
		clif_disp_onlyself() 追加
	pc.c
		pc_gainexp() 修正
	script.c
		buildin_delitem() 修正
		buildin_makepet() 追加
		buildin_getexp() 追加
	npc.c
		#include 修正
		npc_selllist() 修正
	skill.c
		skill_castend_nodamage_id() 修正


--------------------
//1030 by (凸)
・map_athena.confに新婚島ザワイをコメントアウトして追加
・クローンスキルで覚えたスキルを自動セーブごとに忘れていたのでとりあえずログオフ時にのみ忘れるように変更したつもり
・mobskill_castend_posの無害nullpoチェックを変更
・Emotionの設定がないMobがスキルを使用するときに/!を出していたのを修正
・バグスレに投げたtrade.cを添付。とりあえず相手が所持できる種類の限界を超えた場合は渡さずに元に戻すように変更

	(conf/)
	map_athena.conf ザワイ追加
	(doc/)
	client_packet.txt パケット長の更新
	(map/)
	map.c
		map_quit() 終了時にクローンスキルで覚えたスキルを忘れるように変更
	mob.c
		mobskill_castend_pos() nullpoチェック変更
		mob_readskilldb() 修正
	pc.c
		pc_makesavestatus() クローンスキルを忘れるのをmap_quitに任せた
	trade.c
		trade_tradecommit() 所持できる種類以上を取引した場合にアイテムが消えないように

--------------------
//1029 by (凸)
・20040619RagexeHC_jp.rgzの0x204と0x20bパケットに対応
・charとloginも知らないパケットが来たらパケットダンプを出力するようにclif.cからコピペ

	(doc/)
	client_packet.txt 新パケット追加
	(char/)
	char.c
		parse_char() 0x20b対応
	(login/)
	login.c
		parse_login() 0x204対応

--------------------
//1028 by (凸)
・ウンバラ以降、Mobがスキルを使用するときにエモーションを出すようになったので、mob_skill_dbを拡張
	サンプルでオークウォーリアーが喫煙すると「/…」を出すのとオークレディが速度を使うと「/ちゅ」を出します
・アイテム682,683を使用すると30秒間ATKやMATKが増えるらしいのでそれっぽく
・job_db2.txtに謎の行が2行あったのを削除
・範囲魔法などでスキルユニット相手にステータス変更をかけようとした場合にnullpoが出たのを修正

	(db/)
	const.txt SC_INCATK SC_INCMATK追加
	item_db.txt ↑を682,683に追加
	job_db2.txt 謎の2行を削除
	mob_skill_db.txt Emotion追加
	(map/)
	mob.c
		mobskill_use() スキル使用時にエモーションを出すように変更
		mob_readskilldb() Emotionを読み込むように変更
	mob.h 変更
	pc.c
		pc_calcstatus() 変更
	skill.c

		skill_status_change_end() 変更
		skill_status_change_start() 変更とNULLチェック修正
	skill.h 変更

--------------------
//1027 by Ni+S
・getitemname関数追加
・スクリプトにgetitemname関数を追加
・itemidより、jnameを文字列で返します
・詳しくはscript_ref.txtで。

	script.c
		getitemname()追加

--------------------
//1026 by (凸)
・1023で入れてなかったclif.hを同梱
・バイオプラントとスフィアーマインで出したmobを倒すとmob_timer_delete()でnullpoが出る問題を解決したつもり
・バグ報告スレッド part6 >>63 Destさんのscript.c修正を取り込み

	(map/)
	clif.h 変更
	map.h 変更
	mob.c
		mob_changestate() 変更
	skill.c
		skill_castend_pos2() 変更
		mob_spawn() 変更
		do_init_mob() add_timer_func_listにmob_timer_deleteが無かったので追加してみた
	script.c
		script_load_mapreg() 変更

------------------------
//1025 by Sel
・ロードナイトのジョブ補正が間違っていたのを修正
・オーラブレード効果時間を修正
・オーラブレード武器制限を素手以外全てに修正
・コンセントレーション武器制限を両手槍のみから片手槍+両手槍へ修正
・トゥルーサイト効果時間を修正

	(db/)
	job_db2-2.txt 変更
	skill_cast_db.txt 変更
	skill_require_db.txt 変更
--------------------
//1024 by mare
・ファーマシー材料の変更、製造可能薬品の追加
	6/8日本鯖にきたものと同じにしました

	(db/)
	produce_db.txt 変更

--------------------
//1023 by (凸)
・1022でエンバグしたnpc_parse_script()を戻し
・スパイラルピアースの重量追加ダメージ計算式をちょっと変更
・魔法力増幅の計算式をちょっと変更
・テンションリラックスが座って使うのではなく使うと座るという情報を見かけたので変更
・↑に伴いskill_requireのsitting条件廃止
・バーサークをGvGで使用できないように変更

	(db/)
	skill_cast_db.txt 変更
	skill_require_db.txt 変更
	(doc/)
	db_ref.txt 修正
	(map/)
	battle.c
		battle_calc_pc_weapon_attack() 変更
	clif.c
		clif_sitting() 追加
		clif_parse_ActionRequest() 変更
	npc.c
		npc_parse_script() 修正
	pc.h 変更
	pc.c
		pc_calcstatus() 変更
		pc_natural_heal_hp() 変更
		pc_setstand() 追加
	skill.c
		skill_castend_nodamage_id() テンションリラックスを使うと座るように
		skill_check_condition() ST_SITTING廃止
		skill_use_id() バーサークをGvGで使用できないように
		skill_status_change_timer() テンションリラックスは10秒ごとにSPを12消費
		skill_status_change_start() テンションリラックス変更
		skill_readdb() sitting廃止
	skill.h 変更

--------------------
//1022 by (凸)
・NULLチェック変更
・login,char,map終了時に開放されていなかったメモリを微妙に開放する努力をしてみた
・スパノビ爆裂波動実装、クリティカル+50
・スパノビボーナスを変更、最初から一度も死んでないJobLv70にAll+15、BaseLv99にMHP+2000

	(doc/)
	client_packet.txt S 01ed追加
	(char/)
	do_final() 変更
	do_init() 変更
	(login/)
	do_final() 追加
	do_init() 変更
	(map/)
	atcommand.c Destさんの変更を取り込み
	battle.c 同上
	chat.c NULLチェック変更
	chrif.c NULLチェック変更
	clif.c NULLチェック変更
		clif_parse() 変更
		clif_parse_sn_explosionspirits() 追加
		clif_parse_sn_doridori() 名前変更
	guild.c NULLチェック変更
	intif.c NULLチェック変更
	itemdb.c NULLチェック変更
	map.c NULLチェック変更
		do_final() 変更
	mob.c NULLチェック変更
	npc.c NULLチェック変更
		npc_parse_script() buf開放忘れ？を開放
	party.c NULLチェック変更
	path.c NULLチェック変更
	pc.c NULLチェック変更
		pc_calcstatus() スパノビ変更
	pet.c NULLチェック変更
	storage.c NULLチェック変更
	trade.c NULLチェック変更
	vending.c NULLチェック変更

--------------------
//1021 by Kalen
・プロンテラ冠婚品NPCにてタキシード販売
・Umbalaのワープ見直し
	D2Fのワープを本鯖使用に変更。重複ポイント修正
・UmbalaNPC修正
	ラベルを使用しなくいい場所は極力削除(-)
	セーブポイント修正
	バンジージャンプ台追加
	骸骨門追加
	分解、合成処理追加
	カプラ、案内要員をあるべき場所へ移動。
	 ※一部Emoについて、癌呆自身が逆に取り違えているみたいなので独自で変えました。
	 見てもらえば分かりますが18と28を逆にするとNPCの会話内容に合うEmoが出たので
	クエストフラグの条件追加
	　これによりすでに終えている場合でも途中になる可能性があります。
・スパノビ転職NPC追加
	凸さんのログを基に作成しました。
・アルケミストギルドのノビの場合の対応修正(凸さんからのログより)
・結婚NPC追加
	ただし、まだテスト段階です。問題点があるため結婚不可能です。
	(/script)
	 (/warp)
	  npc_warp_umbala.txt
	 (/npc)
	  (/town)
	   npc_town_umbala.txt
	   npc_town_kafra.txt
	   npc_town_guide.txt
	   npc_town_prontera.txt
	  (/quest)
	   npc_event_marriage.txt(新・テスト)
	  (/job)
	   npc_job_alchemist.txt
	   npc_job_supernovice.txt(新)

--------------------
//1020 by (凸)
・nullpoの変更に対応してmap_athena.confの設定削除＆skill.c書き換え
・座っているとHPRとSPRが通常の半分で発動したのを修正
・スパノビが一定条件(クライアント依存)で/doridoriするとSPR回復量が倍になるように変更
・結婚式用のエフェクトをスクリプトからwedding命令で発生させることが出来るようした
・合奏を開始したPCは合奏中に終了できないようにしたつもり(未確認)

	(conf/)
	map_athena.conf nullpo_check削除
	(doc/)
	client_packet.txt 更新
	conf_ref.txt nullpo_check削除
	(map/)
	map.c
		map_config_read() nullpo_check削除
	map.h 同上
	skill.c NULLチェック再度総入れ替え
	clif.c
		clif_wedding_effect() 追加
		clif_parse_QuitGame() 合奏開始者は合奏中に終了できないように変更
		clif_parse_doridori() 追加
		clif_parse() doridori追加
	clif.h 変更
	pc.c
		pc_authok() doridori初期化追加
		pc_natural_heal_hp() 座っているときのHPR時間修正
		pc_natural_heal_sp() 座っているときのHPR時間修正、doridori追加
	script.c
		buildin_wedding_effect() 追加


--------------------
//1019 by Dest
・nullpoモジュールにコーディングミス発見/修正
・同、voidな関数から呼ばれた時のnullpo_retv_f()を追加
・同、条件コンパイルに対応

	(common/)
	nullpo.c
		nullpo_info_core() コーディングミス修正
	nullpo.h
		NULLPO_CHECKフラグによる条件コンパイル追加
		nullpo_retv_f() 追加

--------------------
//1018 by chloe
・ウンバラモンスターを追加

	(script/mob/)
		npc_monster.txt 変更
			各ウンバラマップにMob配置
	(db/)
		mob_db.txt 変更
			1495,STONE_SHOOTER,フレイムシューター 修正
			1511,AMON_RA,アモンラー 修正

--------------------
//1017 by (凸)
・バグ報告スレッド part6 >>46 Destさんのnullpoモジュールを追加＆voidな関数から呼ばれた時のnullpo_retv()を追加(とりあえずskill.cのNULLチェックだけ入れ替え)
・同>>39 Selさんから報告があったコンセントレーションを修正
・仕様について語り合うスレッド >>33 Kalenさんの情報をclient_packet.txtに反映
・本鯖相違スレッド part3 >>24 M ＠zqcM6jBwさんの情報を↑
・同>>30 はちさんの修正を反映

	(conf/)
	map_athena.conf nullpo_check追加
	(db/)
	item_db.txt 結婚指輪を武器-アクセサリに変更＆最新版
	(doc/)
	client_packet.txt 更新
	conf_ref.txt nullpo_check追加
	(common/)
	Makefile 変更
	nullpo.c 追加
	nullpo.h 追加
	(map/)
	Makefile 変更
	map.c
		map_config_read() nullpo_check追加
	map.h 同上
	skill.c NULLチェック総入れ替え
		skill_status_change_start() コンセントレーション修正
		skill_castend_nodamage_id() テレポート修正
	clif.c
		clif_skill_setunit() コメント修正
	pc.c
		pc_calcstatus() コンセントレーション修正

--------------------
//1016 by な。
・Athena雑談スレッドPart4 42 かる氏作のウンバラNPCを追加

	(script/npc/town/)
		npc_town_umbala.txt追加
			イベントデバッグ様(230〜256行目)はコメントアウト
	(conf/)
		map_athena.conf town に npc: script/npc/town/npc_town_umbala.txt 追加

--------------------
//1015 by (凸)
・リムーブトラップを本鯖仕様とAthena仕様で選べるようにした
・スパノビにAll+10する条件が良く分からなかったけど最初から+10じゃないのは確かなのでとりあえずBase99で一度も死んでなければという条件に変更
・ダンス中に吹き飛ばされてもエフェクトは移動しないそうなので変更
・@go 13微調整


	(conf/)
	battle_athena.conf skill_removetrap_type追加
	(doc/)
	client_packet.txt 本鯖相違スレッド part3 23 M ＠zqcM6jBwさんの情報を追加
	conf_ref.txt skill_removetrap_type追加
	(map/)
	atcommand.c
		atcommand_go() ウンバラの出現位置微調整
	battle.c
		battle_config_read() skill_removetrap_type追加
	battle.h 同上
	pc.c
		pc_calcstatus() スパノビAll+10条件変更
	skill.c
		skill_blown() ダンス中の吹き飛ばしを元に戻した
		skill_castend_nodamage_id() リムーブトラップ仕様変更

 --------------------
//1014 by (Pepermint)
I fixed again the problem if you put minus sign(-) in front of digits,
the error comes up when you puchase a item.
When you put a minus sign(-), the error sign will be changed shrotage of
amount as original server dose.

I tested with it in ver. 1013, it was working

--------------------
//1013 by (凸)
・サーバースナップショット

--------------------
//1012 by (凸)
・help.txtにある@goの説明から13と14を削除
　機能は消えてないので使えることは使えますが、helpに載せるのはjROに来てからということで
・cast_db.txtをskill_cast_db.txtに改名
・ついでにmake cleanでGNUmakefileも消してみることにする
・u-0さんの検証などを総合してダンスユニット関連を変更
　演奏・ダンス中のハエはユニット付きで飛ぶそうです
　演奏・ダンス中にワープポイントに乗ったら状態が解除されるようです
　合奏中に片方がハエ飛びしたらエフェクトは元の場所に残り、飛んだ先では合奏状態が継続して動けない＆時間ごとにSP消費するようです
・PC_DIE_COUNTERがスクリプトから変更された時にすぐに反映されるように変更

	(conf/)
	help.txt @go説明変更
	(db/)
	skill_cast_db.txt 改名
	(map/)
	pc.c
		pc_setpos() ダンス中断のタイミング変更
		pc_setglobalreg() PC_DIE_COUNTER特別処理追加
	skill.c
		skill_castend_id() NULLチェック変更
		skill_stop_dancing() マップ移動などでの挙動を変更
		skill_readdb() skill_cast_dbに改名
		skill_blown() 飛ばされたらダンス移動
	npc.c
		npc_touch_areanpc() ワープポイントに乗ったらダンス解除

--------------------
//1011 by パイン
・パーティ要請やギルド要請を出しているときに他の要請を拒否る処理を追加
　battle_athena.confで切り替えが出来るようになっています。
・make clean で事が足りるので、objectdel.batを消去

	(map)
	clif.c
		clif_party_invite()変更(nullpoの文言違ってました)
	guild.c
		guild_invite()変更
	party.c
		party_invite()変更
	battle.c
		battle_config_read()変更
	battle.h変更
	trade.c
		trade_traderequest()変更

--------------------
//1010 by (凸)
・gcc 2.95対策
・スパノビの1度死ぬまでAll+10をスクリプト変数で実装してみる試み
	PC_DIE_COUNTER 死ぬと+1、転職すると0になります
	↑はキャラクタ永続なスクリプト変数なのでNPCで参照＆再設定とか比較的楽かも

	(map/)
	chrif.c
		chrif_divorce() gcc2.95対策
	skill.c
		skill_attack() gcc2.95対策
		skill_unit_move_unit_group() gcc2.95対策
	map.h map_session_dataにdie_counterを追加
	npc.c
		npc_click() nullpoメッセージを修正
	pc.c
		pc_setrestartvalue() nullpoメッセージを修正
		pc_authok() die_counter初期化の追加
		pc_calcstatus() die_counter=0のスパノビはAll+10
		pc_damage() PC_DIE_COUNTER設定
		pc_jobchange() PC_DIE_COUNTER設定
		pc_readparam() gcc2.95対策
		pc_divorce() gcc2.95対策
		pc_get_partner() gcc2.95対策

--------------------
//1009 by ぴざまん
・ダンス移動軽量化実装
　battle_athena.confで切り替え可能です。詳しくはconf_refを
　オリジナルアップデートの為、デフォルトではoffにしています
　また、この軽量化モードは回線負荷を大幅に削減できる(つもり)ですが、
　その分サーバー側の処理が重たくなります(といってもある程度のCPUがあれば全然問題にならない程度の負荷ですが)
・結婚システム／結婚スキル実装
　結婚指輪の特別扱いが未実装です(落とせたり取引に出せたりします)
　離婚のみ未テストです。
・結婚用スクリプト(marriage、divorce)追加。
　・marriage <partner_name>
　　<partner_name>: 結婚相手の名前
　　戻り値: 成功:1　失敗:0
　　結婚処理を行います。対象は話し掛けたプレイヤーと<partner_name>のキャラクターで、どちらかが既婚の場合は失敗します。
　　1回のmarriageスクリプトで新郎→新婦と新婦→新郎の結婚処理を同時に行います。
　　また、このスクリプトで結婚指輪は与えられません。
　・devorce
　　引数無し
　　戻り値: 成功:1　失敗:0
　　離婚処理を行います。対象は話し掛けたプレイヤーで、未婚の場合は失敗します。
　　marriageスクリプトと同様に互いの離婚処理を同時に行います。
　　また、このスクリプトが成功すると自動的に対象キャラクターの結婚指輪は剥奪されます。

　どちらのスクリプトの処理も、2人共ログインしていないと成功しません。

	(map/)
	pc.c
		pc_ismarried()、pc_marriage()、pc_divorce()、pc_authok()変更
		pc_get_partner() 追加
	map.c
		map_quit() 変更
	skill.c
		skill_use_id()、skill_castend_nodamage_id() 変更
		skill_unitsetting()、skill_unit_onlimit() 変更
	script.c
		buildin_marriage()、buildin_devorce() 追加
	pc.h 変更
	battle.h 変更

--------------------
//1008 by ぴざまん
・GMセッション隠し実装(未テスト)
　GMアカウントのキャラクターを@who等で表示するかどうか設定できます。
　詳しくはconf_ref.txtを参照してください。
・結婚システム仮実装
　char-map間通信のみ実装です。まだ結婚することは出来ません。
　尚、このパッチからathena.txtのバージョンが変わります。
　データの互換性は保ったつもりですが、念の為バックアップを取っておく事を強く推奨します。

	(map/)
	clif.c
		clif_countusers() 変更
	battle.c
		battle_config_read() 変更
	atcommand.c
		atcommand_who() 変更
	pc.c
		pc_ismarried()、pc_marriage()、pc_divorce() 追加
	chrif.c
		chrif_divorce() 追加
		chrif_parse() 変更
	(char/)
	char.c
		char_divorce() 追加
		char_delete()、mmo_char_fromstr()、mmo_char_tostr() 変更

--------------------
//1007 by (凸)
・NULLチェックの見直し

	(map/)
	clif.c
		clif_send() 変更
	skill.c
		skill_delunit() 変更

--------------------
//1006 by (ruhu)
・@goに洛陽とニフルヘイム追加

	(conf/)
	help.txt ニフルヘイム、洛陽追加
	(map/)
	atcommand.c 
		atcommand go() ニフルヘイム、洛陽追加
--------------------
//1005 by (凸)
・NULLチェックの見直しと追加、大量に変更したので問題が出る可能性が大です
・ウンバラ分割パッチが配布されたので@go 12にウンバラを追加
・ロードナイト バーサークをちょっとそれっぽく(ASPD増加などは未実装)
・クラウン・ジプシー 月明りの泉に落ちる花びらの使用条件を合奏と同じに変更(効果等は未実装)
・ブレッシングが本鯖ではステータスアップ→エフェクトだったのでそのように変更
・本鯖相違スレッド part2 >>145 zzzさんの報告を反映
・同スレ >>143 plalaさんの報告を反映

	(db/)
	skill_require_db.txt 変更
	(conf/)
	help.txt ウンバラ追加
	map_athena.conf ウンバラ関連のコメントアウトを解除
	(map/)
	atcommand.c NULLチェック強化
		atcommand() @mapmoveなどで落ちる問題を修正
		atcommand_go() ウンバラ追加
	battle.c NULLチェック強化
		battle_calc_mob_weapon_attack() バーサーク時ダメージ150%
		battle_calc_pc_weapon_attack() バーサーク時ダメージ150%
	chat.c NULLチェック強化
	chrif.c NULLチェック強化
	clif.c NULLチェック強化
		clif_parse_ActionRequest() ダンス時の処理を若干変更
		clif_parse_GlobalMessage() バーサーク時は会話が出来ないように変更
		clif_parse_Wis() バーサーク時は会話が出来ないように変更
		clif_parse_PartyMessage() 同上
		clif_parse_GuildMessage() 同上
		clif_parse_TakeItem() バーサーク時はアイテムを取れないように変更
		clif_parse_DropItem() バーサーク時はアイテムを落とせないように変更
		clif_parse_UseItem() バーサーク時はアイテムを使えないように変更
		clif_parse_EquipItem() バーサーク時は装備できないように変更
		clif_parse_UnequipItem() バーサーク時は装備解除できないように変更
		clif_parse_UseSkillToId() バーサーク時はスキル使用ができないように変更
		clif_parse_UseSkillToPos() 同上
		clif_parse_UseSkillMap() 同上
	guild.c NULLチェック強化
	intif.c NULLチェック強化
	itemdb.c NULLチェック強化
	map.c NULLチェック強化
		map_quit() バーサーク時にログアウトするとHP 100/SP 0になるように変更
	mob.c
		mob_attack() clif_fixmobpos()を送信しないように変更
		mob_timer() NULLチェック条件を変更
		mobskill_castend_id() 同上、バーサーク時スキルを使えないように変更
		mobskill_castend_pos() バーサーク時スキルを使えないように変更
		mobskill_use_id() 同上
		mobskill_use_pos() 同上
	npc.c NULLチェック強化
	party.c NULLチェック強化
	path.c NULLチェック強化
	pc.c NULLチェック強化
		pc_calcstatus() バーサーク時は速度UP＆MHP3倍、メディテイティオのSP回復増加をSPRではなく通常回復にかかるようにした
		pc_heal() バーサーク時は回復しない
		pc_jobchange() 転職直後1歩動かないと服の色が反映されなかったのを修正
		pc_natural_heal_sub() バーサーク中はSPが自然回復しないように変更(HPは良く分からなかったので回復するようにしてある)
	pet.c NULLチェック強化
	skill.c
		skill_castend_nodamage_id() ブレッシング等のパケット順を変更、ストーンカースを不死には無効にした
		skill_castend_map() しつこいくらいにバーサーク時にスキルを使えないように変更
		skill_check_condition() 同上
		skill_use_pos() 同上
		skill_use_id() 同上＆月明りの泉に落ちる花びら追加
		skill_status_change_end() バーサーク時にはIAアイコンを消去するように変更
		skill_status_change_timer() NULLチェック条件を変更、月明りの泉に落ちる花びら時SP消費、バーサーク時HP100以上なら10秒あたり1%減らすように変更
		skill_status_change_start() バーサーク時にはIAアイコンを表示するように変更
		skill_delunit() NULLチェック条件を変更
		skill_check_condition_char_sub() 月明りの泉に落ちる花びら追加
		skill_check_condition_use_sub() 同上
		skill_is_danceskill() 同上
		skill_initunitgroup() 同上
	trade.c NULLチェック強化
	vending.c NULLチェック強化

--------------------
//1004 by (凸)
・NULLチェックでエンバグしていたところをいくつか修正と他のNULLチェック強化
・skill.cでもnullpoを表示するように変更

	(map/)
	battle.c
		battle_damage() NULLチェック強化
		battle_heal() 同上
	clif.c
		clif_damage() 同上
	map.c
		map_addflooritem() NULLチェック強化
	mob.c
		mob_once_spawn() 余計なNULLチェックを削除
		mob_once_spawn_area() 同上
		mob_damage() 同上
		mob_counttargeted() 同上
		mobskill_castend_id() 同上
		mob_summonslave() メッセージ間違いを修正
	pc.c
		pc_damage() NULLチェック強化
	skill.c ほぼ全部 NULL関連修正

--------------------
//1003 by (凸)
・jROクライアントで/account使用時に繋がらない原因の0x200パケット問題を修正
・0x1c9パケットの穴埋めを引き続き継続中
・一人で聖体や合奏を使用できる設定(player_skill_partner_check)を追加
	一人で合奏を実行した場合には通常のダンスと挙動が同じになります
・プロボックは不死に対して発動しないように変更
・FWの吹き飛ばし判定を変更
・デリュージに水場判定を追加、聖水を作れるのを確認
・ハイディングの有効時間が正しく機能するように修正
・アスペルシオを不死に使用した場合、聖属性の40ダメージを与えるように変更
・アスペルシオを不死以外のMOBに使用しても効果が無いように変更
・合奏、ダンス、演奏中の経過時間によるSP消費を実装
・報告のあったガーディアンがギルド未加入PCをターゲットしたらmapが落ちる問題の修正(ガーディアン実装当時からずっと落ちてた？)
・mob.c、storage.cのnullチェックを強化
	エラーで落ちるべきところを無理やり通常処理に戻しているので他で問題がでるかもしれません
	その場合、コンソールに「関数名 nullpo」と表示されるので表示された場合は報告をお願いします
	もしかしたら正常な処理でも表示されるかもしれませんが、その際も報告をお願いします
	本来エラー、実は正常、どちらにしてもこれが表示されるのはバグです

	(conf/)
	battle_athena.conf player_skill_partner_check追加
	(db/)
	skill_db.txt アスペルシオの属性を聖に変更
	(doc/)
	conf_ref.txt player_skill_partner_check説明追加
	(login/)
	login.c
		parse_login() 0x200パケット対応
	(map/)
	mob.c NULLチェックでほぼ全部
	storage.c NULLチェックでほぼ全部
	battle.h 変更
	battle.c
		battle_calc_magic_attack() アスペルシオを追加、FWを変更
		battle_config_read() 設定追加
	clif.c
		clif_getareachar_skillunit() 調査結果の反映
		clif_skill_setunit() 同上
	[1001と1002の間の変更点]
	skill.c NULLチェックを沢山
		skill_castend_damage_id() アスペルシオ追加
		skill_castend_nodamage_id() アスペルシオ、プロボック処理変更
		skill_castend_id() アスペルシオ処理変更
		skill_check_condition_char_sub() player_skill_partner_checkに対応
		skill_check_condition_use_sub() 同上
		skill_use_id() 同上
		skill_check_condition() 同上＆デリュージ対応
		skill_status_change_timer() ハイディング修正、ダンス演奏合奏中のSP消費実装
		skill_initunitgroup() ダンスSP消費用変更
		skill_status_change_start() 同上＆プロボックをボスに効かないように(でもbattle.cで止めてるから通常ここまで来ない)

--------------------
//1002 by ぴざまん
・ポータルバグ修正
・スキル関係のNullチェック強化(by(凸))
	(map/)
	skill.c
		skill_castend_map() 修正

--------------------
//1001 by (凸)
・0x1c9でいくつかパケットを見比べて変化のないところを固定値で埋め込み(今後情報が集まると変わる可能性大)
・ダンス中はSPだけ回復しないように変更
・聖体で相方のSPが10以下だと使用失敗にして使用したらSPを10減らしてみる(未確認)
・合奏のスキル使用パケットを若干変更

	(map/)
	clif.c
		clif_getareachar_skillunit() 0x1c9の穴埋め開始
		clif_skill_setunit() 0x1c9の穴埋め開始
	pc.c
		pc_natural_heal_sub() ダンス中はSPのみ回復しないように変更
	skill.c
		skill_check_condition() 変更
		skill_check_condition_char_sub() 聖体は相方のSPチェックするように変更
		skill_check_condition_use_sub() 聖体は相方のSPを減らすように変更

--------------------
//1000 by ぴざまん
・0999の変更取り戻し
・トラップの巻き込み実装
・イドゥンの林檎でNPCまで回復した(ように見える)問題修正(未テスト)
・デモンストレーションのエフェクト変更(こちらに明記)
	(map/)
	skill.c
		skill_count_target() 追加
		skill_unit_onplace()、skill_trap_splash() 変更
--------------------
//0999 by eAthena Dev Team (Yor's Fixes)
(login/)
	added email for accounts
(char/)
	added email for character deletion
--------------------
//0998 by (凸)
・battle.cで引数の存在を確認せずに値を見に行ってる関数をいくつか修正
・ダンス中は座れないようにした(本鯖相違スレッド part2 >>114 DoTさん)
・ダンス中はHP、SPが回復しないように変更(同上)
・ダンス中は通常攻撃できないようにした(本鯖相違スレッド part2 >>116 ・・・さん)
・合奏中片方が落ちた場合、残ったほうで演奏を継続するようにした(同上)
・合奏中はアドリブ以外できないように変更(同上)
・合奏発動条件にダンス中じゃない＆座っていないを追加(本鯖相違スレッド part2 >>118 ろろさん)
・阿修羅使用後にHPも回復しなかったのを修正

	(map/)
	battle.c
		battle_counttargeted() 修正
		battle_get系 たぶん全部修正
	clif.c
		clif_parse_WalkToXY() 合奏の判断方法の変更
		clif_parse_ActionRequest() ダンス中は殴らない座らないように変更
	map.c
		map_quit() ダンス中断追加
	mob.c
		mob_damage() skill_stop_dancingの引数増加による変更
	pc.c
		pc_setpos() 同上
		pc_damage() 同上
		pc_equipitem() 同上
		pc_natural_heal_sub() ダンス中は自然回復しないように＆阿修羅時はSPのみ回復しないように
	skill.c
		skill_castend_nodamage_id() skill_stop_dancingの引数増加による変更
		skill_status_change_start() 同上
		skill_check_condition_char_sub() 相手がダンス中や座っていても合奏できないように変更
		skill_check_condition_use_sub() 同上
		skill_use_id() 合奏の判断方法の変更＆合奏中はアドリブ以外禁止に
		skill_status_change_end() 合奏のダンス状態解除は相手のval4を0にするようにした
		skill_is_danceskill() 戻り値変更
		skill_stop_dancing() 引数増加、合奏で片方だけ落ちたときの処理追加
		skill_delunitgroup() 合奏時のステータス変更処理を↑に移した
		skill_clear_unitgroup() 自分のbl->idとユニットグループのgroup->src_idが違うときは削除しないように変更
	skill.h 変更

--------------------
//0997 by (凸)
・二人で合奏、三人で聖体を実装
	合奏 バード・ダンサーが隣接したセルにいて同じスキルを持っている時に発動
		スキルレベルは両者のスキルレベルの中間
		本鯖仕様が分からないけど斜め隣接もOK
	聖体 使用者のX軸で-1と+1の場所に一人ずつアコライトかプリーストがいる時に発動すると思う(未テスト)
		使用者 ○ アコプリ ●
		OK ●○●

		NG ●
		   ○●
・トーキーボックスを使って設置時に座っていた時はスキル使用失敗にしてみた

	(db/)
	item_db.txt 村正の呪い率を5%に(by e2さん)
	(map/)
	skill.c
		skill_check_condition_char_sub() 追加
		skill_check_condition_use_sub() 追加
		skill_check_condition() 変更
		skill_use_id() 変更
		skill_initunitgroup() 変更
		skill_delunitgroup() 変更
	clif.c
		clif_parse_UseSkillToPos() 変更

--------------------
//0996 by (凸)
・アドリブの5秒制限をcast_db.txtのupkeep_time2で制御できるように変更
・村正で自分を呪わせるためにbonus2 bAddEff2を追加
・呪われていて終了できない時にも「今は終了できません」が表示されるようにした
・ダンスエフェクト等移動時に効果の適用判断が移動前に行われていたのを移動後に変更＆使わなくていい変数を廃止

	(db/)
	cast_db.txt
	const.txt
	item_db.txt
	(doc/)
	item_bonus.txt
	(src/)
	clif.c
		clif_parse_QuitGame() 変更
	map.h addeff2,arrow_addeff2 追加
	pc.c
		pc_calcstatus() 変更
		pc_bonus2() 変更
	skill.c
		skill_additional_effect() 変更
		skill_check_condition() 変更
		skill_unit_move_unit_group() 変更

--------------------
//0995 by (凸)
・battle.pet_lootitemのデフォルトがyesになっていたのを修正
・battle.pet_lootitemの適用をforeach前でやるように修正
・ペットの初期化でpd->lootitemがある時しか初期化されていなかったのを修正
・領域が移動して対象が領域から抜けても効果が解除されない問題を修正
・アドリブはダンス発動から5秒以上経たないと使用できないようにした

	(map/)
	pet.c
		pet_data_init() 修正
		pet_ai_sub_hard() 修正
		pet_ai_sub_hard_lootsearch() 修正
	skill.c
		skill_blown() 変更
		skill_unit_onlimit() エラーメッセージ修正
		skill_check_condition() 変更
		skill_initunitgroup() sd_data[SC_DANCING].val3にgettick()
		skill_unit_move_unit_group_sub() 追加
		skill_unit_move_unit_group() 変更
	skill.h skill_unit_move_unit_group() 引数変更
	battle.c
		battle_config_read() pet_lootitem=0に修正
	pc.c
		pc_walk() 変更

--------------------
//0994 by huge
・battle.pet_lootitemが適応されていなかったのを修正。
・ペットにパフォーマンスをさせた後、10秒間くらいは拾わせないように。

	(map/)
	map.h	pet_dataにlootitem_timer追加。
	pet.c
		pet_ai_sub_hard_lootsearch() 修正。
		pet_lootitem_drop() 修正。

--------------------
//0993 by (凸)
・一人で合奏だけど合奏スキル中は動けないように
・アンコール実装。直前に使ったダンススキルを半分のSPで使えます
・ダンス中に移動するとエフェクトも移動するようにした
・未実装のスキルが使われるとUnknown skillと表示されることがあるかもしれません
・Sageのキャストキャンセルで実は前のスキルを覚えていなかった問題の修正

	(map/)
	clif.c
		clif_parse_WalkToXY() 変更
	map.h アンコール用変数の追加
	pc.c
		pc_walk()
	skill.c
		skill_blown
		skill_castend_nodamage_id
		skill_unitsetting() 変更
		skill_unit_onplace() 罠で同じ処理をしているcaseをまとめた
		skill_unit_onout() 使われてないunit2を削除
		skill_check_condition() 変更
		skill_use_id
		skill_initunitgroup() 使ったダンススキルを変数に入れるようにした
		skill_unit_move_unit_group() 追加
	skill.h 変更

--------------------
//0992 by nokia

map_quitを修正してメモリを釈放する時何度もを釈放するためメモリの間違いが起こる問題を招く

	(map/)
	map.c
		map_quit()

--------------------
//0991 by (凸)
・トーキーボックスを自分が踏んでも発動しない本鯖仕様に変更
・スキル詠唱中とディレイ中はクライアントを終了できないようにしたけど、敵に攻撃されているときは終了できます(ごめんなさいっ！！)

	(map/)
	clif.c
		clif_parse_QuitGame() 変更
	skill.c
		skill_unitsetting() 変更

--------------------
//0990 by ぴざまん
・一部のトラップを範囲攻撃に変更（巻き込みは未実装）。
・mapflagにpvp_nocalcrankとpvp_nightmaredrop追加。
	・<gatname><tab>mapflag<tab>pvp_nocalcrank<tab>dummy
	　PvPによるランキング計算をしないようにします。
	・<gatname><tab>mapflag<tab>pvp_nightmaredrop<tab><item>,<type>,<per>
	　PvPにて死亡した場合、<per>の確率でアイテムをドロップします。
	　<item>: ドロップするアイテムIDを指定します。randomと記述すると所持品からランダムにドロップします。
	　<type>: ドロップするアイテムのタイプを指定します。inventory:所持品 equip:装備品 all:全部
	　<per>: ドロップする確率です。万分率で指定します。
	(map/)
	skill.c
		skill_unit_onplace() 変更
		skill_trap_splash() 追加
	pc.c
		pc_damage() 変更
	npc.c
		npc_parse_mapflag() 変更
	map.h
		map_dataにメンバ追加
	(conf/)
	mapflag.txt
		ナイトメアモードにドロップ設定追加

--------------------
//0989 by (凸)
・スプリングトラップを某所で見たSSを元に実装してみた。違ったら相違スレへ
・ディテクティングを某所で見た解説文を元に実装してみた。違ったら相違スレへ
・キャストキャンセル時のdelete_timerエラーに追加でスキルIDを表示するようにした。あわせて報告するとエラーの原因が分かるかも

	(map/)
	skill.c
		skill_castend_nodamage_id() 変更
		skill_castend_pos2() 変更
		skill_castcancel() 変更

--------------------
//0988 by (凸)
・トーキーボックスは常に足元に置けるように変更とKalenさんに貰った情報等を元にパケットを本鯖にあわせてみた
・ショックウェーブトラップに効果を追加したつもり(未確認)
・ブラストマインとクレイモアトラップを殴ると吹き飛ぶようにした
・リムーブトラップで罠(skill_require_dbで指定したアイテム)を回収できるようにした
・↑の実装により罠の時間切れで罠が出るオリジナル仕様はコメントアウト
・ブラストマインの効果時間が長いのを修正

	(db/)
	cast_db.txt
	(map/)
	battle.c
		battle_check_target() 変更
	mob.c
		mobskill_castend_pos() 変更
	skill.c
		skill_additional_effect() 変更
		skill_blown() 変更
		skill_castend_nodamage_id() 変更
		skill_castend_pos2() 変更
		skill_unitsetting() 変更
		skill_unit_onplace() 変更
		skill_unit_ondamaged() 変更
		skill_castend_pos() 変更
		skill_unit_timer_sub() 変更

--------------------
//0987 by 胡蝶蘭

・ユーザー定義関数/サブルーティンに引数を指定可能に
	詳しくは script_ref.txt を参照
	
	(map/)
	scirpt.c
		buildin_getarg()追加
		buildin_callsub(),buildin_callfunc(),run_func()修正
	(doc/)
	script_ref.txt
		引数についての説明追加

・getguildname,getpartyname,getcastlename,strcharinfo修正
	C_STRで定数文字列(C_CONSTSTR)を返していた問題修正
	strcharinfoでギルド名などを所得する際、未所属だったときの問題
	
	(map/)
	script.c
		buildin_getguildname(),buildin_getpartyname()
		buildin_getcastlename(),buildin_strcharinfo()

--------------------
//0986 by (凸)
・client_packetの記述から推察してトーキーボックスを実装してみたつもり

	(db/)
	skill_db.txt
	(map/)
	clif.c
		clif_talkiebox() 追加
		clif_parse_UseSkillToPos() 変更
		clif_parse() 変更
	clif.h 変更
	map.h 変更
	skill.c
		skill_castend_pos2() 変更
		skill_unitsetting() 変更
		skill_unit_onplace() 変更

--------------------
//0985 by (凸)
・サーバーsnapshot
・/script/extensionに語り部を追加したり
・0984でAthena雑談スレッド part3>>92 Michaelさんの修正を取り込んでた
・バグ報告スレッド part5 >>45に転載されてた あやねさんの修正を取り込み
・バグ報告スレッド part5 >>54 rariさんのたぬき帽修正を取り込み

	(script/extension/)
	npc_event_kataribe6.txt 追加
	npc_event_kataribe7.txt 追加
	(script/npc/)
	quest/npc_event_hat.txt 修正
	job/npc_job_magician.txt 修正

--------------------
//0984 by (凸)
・セージのフリーキャストというスキルの存在を知らなかったので0983の変更を一部戻し
・アイテム更新したけど垂れ猫とインディアンバンダナが装備できない？
・マップフラグとモンスター配置を最新版に

	(db/)
	item_db.txt
	(conf/)
	mapflag.txt
	(script/mob/)
	npc_monster.txt
	(map/)
	clif.c
		clif_parse_WalkToXY() 修正

--------------------
//0983 by (凸)
・長い詠唱中に歩きまわれた気がするので修正
・ペットルーレット回転中に対象が叩き殺されたらmap-serverが困るのを修正
・プロフェッサー ライフ置き換えの手抜き処理をちょっとマシにした

	(map/)
	clif.c
		clif_parse_WalkToXY() 修正
	pet.c
		pet_catch_process2() 修正
	skill.c
		skill_castend_nodamage_id() 修正

--------------------
//0982 by (凸)
・転生スキルの〜
	ストーカー リジェクトソード 相手がPCの場合は剣じゃなければ跳ね返さない予定
	プロフェッサー メモライズ 12秒の固定キャストタイム、その後スキル使用のキャストタイムが3回だけ1/3になる
	プロフェッサー ライフ置き換え HPを10%減らしてSPを増やす。減ったHPのエフェクトは無しにしてみた
・見切りと回避率増加のFlee上昇がステータス変化時にしか反映されていなかったのを修正
・0981で自分以外は歩いたら服の色が戻ってしまうのをなんとかしたつもり

	(db/)
	skill_require_db.txt
	(map/)
	battle.c
		battle_calc_damage() 修正
	clif.c
		clif_movechar() 修正
		clif_getareachar_pc() 修正
	pc.c
		pc_calcstatus() 修正
	skill.c
		SkillStatusChangeTable 変更
		skill_castend_nodamage_id() 変更
		skill_use_id() 変更
		skill_use_pos() 変更
		skill_status_change_timer() 変更
		skill_status_change_start() 変更
	skill.h 変更
	
--------------------
//0981 by (凸)
・転生スキルの〜
	ストーカー リジェクトソード 一定確率でダメージを半分にして減らした分を相手に跳ね返すようにした…が、跳ね返したダメージのエフェクト出ません
・服の色を変更＆保存している場合にリログすると元の色に戻ってるように見える問題の修正

	(db/)
	skill_db.txt
	(map/)
	clif.c
		clif_parse_LoadEndAck() 修正
	battle.c
		battle_calc_damage() 修正
	skill.c
		skill_status_change_timer() 修正
		skill_status_change_start() 修正

--------------------
//0980 by (凸)
・例によって転生スキルとモンク関連
	スナイパー シャープシューティング クリティカル率調整？
	ハイウィザード ソウルドレイン MSP増量とMobを倒したときにSP(mobLv*(65+15*SkillLv)/100)回復。でも本当は範囲攻撃の場合は回復しないらしい？
	ハイウィザード 魔法力増幅 使ったらMATKがSkillLv%増量。次のスキル使用時に元に戻る
	モンク 気奪 ちょっと先取りして20%の確率で敵のLv*2のSPを吸収。成功したときはターゲットを取得するようにしてみた
・アイテム名をjROウンバラに準拠させてみたつもり

	(db/)
	cast_db.txt
	item_db.txt
	(map/)
	battle.c
		battle_calc_pc_weapon_attack() 変更
	mob.c
		mob_damage() 変更
	pc.c
		pc_calcstatus() 変更
	skill.c
		skill_castend_nodamage_id() 変更
		skill_use_id() 変更
		skill_use_pos() 変更
		skill_status_change_end() 変更
		skill_status_change_timer() 変更
		skill_status_change_start() 変更

--------------------
//0979 by (凸)
・転生スキルをちょっと調整
	ハイウィザード マジッククラッシャー 武器攻撃でBaseATK計算をMATK2でしてみる
・息吹を本鯖仕様風にHPとSPの回復タイマーを分けて座っていなくても動かなければタイマーが進むようにした
・阿修羅使用後にHPとSPが5分間自然回復しない本鯖使用風にした(csat_db.txtのupkeep_time2で調整可能)
・古いgccでskill_unit_timer_sub_onplace()あたりでコンパイルエラーになったのを修正

	(db/)
	cast_db.txt
	(map/)
	battle.c
		battle_calc_pet_weapon_attack() 変更
		battle_calc_mob_weapon_attack() 変更
		battle_calc_pc_weapon_attack() 変更
	map.h
	pc.c
		pc_authok() 変更
		pc_walk() 変更
		pc_spirit_heal() 削除
		pc_spirit_heal_hp() 追加
		pc_spirit_heal_sp() 追加
		pc_natural_heal_sub() 変更
	skill.c
		skill_additional_effect() 変更
		skill_castend_damage_id() 変更
		skill_status_change_start() 変更
		skill_unit_timer_sub_onplace() 修正

--------------------
//0978 by (凸)
・転生スキルを修正したり色々
	スナイパー ファルコンアサルト とりあえず飛ぶだけだと思ってください
	スナイパー シャープシューティング ダメージ増加だけど1体だけ
	クラウン・ジプシー アローバルカン ダメージ増加と9回攻撃
	ハイウィザード マジッククラッシャー エフェクトだけ
	
・アイテム交換で重量の計算が違っていたのを修正
	(doc/)
	client_packet.txt パケット長テーブル更新
	(map/)
	battle.c
		battle_calc_misc_attack() 変更
		battle_calc_pet_weapon_attack() 変更
		battle_calc_mob_weapon_attack() 変更
		battle_calc_pc_weapon_attack() 変更
	clif.c パケット長の定義を更新
	skill.c
		skill_castend_damage_id() 変更
	trade.c
		trade_tradeadditem() 修正
	
--------------------
//0977 by (凸)
・転生スキルを修正したり色々
	アサシンクロス メテオアサルト エフェクトが違う？
	ロードナイト プレッシャー 必中ダメージにしてみた
	ロードナイト オーラブレードの必中damage2が他でも適用されていたのを修正
	ロードナイト ゴスペル エフェクト出現位置の調整
	ハイプリースト アシャンプティオ 効果実装
	ハイプリースト メディテイティオ 効果実装
	ハイプリースト バジリカ SGみたいにMobが侵入しようとすると吹き飛ばされるようにした
	ホワイトスミス カートブースト 効果実装
	ホワイトスミス メルトダウン エフェクトと状態異常時間だけ(実際の状態変化は無し)
	ホワイトスミス クリエイトコイン 名前入りの金貨とか作れるだけ
	ストーカー リジェクトソード エフェクトと状態異常時間だけ(実際の状態変化は無し)
	クラウン・ジプシー マリオネットコントロール エフェクトと状態異常時間だけ(実際の状態変化は無し)
	プロフェッサー フォグウォール エフェクトと有効時間だけ
	スナイパー ウインドウォーク 速度上昇とQM、私を忘れないでがかかると解除されるようにした
	スナイパー トゥルーサイト QM、私を忘れないでで解除されるようにしてみた
・トゥルーサイトの綴り間違いを修正
・storage.cでコンパイル警告が出ないようにしたつもり

	(db/)
	cast_db.txt
	skill_db.txt
	skill_require_db.txt
	produce_db.txt
	(map/)
	battle.c
		battle_get_str() 修正
		battle_get_agi() 修正
		battle_get_vit() 修正
		battle_get_int() 修正
		battle_get_dex() 修正
		battle_get_luk() 修正
		battle_get_flee() 修正
		battle_get_hit() 修正
		battle_get_critical() 修正
		battle_get_baseatk() 修正
		battle_get_atk() 修正
		battle_get_atk2() 修正
		battle_get_def() 修正
		battle_get_def2() 修正
		battle_get_speed() 修正
		battle_calc_damage() 修正
		battle_calc_pet_weapon_attack() 変更
		battle_calc_mob_weapon_attack() 変更
		battle_calc_pc_weapon_attack() 変更
	pc.c
		pc_calcstatus() 修正
	skill.c
		skill_get_unit_id() 修正
		skill_additional_effect() 修正
		skill_castend_nodamage_id() 修正
		skill_castend_pos2() 修正
		skill_unit_group() 修正
		skill_unit_onplace() 修正
		skill_unit_onout() 修正
		skill_castend_pos() 修正
		skill_check_condition() 修正
		skill_status_change_end() 修正
		skill_status_change_start() 修正
		skill_can_produce_mix() 修正
		skill_produce_mix() 修正
	skill.h 修正
	storage.c
		storage_comp_item() 修正
	storage.h 修正

--------------------
//0976 by (凸)
・転生スキルを修正したり色々
・準備だけして実装できてないスキルもあります
	ロードナイト オーラブレード 多分こんな感じ？
	ロードナイト パリイング 跳ね返すけど攻撃を1回止めるのは未実装
	ロードナイト コンセントレーション インデュア〜は良く分からないので放置
	ロードナイト スパイラルピアース 通常ダメージ増加と重量ダメージ増加と一応5回攻撃(なんか違う気がする)
	ロードナイト ヘッドクラッシュ ダメージ増加とステータス変更？
	ロードナイト ジョイントビート ダメージ増加とステータス変更？
	アサシンクロス アドバンスドカタール研究 たぶんこんな感じ？
	スナイパー トゥルーサイト たぶんこんな感じ？
	スナイパー ウィンドウォーク たぶんこんな感じ？でも速度上昇とかと競合した時の処理は未実装
	スパイダーウェッブ とりあえずアンクルスネアと同じような感じ＆回避率半減
	チャンピオン 狂気功 適当に増やしていたのをちゃんと増やすようにした
・出血状態と骨折状態の取り扱いがよくわかりませんっ！！

	(db/)
	cast_db.txt
	skill_db.txt
	skill_require_db.txt
	(doc/)
	db_ref.txt
	(map/)
	battle.c
		battle_get_str() 修正
		battle_get_agi() 修正
		battle_get_vit() 修正
		battle_get_int() 修正
		battle_get_dex() 修正
		battle_get_luk() 修正
		battle_get_flee() 修正
		battle_get_hit() 修正
		battle_get_critical() 修正
		battle_get_baseatk() 修正
		battle_get_atk() 修正
		battle_get_atk2() 修正
		battle_get_def() 修正
		battle_get_def2() 修正
		battle_get_speed() 修正
		battle_calc_damage() 修正
	clif.c
		clif_parse_WalkToXY() 修正
	mob.c
		mob_can_move() 修正
		mobskill_castend_pos() 修正
	pc.c
		pc_calcstatus() 修正
		pc_checkallowskill() 修正
	skill.c
		skill_get_unit_id() 修正
		skill_additional_effect() 修正
		skill_castend_nodamage_id() 修正
		skill_castend_pos2() 修正
		skill_unit_group() 修正
		skill_unit_onplace() 修正
		skill_unit_onout() 修正
		skill_castend_pos() 修正
		skill_check_condition() 修正
		skill_status_change_end() 修正
		skill_status_change_start() 修正
		skill_readdb() 修正
	skill.h 修正
--------------------
//0975 by Sin
・0973で実装されたスクリプトによるBaseLv, JobLvの変更時に、
　ステータスポイントやスキルポイントを取得できるように修正。
　※質問スレpart5 >>115 悩める人 さんのpc.cを参考にさせて頂きました。多謝。

	(map/)
	pc.c
		pc_setparam()
		case SP_BASELEVEL: 修正
		case SP_JOBLEVEL: 修正
--------------------
//0974 by latte
・グランドクロスを本鯖に基づき修正
	アンデッド悪魔強制暗闇付与
	反動ダメージ半減、モーションなし
	MOB(PC)が重なったときのHIT数
	%UP系武器カード効果なし
	属性相性二重計算
	MOBダメージ表示白

	後半4項目は設定可

・戦闘基本計算を本鯖に基づき微修正（DEXサイズ補正、弓最低ダメ、PCサイズ補正）

・完全回避
	スタン等で完全回避が発生しなかったのを修正
	AGIVITペナルティが完全回避の敵もカウントして計算されていたのを修正　設定可
		オートカウンターは未修正

・倉庫を閉じるとき、アイテムIDでソートするようにした

・kalenさんのプロ１執事NPCスクリプトを改造して
	商業防衛値、投資金額、宝箱の数を本鯖に準拠(商業値は1~100)
	全砦に設置
	
	(/script/npc)
	aldeg_cas01.txt ... prtg_cas05.txt 修正
	(/script/npc/gvg)
	aldeg_cas01.txt ... prtg_cas05.txt 追加
	tbox.txt 追加

	(/conf)
	battle_athena.conf
		6項目追加

	(/map)
	mob.c/mob.h
		mob_attack() 修正
		mob_counttargeted_sub(),mob_counttargeted() 修正
		mobskill_use() 修正（↑の引数だけ）
	pc.c/pc.h
		pc_counttargeted_sub(),pc_counttargeted() 修正
		pc_attack_timer() 修正
	pet.c
		pet_attack() 修正

	map.h
		pc_data, mob_data, map_data 変数１つ追加
		enum1つ追加
	map.c/map.h
		map_count_oncell() 追加 skill.cでよかったかも・・・

	skill.c	
		GX関連修正(skill_additional_effect(), skill_attack(), skill_castend_damage_id(), skill_unit_onplace())

	battle.c 修正
	battle.h 修正

	storage.c/storage.h
		storage_comp_item() 追加
		sortage_sortitem(), sortage_gsortitem() 追加
		storage_storageclose(), storage_guild_storageclose() 修正
--------------------
//0973 by 獅子o^.^o
・スクリプトのBASELEVEL,JOBLEVEL命令追加
	例: set BASELEVEL,1;
	例: set JOBLEVEL,1;
	(map/)
	pc.c
		pc_setparam()
		case SP_BASELEVEL: 項目追加
		case SP_JOBLEVEL: 項目追加
		
--------------------
//0972 by (凸)
・転生スキルをエフェクトだけいくつか追加したり
・状態変化はそのうち誰かが
	エフェクト(ステータス変化アイコン含む)のみ
		SC_AURABLADE:		/* オーラブレード */
		SC_PARRYING:		/* パリイング */
		SC_CONCENTRATION:	/* コンセントレーション */
		SC_TENSIONRELAX:	/* テンションリラックス */
		SC_BERSERK:		/* バーサーク */
		SC_ASSUMPTIO:		/*  */
		SC_TURESIGHT:		/* トゥルーサイト */
		SC_CARTBOOST:		/* カートブースト */
		SC_WINDWALK:		/* ウインドウォーク */

	(db/)
	cast_db.txt
	(map/)
	skill.h
	skill.c
		SkillStatusChangeTable[] 項目追加
		skill_castend_nodamage_id()  項目追加
		skill_status_change_end()  項目追加
		skill_status_change_start()  項目追加
		
--------------------
//0971 by (凸)
・atcommand.hに残っていたjobchange2とかの残骸を削除
・転生スキルをエフェクトだけいくつか追加したりチャンピオンはそれなりに追加したり
	エフェクトのみ
		ハイプリースト バジリカ(HP_BASILICA)
		ホワイトスミス カートブースト(WS_CARTBOOST)
		スナイパー トゥルーサイト(SN_SIGHT)
		ジプシー 月明りの泉に落ちる花びら(CG_MOONLIT)
		パラディン ゴスペル(PA_GOSPEL)
	追加ダメージ等なし
		ロードナイト ヘッドクラッシュ(LK_HEADCRUSH)
		ロードナイト ジョイントビート(LK_JOINTBEAT)
		ロードナイト スパイラルピアース(LK_SPIRALPIERCE)
		パラディン プレッシャー(PA_PRESSURE)
		パラディン サクリファイス(PA_SACRIFICE)
	それなり(コンボは繋がりますがディレイは適当、ダメージ追加はあるけどそれ以外の追加効果は無し)
		チャンピオン 猛虎硬派山(CH_PALMSTRIKE)
		チャンピオン 伏虎拳(CH_TIGERFIST)
		チャンピオン 連柱崩撃(CH_CHAINCRUSH)
		チャンピオン 狂気功(CH_SOULCOLLECT)

	(db/)
	cast_db.txt
	skill_db.txt
	skill_require_db.txt
	(map/)
	atcommand.h ゴミ削除
	battle.c
		battle_calc_pet_weapon_attack() 変更
		battle_calc_mob_weapon_attack() 変更
		battle_calc_pc_weapon_attack() 変更
	clif.c
		clif_parse_UseSkillToId() 変更
	skill.c
		skill_get_unit_id() 項目追加
		skill_attack() チャンピオンコンボ処理追加
		skill_castend_damage_id() 変更
		skill_castend_nodamage_id() 変更
		skill_castend_id() 変更
		skill_unitsetting() 変更
		skill_check_condition() 変更
		skill_use_id() 変更

--------------------
//0970 by (凸)
・ドレイクのウォーターボールが異常に痛い(121発食らう)のでLv5以上の場合は25発に制限
・シグナムクルシスの計算式を14+SkillLvから10+SkillLv*2変更
・ソースの気が向いたところに落書き
・DB関係をまとめて同梱

	(map/)
	battle.c コメント＿〆(。。)カキカキ
	skill.c skill_status_change_start()
	(db/)
	cast_db.txt
	item_db.txt
	mob_skill_db.txt
	skill_db.txt
	skill_require_db.txt
	skill_tree.txt

--------------------
//0969 by ぴざまん

・白刃取り状態で片方が死亡した場合、片方の白刃取りが解除されない問題修正
・battle_athena.confに項目追加
　ペット・プレイヤー・モンスターの無属性通常攻撃を属性無しにするか否かを設定できます
　詳しくはconf_refを。
・＠コマンド@idsearch実装
　ロードしたitem_dbから検索語句にマッチするアイテムとIDを羅列するコマンドです
　例えば「@idsearch レイ」と入力した場合、ブレイドやレイドリックカード等が引っかかります
・アシッドテラーとデモンストレーション実装
　装備破壊は未実装です
・イドゥンの林檎の回復仕様を丸ごと変更。
	(map/)
	battle.c
	battle.h
		属性補正の修正やアシッドテラー・デモンストレーションのダメージ算出式追加等。
		battle_configに項目追加
	skill.c
		skill_idun_heal()追加。foreachinareaで処理するように変更
		アシッドテラーとデモンストレーションの処理追加。
	atcommand.c
	atcommand.h
		@idsearch追加。

--------------------
//0968 by 胡蝶蘭

・キャラクターIDが使いまわされないように修正
・キャラクター削除時、パーティー、ギルドを脱退するように修正
・アカウント削除時、キャラクターと倉庫を削除するように修正
・倉庫/ギルド倉庫削除時、倉庫内のペットを削除するように修正
	・注意：ログインしているアカウントを削除した場合の動作は不明

	(char/)
	char.c
		パケット2730の処理、char_delete()追加、削除処理修正など
	int_storage.c/int_party.c/int_guild.c/int_party.h/int_guild.h
		inter_party_leave(),inter_guild_leave()追加、
		inter_storage_delete(),inter_guild_storage_delete()修正など
	(login/)
	login.c
		parse_admin()をアカウント削除時にパケット2730を送るように修正

・athena-start stop で停止させた場合、データが保存されない問題を修正
	killで送るシグナルをSIGKILLからSIGTERMに変更。
	どうしてもSIGKILLを送りたい場合は athena-start kill を使ってください。
	
	athena-start
		stop修正、kill追加

--------------------
//0967 by Asong
・モンスターの残影を実装。
　通常モンスターはスキルによるフィルターがかからないので残像が出ません。
　ＰＣ型モンスターには残像が出ます。
・モンスタースキル使用対象を追加。
　around5〜around8はターゲットの周辺セルを対象にします。
　
　	(map)
　	mob.c
　		mobskill_use() 修正
　		mob_readskill() 修正
　	mob.h 修正
　	skill.c
　		skill_castend_pos2() 修正

--------------------
//0966 by (凸)
・サーバーsnapshot
・ディレクトリ構造を変更(common,login,char,mapは/src以下に移転)
　それに伴うMakefile等のパス書き換え
・npc_turtle.txtをnpc_town_alberta.txtに統合
・モンクのコンボに関するディレイを変更
・battle_config.enemy_criticalのデフォルトをnoに変更
・転生職等を無効にするenable_upper_classの追加
・@joblvup,@charjlvlでJobレベルが最高のときに負数を指定してもレベルを下げられなかった問題を修正

	(conf)
	battle_athena.conf 修正
	(doc)
	conf_ref.txt 修正
	(map)
	atcommand.c
		atcommand_joblevelup() 修正
		atcommand_character_joblevel() 修正
	battle.c
		battle_calc_attack() 修正
		battle_config_read() 修正
	battle.h 修正
	pc.c
		pc_calc_skilltree() 修正
		pc_calc_base_job() 修正
		pc_jobchange() 修正
		pc_readdb() 修正
	skill.c
		skill_attack() 修正
--------------------
//0965 by ぴざまん
・@mapexit実行時全セッションをkickするように変更。
・白刃取り時に片方が倒れても、もう片方の白刃が解除されない問題修正。(未テスト)
・スティール情報公開機能実装。(未テスト)
　スティールに成功すると、何をスティールしたのか
　画面内のPTメンバー全員に知らせる機能です。
　battle_athena.confのshow_steal_in_same_partyで設定できます。
　オリジナルアップデートの為、デフォルトはnoにしています。
・イドゥンの林檎の回復効果実装。

	(conf/)
	battle_athena.confに項目追加。
	(map/)
	atcommand.c
		atcommand_mapexit() 修正。
	pc.c
		pc_steal_item() 修正。
		pc_show_steal() 追加。
	skill.c
		skill_unitsetting()、skill_unit_onplace() 修正。
	battle.c
		battle_config_read() 修正。
	battle.h 修正。
	(doc/)
	conf_ref.txt 抜けてたのを色々追加。

--------------------
//0964 by (凸)

・この前追加したskill_tree2.txtを廃止したので削除してください
・skill_tree.txtのフォーマットを変更＆Kalenさんなどの情報を元に転生ツリーの見直し
・それにともなってpc.cのファイル読み出し部分などを変更
・Athena雑談スレッド part3 >>14 miyaさんの指摘があるまですっかり忘れていたatcommand_athena.confの修正を同梱

	(conf/)
	atcommand_athena.conf 修正
	(db/)
	skill_tree.txt 修正
	skill_tree2.txt 廃止
	(map/)
	map.h PC_CLASS_BASE等追加
	pc.c
		pc_calc_skilltree() 修正
		pc_allskillup() 修正
		pc_readdb() 修正

--------------------
//0963 by (凸)

・@jobchange2, @jobchange3廃止 @jobchangeに引数追加 @help参照
	例: @jobchange2 10 → @jobchange 10 1
・同様に@charjob2, @charjob3廃止 @charjobに引数追加 @help参照
	例: @charjob2 10 ほげほげ → @charjob 10 1 ほげほげ
・同様にスクリプトのjobchange2, jobchange3命令廃止 jobchangeに引数追加 script_ref.txt参照
	例: jobchange2 10; → jobchange 10,1;
・↑どれも追加された引数は省略可能です。なので、転生ノービスは現状のスクリプトで転生一次職に転職できます。
	例:	Novice High → @jobchange 10 → Whitesmith
		Novice → @jobchange 10 → Blacksmith
・スクリプトから転生しているか判定するためにUpperを追加しました。Upper 0=通常, 1=転生, 2=養子
	Upper=0の時にBaseLevel=99なら転生させる〜とかそういうスクリプト誰か書いてください
	その時に元の職業は記憶していないので永続変数とかで覚えさせて判定させないと転生後何にでも転職できちゃう？
・バイオプラントとスフィアマインで呼び出されるMobの名前を--ja--にしてmob_db.txtから読むようにした

	(conf/)
	help.txt 修正
	(db/)
	const.txt
	(doc/)
	help.txt 修正
	script_ref.txt 修正
	(map/)
	atcommand.c
		atcommand_jobchange() 修正
		atcommand_jobchange2() 削除
		atcommand_jobchange3() 削除
		atcommand_character_job() 修正
		atcommand_character_job2() 削除
		atcommand_character_job3() 削除
	map.h 修正
	pc.c
		pc_readparam() 修正
		pc_jobchange() 修正
	pc.h 修正
	script.c
		buildin_jobchange() 修正
		buildin_jobchange2() 削除
		buildin_jobchange3() 削除
	skill.c
		skill_castend_pos2() 修正

--------------------
//0962 by (凸)

・職業は0〜23で処理したいので転生職用のスキルツリー追加、eAthenaを参考に拡張
	っていうか韓国本サーバでの実装の資料が見当たらないので適当
・sakexe.exeを解析してskill_db.txt変更、これもeAthenaを参考に拡張
	どれが本サーバで実装されているスキルか分かりませんっ！！
※スキルツリーが表示されたからといって使えるわけじゃありませんっ！！

	(common/)
	mmo.h 定数修正
	(db/)
	skill_db.txt 変更
	skill_require_db.txt 変更
	skill_tree2.txt 追加
	(map/)
	skill.h 定数修正
	pc.c
		pc_calcstatus() 修正
		pc_allskillup() 修正
		pc_calc_skilltree() 修正
		pc_readdb() 修正
	
--------------------
//0961 by 胡蝶蘭

・スクリプトにサブルーチン/ユーザー定義関数機能追加
	詳しくはサンプルとscript_ref.txtを読んでください。
	地味に大改造なので、スクリプト関係でバグがあるかもしれません。
	
	(map/)
	map.h/map.c
		struct map_session_data にスクリプト情報退避用のメンバ追加
		map_quit()修正
	script.h/script.c
		色々修正(run_script(),run_func()が主)
	npc.c
		npc_parse_function()追加他
	(conf/sample)
	npc_test_func.txt
		ユーザー定義関数/サブルーティンのテストスクリプト
	(doc/)
	script_ref.txt
		サブルーティンなどの説明追加

--------------------
//0960 by (凸)
・本鯖相違スレッド part2 >>62 KKさんのアンクルスネア修正を同梱
・バグ報告スレッド part5 >>14-16 rbさんのバグ修正を同梱
・For English User Forum >>15 Mugendaiさんの指摘で0x1d7を使うのはVal>255に修正(0xc3のValは1バイトだから0x1d7を使うのかと納得)
・pc_calc_base_job()を変更して元jobだけでなくノビか一次職か二次職(type)、通常か転生か養子(upper)を返すようにした

	(map/)
	atcommand.c
		atcommand_joblevelup() 修正
		atcommand_character_joblevel() 修正
	clif.c
		clif_changelook() 修正
	pc.h 修正
	pc.c
		pc_setrestartvalue() 修正
		pc_equippoint() 修正
		pc_isequip() 修正
		pc_calc_skilltree() 修正
		pc_calcstatus() 修正
		pc_isUseitem() 修正
		pc_calc_base_job() 修正
		pc_allskillup() 修正
		pc_damage() 修正
		pc_jobchange() 修正
		pc_equipitem() 修正
	script.c
		buildin_changesex() 修正
	skill.c
		skill_castend_nodamage_id() 修正
		skill_unit_onplace() 修正
		
--------------------
//0959 by (凸)
・help.txtがdocじゃなくてconfのが読み出されてた＿|‾|○
・gamejokeを参考に転生二次職のステータス加重値をjob_db2-2.txtに記述
・スクリプトにjobchange2とjobchange3を追加それぞれ転生職と養子職へ転職させる命令です

	(conf/)
	help.txt 修正
	(db/)
	job_db2.txt 修正
	job_db2-2.txt 追加
	(doc/)
	help.txt 修正
	script_ref.txt 修正
	(map/)
	pc.c
		pc_calcstatus() 修正
		pc_readdb() 修正
	script.c
		buildin_jobchange() 修正
		buildin_jobchange2() 追加
		buildin_jobchange3() 追加

--------------------
//0958 by (凸)
・転生職方面の実装を色々
・重量制限は良く分からないので元の職業の値をそのまま使っています(モンク＝チャンピオン等)
・装備品も同上、HPやSPのテーブルも同上なので、転生してもHPなどが増えないガッカリ仕様です

	(map/)
	atcommand.c
		atcommand_joblevelup() 修正
		atcommand_character_joblevel() 修正
	pc.c
		pc_setrestartvalue() 修正
		pc_equippoint() 修正
		pc_isequip() 修正
		pc_calcstatus() 修正
		pc_isUseitem() 修正
		pc_calc_base_job() 追加
		pc_damage() 修正
		pc_jobchange() 修正
		pc_equipitem() 修正
	pc.h 修正
	script.c
		buildin_changesex() 修正
	skill.c
		skill_castend_nodamage_id() 修正

--------------------
//0957 by (凸)
・@charjob2と@charjob3を追加、関係としては@charjob⇔@jobchange、@charjob2⇔@jobchange2、(ry
・@mapexitを追加、map-serverを落とすコマンドですatcommand_athena.confでは99設定にされてますので使用には十分注意してください。

	(map/)
	atcommand.c
		atcommand_character_job2() 追加
		atcommand_character_job3() 追加
	atcommand.h 修正
	(conf/)
	atcommand_athena.conf 修正
	(doc/)
	help.txt 修正

--------------------
//0956 by (凸)
・転生職仮実装(@jobchange2)、見た目と経験値テーブルだけです
・養子職仮実装(@jobchange3)、見た目だけです現状では経験値は転生二次職と同じというマゾ仕様
※上記2点は転生職が実装されているクライアントでなければ実行するとエラー落ちするので注意！！
　その後直接セーブデータを弄らないとキャラセレにも行けなくなります！！
・Athena雑談スレッド part2 >>149 稀枝さんの報告を元にガーディアンを修正
・砦以外でガーディアンとかエンペリウムを殴るとmap-serverが落ちていたのも修正(未確認)
・スパノビのJobテーブルはFor English User Forum >>13 kingboさんのデータを元に修正
・転生職の経験値テーブルはOWNを参照してBase99の経験値は不明だったので適当に設定

	(map/)
	atcommand.c
		atcommand_jobchange() 修正
		atcommand_jobchange2() 追加
		atcommand_jobchange3() 追加
	atcommand.h 修正
	clif.c
		clif_changelook() 修正
	pc.c
		pc_nextbaseexp() 修正
		pc_nextjobexp() 修正
		pc_jobchange() 修正
		pc_readdb() 修正
	battle.c
		battle_calc_damage() 修正
		mob_can_reach() 修正

--------------------
//0955 by huge
・ペットのルート機能。
  ・仕様はmobのルートに近い感じですが、射程を短くしてます。
  ・拾ったアイテムは、パフォーマンスをすると床に落とします。
  ・卵に戻したり、ログオフしたときはPCの手元に入るようにしました。(重量超過はドロップ)
  ・拾える個数はルートmob同様の10個ですが、11個目は拾いに行きません。
  ・ルート権の問題から、アイテムにfirst_idが入っていて、それが飼い主以外だったら、何秒経とうと拾いません。(未確認)
  ・それと、荷物持ちにされると可哀想なので、重量制限もつけました。これはconfで設定可能です。
・atcommandで、@whereがうまく働いてなかったので修正(またウチだけかなぁ・・・）
・@memoでmemoする時は、mapflagを無視するように。
・スフィアマインの名前だけ修正。

	(conf/)
	battle_athena.conf
		pet_lootitem,pet_weight 追加
	(doc/)
	conf_ref.txt 修正
	(map/)
	atcommand.c
		atcommand_memo() 修正
		atcommand_where() 修正
	battle.c
		battle_config_read() 修正
	battle.h 修正
	map.c
		map_quit() 修正
	map.h
		pet_data{} 修正
	pc.c
		pc_memo() 修正
	pet.c
		pet_performance() 修正
		pet_return_egg() 修正
		pet_data_init() 修正
		pet_ai_sub_hard() 修正
		pet_lootitem_drop() 追加
		pet_delay_item_drop2() 追加
		pet_ai_sub_hard_lootsearch() 追加
	pet.h 修正
	skill.c
		skill_castend_pos2() 修正

--------------------
//0954 by (凸)
・object_del.batで各server.exeも削除するようにした
・For English User Forum >>11 kingboさんの修正を取り込み
・バグ報告スレッド part5 >>10 Sinさんの修正を取り込み
・ついでに見かけたatcommand_character_joblevelの不具合を修正
・@コマンドでジョブレベルを上げるときにスパノビはJob70まで対応(未確認)

	(/)
	object_del.bat 修正
	(map/)
	atcommand.c
		atcommand_joblevelup() 修正
		atcommand_character_joblevel() 修正
		atcommand_character_baselevel() 修正

	code by kingbo 2004/4/29 PM 06:15
	base on 0953
	now i sure it works well
	(map/)
	mob.c
		mob_can_reach() fix

--------------------
//0953 by (凸)
・mob_skill_db.txtの条件値に0以外入っていなかったのを訂正
・gcc 2.95でコンパイルできるように訂正(by バグスレpart5 >>2 茜さん)
・↑やLinuxなどを考慮してstartやMakefileなどの改行をLFに変更
・0952で出たコンパイル警告を出ないように修正
・0952で更新されなかったconf_ref.txtを修正

	(/)
	start 改行コード変更
	athena-start 改行コード変更
	(db/)
	mob_skill_db.txt 修正
	(doc/)
	conf_ref.txt 修正
	(login/)
	Makefile 改行コード変更
	(map/)
	Makefile 改行コード変更
	atcommand.c
		atcommand() 宣言位置修正
		atcommand_where() 宣言位置修正
	battle.c 
		battle_calc_pet_weapon_attack() 修正
		battle_calc_mob_weapon_attack() 修正
		battle_calc_pc_weapon_attack() 修正
		battle_calc_magic_attack() 修正
	clif.c
		clif_skill_fail() 宣言位置修正
	guild.c
		guild_gvg_eliminate_timer() 宣言位置修正
	mob.c
		mob_damage() 宣言位置修正
	script.c
		buildin_deletearray() 宣言位置修正
		buildin_getequipcardcnt() 宣言位置修正
		buildin_successremovecards() 宣言位置修正

--------------------
//0952 by CG
・confでDEFとMDEFの計算方法を選択できるように。

	(conf/)
	battle_athena.conf 変更
	(map/)
	battle.c 
		battle_calc_pet_weapon_attack() 修正
		battle_calc_mob_weapon_attack() 修正
		battle_calc_pc_weapon_attack() 修正
		battle_calc_magic_attack() 修正
	battle.h 修正

--------------------
//0951 by (凸)
・サーバーsnapshot
・バグ報告スレッド part4 >>95 KAJIKENさんの修正を同梱
・同 >>138 バグかな？さんの修正を同梱
・Athena雑談スレッド part2 >>112 名無しさんのPVPナイトメアモードのアンダークロスマップワープポイントを同梱
・同 >>96 稀枝さんのnpc_gldcheck.txtを同梱
・スナップショットにsave/を入れるのをやめました。無い場合はathena-startが作ってくれます
・athena-startでlog/が無い場合に作るように変更
・その他？

	(/)
	athena-start 変更
	(db/)
	mob_db.txt 変更
	(conf/)
	map_athena.conf 変更
	(conf/extension/)
	npc_gldcheck.txt 追加
	(conf/npc/)
	npc_event_ice.txt 変更
	npc_job_alchemist.txt 変更
	npc_event_valentine.txt 変更
	npc_town_geffen.txt 変更
	npc_event_whiteday.txt 変更
	npc_event_potion.txt 変更
	npc_town_comodo.txt 変更
	(conf/warp/)
	npc_warp_pvp.txt 追加

--------------------
//0950 by (凸)
・mob_dbのModeフラグに以下の物を追加
	0x40(64) ダメージを1に固定(草やクリスタルなど)
	0x80(128) 攻撃を受けたときに反撃をする
・上記の変更のためmob_db.txtほぼ全部変更、mob_db2.txtを作っている人は
	草など1ダメ固定にはModeに64を足さないと普通にダメージ
	その他MobはModeに128を足さないと反撃してこなくなるので注意

	(db/)
	mob_db.txt 修正
	(map/)
	battle.c
		battle_calc_pet_weapon_attack()
		battle_calc_mob_weapon_attack()
		battle_calc_pc_weapon_attack()
		battle_calc_magic_attack()
	mob.c
		mob_once_spawn()
		mob_attack()
		mob_target()
		mob_ai_sub_hard()

--------------------
//0949 by ぴざまん

・ステータス異常耐性全面修正。
　耐性算出式全面修正。
　ステータス異常耐性100%のキャラクターには状態異常を行わないように修正。
・ディスペルの仕様変更。
　解除したらシステム上問題のあるステータス変化以外片っ端から解除するように修正。
・フロストダイバーの仕様変更。
　凍結率修正(マジスレテンプレ準拠)。
・リカバリーの仕様変更。
　ノンアクティブモンスターに使用するとターゲットがリセットされるように修正。
・クァグマイアの仕様がアレだったので修正。
　演奏や属性場と同様にrangeで処理するように修正。
　DEX/AGI半減の影響が詠唱以外にも及ぶ様に修正。
・スキルターゲット中に死んだ振りを使用してもスキルが回避できない問題修正。
・白刃取りが動作しない問題修正(cast_dbが抜けてました)。
	(map/)
	pc.c
		pc_calcstatus()修正
	skill.c
		skill_additional_effect()、skill_attack() 修正
		skill_status_change_start()、skill_unitsetting() 修正
	(db/)
	cast_db.txt 修正。

--------------------
//0948 by 胡蝶蘭

・warpwaitingpcが正しくPCを転送できない問題を修正
・スクリプトの読み込み時にエラーまたは警告が出る場合、警告音を鳴らすように。
  （流れたログを見ない人対策です）

	(map/)
	script.c
		buildin_warpwaitingpc()修正
		disp_error_message()修正

・atcommand.c修正
	・atcommand_athena.confのmapmoveを読むように
	・@strなどの省略時の必須レベルを0に。
	・@paramは使わないのでコメント化
	
	(map/)
	atcommand.c
		該当個所修正

・mobが最大15秒ほど移動しない場合がある問題修正
	・手抜きでないmob処理で、移動しない時間が7秒以上続かないように修正

	(map/)
	mob.c
		mob_ai_sub_hard()修正

・快速船員の伊豆港行きの判別式修正 (by ID:F8nKKuY)
	(conf/npc/)
	npc_town_comodo.txt

--------------------
//0947 by (凸)
・取り巻きは取り巻きを召喚しないように修正
・露天の販売価格の上限をbattle_athena.confで設定できるように修正

	(conf/)
	battle_athena.conf
		vending_max_value追加
	(doc/)
	conf_ref.txt 修正
	(map/)
	skill.c
		skill_castend_nodamage_id() 修正
	battle.c
		battle_config_read() 修正
	battle.h 修正。
	vending.c
		vending_openvending() 修正。

--------------------
//0946 by Kalen
・プロ北Warp見直し
参考：本鯖(1F,2F)らぐなの何か(3F)
	(conf/warp/)
	npc_warp.txt

・語り部の2週3週追加(どうせ見ないと思いますが…)
	(conf/npc/)
	npc_event_kataribe.txt

--------------------
//0945 by 胡蝶蘭

・NPCタイマーラベルデータが正しくインポートされない問題を修正
・NPCタイマー初期値やタイマーIDが正しく初期化されない問題を修正
・NPCのduplicateを行うとアクセス違反が起こる場合がある問題を修正

	(map/)
	npc.c
		npc_parse_script修正

・パッチアップスレ４の87のpc.cとりこみ
	(map/)
	pc.c
		カード重量制限を元に戻したもの

--------------------
//0944 by huge
・ギルドの上納経験値の上限を、confで制限できるように。
・露店の販売価格を10Mまでに制限。
・カートの重量制限が一桁下がってたんですが、ウチだけですか？修正してみましたが。

	(conf/)
	battle_athena.conf
		guild_exp_limit追加
	(doc/)
	conf_ref.txt 修正
	(map/)
	atcommand.c
		蘇生時のSP回復で、細かい修正。
	battle.c
		battle_config_read() 修正
	battle.h 修正。
	guild.c
		guild_change_position() 修正。
	pc.c
		pc_calcstatus() 修正。
	vending.c
		vending_openvending() 修正。

--------------------
//0943 by (凸)
・battle_athena.confでdead_branch_activeをyesにすると古木の枝で召喚されるモンスターがアクティブになるように変更
・微妙に変更したclient_packet.txtを同梱

	(conf/)
	battle_athena.conf
		dead_branch_active追加
	(doc/)
	client_packet.txt 修正
	conf_ref.txt 修正
	(map/)
	battle.c
		battle_config_read() 修正
	battle.h 修正
	map.h 修正
	mob.c
		mob_once_spawn() 修正
		mob_attack() 修正
		mob_target() 修正
		mob_ai_sub_hard_lootsearch() 修正
		mob_ai_sub_hard() 修正
		
・英語スレのkingboさんの変更を同梱
	code by kingbo 2004/4/16 PM 09:47

	support guildcastle guardian
	maybe still have problems..need to try
	Good Luck Q^^Q
	P.S: sorry my poor english ^^a

	(map/)
	mob.c
		mob_can_reach() fix
	battle.c
		battle_calc_damage() fix

	(conf/gvg/)
		prtg_cas01_guardian.txt

--------------------
//0942 by 胡蝶蘭

・アクセスコントロールで不正なメモリにアクセスする場合があるバグを修正
	(login/)
	login.c
		check_ipmask()修正

・スクリプトリファレンス少し追加と修正
	(doc/)
	script_ref.txt
		修正

--------------------
//0941 by (凸)

・e2さんの報告を元に召喚された手下のスピードを召喚主と同じにしてみる

	(map/)
	battle.c
		battle_get_speed() 修正
	mob.c
		mob_spawn() 修正
		mob_summonslave() 修正

--------------------
//0940 by End_of_exam

・ヒールやポーションピッチャーを使用しても回復しないバグを修正(0938〜)。

　Thanks for Pepermint, reporting the bug that using PotionPitcher with
　BluePotion was no effective.
　（＝ポーションピッチャー＋青Ｐで効果がない事を報告してくれたPepermint氏に感謝）

	(map/)
	battle.c
		battle_heal() 修正

--------------------
//0939 by (凸)
・cutinパケットを0x145(ファイル名16文字)から0x1b3(64文字)に変更
・ついでに雑談スレに上げたathena-startを同梱

	(/)
	athena-start saveファイルが無いときに作るように
	(map/)
	clif.c
		clif_cutin() 本鯖パケット準拠に変更
	(doc/)
	client_packet.txt 修正

--------------------
//0938 by ぴざまん

・ポーションピッチャーで青ポを投げてもエフェクトだけだったバグ修正。
・露店開設が特定のアイテム配置で失敗するバグ修正。
・スクリプト関数getareadropitem実装。
　指定エリア内のドロップアイテムをカウントする関数です

　書式：getareadropitem <mapname>,<x0>,<y0>,<x1>,<y1>,<item>;
　　mapname：対象マップ名(例：prontera.gat)
　　x0とx1：対象X座標範囲
　　y0とy1：対象Y座標範囲
　　item：カウントする対象アイテム

　戻り値：mapname内座標(x0,y0)-(x1,y1)の範囲内に落ちているitemの総個数
　　　　　取得失敗時には-1を返します。
　・itemの値はIDでもアイテム名("Red_Jemstone"とか)でもいいです。

	(map/)
	battle.c
		battle_heal() 修正。
	vending.c
		vending_openvending() 修正。
	script.c
		ローカルプロトタイプ宣言修正。
		struct buildin_func[] 修正。
		buildin_getareadropitem()、buildin_getareadropitem_sub() 追加。

--------------------
//0937 by netwarrior

- Fix Japanese remarks problem in 0936
- Fix minor problem in battle_heal()

--------------------
//0936 by Pepermint

Retouch about problem of increase in quantity at the CART,
when enter the an minus quantity in the CLIENT.

Retouch about problem of not recovery,use POTIONPITCHER skill.

	(map/)
	battle.c
		battle_heal()

	vending.c
		vending_purchasereq()

--------------------
//0935 by 胡蝶蘭

・内容の同じスクリプトNPCを何度も記述しなくても言いように修正
	・NPC定義の"script"と書く部分を"duplicate(NPC名)"とすると、
	  該当のNPCとスクリプトを共有するように。NPC名は表示名ではなく
	  エクスポートされる名前を指定します。
	  <例>
prontera.gat,165,195,1	duplicate(カプラ職員)	カプラ職員2	112

	・共有元のNPCは同じマップサーバーに存在する必要があるため、
	  同じマップでない場合はduplicateすべきではない。
	  ただし、NPCの位置を"-"にすることで、マップ上には存在しないが、
	  マップサーバー内には存在するNPCを作成できるので、
	  そのNPCを共有元にするのであればどのマップへも共有できる。
	  <例>

-	script	テスト::test1	112,{	// このNPCグラフィックIDは使用しない
//	(略)
}
prontera.gat,165,195,1	duplicate(test1)	テスト2	112
geffen.gat,99,99,1	duplicate(test1)	テスト3	112

	・上のマップに存在しないNPCはイベントにもすることができる。
	  （どのマップサーバーからでも必ず呼び出せるイベントになる）

	(map/)
	map.h
		struct npc_label_list追加,struct npc_data修正
	npc.c
		npc_parse_script()修正
		不要になったラベルデータベース関連の関数を削除

--------------------
//0934 by ぴざまん

・MOBの状態異常耐性がやたら高かったのを修正。
・速度減少の仕様変更(成功率計算式変更・失敗時にはエフェクト無し)。
・何時の間にか状態異常の継ぎ足し禁止がコメントアウトされていたので戻し。
・ポイズンリアクトのアイコン表示が無くなっていたので修正(でも出るだけ…)
・白刃取り実装。

	(map/)
	battle.c
		battle_weapon_attack() 修正。
	clif.c
		clif_parse_WalkToXY()、clif_parse_ActionRequest() 修正。
		clif_parse_TakeItem()、clif_parse_UseItem() 修正。
		clif_parse_DropItem()、clif_parse_EquipItem() 修正。
		clif_parse_UnequipItem() 修正。
	mob.c
		mob_can_move()、mob_attack()、mob_ai_sub_hard() 修正。
		mobskill_use_id()、mobskill_use_pos() 修正。
		mobskill_castend_id()、mobskill_castend_pos() 修正。
	pc.c
		pc_attack_timer()、pc_setpos() 修正。
	skill.c
		SkillStatusChangeTable[] 修正。
		skill_additional_effect()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_check_condition() 修正。
		skill_status_change_start()、skill_status_change_end() 修正。
		skill_use_id() 修正。
	skill.h 修正。
	(db/)
	cast_db.txt 修正。

--------------------
//0933 by 胡蝶蘭

・ウィザード転職所NPC仮実装
	・eathenaのデータの翻訳、および某所の昔のデータを元に作ったので
	  癌鯖とは微妙に異なってると思います。
	  「古い巻物」とか使えませんし。
	・現行のjob_2nd.txtと一緒に読み込むと、NPCが重なるので、
	  job_2nd.txtの該当スクリプトをコメント化してください。
	  ただし、その場合はセージに転職させてもらえないので注意してください。
	
	(conf/npc/)
	npc_job_wizard.txt
		追加
	(conf/warp/)
	npc_warp_job.txt
		ウィザード転職所のワープをコメント化

・バグ修正
	・gotoやmenuでラベルが見つからないときスクリプトの実行を中断するように.
	・１回のスクリプトの実行において、実行命令数が約8000を超えるか、
	  gotoやmenuの実行回数が約500回を超えると実行を中断するように。
	・関数/命令実行時にもエラーチェックを入れた
	・ギルド/パーティ/ペットの名前に日本語が使えない問題修正


	(char/)
	int_guild.c/int_party.c
		名前問題修正
	(map/)
	pet.c
		名前問題修正
	script.c
		修正

--------------------
//0932 by End_of_exam

・0930でギルド倉庫の中身が消えるバグを修正。

	(char/)
	int_storage.c guild_storage_tostr() 修正。

--------------------
//0931 by (凸)
・サーバーsnapshot
・AthenaDB計画から更新のあった物を反映
・atcommand_athena.confにstr等を追加
・ワープポータルの本鯖相違点を修正
・霧さんのaldeg_cas03〜05を同梱
・pさんのnpc_event_kataribe.txt同梱
・KAJIKENさんのnpc_warp_louyang.txt同梱

	(db/)
	item_db.txt 変更
	(conf/)
	atcommand_athena.conf 変更
	map_athena.conf 変更
	(conf/gvg/)
	aldeg_cas03.txt 変更
	aldeg_cas04.txt 変更
	aldeg_cas05.txt 変更
	(conf/mob/)
	npc_monster.txt 変更
	(conf/npc/)
	npc_event_kataribe.txt 追加
	(conf/warp/)
	npc_warp_louyang.txt 追加
	(map/)
	pc.c pc_memo() 変更

--------------------
//0930 by 胡蝶蘭

	既存の char/ にあるlock.cとlock.hは削除してください。
	これらは common/ に移動されます。

・スクリプト追加修正
	・setarray（配列へリスト代入）追加
	・cleararray（配列を指定値でクリア）追加
	・copyarray（配列をコピー）追加
	・getarraysize（配列の有効な要素数を求める）追加
	・deletearray（配列の要素を削除してつめる）追加
	・warpwaitingpc：人数やアカウントIDをマップ変数にセットするように修正

	(map/)
	script.c
		色々
	(doc/)
	script_ref.txt
		命令追加など
	(npc/sample/)
	npc_test_array.txt
		配列系テスト用NPCスクリプト

・バグ修正など
	・キャラクター名/アカウント名/パーティ名/ギルド名/ペット名に
	  コントロールコードを使えないように修正。
	・char.cなどの保存の効率を更にアップ。
	・倉庫ファイル/ギルド倉庫ファイルに空行が残らないように修正
	・lock.*をcommon/に移動、ファイルが保存できなくなるバグ修正、
	  アカウントとマップ変数の保存にもlock_fopenを使うように。

	(common/)
	lock.c/lock.h
		フォルダ移動、lock_fopen修正
	(login/)
	login.c
		mmo_auth_new()修正
	(char/)
	char.c
		mmo_char_tostr(),make_new_char()修正
	int_storage.c
		storage_tostr(),guild_storage_tostr(),
		inter_storage_save_sub(),inter_guild_storage_save_sub()修正
	int_party.c
	int_guild.c
		名前問題修正
	(map/)
	pet.c
		名前問題修正

--------------------
//0929 by ぴざまん

・ランドプロテクター完全実装。
・プロボックのスキル仕様変更(詠唱妨害・凍結、石化、睡眠解除)。
・リカバリーのスキル仕様変更(アンデッドに使用すると一定確率で暗闇効果)。
・状態異常中でも装備の切り替えが出来るように変更。
・アイテム自動取得中に@killmonsterを使用すると落ちるバグ修正。
・胡蝶蘭さんが上げていたnpc.cを同梱しました。
・skill_dbで気になってたとこをちょこっと修正。

	(map/)
	clif.c
		clif_parse_EquipItem() 修正。
	skill.c
		skill_castend_nodamage_id() 修正。
		skill_unitsetting()、skill_unit_onplace() 修正。
		skill_landprotector() 追加。
	mob.c
		mob_delay_item_drop()、mob_delay_item_drop2() 修正。
	npc.c 修正

	(db/)
	skill_db.txt 修正。

--------------------
//0928 by End_of_exam

・キャラや倉庫内アイテムが消える問題に暫定対処（キャラ鯖の改良）。

　1.キャラデータ・倉庫データのデータ変換処理を改良。
　　(char/char.c , char/int_storage.c)

　2.ファイル書き出しが終わるまで、旧ファイルを残すように修正。
　（char/lock.c, char/lock.h の追加。メイクファイルの修正。
　　char/int_storage.c,int_guild.c,int_party.c,int_pet.c,char.c,inter.c
　　内にある、データ書き出し処理を変更。）

--------------------
//0927 by ぴざまん

・武器攻撃以外に種族補正が入っていなかったのを修正。
・演奏中に楽器・鞭以外の武器に持ち変えると演奏が止まる様に修正。
・演奏の効果が演奏者自身にはかからないように修正。
・アイテム自動取得機能実装
　敵を倒した時に、アイテムがドロップされるのではなく、その敵に一番多くのダメージを
　与えた人(ルート権1位の人)にドロップアイテムが自動で与えられる機能です。
　battle_athena.confのitem_auto_getで設定できます。
　オリジナルアップデートの為、battle_athena.confでのデフォルトではnoにしています。
・属性場(デリュージ・バイオレントゲイル・ボルケーノ・ランドプロテクター)仮実装
　一部の機能が未実装です
　　デリュージ：水場を用いたウォーターボール
　　バイオレントゲイル：ファイアーウォールの持続時間補正
　　ボルケーノ：アイスウォール禁止
　　ランドプロテクター：オブジェクト設置系スキル禁止(つまり出るだけのLPです)

	(map/)
	battle.c
		battle_calc_damage()、battle_calc_magic_attack() 修正。
		battle_calc_misc_attack()、battle_config_read() 修正。
	mob.c
		mob_delay_item_drop()、mob_delay_item_drop2() 修正。
	pc.c
		pc_calcstatus()、pc_equipitem() 修正。
	skill.c
		ローカルプロトタイプ宣言修正。
		SkillStatusChangeTable[] 修正。
		skill_castend_nodamage_id()、skill_castend_pos2() 修正。
		skill_unitsetting()、skill_unit_onplace() 修正。
		skill_unit_onout()、skill_unit_ondelete() 修正。
		skill_status_change_start()、skill_status_change_end() 修正。
		skill_clear_element_field() 追加。
	battle.h 修正。
	skill.h 修正。
	(conf/)
	battle_athena.conf
		item_auto_get項目を追加。
	(db/)
	cast_db.txt 修正。

--------------------
//0926 by 胡蝶蘭

・ギルド城の初期化方法変更
	・全てのギルド城（＋占拠ギルド情報）を所得したときにOnAgitInitが
	  よばれるように。GetCastleDataやRequestGuildInfoの必要がなくなります。
	  従って、現在のgvgスクリプトのOnInterIfInitやOnRecvCastleXXXは
	  必要なくなります。（おそらく現行のスクリプトも動作は可能です）
	  初期化が必要なNPCは変わりにOnAgitInitを使ってください。
	  なお、不要になった命令などを削除する予定はありません。
	
	(char/)
	inter.c/inter.h/char.c/int_guild.c/int_guild.h
		マップサーバー接続時に処理を行えるように修正
		接続時にギルド城データを送信するように
	(map/)
	intif.c/guild.c/guild.h
		接続時のギルド城データ一括受信処理＆ギルド情報要求、
		OnAgitInitの呼び出しなど
	chrif.c
		旧OnAgitInitの呼び出し削除
	(doc/)
	inter_server_packet.txt
		ギルド城データ一括送信パケット0x3842追加

・スクリプトにNPC主体イベント実行命令追加
	・donpcevent(NPC主体イベント実行)追加
	  こちらはdoeventと違いブロードキャスト可能です。詳細はscript_ref。
	・isloggedinのコンパイル警告がでないように修正
	(map/)
	script.c
		buildin_donpcevent()追加など
	(doc/)
	script_ref.txt
		doevent,donpcevent,OnAgitInit追加など

・その他修正
	(map/)
	clif.c
		clif_parse_GMReqNoChat()追加


--------------------
//0925 by 胡蝶蘭

・スクリプトのバグ修正
	・monster,areamonsterの問題修正
	  これらはscript_rid2sdを使用しないようにしました。
	  sdがNULLのとき、レベルチェックを行わないようにしました。
	
	(map/)
	script.c/mob.c
		buildin_monster(),buildin_areamonster(),mob_once_spawn()他

・スクリプトの機能追加
	・detachrid命令（プレイヤーのデタッチ）追加
	・isloggedin関数（プレイヤーのログインチェック）追加
	・getitem,getitem2命令,countitem,checkweight関数で
	  nameidにアイテムの名前を指定可能に。
	  (item_dbなどに依存するため、使用すべきではありませんが、一応)

	(map/)
	script.c
		色々
	(doc/)
	script_ref.txt
		変更部分とエラー説明修正

・athena-startとstartを修正
	・athena-start stopでプロセスが終了するまで待つように
	・startで再起動させるときathena-start restartを呼ぶように。

--------------------
//0924 by (凸)

・バグ報告スレッド part4 >>66のnpcを取り込み
・同 >>51のguild.cを反映
・同 >>38のatcommand_athena.confへの変更を取り込み
・なぜかnpcフォルダにあってmap_athena.confないファイルを一覧に追加。ついでにギルドフラッグのコメントアウトを解除
・conf/npc/npc_job_1st.txt npc_script2.txt npc_shop3.txtはスナップショットから削除してください

	(map/)
	guild.c 修正
	(conf/)
	map_athena.conf 修正
	atcommand_athena.conf 修正
	(conf/npc/)
	npc_event_hat.txt 修正
	npc_event_oni.txt 修正
	npc_job_1st.txt 削除
	npc_script2.txt 削除
	npc_shop3.txt 削除

--------------------
//0923 by 胡蝶蘭

・スクリプトのバグ修正
・script_rid2sdが失敗してもサーバーを終了しないように変更
	・monster,areamonsterなどが実行できない問題修正

	(map/)
	script.c/mob.c
		buildin_monster()など修正

	(doc/)
	script_ref.txt
		ラベルとエラーの説明修正
	
--------------------
//0922 by 胡蝶蘭

・スクリプトエラーの行番号が正しく表示されるように
	
	(map/)
	itemdb.c / npc.c
		itemdb_readdb(),npc_parse_script()修正

・キャラクター情報にアクセスできない状態でアクセスするとエラーを出すように修正
・goto/menuでラベルが指定される場所にラベル以外が指定されると警告を出すように
・script_refにエラーメッセージの説明追加
・イベント起動されたスクリプトでキャラクターを使用できるようにする関数追加
	・attachrid（指定したIDの情報を使用できるようにする）追加
	・getcharid（3でアカウントIDを所得できるように）修正
	(map/)
	script.c
		script_rid2sd(),buildin_attachrid()追加
		多々修正。
	(doc/)
	script_ref.txt
		エラーメッセージの説明追加、変数/ラベルの説明修正
		他修正

--------------------
//0921 by RR
・スクリプトバグ修正(ご迷惑をおかけしました)
	(conf/npc/)
	npc_event_tougijou.txt

・steal率修正(自DEX - 敵DEX + SLv*3 +10の部分で一度判定をしていたので)
・0918で0914以前に巻き戻ってしまっていた部分を元に戻した
	(map/)
	pc.c
		pc_steal_item() 修正
	itemdb.c
	pet.c
	skill.c 修正

--------------------
//0920 by 獅子o^.^o
・ Steal率 = Drop率 * (自DEX - 敵DEX + SLv*3 +10) /100
	(map/)
	pc.c
		int pc_steal_item()修正

--------------------
//0919 by RR
・atcommandのlvupを使うと取得ステータスポイントがおかしい問題の修正
・バグ修正(バグ報告スレで修正の出たものの取り込み　胡蝶蘭さん、pさん、共にお疲れ様です)
	(map/)
	atcommand.c
		atcommand_baselevelup()修正
	guild.c
		guild_gvg_eliminate_timer()修正
	pc.c
		pc_setreg(),pc_setregstr()修正
	(login/)
	login.c 
		parse_login()修正
--------------------
//0918 by 聖
・item_db自体がオーバーライド可能になったので、class_equip_db.txtの廃止。
・pet_db.txt、produce_db.txtもオーバーライド可能に修正。
	(map/)
	itemdb.c
		do_init_itemdb() 修正。
	pet.c
		read_petdb() 修正。
	skill.c
		skill_readdb() 修正。

--------------------
//0917 by RR
・スクリプト修正
	桃太郎イベントと闘技場イベントをNPCタイマーに変更
	(conf/npc/)
	npc_event_momotarou.txt
	npc_event_tougijou.txt 修正
・スキルツリー修正(バグ報告スレ25より)
	(db/)
	skill_db.txt 修正

--------------------
//0916 by (凸)
・npc_monsterにnpc_mob_jobを統合。npc_mob_job.txtは削除してかまいません

	(conf/)
	map_athena.conf npc_mob_jobを削除
	(conf/mob/)
	npc_monster.txt 更新

--------------------
//0915 by 胡蝶蘭

・NPCタイマー関係の命令追加＆修正他
	・delwaitingroom（NPCチャット終了）引数を見てなかったので修正
	・initnpctimer（NPCタイマー初期化）追加
	・stopnpctimer（NPCタイマー停止）追加
	・startnpctimer（NPCタイマー開始）追加
	・getnpctimer（NPCタイマー情報所得）追加
	・setnpctimer（NPCタイマー値設定）追加

	既存のaddtimerなどはプレイヤー単位のため、NPC単位のタイマーを作りました。
	こちらは、addtimerなどとは違い、OnTimerXXXという風にラベルを指定します。
	詳しくはサンプルとscrit_ref.txtを参照。
	
	(map/)
	map.h
		struct npc_data 修正、struct npc_timerevent_list追加
	npc.c / npc.h
		npc_timerevent(),npc_timerevent_start(),npc_timerevent_stop(),
		npc_gettimerevent_tick(),npc_settimerevent_tick()追加
		npc_parse_script()修正
	script.c
		buildin_*npctimer()追加など
	(conf/sample/)
	npc_test_npctimer.txt
		NPCタイマー使用サンプル
	(doc/)
	script_ref.txt
		NPCタイマー関係の命令/関数追加、定数ラベルの説明修正

・Sageのアーススパイクの所得条件修正
	(db/)
	skill_tree.txt
		アーススパイクの行（サイズミックウェポンをLv1に）

--------------------
//0914 by p
・範囲スキル使用時に解放済みメモリを参照していた問題に対応
・メモリを初期化せずに使用していた領域を、初期化してから使用するように変更
	(common/)
	db.c
	grfio.c
	socket.c
	timer.c
	(char/)
	char.c
	int_guild.c
	int_party.c
	int_pet.c
	int_storage.c
	inter.c
	(login/)
	login.c
	(map/)
	ほとんど.c

--------------------
//0913 by Kalen

・GVGScriptの修正
　911対応
　フラグからアジトへ戻る機能追加
　戻るときに聞かれるように修正(TESTscript)
　砦取得時::OnRecvCastleXXXを発動するように修正
	(conf/gvg/)
	ほとんど.txt

--------------------
//0912 by (凸)
・このファイルの文字化けとTEST_prtg_cas01_AbraiJの文字化けを修正
・バグ報告スレの>>19-20を取り込み
・昔やっちまったbattle_athena.confの誤字の訂正

	(common)
	mmo.h
		#define MAX_STAR 3に修正
	(conf)
	battle_athena.conf
	(conf/gvg/)
	TEST_prtg_cas01_AbraiJ.txt
	(map)
	atcommand.c
		get_atcommandinfo_byname() 修正


--------------------
//0911 by Michael_Huang

	Mounting Emblem of the Flag-NPC.
	(Added Script Command: FlagEmblem).

(conf/gvg/)
	TEST_prtg_cas01_AbraiJ.txt (FlagEmblem Test)

	(map/)
	map.h struct npc_data{}
	clif.c clif_npc0078()
	script.c buildin_flagemblem()

--------------------
//0910 by RR
・スクリプトの間違いを修正
(conf/gvg/)
	ev_agit_payg.txt
	ev_agit_gefg.txt

・ひな祭りに一度入ったらマップ変数が残ったままになるので、マップ変数を使わないよう変更
(一時的マップ変数にすれば問題ないとも言えますが、
town_guideとtown_kafraに時期限定の物が常駐してしまうのが気になったので、
それらをevent_hinamatsuriへ移動し、普段のをdisableしています)
	(conf/npc/)
	npc_event_hinamatsuri
	npc_town_guide
	npc_town_kafra

・スキルリセット時のスキル取得制限判定をスキルポイント48以上消費から、
	スキルポイント58以上消費か残りスキルポイントがJOBLEVELより小さくなったときに変更
・@model時の服色染色制限を緩和(男アサ、ローグのみへ)
	(map/)
	pc.c pc_calc_skilltree()
	atcommand.c atcommand_model()


--------------------
//0909 by 胡蝶蘭

・NPCチャット関係の命令追加
	・waitingroom（NPCチャット作成）修正（イベントを起こす人数を指定可能）
	・delwaitingroom（NPCチャット終了）追加
	・enablewaitingroomevent（NPCチャットイベント有効化）追加
	・disablewaitingroomevent（NPCチャットイベント無効化）追加
	・getwaitingroomstate（NPCチャット状態所得）追加
	・warpwaitingpc（NPCチャットメンバーワープ）修正
	詳しくはscript_ref.txtを参照

	(map/)
	script.c/npc.c/npc.h/chat.c/chat.h/clif.c
		多々修正
	(doc/)
	script_ref.txt
		修正
	(conf/sample/)
	npc_test_chat.txt
		追加命令のテストスクリプト

・スクリプトの間違いを修正
	(conf/npc/)
	npc_event_skillget.txt
	npc_event_yuno.txt
	npc_town_lutie.txt
	npc_turtle.txt
		謎命令additemをgetitemに置換
	npc_town_guide.txt
		謎命令scriptlabelをコメント化
	npc_event_momotaro.txt
	npc_job_swordman.txt
	npc_job_magician.txt
		';'付け忘れ修正
	(conf/gvg/)
	ev_agit_aldeg.txt
		@GID4を@GIDa4に置換
	ev_agit_gefg.txt
	ev_agit_payg.txt
		Annouceに色指定と';'の付け忘れを習性
	

・AthenaDB計画のデータとりこみ、その他修正
	安定しているデータかどうかわかりませんが。

	(db/)
	item_db.txt/mob_db.txt/mob_skill_db.txt
		AthenaDB計画のデータとりこみ
	mob_skill_db.txt.orig
		以前のデータ（コメント部分などの参考に）
	(conf/)
	water_height.txt/mapflag.txt
		AthenaDB計画のデータとりこみ
	map_athena.conf
		npc_monster3*.txtを削除
		追加マップデータ (by ID:UVsq5AE)
	(conf/mob/)
	npc_monster.txt
		AthenaDB計画のデータとりこみ

--------------------
//0908 by 胡蝶蘭

・スクリプトのエラーチェック処理を増やした
	・文字列の途中で改行があるとエラーを出すように。
	・関数呼び出し演算子'('の直前に関数名以外があるとエラーを出すように。
	・命令があるべきところに関数名以外があるとエラーを出すように。
	・命令および関数の引数区切りの','を省略すると警告を出すように。
	・命令および関数の引数の数が異なると警告を出すように。

	(map/)
	script.c
		色々修正

・NPCスクリプト修正
	(conf/npc/)
	npc_town_guide.txt
		４行目はいらないようなのでエラーが出ないようにコメント化
	npc_event_hat.txt
		コモドの仮面職人とフェイヨンの青年 (by ID:dS8kRnc)
	(conf/sample/)
	npc_card_remover.txt
		@menuを使って短くした＆文章少し修正

・その他
	(db/)
	skill_tree.txt
		Sage応急手当

--------------------
//0907 by p
・atcommand() の肥大化がひどいのでリファクタリング
  @ コマンドを追加する場合は、atcommand.h 内で定数を、atcommand.c 内で
  関数定義マクロとマッピングテーブル、処理用の関数を記述してください。
・global 変数の atcommand_config を消去。
  @ コマンド毎のレベルは get_atcommand_level() で取得してください。
・一部のキャラ名を取る @ コマンドで、半角スペースを含む名前のキャラを
  正常に処理できていなかった問題を修正。
  この影響により、@rura+ など、キャラ名がパラメータの途中にあったものは
  全て最後に回されています。
・@ コマンドの文字列を正常に取得できなかった場合に、バッファの内容を
  チェックせずに処理を行おうとしていた部分を修正しました。

	(common/)
	mmo.h
	(map/)
	atcommand.h
	atcommand.c
	clif.h
	clif.c

--------------------
//0906 by Selena
・胡蝶蘭さんの修正にあわせて、バルキリーレルム１以外のスクリプトの修正。
・@コマンド入力ミスの際にエラーメッセージを表示。
	(conf/gvg/)
	ev_agit_aldeg.txt
	ev_agit_gefg.txt
	ev_agit_payg.txt
	ev_agit_prtg.txt
	aldeg_cas01〜05.txt
	gefg_cas01〜05.txt
	payg_cas01〜05.txt
	prtg_cas02〜05.txt
	(map/)
	atcommand.c

--------------------
//0905 by 管理人

・サーバーsnapshot
・前スレのファイル取り忘れた人がいるかもしれないので

--------------------
//0904 by 胡蝶蘭

・スクリプト処理修正
	・char/interサーバーに接続した時にOnCharIfInit/OnInterIfInitイベントが
	  呼ばれるようになりました。
	  OnAgitInitはOnInterIfInitに変更すべきです。
	・getcastledata命令で第２パラメータが0のとき、第３パラメータに
	  イベント名を設定できます。このイベントはギルド城のデータを
	  Interサーバーから所得完了したときに実行されます。
	・起こすNPCイベント名を"::"で始めると、同名ラベルを持つ全NPCのイベント
	  を実行できます。
	  たとえば、getcastledata "prtg_cas01.gat",0,"::OnRecvCastleP01";
	  とすると全てのNPCの OnRecvCastleP01ラベルが実行されます。
	・requestguildinfo命令追加。特定ギルドの情報をInterサーバーに
	  要求できます。第１パラメータはギルドID、第２パラメータはイベント名で
	  このイベントはギルド情報をInterサーバーから所得完了したときに
	  実行されます。
 
	(map/)
	guild.c/guild.h/npc.c/npc.h/script.c/intif.c/chrif.c
		色々修正

・ギルド城関連NPC修正
  （バルキリーレルム１のみ修正。他の城のスクリプトは各自で弄ってください。
    というか、むしろ弄ったらあっぷしましょう）
  	・初期化処理をOnAgitInitでなくOnInterIfInitに変更。
	・城データ所得完了処理としてOnRecvCastleP01を追加。
	・鯖再起動時、ギルド専属カプラが正しく表示されるように。
	・ギルド専属カプラの名前を"カプラ職員::kapra_prtg01"に変更。
	  （"::"以降はエクスポートされる名前で、"::"以前が表示名）
	  "カプラ職員#prt"より名前を長くして競合しにくくするためです。
	  この関係で、disablenpcなどのパラメータを"kapra_prtg01"に修正。
	(conf/gvg/)
	prtg_cas01.txt
		ギルド専属カプラ修正
	ev_agit_prtg.txt
		初期化処理修正（バルキリーレルム１のみ）
	TEST_prtg_cas01_AbraiJ.txt
		ギルド専属カプラ雇用/城破棄修正

・NPCの修正
	(conf/npc/)
	npc_job_swordman.txt
	npc_event_hat.txt
		修正

・アカウントを削除してもアカウントIDを再利用しないように修正
・ギルド/パーティについても一応同等の処理追加（コメント化されています。
  ギルドやパーティはIDを再利用してもおそらく問題ないため）

	(login/)
	login.c
		読み込み/保存処理修正
	(char/)
	int_guild.c/int_party.c
		読み込み/保存処理修正

--------------------
//0903 by 胡蝶蘭

・l14/l15およびプレフィックスlを"推奨されない(deprecated)"機能としました。
	・まだ使用できますが、今後の動作が保障されないので、速やかに代替機能を
	  使用するように移行してください。
	・プレフィックス'l'は代替機能のプレフィックス'@'を使用してください。
	・l15は代替機能の@menuを使用してください。
	・l14は代替機能はありません。input命令の引数を省略しないで下さい。
	・これらの推奨されない機能を使用すると警告メッセージがでます。

	(map/)
	script.c
		parse_simpleexpr()修正
	(conf/warp/)
	npc_warp.txt/npc_warp25.txt/npc_warp30.txt
		変数名l0を@warp0に修正
	(conf/npc/)
	npc_event_hat.txt
		変数名l15を@menuに修正
	(doc/)
	script_ref.txt
		配列変数の説明追加
		変数のプレフィックス'l'、input命令のl14、menu命令のl15の
		説明を修正
	
--------------------
//0902 by 胡蝶蘭

・スクリプトが配列変数に対応。
	・array[number]のように使います。数値型、文字列型両方使えます。
	・使えるプレフィックスは @, $, $@ です。
	  （一時的キャラクター変数、一時的/永続的マップサーバー変数）
	・number==0は配列じゃない変数と値を共有します。
	  （@hoge[0]と@hogeは同じ変数を表す）
	・まだ仮実装段階なのでバグ報告よろしくお願いします。
・マップサーバー変数の読込中にCtrl+Cをするとデータ破損の可能性がある問題を修正.
・マップファイル読み込み画面がさびしいのでせめてファイル名を表示するように。

	(conf/sample/)
	npc_test_array.txt
		配列変数テストスクリプト
	(map/)
	script.c
		buildin_set(),buildin_input(),get_val(),
		parse_simpleexpr()修正
		buildin_getelementofarray()追加
		do_final_script()修正など
	map.c
		map_readmap(),map_readallmap()修正

--------------------
//0901 by ぴざまん

・露店バグの修正

	(map/)
	pc.c
		pc_cartitem_amount() 追加。
	vending.c
		vending_openvending() 修正。
	clif.c
		clif_parse_NpcClicked() 修正。
	pc.h 修正。

--------------------
//0900 by ぴざまん

・アブラカダブラのランダムスキル発動率をabra_db.txtで設定できるように。
・スフィアーマインとバイオプラントの微修正。
・Noreturnマップで蝶が消費だけされるバグ修正。
・一部のアブラ固有スキルが正しく動作しなかったバグ修正。
	(map/)
	mob.c
		mob_damage()、mobskill_use() 修正。
		mob_skillid2skillidx() 追加。
	skill.c
		skill_readdb()、skill_abra_dataset() 修正。
		skill_castend_nodamage_id()、skill_castend_pos2() 修正。
	script.c
		buildin_warp() 修正。

	skill.h 修正。
	map.h 修正。
	(db/)
	abra_db.txt 追加。
	skill_db.txt 修正。

--------------------
//0899 by 胡蝶蘭

・取り巻きMOBの処理修正
	・取り巻き召喚でコアを吐くバグ修正
	・主が別マップに飛ぶと、テレポートで追いかけるように修正
	・取り巻き処理をより軽く変更

	(map/)
	mob.c
		mob_ai_sub_hard_mastersearch()をmob_ai_sub_hard_slavemob()
		に名前を変えて処理修正。
		mob_summonslave()修正

--------------------
//0898 by 胡蝶蘭

・eathenaからCardRemoverNPCの取り込み
	NPCデータも日本語訳してますが、かなり適当です。

	(map/)
	script.c
		buildin_getequipcardcnt(),buildin_successremovecards()
		buildin_failedremovecards()追加
	(conf/sample/)
	npc_card_remover.txt
		カード取り外しNPCの日本語訳
		プロンテラの精錬所の中の左下の部屋にいます

・ポータルで別マップに飛ばしたMOBがそのマップに沸き直すバグ修正
	(map/)
	map.h
		struct mob_dataにmメンバ追加
	mob.c
		mob_spawn(),mob_once_spawn()修正
	npc.c
		npc_parse_mob()修正
	

--------------------
//0897 by ぴざまん

・細かい調整
・ストリップ系とケミカルプロテクション系スキルの全実装
　本鯖での細かい仕様が分ったので実装しました。
　確率は暫定です。

	(map/)
	pc.c
		pc_isequip() 修正
	skill.c
		skill_status_change_start()、skill_castend_nodamage_id() 修正。
		skill_abra_dataset() 修正。
	battle.c
		battle_get_def()、battle_get_atk2() 修正。
		battle_get_vit()、battle_get_int() 修正。
	(db/)
	const.txt 修正。
	skill_db.txt 修正。
	cast_db.txt 修正。

--------------------
//0896 by 胡蝶蘭

・永続的マップ変数機能追加
・マップ変数を文字列型変数としても使用できるようにした
	・今までのプレフィックス $ は永続的になります。
	  一時的マップ変数を使用する場合はプレフィックス $@ を指定してください.

	・永続的/一時的ともに文字列型に対応しています。
	  文字列型のポストフィックスは$です。

	<例> $@hoge 数値型一時マップ変数、$hoge$ 文字列型永続マップ変数
	・永続マップ変数はデフォルトでは save/mapreg.txt に保存されます。
	  これはmap_athena.confのmapreg_txtで設定できます。

・str_dataが再割り当てされるとマップ変数が正常に使用できないバグ修正
	・strdbからnumdbにして、変数名はstr_bufに入れるように。

・map_athena.confのdelnpc,npc:clearが正しく働かないバグ修正

	(map/)
	npc.c
		npc_delsrcfile(),npc_clearsrcfile()修正
	script.c / script.h
		マップ変数系かなり修正
	map.c
		map_read_config()修正など
	(conf/)
	map_athena.conf
		mapreg_txt追加
	(doc/)
	conf_ref.txt
		mapreg_txt,help_txt,motd_txt追加
	script_ref.txt
		文字列型変数の説明修正

--------------------
//0895 by Selena

・mapflagにnozenypenaltyを追加。
　GVGや街中のテロなどで死亡した際に、Zenyペナルティー発生を外す用。

	(map/)
	pc.c
		pc_setrestartvalue() 修正
	script.c
		buildin_setmapflag()、buildin_removemapflag() 修正
	npc.c
		npc_parse_mapflag() 修正
	map.h
		map_data() 修正
	(db/)
	const.txt 修正。

--------------------
//0894 by ぴざまん

・コーマ以外のアブラカダブラ固有スキル全実装。
　オートスペルにはレベルアップ以外多分全部乗せれます。(オートスペルレベルアップは未テスト)
・アブラカダブラ仮実装
　発動スキルがレベル依存じゃありません。
　全ての発動率が理論上均一です。
　アイテムスキルを使って実装しているので一部の使用条件を無視します（ジェム罠気球等）
・アイテムスキルがキャスト・ディレイ無しだったのを修正。

	(map/)
	skill.c
		skill_castend_nodamage_id()、skill_use_id()、skill_use_pos() 修正。
		skill_abra_dataset() 追加。
	(db/)
	skill_db.txt 修正。

--------------------
//0893 by 胡蝶蘭

・他マップからポータルの上にワープしてきたPCがワープしない問題を修正
・チャット中のPCをワープポータルで飛ばすかどうか設定可能に
・MOBをワープポータルで飛ばすかどうか設定可能に
	MOBのワープポータルを許可すると、テロが簡単にできるので注意。

・アカウント変数変更と同時にファイルに書き出すように修正
・マップデータのロード部分のログ表示はあまり重要じゃないと思うので変更。

	(char/)
	inter.c
		mapif_parse_AccReg()でinter_accreg_save()を呼ぶように修正
	(map/)
	mob.c/mob.h
		mob_warp()の引数変更と修正
	battle.c/battle.h
		mob_warp()呼び出しの引数修正
		battle_config関連
	map.c
		map_readallmap(),map_readmap()修正
	pc.c
		pc_setpos()修正
	skill.c
		mob_warp()呼び出しの引数修正
		skill_unit_onplace()修正
	(conf/)
	battle_athena.conf
		chat_warpportal,mob_warpportalの追加
	(doc/)
	conf_ref.txt
		chat_warpportal,mob_warpportalの追加

--------------------
//0892 by 胡蝶蘭

・各種confファイルで別ファイルをインポートできるようにした
	・自分のサーバー用の設定を別ファイルに記述できるようになります。
	・全て「import: ファイル名」形式で記述します。
	・各種confファイル（login,char,map,inter,atcommand,battle）の最後に
	  conf/import/*_conf を読むように指定したので、そこに自分用の設定を
	  書いておけば、変更部分のみオーバーライドします。
	  msg,scriptのconfについては、この限りではありませんが、import命令の
	  処理は追加されているので、自分でimport命令を書けば動きます。
	・新しいスナップショットが出た場合などに、このconf/importフォルダを
	  昔のAthenaからコピーするだけで自分用の設定を適用できるようになります.

・map_athena.confのmapとnpcで追加したファイルを削除できるようにした
	・上に関連する変更です。
	・delmap,delnpc命令を使用すれば、map,npc命令で追加したファイルを
	  読み込まないように指定できます。ここでファイル名ではなく、
	  all と指定するとそれまでに指定されたファイルを全て読み込まなくします.
	・map,npc命令で、ファイル名にclearを指定すると、
	  delmap,delnpcのallと同等の動作をするようになりました。

・login_athena.confのallowとdenyをクリアできるようにｓた
	・allowおよびdeny命令でclearを指定すると以前のホスト情報を全削除します.

	(conf/)
	各種confファイルの最後にimport命令追加
	(conf/import)
	*.txt
		インポートされるファイル。これらに自分用の設定を書くとよい。
	(login/)
	login.c
		login_read_config()修正
	(char/)
	char.c/inter.c
		char_read_config(),inter_read_config()修正
	(map/)
	map.c
		map_read_config(),map_addmap()修正、map_delmap()追加
	npc.c
		npc_addsrcfile()修正,npc_delsrcfile(),npc_clearsrcfile()追加
	battle.c/atcommand.c/script.c
		battle_read_config(),atcommand_read_config(),
		msg_read_config(),script_read_config()修正
	(doc/)
	conf_ref.txt
		修正

--------------------
//0891 by (凸)

・「スキル使用の後は、しばらくお待ちください」を表示するかどうか設定できるようにした。
    ・本鯖相違スレッド　其のⅡ>>5さんのコードをパクリました。
	(doc/)
	conf_ref.txt 修正。
	(conf/)
	battle_athena.conf 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_config_read() 修正。
	clif.c
		clif_skill_fail() 修正。

--------------------
//0890 by 死神

・ギルド倉庫を一度に一人だけが使用するように変更。(未テスト)
・battle_athena.confからplayer_undead_nofreeze 削除。
・@コマンド@gstorage 追加。
・スクリプトguildstorageをguildopenstorageに変更。
・その他細かいバグ修正。
	(doc/)
	conf_ref.txt 修正。
	script_ref.txt 修正。
	(conf/)
	atcommand_athena.conf 修正。
	battle_athena.conf 修正。
	help.txt 修正。
	(conf/sample/)
	gstorage_test.txt 追加。
	(char/)
	makefile 修正。
	int_storage.h 修正。
	int_storage.c
		inter_storage_delete()、inter_guild_storage_delete() 追加。
	int_guild.c
		guild_check_empty()、mapif_parse_BreakGuild() 修正。
	(map/)
	makefile 修正。
	battle.h 修正。
	battle.c
		battle_config_read() 修正。
	guild.c
		guild_broken() 修正。
	storage.h 修正。
	storage.c
		storage_guild_storageopen() 修正。
		storage_delete()、guild_storage_delete() 追加。
	script.c
		buildin_guildstorage() を buildin_guildopenstorage()に変更。
	intif.c
		intif_parse_LoadGuildStorage() 修正。
	mob.c
		mob_summonslave()、mob_damage()、mob_delete() 修正。
		mob_catch_delete()、mob_readdb() 修正。
	skill.c
		skill_castend_nodamage_id()、skill_status_change_start() 修正。
	clif.c
		clif_parse_ActionRequest() 修正。
	atcommand.h 修正。
	atcommand.c
		atcommand() 修正。

--------------------
//0889 by 胡蝶蘭

・文字列型一時的キャラクター変数機能追加。
	・プレフィックス@,ポストフィックス$を使用します。（@hoge$など）
	・inputで文字列変数を指定すると文字列入力になります。
	・関係演算子（比較演算子）で文字列どうしを指定すると文字列の比較が
	  できます。数値と文字列を混ぜて比較することはできません。
	・とりあえずサンプル付けてます。

	(map/)
	map.h
		struct map_session_dataにnpc_str,regstr,regstr_numメンバ追加
	script.c
		buildin_set(),get_val(),buildin_input(),op_2num()など修正
		op_2str(),op_2()追加
	clif.c / clif.h
		01d5パケット長修正
		clif_parse_NpcStringInput(),clif_scriptinputstr()追加
	pc.c / pc.h
		pc_readregstr(),pc_setregstr()追加
	(doc/)
	script_ref.txt
		演算子の説明追加、変数の説明修正、input,menu修正
	(conf/sample/)
	npc_test_str.txt
		文字列変数を使用したスクリプトの例。
		文字列の代入、結合、比較、入力などのテストを行うもの。

--------------------
//0888 by 死神

・設計から間違っていたギルド倉庫修正。(ただ複数人の使用によるバグがある可能性はまだあります。)
・細かいバグ修正。
	(doc/)
	inter_server_packet.txt 修正。
	conf_ref.txt 修正。
	(conf/)
	inter_athena.conf 修正。
	help.txt 修正。
	(common/)
	mmo.h 修正。
	(char/)
	makefile 修正。
	int_storage.h 修正。
	int_storage.c
		account2storage()、inter_storage_init()、storage_fromstr() 修正。
		inter_storage_save()、mapif_load_storage() 修正。
		mapif_parse_SaveStorage() 修正。
		guild_storage_fromstr()、guild_storage_tostr() 追加。
		inter_storage_save_sub()、inter_guild_storage_save_sub() 追加。
		inter_guild_storage_save()、mapif_parse_LoadGuildStorage() 追加。
		mapif_parse_SaveGuildStorage()、mapif_load_guild_storage() 追加。
		mapif_save_guild_storage_ack()、guild2storage() 追加。
	int_party.c
		inter_party_init() 修正。
	int_guild.h 修正。
	int_guild.c
		inter_guild_init() 修正。
		inter_guild_search() 追加。
	int_pet.c
		inter_pet_init() 修正。
	inter.c
		inter_init()、inter_save()、inter_config_read() 修正。
	(map/)
	makefile 修正。
	map.h 修正。
	map.c
		map_quit()、do_init() 修正。
	pc.c
		pc_setpos() 修正。
	storage.h 修正。
	storage.c
		do_init_storage()、do_final_storage()、account2storage() 修正。
		storage_storageopen()、storage_storageadd()、storage_storageget() 修正。
		storage_storageaddfromcart()、storage_storagegettocart() 修正。
		storage_storageclose()、storage_storage_quit() 修正。
		storage_storage_save() 修正。
		guild2storage()、storage_guild_storageopen() 追加。
		guild_storage_additem() 、guild_storage_delitem() 追加。
		storage_guild_storageadd()、storage_guild_storageget() 追加。
		storage_guild_storageaddfromcart()、storage_guild_storagegettocart() 追加。
		storage_guild_storageclose()、storage_guild_storage_quit() 追加。
	intif.h 修正。
	intif.c
		intif_send_storage()、intif_parse_LoadStorage()、intif_parse() 修正。
		intif_request_guild_storage()、intif_send_guild_storage() 追加。
		intif_parse_SaveGuildStorage()、intif_parse_LoadGuildStorage() 追加。
	clif.h 修正。
	clif.c
		clif_additem()、clif_parse_MoveToKafra() 修正。
		clif_parse_MoveFromKafra()、clif_parse_MoveToKafraFromCart() 修正。
		clif_parse_MoveFromKafraToCart()、clif_parse_CloseKafra() 修正。
		clif_parse_LoadEndAck() 修正。
		clif_guildstorageitemlist()、clif_guildstorageequiplist() 追加。
		clif_updateguildstorageamount()、clif_guildstorageitemadded() 追加。
	guild.c
		guild_broken() 修正。
	script.c
		buildin_openstorage()、buildin_guildstorage() 修正。
	skill.c
		skill_castend_nodamage_id() 修正。
	mob.c
		mob_summonslave()、mob_damage() 修正。
	atcommand.c
		atkillmonster_sub()、atcommand() 修正。

--------------------
//0887 by 獅子o^.^o

・(db/)
	skill_tree.txt 修正

--------------------
//0886 by ぴざまん

・サーバーsnapshot
・ファイル調整

--------------------
//0885 by huge

・ギルド共有倉庫の実装。guildstorageで開けます。
    自分の鯖で実験はしてみましたが、過疎地なので多人数ギルドになるとどう動くか分かりません。
    (念のためバックアップは必ず取っておいて下さい)
・areawarpで、対象マップ名を"Random"にすると、同マップ内でランダムに飛ぶように修正。
・GMコマンドで生き返したときにSPも全回復するように修正。
・ディボーションの条件をちょっと修正。

	(char/)
	int_storage.c
		mapif_load_storage() 修正。
		mapif_parse_SaveStorage() 修正。
	inter.c
		inter_send_packet_length[] 修正。
		inter_recv_packet_length[] 修正。
	(map/)
	atcommand.c
		@alive,@raise,@raisemap 修正。
	intif.c
		packet_len_table[] 修正。
		intif_request_storage() 修正。
		intif_send_storage() 修正。
		intif_parse_LoadStorage() 修正。

	map.h
		map_session_data stateにstorage_flag 追加。
	script.c
		buildin_areawarp_sub() 修正。
		buildin_openstorage() 修正。
		buildin_guildstorage() 追加。
	skill.c
		skill_castend_nodamage_id() 修正。
	storage.c
		account2storage() 修正。
		storage_storageopen() 修正。
		storage_storage_save() 修正。

--------------------
//0884 by 死神

・細かいバグ修正。
・battle_athena.confにpet_str、zeny_penalty、resurrection_exp 追加。
・0878の銀行関係のコードはもういらないので全て削除。
・zeny_penaltyを設定して使う場合は手数料はなくした方がいいかも。
・ポーションピッチャーでpercenthealにもPPとLPによる回復ボーナスが付くように変更。(ただvitやint、HPR、MPRによる回復ボーナスが付きません。)
・ほとんど未テスト。
	(common/)
	mmo.h 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	map.c
		do_init()、do_final() 修正。
	script.c
		buildin_openbank() 削除。
		buildin_failedrefitem() 修正。
	storage.h 修正。
	storage.c
		do_init_bank()、do_final_bank()、account2bank() 削除。
		storage_bank()、storage_readbank() 削除。
	skill.c
		skill_castend_nodamage_id()、skill_attack() 修正。
	battle.h 修正。
	battle.c
		battle_calc_pet_weapon_attack()、battle_config_read() 修正。
	pc.c
		pc_setrestartvalue() 修正。
	clif.c
		clif_skill_nodamage()、clif_refine() 修正。
	itemdb.c
		itemdb_isequip3() 修正。
	atcommand.c
		atcommand() 修正。

--------------------
//0883 by Kalen

・Warp色々修正
	・アサシンギルド周り修正(昔のままのリンクだったので現在の状態に修正。)
	・YunoのWarp全面見直し(YumilLoop修正、SageCastleRandomWarp追加、女医さんの家追加)
	・モンクギルド周り追加
・NPC色々修正
	・帽子作成NPCを別ファイルへ。一部追加(ep2.5追加分)
	　参考Data(R.O.M776): ttp://green.sakura.ne.jp/~youc/ro/data/itemmaking.html#04
	・アサシンギルド修正
	・二次職転職関係NPC一部追加(これでコモド小劇場へ行けます)
	・マスターアルケミストの台詞修正
	・アルデバランの案内要員を移動&台詞修正&イメージ追加
	・BBSにあがっていたコモドスクリプト追加(event_hat等へ分散)
	・コンロンクエスト関係NPC一部追加(女医[yuno]、ネル[prontera])
	(conf/warp/)
		npc_warp.txt
		npc_warp30.txt
		npc_warp_job.txt
	(conf/npc/)
		npc_event_hat.txt(新規)
		npc_job_2nd.txt
		npc_job_alchemist.txt
		npc_town_aldebaran.txt
		npc_town_comodo.txt
		npc_town_gonryun.txt
		npc_town_guide.txt
		npc_town_yuno.txt
		npc_town_lutie.txt

--------------------
//0882 by 胡蝶蘭

・スクリプトに0881相当のアカウント共有変数機能のプレフィックス変更
	・0881のアカウント変数はプレフィックス##になりました。
	・0881のアカウント変数は全ワールドで共有されます。
	・変数の個数はmmo.hのACCOUNT_REG2_NUMで定義されています(16)。
・ワールド内のアカウント共有変数機能追加
	・変数名のプレフィックスは#です。
	・変数の個数はmmo.hのACCOUNT_REG_NUMで定義されています(16)。
	・0881の銀行スクリプトはこちらを使用するようになります。
	  よって以前のデータがつかえないのであらかじめ引き出しておいてください.
	・変数データは save/accreg.txt に保存されます。
	  このファイル名は inter_athena.conf で変更可能です。conf_ref.txt参照。

	(common/)
	mmo.h
		ACCOUNT_REG_NUMを16に、ACCOUNT_REG_NUM2追加
		struct mmo_charstatusにaccount_reg2_num,account_reg2メンバ追加
	(login/)
	login.c
		account_regを全てaccount_reg2に置き換え
	(char/)
	char.c
		account_regを全てaccount_reg2に置き換え
	inter.c
		ワールド内アカウント変数機能追加。
		inter_accreg*()追加、accreg_db追加など。
	(map/)
	chrif.c/chrif.h
		account_regを全てaccount_reg2に置き換え
		0881でのバグを修正
	intif.c/intif.h
		ワールド内アカウント変数機能追加。
	pc.c/pc.h
		pc_*accountreg()=>pc_*accountreg2()に。
		pc_setaccountreg(),pc_readaccountreg()追加。
	script.c
		buildin_set(),buildin_get_val(),buildin_input()修正
	(doc/)
	inter_server_packet.txt
		ワールド内アカウント変数関係
	conf_ref.txt
		accreg_txt追加
	
--------------------
//0881 by 胡蝶蘭

・スクリプトにアカウント共有変数機能追加
	・変数名にプレフィックス#を付けることでアカウント共有変数になります。
	・アカウント変数は変更した時点で全サーバーにポストされるので
	  頻繁に書き換えるとサーバー間通信が肥大化します。
	・アカウント変数は変更した時点（そしてそれがlogin鯖に届いた時点）で
	  account.txtに書き出されます。
	・グローバル変数（永続変数）の個数を96に減らし、減った32個分を
	  アカウント変数にしていますが、mmo_charstatusのサイズが
	  16000byteを超えない限り増やすことができます。＜0879の変更を参照
	  変数の個数はmmo.hのACCOUNT_REG_NUMで定義されています。
	・0878の銀行をアカウント変数を使用するように修正
	  bank.txtのデータが使えなくなるのであらかじめ引き出しておいて下さい。
	
	(common/)
	mmo.h
		GLOBAL_REG_NUMを96に、ACCOUNT_REG_NUMを追加
		struct mmo_charstatusにaccount_reg_num,account_regメンバ追加
	(login/)
	login.c
		パケット2728処理追加
	(char/)
	char.c
		パケット2729,2b10処理追加
	(map/)
	chrif.c
		chrif_saveaccountreg(),chrif_accountreg()
		(パケット2b10,2b11処理)追加。
	pc.c/pc.h
		pc_readaccountreg(),pc_setaccountreg()追加
	script.c
		buildin_set(),buildin_get_val(),buildin_input()修正
	(conf/sample/)
	bank_test.txt
		アカウント変数使用版の銀行スクリプト

--------------------
//0880 by 死神

・ポーションピッチャーを正しく実装とちょっと機能拡張。
・ポーションピッチャーでレベル別に使えるアイテムをskill_require_db.txtに設定できるようにしました。ただポーションピッチャーで使えるアイテムはitemheal、percentheal、sc_start、sc_end以外の物が入っていると正しく動作しません。
レベル5までは本鯖に合わせていますが最大レベルを10まで拡張するとレベル6 - マステラの実、7 - ローヤルゼリー、8 - イグドラシルの種、9 - イグドラシルの実、10 - バーサークポーションに設定しています。skill_db.txtを修正すればこれが有効になります。(どこを修正するかもわからない人は諦めることです。) ポーションピッチャーによるアイテム使用は使用条件を無視します。少しはアルケミストに希望ができたかも...(多分無理...)
・battle_athane.confにproduce_item_name_input、produce_potion_name_input、making_arrow_name_input、holywater_name_input 追加。
・パーティ員にだけ使うスキルとギルド員にだけ使うスキルを設定できるように修正。
・その他細かい修正。
	(conf/)
	battle_athane.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	db_ref.txt 修正。
	(db/)
	skill_db.txt 修正。
	skill_require_db.txt 修正。
	(map/)
	map.h 修正。
	skill.h 修正。
	skill.c
		skill_status_change_timer()、skill_attack()、skill_use_id() 修正。
		skill_castend_nodamage_id()、skill_castend_damage_id() 修正。
		skill_castend_id()、skill_castend_pos()、skill_produce_mix() 修正。
		skill_arrow_create()、skill_check_condition() 修正。
		skill_status_change_clear()、skill_readdb() 修正。
	mob.c
		mobskill_use_id()、mob_changestate() 修正。
	pc.c
		pc_itemheal()、pc_percentheal()、pc_calcstatus() 修正。
	battle.h 修正。
	battle.c
		battle_delay_damage()、battle_damage()、battle_heal() 修正。
		battle_get_adelay()、battle_get_amotion() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_weapon_attack()、battle_config_read() 修正。
	clif.c
		clif_skill_fail() 修正。
	script.c
		buildin_sc_start()、buildin_sc_end() 修正。
	makefile 修正。

--------------------
//0879 by 胡蝶蘭

・送信FIFOのバッファオーバーフローの脆弱性の修正
	・2048バイト以上のパケットを送るとき、FIFOが満杯に近ければ
	  バッファオーバーフローによる不正アクセスが起こっていた問題修正。
	・FIFOが満杯に近いときWFIFOSETされたパケットが捨てられていた問題修正。
	・FIFOがオーバーフローする場合、自動的にFIFOを拡張するようにした。
	  （ただし、一度にWFIFOSETするパケットが16384バイト以下と仮定している）
	・「socket: ? wdata expanded to ???? bytes」はFIFOが拡張されたときに
	  でるログだが、エラーではなく、パケットは正しく送信される。
	・「socket: ? wdata lost !!」はパケットが喪失したことを表すログで、
	  エラーであるが64KBを超える超巨大なパケットをWFIFOSETしないと出ない。
	・16384バイトを超えるパケットをWFIFOSETするとエラーメッセージなしに、
	  不正アクセスが起こる可能性があるので、超えないようにすること。
	
	(common/)
	socket.c /socket.h
		WFIFOSET()をマクロから関数に変更
		realloc_fifo()追加
	
・サーバー間通信FIFOのバッファサイズを大きくした
	・大量のデータが通信されたときにデータ処理遅延が起きにくくするため。
	・メモリ使用量が増えた。(ぎりぎりの人は65536に設定すると元通りになる)
	・サーバー間通信のFIFOサイズは mmo.h で定義されている。
	  変更する場合は64KB(65536)以上の値にすること。
	  大きくすると巨大データ受信時の遅延が減るがメモリを多く使う。
	・@kickall時などにデータ送信が激しくなるので変更したが、
	  同時ログイン人数が少ないと増やしても意味は無い。

	(common/)
	mmo.h
		FIFOSIZE_SERVERLINKマクロ追加。
	(login/)
	login.c
		2710パケットでrealloc_fifo()を呼ぶように
	(char/)
	char.c
		2af8パケットでrealloc_fifo()を呼ぶように
		check_connect_login_server()でrealloc_fifo()を呼ぶように
	(map/)
	chrif.c
		check_connect_char_server()でrealloc_fifo()を呼ぶように

--------------------
//0878 by huge

・カプラ銀行サービス。
	自分の鯖で実装してたんですが、意外と好感触だったので出してみます。
	NPCscriptで、openbank(0);で預金額を返して、中に数字を入れると出し入れします。
	詳しくはサンプルを同封したので、それを参照。

	(common/)
	mmo.h
		struct bank 追加。
	(map/)
	map.c
		do_final(),do_init() 修正。
	script.c
		buildin_openbank() 追加。
	storage.c
	storage.h
		グローバル変数追加。
		do_init_bank(),do_final_bank(),account2bank() 追加。
		storage_bank(),storage_readbank() 追加。

--------------------
//0877 by 胡蝶蘭

・login鯖のアクセスコントロールがネットマスク表記に対応
	192.168.0.0/24 や 192.168.0.0/255.255.0.0 といった表記に対応。
・battle_athena.confにGMが無条件で装備品を装備できる＆
  無条件でスキルを使用できる設定追加
	これらはデバグ用なので動作に不都合があるかもしれません。

	(login/)
	login.c
		check_ip()修正,check_ipmask()追加
	(map/)
	battle.c/battle.h
		battle_configにgm_allequip,gm_skilluncond追加
		battle_config_read()修正更
	skill.c
		skill_check_conditio()修正
	pc.c
		pc_isequp()修正
	(doc/)
	conf_ref.txt
		allow変更、gm_all_equipment、gm_skill_unconditional追加

--------------------
//0876 by 死神

・細かいバグ修正。
・@コマンドにテストの為に入れていた物が入っていたので修正。
・ハンマーフォールの射程を5から4に修正(本鯖射程は不明)とリザレクションが無属性だったのを聖属性に修正。
	(db/)
	skill_db.txt 修正。
	(map/)
	mob.c
		mob_catch_delete()、mob_stop_walking() 修正。
	storage.c
		storage_additem() 修正。
	pc.c
		pc_damage()、pc_stop_walking() 修正。
	clif.c
		clif_parse_UseSkillToId()、clif_parse_UseSkillToPos() 修正。
	battle.c
		battle_calc_magic_attack() 修正。
	skill.c
		skill_check_condition() 修正。
	atcommand.c 修正。

--------------------
//0875 by 胡蝶蘭

・party_share_levelをinter_athena.confに移した
  (パーティ関連の処理の管轄がinter鯖のため)
・inter_athena.confにinter_log_file項目追加
・ギルド作成/解散/城占領/城破棄がログに残るように
・ギルド解散時にメモリリークしていた問題を修正
	(char/)
	char.c/char.h
		party_share_level関連
	(inter/)
	inter.c/inter.h
		party_share_level / inter_log_file 関連
		ログ出力用にinter_log()追加
	int_guild.c
		作成/解散/城占領/城破棄をログに出力
		メモリリーク修正
	(doc/)
	conf_ref.txt
		修正

・サーバー状態確認用CGIスクリプト添付など
	・自己責任＆詳細な解説無し、質問されてもスルーする可能性有り
	・エディタで開いたら少し説明有り
	・CGI設置の基本さえわかれば問題ないはず
	
	(tool/cgi/)
	serverstatus.cgi
		サーバー状態確認用CGIスクリプト
	addaccount.cgi
		説明修正

--------------------
//0874 by Kalen
・WhiteDayイベント追加
	conf/npc/npc_event_whiteday.txt(新規)
	 ただ、お菓子売ってるだけみたい…GMがなにやるのかは知りませんが。
	 sakROのほうではホワイトチョコらしきものが追加されたのに
	 jROで追加されたのは雛壇撤去パッチのみ(*´д`;)…

・Alchemistギルドで乳鉢、製造書を変えるように
	conf/npc/npc_job_alchemist.txt(新規)
	 転職クエストが分からなかったので温めていましたが
	 買えないと不便と聞いたので、追加

・染色NPC実装
	conf/npc/npc_event_dye.txt(更新)
	 髪型変更がsakROに来たらしいので
	 なんとなーく更新

--------------------
//0873 by 死神

・@コマンドitem2とkillmonster 追加。
・スクリプトgetitem2とkillmonsterall 追加。
・矢作成で作られた矢も製造者の名前が付くように修正。
・battle_athena.confにmonster_class_change_full_recover追加。
・装備スクリプトにbWeaponComaEleとbWeaponComaRace 追加。
・少し間違いがあったダメージ計算式修正。
・bInfiniteEndureの処理をインデュア表示なしで内部処理するように変更。
・オートスペルでcastend_nodamage_id()を呼ぶスキルも使用できるように修正。
・その他細かい修正とバグ修正。
・ほとんど未テストなのでバグがあったら報告お願いします。
	(conf/)
	help.txt 修正。
	atcommand_athena.conf 修正。
	battle_athena.conf 修正。
	char_athena.conf 修正。
	(db/)
	const.txt 修正。
	item_db.txt 修正。
	(doc/)
	item_bonus.txt 修正。
	script_ref.txt 修正。
	conf_ref.txt 修正。
	(map/)
	map.h 修正。
	map.c
		map_quit() 修正。
	skill.h 修正。
	skill.c
		skill_castend_nodamage_id()、skill_status_change_clear() 修正。
		skill_castend_id()、skill_castend_pos()、skill_arrow_create() 修正。
		skill_status_change_timer() 修正。
	pc.c
		pc_calcstatus()、pc_bonus2()、pc_equipitem() 修正。
		pc_unequipitem()、pc_damage() 修正。
	battle.h 修正。
	battle.c
		battle_get_dmotion()、battle_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_calc_magic_attack()、battle_config_read() 修正。
	clif.c
		clif_parse_LoadEndAck()、clif_damage()、clif_skill_damage() 修正。
		clif_skill_damage2() 修正。
	itemdb.h 修正。
	itemdb.c
		itemdb_isequip3() 追加。
	mob.h 修正。
	mob.c
		mob_delay_item_drop()、mob_damage()、mob_changestate() 修正。
		mob_class_change()、mob_delete()、mob_catch_delete() 修正。
	script.c
		buildin_getitem() 修正。
		buildin_killmonsterall_sub()、buildin_killmonsterall() 追加。
	atcommand.h 修正。
	atcommand.c
		atcommand() 修正。
		atkillmonster_sub() 追加。

--------------------
//0872 by ElFinLazz

・スキルポーションピッチャー修正
・スキルギムソバングドンボルオッネ具現
・スキルアブラカダブなら義コーマ具現
・コーマの武器オプション追加(種族, 千分率)
・オプション説明追加
	(db/)
	const.txt 修正.
	(doc/)
	item_bonus.txt 修正.
	(map/)
	map.h 修正.
	skill.c
		skill_castend_nodamage_id(), skill_unit_group(), skill_status_change_start() 修正.
	pc.c
		pc_calcstatus(), pc_bonus2(), pc_gainexp() 修正.
	battle.c
		battle_weapon_attack() 修正.

--------------------
//0871 by 死神

・0869のバグ修正。
・char_athena.confとlogin_athena.confに項目追加。(キャラ鯖とログイン鯖のログファイルを変えることができるようにしました。デフォルトでlog/フォルダーに入るのでlogフォルダーを作る必要があります。)
・エナジーコートの処理を少し修正。モンスターが使った場合はスキルレベル*6%の物理ダメージを減らすように変更。
・武器以外の物でも製造者の名前を表示するように変更。(本鯖ではプレゼントボックスと手作りチョコレット以外は表示されませんがパケットはあることだし入れてみました。)
・その他スキル関係の細かい修正。
・@コマンド一つとスクリプト一つを追加しましたが説明は後のパッチで書きます。
	(conf/)
	char_athena.conf 修正。
	login_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(login/)
	login.c
		parse_login()、login_config_read()、login_log() 修正。
	(char/)
	char.h 修正。
	char.c
		char_config_read()、make_new_char()、parse_char() 修正。
	int_party.c 修正。
	int_storage.c 修正。
	int_guild.c 修正。
	int_pet.c 修正。
	(map/)
	map.h 修正。
	skill.c
		skill_status_change_start()、skill_additional_effect() 修正。
		skill_castend_nodamage_id()、skill_check_condition() 修正。
		skill_status_change_clear()、skill_produce_mix() 修正。
		skill_status_change_timer() 修正。
	pc.c
		pc_calcstatus()、pc_insert_card()、pc_additem()、pc_cart_additem() 修正。
	storage.c
		storage_additem() 修正。
	battle.c
		battle_get_adelay()、battle_get_amotion()、battle_calc_damage() 修正。
	clif.c
		clif_additem()、clif_equiplist()、clif_storageequiplist() 修正。
		clif_tradeadditem()、clif_storageitemadded()、clif_use_card() 修正。
		clif_cart_additem()、clif_cart_equiplist()、clif_vendinglist() 修正。
		clif_openvending()、clif_arrow_create_list() 修正。
		clif_skill_produce_mix_list()、clif_parse_SelectArrow() 修正。
		clif_parse_ProduceMix() 修正。
	script.c
		buildin_produce() 修正。
		buildin_getitem2() 追加。
	atcommand.c
		atcommand() 修正。

--------------------
//0870 by shuto

・mapflagの攻城戦MAPにnomemo追加
・ギルド宝箱で、宝箱出現と同時にMAP鯖が落ちる問題修正(by ぴざまん)

--------------------
//0869 by 死神

・battle_athena.confにplayer_land_skill_limit、monster_land_skill_limit、party_skill_penaly 追加。
・char_athena.confにparty_share_level 追加。
・その他細かい修正。
	(conf/)
	char_athena.conf 修正。
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(char/)
	char.h 修正。
	char.c
		char_config_read() 修正。
	int_party.c
		party_check_exp_share() 修正。
	(map/)
	map.h 修正。
	skill.c
		skill_attack()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_status_change_start() 修正。
		skill_castend_pos() 修正。
	pc.c
		pc_calcstatus() 修正。
	mob.c
		mobskill_castend_pos() 修正。
	battle.h
	battle.c
		battle_get_adelay()、battle_get_amotion()、battle_calc_damage() 修正。
		battle_config_read() 修正。
	pet.c
		pet_data_init() 修正。

--------------------
//0868 by 死神

・マジックロッド実装とスペルブレイカー修正。
・マジックロッドの場合本鯖で使ってもなんの表示もなく発動の前には使ったかどうかの確認ができないのでスキル詠唱パケット(0x13e)を利用して使用する時スキル名が出るようにしています。(本鯖と違うぞとかで文句がこないように)
・スペルブレイカー詠唱キャンセルに関係なくskill_db.txtに設定されてるskill_typeがmagicのスキルのみ破ることができます。(ラグナゲートの説明を適用)
・skill_db.txtの書式が変わったので注意してください。ノックバック距離の設定もできますが念の為にいっておきますがA鯖でのテストでFWのノックバック距離は2でサンクも2であることを確認しています。韓国の2003年11月19日パッチ前の鯖ではありますが2-2は適用されている所なので本鯖の違いはないと思います。
・その他スキル関係の細かい修正。
・0867で書き忘れ。モンスターのヒールでアンデッドモンスターが攻撃されて自滅するのでヒールやリザの場合mob_skill_db.txtのval1(値1)に1を入れるとアンデッドモンスターも攻撃を受けず回復するようになります。本鯖ではモンスターのヒールはアンデッドに関係なく回復するようです。ただ個人的にはゾンビがヒールして自滅する方が正しいと思うのでmob_skill_db.txtで設定できるようにしております。
	(doc/)
	db_ref.txt 修正。
	(db/)
	cast_db.txt 修正。
	skill_db.txt 修正。
	(map/)
	skill.h 修正。
	skill.c
		skill_status_change_start()、skill_status_change_end() 修正。
		skill_castend_damage_id()、skill_castend_nodamage_id() 修正。
		skill_attack()、skill_status_change_timer()、skill_castcancel() 修正。
		skill_unit_onplace()、skill_use_id()、skill_castend_id() 修正。
		skill_readdb() 修正。
		skill_get_blewcount() 追加。
	mob.c
		mobskill_use_id()、mob_spawn()、mob_attack() 修正。
	battle.c
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_calc_misc_attack()、battle_weapon_attack() 修正。
	clif.c
		clif_damage() 修正。
	pet.c
		pet_attack() 修正。
	pc.c
		pc_attack_timer()、pc_authok() 修正。
		pc_spirit_heal()、pc_natural_heal_sub() 修正。

--------------------
//0867 by 死神

・スキル関係の細かい修正。
・battle_athena.confにplayer_undead_nofreeze追加。
・新しいアイテムパケットに対応。(PACKETVERを5以上にする必要があります。)
・mob_avail.txtでプレイヤーの姿を指定した時ペコペコや鷹を付けることができるように変更。頭下段次にオプションを設定できます。(ただハイディングとクローキングは指定できないようになっています。)
	makefile 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	client_packet.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_config_read() 修正。
	clif.c
		clif_mob_class_change()、clif_spawnmob()、clif_spawnpet() 修正。
		clif_damage()、clif_skill_damage()、clif_skill_damage2() 修正。
		clif_itemlist()、clif_cart_itemlist()、clif_storageitemlist() 修正。
		clif_mob0078()、clif_mob007b()、clif_pet0078()、clif_pet007b() 修正。
	pc.c
		pc_attack_timer() 修正。
	skill.c
		skill_castend_nodamage_id()、skill_additional_effect() 修正。
		skill_status_change_start() 修正。
	mob.h 修正。
	mob.c
		mobskill_castend_id()、mob_getfriendstatus_sub() 修正。
		mob_readdb_mobavail() 修正。

--------------------
//0866 by ぴざまん

・MOTDのメッセージを全て編集できるように変更。
・クローンスキル実装。
　ドル服のヒールアタックによるヒール習得は未テストです。
・ギルド宝箱仮実装。
　ヴァルキリー１のみです。
　商業投資による宝箱個数の算出式は適当です(初期個数4個としか知らないので)。
　Onclockイベントで動作させています。任意の時刻に変更してください。
・AthenaDB計画のmob_db.txtとmapflag.txtを入れておきました。

	(map/)
	pc.c
		pc_makesavestatus()、pc_calc_skilltree() 修正。
		pc_allskillup()、pc_calc_skillpoint() 修正。
		pc_resetskill()、pc_authok() 修正。
	skill.c
		skill_attack() 修正。
	map.h 修正。
	(conf/)
	gvg/TEST_prtg_cas01_AbraiJ.txt 修正。
	motd.txt 修正。
	mapflag.txt 修正。
	(db/)
	mob_db.txt 修正。

--------------------
//0865 by ぴざまん

・自分が占領しているアジトのエンペリウムを攻撃できたバグ修正。
・アブライが占領ギルドメンバー全員をマスターとみなしていたバグ修正。
　この修正に伴ってスクリプトリファレンスに改変があります。
	・getcharid(0)で、自分のcharIDを返すように。
	・getguildmasterid(<n>)追加。
	　<n>=ギルドID
	　該当ギルドのマスターのcharIDを返します。

	(map/)
	guild.c
		guild_mapname2gc() 追加。
	battle.c
		battle_calc_damage() 修正。
	script.c
		buildin_getcharid() 修正。
		buildin_getguildmasterid() 追加。
		ローカルプロトタイプ宣言の一部を修正、追加。
	guild.h 修正。

--------------------
//0864 by 胡蝶蘭

・inter鯖のwisの処理変更
	・自前リンクリストからdb.hで提供されているデータベースを使用するように
	・WISのIDを16ビットから32ビットに増やした（パケットも修正）
	・メッセージのサイズチェックを入れた
	・パケットスキップが二回行われる可能性があるバグ修正
	
	(char/)
	inter.c
		wis関係大幅変更
	(map/)
	intif.c
		wis関係の修正。主にパケット処理。
	(doc/)
	inter_server_packet.txt
		パケット3002,3801を変更

--------------------
//0863 by 死神

・細かい修正。
・battle_athena.confにplayer_attack_direction_change追加。
・mob_skill_db.txtを修正する時挑発の修正を間違って修正。
・モンスターのスキル自爆問題修正。(未テスト)
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(db/)
	mob_skill_db.txt 修正。
	(map/)
	mob.c
		mobskill_use_id()、mobskill_use()、mobskill_castend_id() 修正。
	pc.c
		pc_skill()、pc_attack_timer() 修正。
	skill.c
		skill_castend_damage_id() 修正。
	battle.h 修正。
	battle.c
		battle_weapon_attack()、battle_config_read() 修正。

--------------------
//0862 by 胡蝶蘭

・mobスキル使用条件追加
	・friendhpltmaxrate : 味方のHPが指定％未満のとき(テスト済み)
	・friendstatuson  : 味方が指定したステータス異常になっているとき
	・friendstatusoff : 味方が指定したステータス異常になっていないとき
	・mystatuson  : 自分が指定したステータス異常になっているとき
	・mystatusoff : 自分が指定したステータス異常になっていないとき
	ステータス系は未テストです。mob_skill_db.txtに指定方法を書いています。
	たとえば自分が毒かどうかは mystatus,poison で、
	ハイディング中かどうかは mystatuson,hiding で指定します。
・mobスキル使用ターゲット追加
	・friend : 味方
	・around : 自分の周囲（現在の仕様では周囲81マス）のどれか
	・around1〜around4 : 自分の周囲９,25,49,81マスのどれか(範囲を明示)
	friendは条件がfriend系(friendhpltmaxrateなど)のときに使用可能。
	around系は場所指定スキルで使用可能。

	(map/)
	mob.c / mob.h
		mob_getfriend*()追加、mobskill_use()修正など
	(db/)
	mob_skill_db.txt
		最初の説明のみ修正。データは修正していません。

--------------------
//0861 by いど

・サーバーsnapshot

--------------------
//0860 by J

・死神さんの手下召喚の修正に合わせてMOBスキルDBを修正
(/conf)
	mob_skill_db.txt 修正。

--------------------
//0859 by 獅子o^.^o
Alchemist warp 修正(Aegis参考)
(/conf)
    (/warp)
		npc_warp_job.txt 修正
		
--------------------
//0858 by 死神

・細かい修正。
・MAX_MOBSKILLを24から32に変更。(ただ少しですがまたメモリー使用量が増えます。)
・プロボケーションで取る行動をmob_skill_db.txtのval1(値1)で設定できるように修正。
・手下召喚で複数の種類を設定出切るように修正。(最大5つまで)
・メタモルフォーシスとトランスフォーメーションも複数の種類を設定できるように修正。
	(db/)
	skill_db.txt 修正。
	mob_skill_db.txt 修正。
	(map/)
	skill.c
		skill_castend_damage_id()、skill_castend_nodamage_id() 修正。
	map.h 修正。
	mob.h 修正。
	mob.c
		mob_readskilldb()、mob_summonslave()、mob_class_change() 修正。

--------------------
//0857 by J

・OWN Ragnarokにのっていた情報を元にMOBスキルを修正。
・chase(突撃)が実装されているとのことなので突撃(?)をchaseにかえて
コメントアウトをはずしました。
・死神さんが実装したMOBスキルを使用するモンスターを狩場情報に載ってる情報を元に実装。
	(/conf)
		mob_skill_db.txt

--------------------
//0856 by 死神

・バグ修正と細かい修正。
・battle_athena.confにmonster_attack_direction_change追加。
・battle_athena.confのbasic_skill_checkとカプラの倉庫利用を合わせていましたがいつのまにかなくなったので取り戻し。(basic_skill_checkがnoなら基本機能スキルレベルに関係なく倉庫を使えます。)
・ピアーシングアタックの射程を3セルに変更して近接攻撃として認識するように修正。
・A鯖でのテストでアンデッドの認識を属性によってすることがわかったのでundead_detect_typeのデフォルトを0に変更。
・メタモルフォーシスやトランスフォーメーションで見た目がプレイヤーなら0x1b0パケットを送らないように変更。
・ニューマバグは修正してみましたがスキルユニットの時間による作動仕様はまだ分析が完全じゃないので他の不具合が出てくるかも...
	(conf/)
	battle_athena.conf 修正。
	mapflag.txt 修正。(普通のダンジョンがシーズモードであるはずがないので)
	(conf/npc/)
	npc_town_kafra.txt 修正。
	(db/)
	skill_db.txt 修正。
	(doc/)
	conf_ref.txt 修正。
	script_ref.txt 修正。
	(map/)
	pc.c
		pc_modifybuyvalue()、pc_modifysellvalue() 修正。
	battle.h
	battle.c
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_weapon_attack() 修正。
		battle_config_read() 修正。
	skill.c
		skill_unitsetting()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id() 修正。
	mob.c
		mob_attack() 修正。
	pet.c
		pet_attack() 修正。
	clif.c
		mob_class_change() 修正。

--------------------
//0855 by asong

・メタモルフォーシスでＰＣとして表示するＭＯＢを指定した場合倉落ちするバグを「暫定」修正。
・0x1b0パケでは無く0x7bを使うことで何とかしています。
・使い分けをしたいところですが当方Ｃの知識が無く条件分岐が上手くいきませんでした。
・もしかしたらプパの孵化（羽化？）がおかしくなってるかもしれません。
	(/map)
		clif.c
			mob_class_change() 修正。

--------------------
//0854 by Kalen

・不足していた一次職転職クエスト追加及び、それに伴うWarp、Mob修正)
	(/conf)
	   (/npc)
		npc_job_archer.txt
		npc_job_swordman.txt
		npc_job_thief.txt(台詞修正、点数処理変更)
		npc_job_magician.txt
	   (/warp)
		npc_warp25.txt(一部移動)
		npc_warp.txt(一部移動)
		npc_warp_job.txt(新設)
	   (/mob)
		npc_mob_job.txt
・雛祭りQuest追加及び、それに伴うNPC修正。アマツ行き船で料金を取らなかった問題修正
	(/conf)
		npc_event_hinamatsuri.txt
		npc_town_amatsu.txt
		npc_town_guide.txt
		npc_town_kafra.txt
	雛祭りを有効にするとアマツカプラをWに、
	アルベルタ南カプラを削除にするようにしています。

--------------------
//0853 by 死神

・バグ修正とNPCスキル関係の修正。
・ダークブレスをMISC攻撃に変更。(ただ命中判定有り)
・クリティカルスラッシュ、コンボアタック、ガイデッドアタック、スプラッシュアタック、ブラインドアタック、カースアタック、ペトリファイアタック、ポイズンアタック、サイレンスアタック、スリープアタック、スタンアタック、ランダムアタック、ダークネスアタック、ファイアアタック、グラウンドアタック、ホーリーアタック、ポイズンアタック、テレキネスアタック、ウォーターアタック、ウィンドアタック、マジカルアタック、ブラッドドレイン、メンタルブレイカーはモンスターの武器射程に変更。そしてこれらのスキルをモンスターの攻撃射程によって遠距離攻撃と近距離攻撃になるように変更。
・ピアーシングアタックは武器射程+2に変更。
・エナジードレイン、ハルシネーションは魔法射程に変更。
・ダークブレッシングの射程を4に変更とかかる確率を50+スキルレベル*5%に変更。(一応これも魔法なので少し射程を広くしました。基本魔法射程である8に変えるべきなのかどうかは微妙...)
・ガイデッドアタックはセイフティウォールとニューマを無効にする報告がありましたのでセイフティウォールとニューマが効かないように修正。
・ディフェンダーはエフェクトだけ出るように修正。(スキルの仕様等をわかる方は情報をお願いします。)
・トランスフォーメーション実装。(メタモーフォシスと同じ物だそうです。ただこれは全然関係ない別のモンスターになる物らしいです。ニフルヘイムに使うやつがいるみたいです。)
・Athena雑談スレッド 其の弐の80をscript_ref.txtとして追加とちょっと修正。
	(db/)
	skill_db.txt 修正。
	(doc/)
	script_ref.txt 追加。
	(map/)
	battle.c
		battle_calc_damage()、battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_calc_magic_attack()、battle_calc_misc_attack() 修正。
	skill.c
		castend_damage_id()、castend_nodamage_id()、skill_use_pos() 修正。
	clif.c
		clif_spawnnpc()、clif_parse_Restart()、clif_parse_QuitGame() 修正。
	mob.c
		mobskill_castend_id()、mobskill_castend_pos() 修正。
		mobskill_use_id()、mobskill_use_pos() 修正。

--------------------
//0852 by ぴざまん

・亀島4F・蟻D2F・アマツD1Fをテレポ不可、シーズモードに変更。
・nosaveの引数にSavePointが指定できてなかったので追加。
・PVPのmapflagをmapflag.txtに統合。
	(map/)
	npc.c
		npc_parse_mapflag() 修正。
	(conf/)
		mapflag.txt 修正。
		npc/npc_pvp.txt 修正。

--------------------
//0851 by 胡蝶蘭

・ログイン時の暗号化keyが常に同じという大きな問題があったので修正
・ログイン管理者ログイン(ladminで使用)でパスワードの暗号化に対応
	(login/)
	login.c
		login_session_data作成、暗号化keyをクライアントごとに作成など
	(tool/)
	ladmin
		ver.1.05に。デフォルトでパスワードを暗号化するように。
		暗号化のためにDigest::MD5モジュールを使用します。
		Digest::MD5が無い場合はパスワードの暗号化を行いません。
	(doc/)
	admin_packet.txt
		ログインサーバー管理ログイン部分変更

--------------------
//0850 by 死神

・NPCスキル実装。(ハルシネーション、キーピング、リック、メンタルブレイカー、プロボケーション、バリヤー、ダークブレッシング、ダークブレス)
・スキル自爆の制限はmob_skill_db.txtでやればいいものなので取り戻し。
・battle_athena.confにpet_hungry_friendly_decrease追加。
・ペットの腹が完全に減ると支援攻撃を中止するように変更。
・属性変更スキルが作動しなかった問題修正。
・メンタルブレイカーは10+スキルレベル*5%のSPを減らす。(攻撃は通常武器スキル攻撃)
・リックは必中でSP-100、スタン確率スキルレベル*5%。(ダメージは無し、bNoWeaponDamageで無効)
・プロボケーションはモーションが準備されてないモンスターは入れてもなんの効果もなし。
・ダークブレッシングはかかるとHPが1になる。耐性は魔法防御で適用。
・ダークブレスは500+(スキルレベル-1)*1000+rand(0,1000)のダメージ。回避できるが防御無視で近距離物理攻撃だがセイフティウォールは無視して闇属性攻撃。(本鯖の計算式にあっている可能性はないかも。ただダメージ量と命中補正以外は本鯖合わせ)
・NPCスキルの維持時間は適度に設定。
・モンスターの属性攻撃とガイデッドアタックがセイフティウォールを無視するとの報告を受けたのですが修正するかどうかはちょっと微妙。(スプラッシュアタックもセイフティウォール無視かも)
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(db/)
	cast_db.txt 修正。
	skill_db.txt 修正。
	(map/)
	mob.c
		mob_damage() 修正。
	clif.h 修正。
	clif.c
		clif_skill_estimation()、clif_damage()、clif_skill_damage() 修正。
		clif_skill_damage2()、clif_pet_performance() 修正。
	pet.c
		pet_performance()、pet_target_check()、pet_hungry() 修正。
	skill.h 修正。
	skill.c
		skill_additional_effect()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_status_change_start() 修正。
	battle.h 修正。
	battle.c
		battle_get_def()、battle_get_mdef()、battle_calc_damage() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_config_read() 修正。

--------------------
//0849 by lapis

・街中のテストギルドフラグの表示がおかしかったのを修正。
・ギルドメンバーは旗からアジトに飛べるように修正。
	(conf/gvg)
		TEST_prtg_cas01_AbraiJ.txt 修正。

--------------------
//0848 by huge

・スキル自爆を、HPが全回復している時は使えないよう修正。
・スフィアマイン・バイオプラント・・・ターゲット変更できない...。
・mobにターゲット無視IDを設定できるようにしました。(Gv用mobに使える？)
	(map/)
	map.h 修正。
		mob_dataに int exclusion_src,exclusion_party,exclusion_guild 追加。
	mob.h 修正。
	mob.c
		mob_exclusion_add() 追加。
		mob_exclusion_check() 追加。
		mob_timer_delete() 追加。
		mob_attack() 修正。
		mob_target() 修正。
		mob_ai_sub_hard_activesearch() 修正。
		mob_ai_sub_hard_mastersearch() 修正。
		mob_ai_sub_hard() 修正。
	skill.c
		skill_castend_damage_id() 修正。
		skill_castend_pos2() 修正。

--------------------
//0847 by 死神

・露店バグ修正。
	(map/)
	clif.c
		clif_vendinglist()、clif_openvending() 修正。
	vending.c
		vending_openvending() 修正。
	skill.c
		skill_castend_nodamage_id() 修正。

--------------------
//0846 by 死神

・バグ修正と細かい修正。
・battle_athena.confのenemy_strがペットにも適用するように変更。
・bHPDrainRateとbSPDrainRateでxがマイナスでも作動するように変更。
・PCやNPCの姿をしたモンスターも死ぬと5秒後マップから消えるように変更。
	(map/)
	battle.c
		battle_calc_pet_weapon_attack()、battle_weapon_attack() 修正。
	skill.c
		skill_attack()、skill_castend_damage_id() 修正。
	pc.c
		pc_allskillup() 修正。
	clif.h 修正。
	clif.c
		clif_openvending()、do_init_clif() 修正。
		clif_clearchar_delay()、clif_clearchar_delay_sub() 追加。
	mob.c
		mob_damage() 修正。

--------------------
//0845 by ぽぽぽ

・mob_avail.txtでPCグラフィック(0〜23)を指定したペットが出現したときクライアントエラーがでるのを暫定修正。
・mob_avail.txtでペットにもPCキャラの性別・髪型&色・武器・盾・頭装備を指定できるようにしました。
・MOBのATK計算にSTRを適用するかどうか設定可能にした。
	(map/)
	clif.c
		clif_pet0078()、clif_pet007b()、clif_spawnpet()修正。
	battle.h修正。
	battle.c
		battle_config_read()、battle_calc_mob_weapon_attack()修正。

--------------------
//0844 by ぽぽぽ

・mob_avail.txtでPCグラフィック(0〜23)を指定したMOBが出現したときクライアントエラーがでるのを暫定修正。
・mob_avail.txtでPCキャラの性別・髪型&色・武器・盾・頭装備を指定できるようにしました。
　グラフィックすり替え先IDが0〜23の時だけ有効で、指定方法は
	MOB-ID,グラフィックすり替え先ID,性別(0=female,1=male),髪型,髪色,武器,盾,上段頭装備,中段頭装備,下段頭装備
　となります。装備はitem_dbのView欄参照のこと。
	(map/)
	clif.c
		clif_mob_0078()、clif_mob007b()、clif_spawnmob()修正。
	mob.h修正。
	mob.c
		mob_get_sex()、mob_get_hair()、mob_get_hair_color()、ob_get_weapon()、
		mob_get_shield()、mob_get_head_top()、mob_get_head_mid()、mob_get_head_buttom()追加。
		mob_readdb()、mob_readdb_mobavail()修正。
		
--------------------
//0843 by 死神

・リフレクトシールド実装。
・アイテムスクリプトにbShortWeaponDamageReturnと
bLongWeaponDamageReturn 追加。
・その他スキル関係や他の所修正。
	(db/)
	item_db.txt 修正。
	skill_db.txt 修正。
	cast_db.txt 修正。
	const.txt 修正。
	(doc/)
	item_bonus.txt 修正。
	(map/)
	map.h 修正。
	battle.c
		battle_get_def()、battle_get_def2()、battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_weapon_attack()、battle_calc_magic_attack() 修正。
	pc.c
		pc_calcstatus()、pc_bonus()、pc_bonus2()、pc_equipitem() 修正。
		pc_unequipitem()、pc_checkallowskill() 修正。
	skill.c
		skill_attack()、skill_unit_onplace()、skill_status_change_start() 修正。
		skill_status_change_end()、skill_status_change_timer() 修正。
		skill_castend_nodamage_id() 修正。
	clif.c
		clif_additem()、clif_equiplist()、clif_storageequiplist() 修正。
		clif_tradeadditem()、clif_storageitemadded()、clif_cart_additem() 修正。
		clif_cart_equiplist()、clif_vendinglist()、clif_openvending() 修正。
		clif_damage()、clif_skill_damage()、clif_parse_LoadEndAck() 修正。

--------------------
//0842 by 死神

・スキル関係の修正と細かい修正。
・aegis鯖で色々と検証した物を適用。
・メテオの範囲を7*7、LoV13*13、SG11*11、FN5*5に修正。
・シグナム実装。(ただPVPでプレイヤーにかかるかどうかがわからなかったので
かかる方向で実装。)これで1次職業のスキルはクリアかも...
・装備スクリプトにbHPDrainRateとbSPDrainRate追加。
・その他細かい修正少し。
	(doc/)
	item_bonus.txt 修正。
	(db/)
	cast_db.txt 修正。
	item_db.txt 修正。
	const.txt 修正。
	(map/)
	map.h 修正。
	skill.c
		skill_castend_damage_id()、skill_castend_nodamage_id() 修正。
		skill_unitsetting()、skill_castend_pos2()、skill_castend_id() 修正。
		skill_status_change_start()、skill_status_change_timer() 修正。
		skill_status_change_end()、skill_unit_onplace() 修正。
		skill_frostjoke_scream()、skill_attack() 修正。
		skill_attack_area() 追加。
	battle.c
		battle_calc_magic_attack()、battle_get_element()、battle_get_def() 修正。
		battle_get_def2()、battle_get_mdef()、battle_damage() 修正。
		battle_calc_damage()、battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_weapon_attack() 修正。
	mob.c
		mobskill_castend_id() 修正。
	pc.c
		pc_calcstatus()、pc_bonus2()、pc_attack_timer() 修正。
	clif.c
		clif_spawnmob()、clif_spawnpet()、clif_spawnnpc() 修正。
		clif_parse_ActionRequest() 修正。

--------------------
//0841 by Kalen

・水溶液が作れなかったので追加
	conf/npc/npc_job_magician.txt

--------------------
//0840 by Kalen

・鬼イベント追加
	conf/npc/npc_event_oni.txt

・map_athena.conf修正(バレンタインコメントアウト。鬼追加)
	conf/map_athena.conf

--------------------
//0839 by shuto

・コンロンNPC追加(カン ソンソンが抜けてた)

--------------------
//0838 by 死神

・スキルサイトラッシャー実装。
・モンスターのクローキングとマキシマイズパワーは持続時間をレベル*5秒に変更。
・その他細かいバグ修正。
	(db/)
	skill_db.txt 修正。
	(map/)
	skill.c
		skill_castend_damage_id()、skill_castend_nodamage_id() 修正。
		skill_castend_pos2()、skill_unitsetting()、skill_get_unit_id() 修正。
		skill_status_change_start() 修正。
	battle.c
		battle_calc_magic_attack() 修正。

--------------------
//0837 by 死神

・スキル関係の細かい修正。
・フロストノヴァをユニット設置式に変更。
・ロードオブヴァーミリオンの範囲を11*11に修正と40ヒットするように変更。(ラグナゲートの情報。
13*13説もありますが...)
・ユピテルサンダーのノックバックを2~7に変更。
・ストームガストの攻撃回数をレベル依存から10回に固定。
・サンクチュアリのノックバックを3から2に変更。(aegis鯖でノックバックがあることは確認しましたがどれぐらいなのかが不明だったので少し減らしてみました。)
・モンスターの詠唱時間が早くなっていた問題修正。(dex補正が入ってしまったせいです。)
・その他オートスペル当たりの細かい修正。
	(db/)
	skill_db.txt 修正。
	(map/)
	skill.c
		skill_castfix()、skill_delayfix()、skill_timerskill() 修正。
		skill_castend_pos2()、skill_unitsetting()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_get_unit_id()、skill_attack() 修正。
	battle.c
		battle_calc_magic_attack()、battle_weapon_attack() 修正。

--------------------
//0836 by 釈尊

・モンスターの取り巻き召還の間隔を中ボス以外完全修正。
	(db/)
	mob_skill_db.txt 修正。

--------------------
//0835 by (凸)

・白刃取りでポーズをとるようにした。
(ポーズだけなので、実際に攻撃を受け止めたりはできません)
clif_bladestop()を呼ぶことで白刃取り状態のON、OFFのパケットが送れます。

	(map/)
	clif.h 修正。
	clif,c
		clif_bladestop() 追加
	skill.c
		skill_castend_nodamage_id() 修正。

--------------------
//0834 by 釈尊

・モンスター取り巻き召還の間隔が短すぎるとの事で応急処置。(今回は黄金蟲のみ)
	(db/)
	mob_skill_db.txt 修正。

--------------------
//0833 by (凸)

・memo禁止地域で/memo時の修正。
・ついでにitem_dbを更新。

	(doc/)
	client_packet.txt
		R 0189 更新。
	(db/)
	item_db.txt 最新版へ更新。
	(map/)
	pc.c
		pc_memo() 修正。

--------------------
//0832 by 死神

・コード最適化と細かい修正。
・オートスペルを地面魔法に対応。
・サンダーストームとヘヴンズドライブをユニット設置式に変更。
・ディフェンダーの攻撃速度低下を本鯖にあわせ。
・その他細かい修正。
	(doc/)
	item_bonus.txt 修正。
	(db/)
	skill_require_db.txt 修正。
	cast_db.txt 修正。
	(map/)
	map.h 修正。
	path.c
		calc_index()、path_search() 修正。
	skill.c
		skill_unitsetting()、skill_castend_pos2()、skill_get_unit_id() 修正。
		skill_status_change_timer_sub()、skill_castend_nodamage_id() 修正。
		skill_additional_effect()、skill_frostjoke_scream() 修正。
	pc.c
		pc_calcstatus()、pc_skill()、pc_allskillup() 修正。
	battle.c
		battle_get_speed()、battle_get_adelay()、battle_get_amotion() 修正。
		battle_weapon_attack() 修正。

--------------------
//0831 by 死神

・少し修正。
・オートスペル修正。装備による物とスキルによる物を別々に適用、発動確率修正。
・装備によるオートスペルは指定したレベルより2つ下まで判定をします。つまりレベル5を設定するとレベル3から5まで発動します。
・battle_athana.confのplayer_cloak_check_wall、monster_cloak_check_wallをplayer_cloak_check_type、monster_cloak_check_typeに変更。
・アイテムルート権限時間を本鯖に合わせて修正。
・その他スキル関係の細かい修正。
	(doc/)
	conf_ref.txt 修正。
	db_ref.txt 修正。
	item_bonus.txt 修正。
	(conf/)
	battle_athana.conf 修正。
	(db/)
	item_db.txt 修正。
	(map/)
	map.h
	map.c
		block_free_max、BL_LIST_MAX 修正。
	skill.h 修正。
	skill.c
		skill_additional_effect()、skill_attack()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_unit_onplace() 修正。
		skill_status_change_end()、skill_status_change_start() 修正。
		skill_initunitgroup()、skill_unitsetting()、skill_castfix() 修正。
		skill_delayfix()、skill_autospell()、skill_use_id()、skill_use_pos() 修正。
		skill_check_cloaking()、skill_unit_timer_sub()、skill_check_condition() 修正。
	battle.h 修正。
	battle.c
		battle_damage()、battle_get_agi()、battle_get_speed() 修正。
		battle_get_adelay()、battle_get_amotion()、battle_get_flee() 修正。
		battle_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_config_read() 修正。
	mob.c
		mob_attack()、mob_damage()、mobskill_use_id() 修正。
		mobskill_use_pos()、mob_spawn()、mob_class_change() 修正。
		mob_can_move() 修正。
	pc.c
		pc_attack_timer()、pc_checkweighticon()、pc_calcstatus() 修正。
		pc_damage()、pc_equipitem()、pc_unequipitem() 修正。
		pc_bonus2()、pc_bonus3()、pc_memo()、pc_authok() 修正。
		pc_isUseitem() 修正。
	clif.h 修正。
	clif.c
		clif_changeoption()、clif_parse_LoadEndAck()、clif_autospell() 修正。
		clif_skill_memo() 修正。
		clif_skill_teleportmessage() 追加。
	script.c
		buildin_sc_start() 修正。
	atcommnad.c
		atcommand() 修正。

--------------------
//0830 by huge

・オートスペルで、自分の習得してるレベルよりも高いレベルで
  魔法が発動していたであろう問題を修正。
・オートスペルでも、ちゃんとSPが減るように修正(ど忘れ)
	(map/)
	battle.c
		battle_weapon_attack() 修正。
	skill.c
		skill_autospell() 修正。

--------------------
//0829 by Kalen

・mob_db修正
	自鯖用のと間違ってUPしてしまったようです。
	本来のものに直しました。

--------------------
//0828 by 聖

・サーバのSnapshot
・MVPボス系からバカンスチケットが大量に出ていた問題を修正。
	(common/)
	version.h 修正。
	(db/)
	mob_db.txt 修正。

--------------------
//0827 by J

・固定MOBのはずのメガリスと人面桃樹が歩いていたのを修正。
・闘技場のMOBにスキルを実装。
・パサナとファラオがスキルが設定されていなかったのを実装。
	(db/)
	mob_db.txt 修正。
	mob_skill_db.txt 修正。	

--------------------
//0826 by ぴざまん

・一部の演奏スキルを使うと鯖が落ちるバグ修正。
・クローキング中にスキルを使用でき、
　使用するとクローキングが解除されるように修正。
・Kalenさんのmob_db.txtをまとめました。
	(map/)
	skill.c
		skill_unit_onplace()、skill_unit_onout() 修正。
		skill_status_change_start()、skill_status_change_timer() 修正。
		skill_use_id()、skill_use_pos() 修正。
	(db/)
	mob_db.txt 修正。

--------------------
//0825 by 死神

・細かい修正。(細かいことのわりには修正した所が多いけど...)
・ワープポータルの中に止まった時以外はワープしないように修正。
・battle_athena.confにplayer_skill_nofootset、monster_skill_nofootset 追加。
・NPCをクリックした後露店をクリックして露店を閉じると動けなくなるバグ修正。
ただ露店を閉じる時何のパケットも転送してこないので露店をクリックするとNPCの処理から抜けるようにしました。(本鯖ではNPCの処理が抜けないらしいですがそれ以外方法がなかったのっで。)
・killmonsterのAllで召喚されたモンスターだけ消すように変更。
・ソース最適化やスキル関係の細かい修正多数。
	(doc/)
	conf_ref.txt 修正。
	db_ref.txt 修正。
	(conf/)
	battle_athana.conf 修正。
	atcommnad_athena.conf 修正。
	(db/)
	item_db.txt 修正。
	skill_db.txt 修正。
	(login/)
	parse_fromchar() 修正。
	(map/)
	map.h 修正。
	clif.c
		clif_closevendingboard()、clif_parse_VendingListReq() 修正。
		clif_mob0078()、clif_mob007b()、clif_pet0078()、clif_pet007b() 修正。
	skill.h 修正。
	skill.c
		skill_check_condition()、skill_castend_pos2() 修正。
		skill_castend_damage_id()、skill_castend_nodamage_id() 修正。
		skill_castend_id()、skill_status_change_start()、skill_castfix() 修正。
		skill_delayfix()、skill_check_unit_range_sub() 修正。
		skill_check_unit_range()、skill_castend_pos()、skill_stop_dancing() 修正。
		skill_unit_onplace()、skill_readdb()、skill_timerskill()、skill_blown() 修正。
		skill_check_unit_range2_sub()、skill_check_unit_range2() 追加。
		skill_get_maxcount() 追加。
	mob.c
		mobskill_castend_id()、mobskill_castend_pos()、mob_deleteslave() 修正。
		mob_stop_walking()、mob_walk()、mob_damage() 修正。
	pc.c
		pc_calcstatus()、pc_checkskill()、pc_stop_walking() 修正。
		pc_walk()、pc_damage() 修正。
	npc.c
		npc_touch_areanpc() 修正。
	pet.c
		pet_stop_walking() 修正。
	script.c
		buildin_killmonster()、buildin_killmonster_sub() 修正。
	battle.h
	battle.c
		battle_calc_magic_attack()、battle_get_flee()、battle_get_flee2() 修正。
		battle_get_adelay()、battle_get_amotion()、battle_get_max_hp() 修正。
		battle_get_hit()、battle_get_critical()、battle_get_atk2() 修正。
		battle_damage()、battle_config_read() 修正。
	atcommand.h 修正。
	atcommand.c 修正。

--------------------
//0824 by ぴざまん

・セイフティウォール・ニューマの足元置きができなかった問題修正。
・エンペリウムにヒール等の支援スキルが効いていた問題修正。
・闘技場でモンスターリセットができなかった問題修正。
　killmonsterは"killmonster <mapname>,<eventname>"と記述して
　該当eventnameを持つモンスターを削除しますが
　eventnameにAllと入れると該当MAPの全モンスターを消去するようにしました。

	(map/)
	skill.c
		skill_check_unit_range_sub()、skill_castend_nodamage_id() 修正。
	script.c
		buildin_killmonster()、buildin_killmonster_sub() 修正。
	(conf/npc/)
	npc_event_tougijou.txt 修正。

--------------------
//0823 by Kalen

・闘技場データ揃ったので、完成
	conf/npc/npc_event_tougijou.txt
	ただし、こちらでチェックしたところkillmonsterがうまくいかず、
	失敗、時間切れした場合モンスターリセットが出来ません。
	イベントが設定されているモンスターは処理できないのかと思いましたが
	AgitのほうのエンペのKillmonsterはちゃんと動いてますし…
	原因分かる方お願いします<(_ _)>

・gon_testのmapflag追加
	conf/mapflag.txt

・mob_db更新
	1419〜1491が既存のMobの定義ばかりなので追加しませんでしたが、
	調べた所闘技場のMobのデータであることが分かりました(Dropを弄ったもの)
	本鯖では闇りんごが報告されています。が、こちらはDrop空白で処理しました。
	クライアント上では同名でしたが、区別のため接頭にG_をつけて区別してます。
	mob_skill_dbありがとうございました↓

--------------------
//0822 by ぴざまん

・演奏スキルでの補正をダンサーにも適用。
・サンクチュアリバグ修正。
・KalenさんのMOBスキルデータベースをまとめときました。

	(map/)
	skill.c
		skill_status_change_start()、skill_unit_onplace() 修正。
	battle.c
		battle_get_critical()、battle_get_hit() 修正。
	pc.c
		pc_calcstatus() 修正。

--------------------
//0821 by huge

・オートスペル仮実装。
・timerで判定しようかとも思いましたが、装備の無限オートスペルの為にsc_[].val1で見てマス。
・bonus2 bAutoSpell追加。一応どんなスキルでも指定できるようにしてますが(番号はskill_tree参照)
  skill_castend_damage_idのタイプ以外のスキルを指定しないでください。
  発動確率は、Lv1:50%、Lv2:35%、Lv3:15%、それ以上は 5%固定です。
  あと、スキルレベルも指定できますが、限界を超えた数字を入れると墜ちるかもしれません。
■書き方例：（ファイアボルトLv3の時）bonus2 bAutoSpell 19,3;

	(db/)
	const.txt 修正。
	(map/)
	battle.c
		battle_weapon_attack() 修正。
	clif.h
	clif.c
		packet_len_table 修正。
		clif_autospell() 追加。
		clif_parse_AutoSpell() 追加。
	map.h 修正。
	pc.c
		pc_bonus2() 修正。
		pc_equipitem() 修正。
		pc_unequipitem() 修正。
	skill.h
	skill.c
		skill_castend_nodamage_id() 修正。
		skill_autospell() 追加。
		skill_status_change_end() 修正。
		skill_status_change_start() 修正。
		status_changeの番号テーブル修正。

--------------------
//0820 by ぴざまん

・アドリブのメッセージが入ってなかったので修正
・バードの演奏スキルで楽器の練習や自ステータスの補正が入ってなかったのを修正。
　struct status_changeのvalが3つ必要だったので(val4は予約されてたっぽいので)val5を追加しました
	(map/)
	map.h 修正。
	skill.c
		skill_status_change_start()、skill_castend_nodamage_id() 修正。
		skill_castfix()、skill_delayfix() 修正。
	battle.c
		battle_get_flee()、battle_get_max_hp() 修正。
		battle_get_adelay()、battle_get_amotion() 修正。
		battle_calc_misc_attack() 修正。
	pc.c
		pc_calcstatus() 修正。

--------------------
//0819 by Kalen

・コンロン(NPC、Warp)修正
	conf/npc/npc_town_gonryun.txt(案内員補充)
	conf/npc/npc_event_tougijou.txt
	conf/warp/npc_warp_gonryun.txt(宿2FとD2Fなど)

・MOB修正
	conf/mob/npc_monster30.txt(一反木綿不足追加)
	conf/mob/npc_monster35.txt(コンロンMob追加)

・DB修正
	db/mob_db.txt(コンロン[全て]+ウンバラ[定義]追加。Aspeed等適当です。まぁ無いよりましということで)
	db/mob_skill_db.txt(情報を元にコンロンのMob分追加)
	db/item_db.txt(Athena DB Project 2/19 21:10DL分)

--------------------
//0818 by あゆみ

・テレポートスキルLv1で、選択ウインドウが出てこないバグを修正。
・重量が90％以上の場合でも、一部のスキルが使用可能だったバグを修正。
・@allskillコマンドの修正とか。

	(conf/)
	msg_athena.conf 修正。
	(map/)
	atcommand.c
		atcommand() 修正。
	pc.c
		pc_allskillup() 修正。
	skill.c
		skill_castend_nodamage_id() 修正。
		skill_check_condition() 修正。

--------------------
//0817 by huge

・ディボーションの処理修正
  ・糸の出し方はパケを貰ったのでできましたが、アイコンの方はまだ分からないです。
  ・あと、自分の環境で2人以上に同時に掛けれなかったので、複数人にかけた場合
    多分0の羅列の所に2人目、3人目・・・のIDが入るんじゃないかなぁという予測でやってます。
・ハイディング中、及びクローキング中にダメージを受けると解けるよう修正。

	(map/)
	battle.c
		battle_damage() 修正。
	clif.c
		clif_devotion() 修正。
	pc.c
		pc_walk() 修正。
	skill.c
	skill.h
		skill_castend_nodamage_id() 修正。
		skill_devotion() skill_devotion2() 修正。
		skill_devotion3()skill_devotion_end() 修正。

--------------------
//0816 by ぴざまん
・ファイアーウォール3枚制限実装。
・重ね置き禁止をプレイヤー・モンスターにも適用するように修正。
・寒いジョーク・スクリームのPvP・GvGで、効果が自分にも及ぶバグ修正。
　ついでにPTメンバーには低確率でかかるのも実装。
・寒いジョーク・スクリーム・スピアブーメランのディレイ修正。
　ミュージカルストライク・矢撃ちの詠唱時間修正。
	(map/)
	skill.c
		skill_check_condition()、skill_check_unit_range_sub() 修正。
		skill_check_unit_range()、skill_delunitgroup() 修正。
		skill_castend_pos2()、skill_frostjoke_scream() 修正。
	map.h 修正。
	(db/)
	cast_db.txt 修正。

--------------------
//0815 by 死神

・0814のバグ修正と細かい修正。
・mapflag monster_noteleport、noreturn追加とnoteleportの仕様変更。
noteleportはプレイヤーのハエとテレポート、ワープスキルの制限をするが蝶は制限しないように変更、monster_noteleportはモンスターのテレポートを制限する物でnoreturnは蝶の使用を制限する物です。ただmapflag.txtは修正していません。(noreturnを設定する必要があります。)
・battle_athena.confのplayer_auto_counter_typeとmonster_auto_counter_typeが説明通りに機能しなかった問題修正。
・battle_athena.confにplayer_cloak_check_wall とmonster_cloak_check_wall 追加。
・ボスモンスターの認識をMVP経験とmodeの0x20で行なっていた物をmodeだけにするように変更。(本鯖のイベントモンスターでMVP経験をくれるが状態異常に掛かるやつがあったらしく修正。HPが1億もあって毒じゃないと倒せなかったらしいので...) つまりMVP経験があってもボス扱いではないモンスターを作ることも可能です。
・状態異常に掛かった状態で接続切断ができないように修正。(ただタイマーチェックではなくopt1とopt2をチェックするだけなので見た目が変わる状態異常だけに適用されます。)
・今さらですが昔のyareCVS(2003年9月バージョン)で適用されていたラグを減らす為の処理を入れてみました。どんな効果があるかは自分でもわかりません。(ただ入れてみただけ...)
・シーズモードとPVPで禁止装備が外されても効果が消えないバグ修正。
・その他細かい修正。
・未テストの物もかなりあります。
	(common/)
	socket.c
		connect_client()、make_listen_port()、make_connection() 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_calc_magic_attack()、battle_config_read() 修正。
	skill.c
		skill_unit_onplace()、skill_status_change_timer() 修正。
		skill_castend_nodamage_id()、skill_use_id() 修正。
		skill_check_unit_range_sub()、skill_timerskill() 修正。
		skill_additional_effect()、skill_attack()、skill_status_change_start() 修正。
		skill_check_cloaking() 修正。
	clif.c
		clif_item_identify_list()、clif_parse_QuitGame()、clif_GM_kick() 修正。
	pc.c
		pc_attack_timer()、pc_isUseitem()、pc_checkitem 修正。
	mob.c
		mob_warp()、mob_walk()、mob_attack()、mob_target() 修正。
		mob_ai_sub_hard_activesearch()、mob_ai_sub_hard_mastersearch() 修正。
		mob_ai_sub_lazy()、mob_damage() 修正。
	npc.c
		npc_parse_mapflag() 修正。
	map.h 修正。

--------------------
//0814 by 死神

・バグ修正と細かい修正。
・battle_athena.confのplayer_auto_counter_typeとmonster_auto_counter_typeの仕様を変更。(本鯖ではスキル反撃はできないみたいなので設定できるように変更。)
・毒と石化によるHP減少を本鯖に合わせて修正と完全石化の前では動けるように変更。(毒は1秒に3+最大HPの1.5%(モンスターは0.5%)、石化は5秒に1%) 未テスト
・MVP経験値は本鯖でいつも入るようになったので修正。
・スティールの確率を少し下げ。
・モンスターのハイディング、クローキング、マキシマイズパワーがすぐに解除される問題修正。(モンスターにはSPがないせいです。取り敢えずクローキングはハイディングの時間を適用してマキシマイズパワーはウエポンパーフェクションの時間を適用します。) 未テスト
・サンクチュアリを人数から回数に変更。
・PVPで自分のトラップに攻撃対象になるように変更。
・vitペナルティの適用で乗算防御も減るように変更。(未テスト)
・その他細かいバグ修正。
	(conf/)
	battle_athena.conf
	(doc/)
	conf_ref.txt
	(db/)
	skill_db.txt
	(map/)
	map.h 修正。
	script.c
		buildin_itemskill() 修正。
	mob.c
		mob_can_move()、mob_ai_sub_hard()、mob_damage() 修正。
	skill.c
		skill_unitsetting()、skill_unit_onplace()、skill_castend_nodamage_id() 修正。
		skill_attack()、skill_status_change_start() 修正。
		skill_status_change_timer()、skill_status_change_timer_sub() 修正。
		skill_addtimerskill()、skill_cleartimerskill() 修正。
		skill_check_unit_range_sub() 修正。
	battle.c
		battle_calc_damage()、battle_check_target() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack() 修正。
	pc.c
		pc_steal_item() 修正。
	clif.c
		clif_parse_WalkToXY()、clif_closevendingboard() 修正。

--------------------
//0813 by Kalen
・コンロンNPC追加
	conf/npc/npc_town_gonryun.txt(クエストは不明
	conf/npc/npc_town_kafra.txt
	conf/npc/npc_town_guide.txt
	(conf/npc/npc_event_tougijou.txt)データ不足

・全GvGMAPのMobデータ追加
	conf/mob/npc_monster_gvg.txt

・TESTmobからテストギルドフラグ移動
	conf/gvg/TEST_prtg_cas01_AbraiJ.txt

--------------------
//0812 by huge

・ディボーションの仮実装
  ・パケットが全然分かりませんでしたので、
    青い糸も出ないし、アイコンすら表示できません。
  ・ダメ移動だけで、ノックバック・オートガードは適応されません。

	(map/)
	clif.c
	clif.h
		clif_devotion() 追加。
	skill.c
		skill_castend_nodamage_id() 修正。
		skill_devotion() skill_devotion2() 追加。
		skill_devotion3() skill_devotion_end() 追加。
		skill_status_change_end() 修正。
		skill_status_change_start() 修正。
		skill_brandishspear_first() 修正。
		skill_brandishspear_dir() 修正。
	pc.c
		pc_authok() 修正。
		pc_walk() 修正。
		pc_damage() 修正。
	battle.c
		battle_damage() 修正。
	map.h
		map_session_data{}
			 struct square dev 追加。
	skill.h のbrandishをsquareに改名し、
	(common/) mmo.h に移動

--------------------
//0811 by ぴざまん

・攻城中は蝶が使えるように修正
・寒いジョーク・スクリーム実装(PTメンバーに低確率で云々は未実装です)
・GVGスクリプトを修正(試行錯誤しすぎてどこをどうしたか覚えてません…)
　GVGスクリプトに関してですが、既知のバグがあります
　それは、占領ギルドマスター以外のPCが、占領ギルドマスターより先にNPCに話し掛けると
　マップサーバが落ちるというものです。
　これは、getguildmaster・getguildnameを使用しているスクリプトすべてに起こり得ることであり
　先に占領ギルドマスター以外で話し掛けると、guild_searchが何故か(該当IDのギルドがあるにも関わらず)
　NULLを返す事に起因します。
　正直スクリプト関係はよくわかっていないので、これは私の技術では修正のしようがありません。
　暫定的な対処としてNULLを返してMAP鯖が落ちるくらいなら文字列「null」を返すようにしました。

	(map/)
	skill.c
		skill_frostjoke_scream() 追加。
		skill_additional_effect()、skill_timerskill() 修正。
		skill_castend_nodamage_id() 修正。
	pc.c
		pc_isUseitem() 修正。
	script.c
		buildin_getpartyname()、buildin_getguildname() 修正。
		buildin_getguildmaster() 修正。
	(db/)
	cast_db.txt 修正。
	(conf/gvg/)
	ev_*.txt以外のtxt全てを修正。

--------------------
//0810 by 聖

・MVPの処理を変更。(確率で10000があっても、他のアイテムも出るようにしました)
・MVPで装備を入手した場合、鑑定済みで入手していた問題を修正。
・スキル詠唱中にイグ葉や拡大鏡を使うとプレーヤーの使用可能な
　全スキルのLVが1に固定されてしまう問題を修正。
・オークアーチャー等、モンスターによる罠スキルの有効期限が切れたときに、
　設置用トラップが出る問題を修正。
・ログインエラー(パスワード入力ミスやBAN等)のエラーメッセージが
　正しくクライアントに通知されない問題を修正。
・その他細かな修正。
	(common/)
	version.h 修正。
	(login/)
	login.c
		parse_login() 修正。
		parse_fromchar() 修正。
	(char/)
	int_guild.c
		mapif_parse_GuildLeave() 修正。
	(map/)
	itemdb.c
		itemdb_read_itemnametable() 修正。
	atcommand.c
		atcommand() 修正。
	skill.c
		skill_unit_timer_sub() 修正。
	script.c
		buildin_itemskill() 修正。
	mob.c
		mob_damage() 修正。

--------------------
//0809 by Kalen

・東湖城ワープポイント修正
・アマツ寿司屋修正
・バグスレ129の問題修正？


--------------------
//0808 by ぴざまん

・装備制限が上手く動作していなかったのを修正。
・モンハウギルドはGvG開始時に作られるように変更。
・GvG開始時に該当マップにいる全PC(占領ギルド員以外)をセーブポイントに戻すように修正。
・モンハウギルドアジトでエンペを壊すと、モンハウが消えるように修正。
　この修正に伴ってmaprespawnguildidの引数のflagの仕様を変更しました
　flagはビットフラグになり、
　　1ビット目：占領ギルド員をセーブポイントに戻すか
　　2ビット目：占領ギルド員以外をセーブポイントに戻すか
　　3ビット目：エンペ・ガーディアン以外のMOBを消すか
　いずれも、0=NO、1=YESになります

	(conf/gvg/)
	ev_agit_aldeg.txt 修正。
	ev_agit_gefg.txt 修正。
	ev_agit_payg.txt 修正。
	ev_agit_prtg.txt 修正。
	TEST_prtg_cas01_AbraiJ.txt 修正。
	TEST_prtg_cas01_mob.txt 修正。
	(map/)
	pc.c
		pc_checkitem() 修正。
	script.c
		buildin_maprespawnguildid_sub() 修正。
		buildin_maprespawnguildid() 修正。

--------------------
//0807 by 死神

・0805でFD_SETSIZEを修正する所を間違ったので修正しました。56名止まりが治ると言う保証はありませんが...
・一度に転送するパケットの長さを32768bytesから65536bytesに変更。
	(common/)
	mmo.h 修正。
	socket.h 修正。
	socket.c 修正。

--------------------
//0806 by Kalen

・agitフォルダ→gvgフォルダへ移行
	諸意見あると思いますが、jROでは攻城戦をgvgと呼ぶことが一般的なのでこちらに統合します。
	conf/gvg/
	###agitフォルダを削除してください###　(Please delete the "agit" folder.)
	getmaster対応

・アマツの寿司屋バグ修正と項目追加(thx 114
	conf/npc/npc_town_amatsu.txt

・map_flag再修正
	conf/map_flag.txt
	[GVGMAP]確かに常にシーズモードなら問題ないですが、削除されましたので
	常にシーズモードではありません。従って解除時(時間外)には枝、テレポが使えます
	時間前に枝撒き、まだ実装してませんが宝箱奪取も可能になるので枝、テレポは常に使用不可で問題ないと思います。

後前回書き忘れましたが、momotaroイベントですが、ちょっと不安定な可能性があります。
原因がわからないのですが、ループしてるかもしれません。一応コメントアウトしてあります

--------------------
//0805 by 死神

・文字化け修正。
・シーズモードでのテレポート禁止や古木の枝使用禁止はソースレベルで
処理しているのでmapflag.txtから削除。(因みにnopenaltyもソースレベルで
処理しています。)
・battle_athena.confのagit_eliminate_timeをgvg_eliminate_timeに変更。
・@コマンド@GM削除。
・FD_SETSIZEかcygwinで64に設定されていたのせいで最大接続人数が56名を
越えるとマップ鯖が無限ループする問題修正。(ただテストができなかった物なので本当に大丈夫になったかどうかは不明です。あくまでも自分の予測にすぎない物ですが...)
・文字化けのせいでどこをどう修正したか覚えてないので修正したファイルだけ。
	(conf/)
	atcommand_athena.conf
	battle_athena.conf
	mapflag.txt
	(db/)
	castle_db.txt
	(doc/)
	conf_ref.txt
	(common/)
	mmo.h
	(login/)
	login.c
	(char/)
	inter.c
	int_guild.c
	(map/)
	atcommand.h
	atcommand.c
	battle.h
	battle.c
	chrif.c
	guild.h
	guild.c
	intif.h
	intif.c
	map.h
	map.c
	mob.c
	npc.c
	npc.h
	script.c
	skill.c
	pc.c
	makefile

--------------------
//0804 by 釈尊

・アルベルタのぬいぐるみイベントでうさぎのぬいぐるみをあげるとサーバーが落ちるバグ修正

	(conf/npc/)
	npc_event_doll.txt 修正。

--------------------
//0803 by ぴざまん

	GvGでエンペリウム崩壊時gvg_eliminate_timeの値に関わらず即座に退去させられていたバグ修正
	GvGのセリフを一部修正
	inter鯖でcastle.txtがないと起こる色々なエラーを修正
	help.txtを修正(@gvgstart→@agitstart云々)

	(conf/)
	gvg/TEST_prtg_cas01_AbraiJ.txt 修正。
	agit/ev_agit_prtgJ.txt 修正。
	help.txt 修正。
	(map/)
	int_guild.c
		inter_guild_init() 修正。

--------------------
//0802 by Michael_Huang

  Added NPC Script - 'GetGuildMaster' Command.
	(common/)
	version.h
		Mod_Version 0802
	(map/)
	script.c
		buildin_getguildmaster_sub() buildin_getguildmaster()

--------------------
//0801 by Kalen
・アマツ修正
　　実装前のデータ、抜けてるデータなどを調査し修正
	conf/npc/npc_town_guide.txt
	conf/npc/npc_town_amatsu.txt
	conf/npc/npc_event_momotaro.txt
	conf/npc/npc_event_alchemist.txt
	conf/mob/npc_monster35.txt
	conf/warp/npc_warp_amatsu.txt
・map_flag修正
	[GVGMAP]枝、テレポは常に使用不可
・GVG関係
	0800のコマンドに対応

--------------------
//0800 by Michael_Huang

  Added Agit NPC Script & Command.
  Fix FreeBSD GCC compatibility.
  Attachment Agit Demo NPCs. 

	(char/)
	int_guild.c
		mapif_guild_castle_dataload() mapif_guild_castle_datasave()
		int mapif_parse_GuildCastleDataLoad() int mapif_parse_GuildCastleDataSave()
		inter_guild_parse_frommap() inter_guildcastle_tostr() inter_guildcastle_fromstr()
	inter.c
		inter_send_packet_length[] inter_recv_packet_length[]
	(common/)
	mmo.h
		GLOBAL_REG_NUM, struct global_reg {}
	version.h
		Mod_Version 0799.
	(conf/)
	atcommand_athena.conf
		agitstart: 1,agitend: 1
	battle_athena.conf
		agit_eliminate_time: 7000
	map_athena.conf
		conf/agit/ev_agit_*.txt
	(doc/)
	conf_ref.txt
		battle_athena.cnf
	agitdb_ref.txt
	(login/)
	login.c
		parse_login()
	(map/)
	atcommand.h
		agitster, agitend

	atcommand.c
		@agitstart, @agitend
	battle.h
		battle_config.agit_eliminate_time
	battle.c
		battle_config_read()
	chrif.c
		chrif_changedsex() chrif_connectack()
	guild.h
		guild_agit_start() guild_agit_end() guild_agit_break()
	guild.c
		guild_read_castledb() do_init_guild()
		guild_agit_start() guild_agit_end() guild_agit_eliminate_timer() guild_agit_break()
	intif.h
		intif_guild_castle_dataload() intif_guild_castle_datasave()
	intif.c
		packet_len_table[] intif_guild_castle_dataload() intif_guild_castle_datasave()
		intif_parse_GuildCastleDataLoad() intif_parse_GuildCastleDataSave() intif_parse()
	map.h
		agit_flag
	map.c
		agit_flag
	npc.h
		npc_event_doall() npc_event_do()
	npc.c
		npc_event_do_sub() npc_event_do()
	script.c
		buildin_maprespawnguildid() buildin_agitstart() buildin_agitend()
		buildin_getcastlename() buildin_getcastledata()	buildin_setcastledata()
	skill.c
		skill_unit_onplace()
		skill_gangster_count()

--------------------
//0799 by ぴざまん

・GvG実装の為にinter-map間の通信仕様変更
・0798のコンパイルエラー修正(byバグ報告スレ82氏)
	(login/)
	login.c
		parse_login() 修正。
	(map/)
	intif.c
		packet_len_table[] 修正。
		intif_parse_GuildCastleInfo() 修正。
		intif_parse_GuildCastleChange()をintif_parse_GuildCastleChangeErr()に改名・修正。
		intif_parse() 修正。
	guild.c
		guild_read_castledb() 修正。

	(char/)
	inter.c
		inter_send_packet_length[] 修正。
	int_guild.c
		inter_guildcastle_tostr() 修正。
		inter_guildcastle_fromstr() 修正。
		mapif_parse_GuildChangeCastle() 修正。
		mapif_parse_GuildCastleInfo() 修正。
		mapif_guild_castle_info() 修正。
		mapif_guild_change_castle()をmapif_guild_change_castle_err()に改名・修正。
	(common/)
	mmo.h 修正。
	version.h 修正。

--------------------
//0798 by 胡蝶蘭

・login-serverのログイン失敗パケットの長さがおかしかったのを修正
・login-serverにアクセスコントロール機能追加
	・login_athena.cnfにorder,allow,denyを記述することで、
	  IP単位(前方一致)でアクセスを禁止する機能。
	・指定方法は doc/conf_ref.txt を参照
	
	(doc/)
	conf_ref.txt
		login_athena.cnfの部分修正
	(login/)
	login.c
		グローバル変数 access_* 追加
		parse_login()修正,check_ip()追加

・アカウント作成用CGIスクリプト追加
	・自己責任＆詳細な解説無し、質問されてもスルーする可能性有り
	・エディタで開いたら少し説明有り
	・CGI設置の基本さえわかれば問題ないはず
	・メッセージは英語、日本語両対応
	  （Accept-Languageがjaなら日本語に変換します）
	・管理者パスワードなしで動くのでセキュリティには注意(.htaccessなど推奨)

	(tool/cgi/)
	addaccount.cgi
		アカウント作成用CGI。

・その他
	(tool/)
	backup
		castle.txtもバックアップするように

--------------------
//0797 by 死神

・少し修正。
・battle_athena.confの項目変更。(lootitem_time 削除、item_first_get_time、
item_second_get_time、item_third_get_time、mvp_item_first_get_time、
mvp_item_second_get_time、mvp_item_third_get_time 追加。)
・アイテムルート権限を正しく実装。最初攻撃ではなく与えたダメージの
量によって収得権限を与えるように変更。(最初収得権限のみテスト)
パーティの場合パーティの設定に合わせる必要がありますがまだパケットが
不明な所がある為同じパーティなら収得できるようになっています。
・ボウリングバッシュのバグ修正。(多分修正されたはず...)
・装備スクリプトbonusにbSplashRangeとbSplashAddRange追加。
bSplashRangeとbSplashAddRangeは武器でダメージを与えた時のみ発動、通常の武器攻撃扱いなので避けられるが(Flee2による完全回避は不可能)クリは出ないようになっていて武器による状態異常は発生しません。本鯖仕様なんて知りません。
・スキルの重ね置き処理を本鯖に合わせて修正。
・mapflagのgvgはいつもなっているわけじゃないので削除。
・その他細かい修正。
	athena-start 修正。
	(common/)
	mmo.h 修正。
	(conf/)
	mapflag.txt 修正。
	battle_athena.conf 修正。
	(db/)
	const.txt 修正。
	item_db.txt 修正。
	(doc/)
	conf_ref.txt 修正。
	item_bonus.txt 修正。
	(map/)
	mob.c
		mob_spawn()、mob_damage()、mob_class_change()、mob_warp() 修正。
		mob_delay_item_drop()、mob_delay_item_drop2() 修正。
		mobskill_castend_pos() 修正。
	pc.c
		pc_takeitem()、pc_dropitem()、pc_equipitem() 修正。
		pc_calcstatus()、pc_bonus() 修正。
	skill.c
		skill_attack()、skill_additional_effect()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_produce_mix() 修正。
		skill_arrow_create()、skill_unit_timer_sub()、skill_castend_pos() 修正。
	map.h 修正。
	map.c
		map_addflooritem() 修正。
	script.c
		buildin_getitem() 修正。
	pet.c
		pet_return_egg()、pet_get_egg()、pet_unequipitem() 修正。
	battle.h 修正。
	battle.c
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack() 修正。
		battle_weapon_attack()、battle_config_read() 修正。

--------------------
//0796 by huge

・細かい修正
	(conf/npc/)
	npc_event_valentine.txt 修正。

	(map/)
	pc.c
		pc_takeitem() 修正。
	skill.c
		skill_unit_timer_sub() 修正。

--------------------
//0795 by Kalen

・雑談341のnpc_warp_niflheim.txt追加
	conf/warp/npc_warp_niflheim.txt

・mapflag.txt修正(GVGMAP設定)
	　nosaveはしていません

・map_athena.confの修正
	　umbala niflheim等の追加
	　コメントアウトしてあります。

・バレンタインスクリプト追加
	conf/npc/npc_event_valentine.txt
	　チョコ達のDropは弄っていません。お好みでどうぞ
	　尚、手作りチョコを食べたときのエフェクトは
	　最新クライアントにすれば見えます。

・GVGScript追加
	conf/gvg/以下
	　Weiss時代に作成したものをAthena用にコンバート&台詞修正
	　prtg_cas01以外は旗のみです。
	　GVGDATAは鯖再起動で消滅します。
	　エラーが出るようならコメントアウトしてください。
	　MobData、執事Scriptもprtg_cas01のみです。(TestScript)
	　あくまでテストスクリプトです。GVG実装の参考にどうぞ

--------------------
//0794 by DRG

・skillusedで指定したIW,QMなどにのってる間MOBスキルを使用するように変更
・アップスレ３の7のathena-startを一応含めときました

	athena-start
	(map/)
	skill.c
		skill_unit_onplace() 修正。

--------------------
//0793 by huge

・サーバーsnapshot
・サーバーがクラッシュするバグを修正
・発動せずに罠が消えたら、設置用トラップが返ってくるように修正。
・ルート権限で、同じパーティーのキャラはすぐ拾えるように修正。
・バグ報告スレ３ >>54 のバグ修正。
・ログイン時にサーバー側にIDを表示するようにしました。
	(login/)
	login.c
		parse_login() 修正。
	(conf/npc/)
		npc_event_doll.txt 修正。
	(map/)
	skill.c
		skill_unit_timer_sub() 修正。
	mob.c
		mob_spawn_dataset() 修正。
		mob_damage() 修正。
	pc.c
		pc_additem() 修正。

--------------------
//0791 by 聖

・マップサーバがクラッシュするバグ修正。
・イグ葉を使ってもジェムが必要になる問題を修正。
・PvP強制送還実装。
・PvPでリザレクションが出来なかった問題を修正。
・その他細かな修正。
	(map/)
	guild.c
	mob.c
	pc.c
	skill.c

--------------------
//0790 by 死神

・バグ修正。
	(conf/)
	battle_athena.conf 誤字修正。
	(doc/)
	conf_ref.txt 誤字修正。
	(common/)
	mmo.h 修正。
	(map/)
	itemdb.h 修正。
	map.h 修正。
	skill.c
		skill_check_condition()、skill_use_pos()、skill_unit_onplace() 修正。

--------------------
//0789 by huge

・ドロップアイテムにルート権限を実装。
・最初に攻撃した人以外がドロップアイテムを拾えるまでの時間を設定できるように。
	(/conf)
	battle_athena.conf 項目追加。

	(/doc)
	conf_doc.txt 説明追加。

	(/map)
	battle.h
		Battle_Config{} 修正。
	battle.c
		battle_config_read() 修正。
	itemdb.h
		item_data {} 修正。
	map.h
		flooritem_data {} 修正。
		mob_data {} 修正。
	map.c
		map_addflooritem() 修正。
	mob.c
		delay_item_drop{} 修正。
		mob_spawn() 修正。
		mob_damage() 修正。
		mob_delay_item_drop() 修正。
		mob_warp() 修正。
	pc.c
		pc_takeitem() 修正。

--------------------
//0788 by あゆみ

・cardスキルの処理？を修正。
・@allskillコマンドの再修正。

	(map/)
	pc.c
		pc_skill() 修正。
		pc_allskillup() 修正。

--------------------
//0787 by ぽぽぽ

・ペットにもmob_avail.txtの設定を適用するようにした。
・MOBスキルのskillusedでval1に0を入れるとあらゆるスキルに対して発動するようにした。
・skillusedで発動したスキルの対象を、発動させたPCにするかどうか設定できるようにした(対IWハメなど？)。
	(/map)
	clif.c
		clif_pet0078()、clif_pet007b()修正。
	mob.c
		mobskill_use()修正。
	skill.c
		skill_attack() 、skill_castend_damage_id()修正。
	battle.h
	battle.c
		battle_config_read()修正。

--------------------
//0786 by huge

・BDS修正
    前から吹き飛ばして行くと良くないかもしれないので、後ろから処理
    有効範囲の修正

	(/map)

	skill.h
	skill.c
		skill_castend_damage_id() 修正。
		skill_castend_nodamage_id() 修正。
		skill_brandishspear_first() 修正。
		skill_brandishspear_dir() 修正。

--------------------
//0785 by 死神

・本鯖に合わせて修正。(韓国鞍のパッチnoticeを参考して修正しました。)
・BBとBSのキャスティング時間を0.7秒にしてディレイは0に変更。
・ghostの変わりにマップ移動後の無敵時間を設定。この時間の間はどんな攻撃も受けないが移動や攻撃、スキル使用、アイテム使用でこの時間はなくなります。シーズモードではこの無敵時間を2倍として適用。
・シーズモードで死んでも経験が減らないように修正。(mapflagのnopenaltyを設定する必要はありません。)
・スキッドで滑べる距離増加。
・既に沈黙にかかってる対象にレックスディビーナを使うと沈黙が解除されるように変更。
・呪いにかかると移動速度も減るように修正。
・battle_athena.confに項目変更。
・スキルの重ね置きを判断処理を少し変更。
・HPの自然回復時間が4秒ではなく6秒だとわかったのでデフォルト修正とbattle_athena.conf修正。
・その他細かい修正やバグ修正。
・殆どテストしてません。
	(conf/)
	atcommand_athena.conf 修正。
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(db/)
	cast_db.txt 修正。
	(map/)
	atcommand.c 修正。
	clif.c
		clif_mob0078()、clif_mob007b()、clif_skill_estimation() 修正。
		clif_mob_class_change()、clif_parse_WalkToXY() 修正。
		clif_parse_ActionRequest()、clif_parse_LoadEndAck() 修正。
		clif_parse_UseItem()、clif_parse_UseSkillToId() 修正。
		clif_parse_UseSkillToPos()、clif_parse_UseSkillMap() 修正。
	mob.h 修正。
	mob.c
		mob_get_viewclass()、mob_attack()、mob_target() 修正。
		mob_ai_sub_hard_activesearch()、mob_ai_sub_hard() 修正。
		mobskill_castend_id()、mobskill_castend_pos() 修正。
	skill.h 修正。
	skill.c
		skill_can_produce_mix()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_castend_id() 修正。
		skill_castend_pos()、skill_use_id()、skill_readdb() 修正。
		skill_check_condition()、skill_unit_onplace()、skill_unitsetting() 修正。
		skill_additional_effect()、skill_check_unit_range() 修正。
		skill_check_unit_range_sub()、skill_status_change_end() 修正。
		skill_status_change_start() 修正。
	pc.h
	pc.c
		pc_ghost_timer()、pc_setghosttimer()、pc_delghosttimer() 削除。
		pc_gvg_invincible_timer() -> pc_invincible_timer()に変更。
		pc_setgvginvincibletimer() -> pc_setinvincibletimer()に変更。
		pc_delgvginvincibletimer() -> pc_delinvincibletimer()に変更。
		pc_authok()、pc_attack_timer()、pc_calcstatus() 修正。
		pc_setrestartvalue()、pc_damage()、pc_allskillup() 修正。
		do_init_pc() 修正。
	battle.h 修正。
	battle.c
		battle_config_read()、battle_weapon_attack()、battle_check_target() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_get_speed() 修正。
	map.h 修正。
	map.c
		map_quit() 修正。

--------------------
//0784 by あゆみ

・カードスキルを覚えている状態で@allskillコマンドを使用するとmap-serverが暴走する問題を修正。

	(map/)
	pc.c
		pc_allskillup() 修正。

--------------------
//0783 by huge

・ブランディッシュスピアの修正
	範囲指定、斜めの際の格子範囲、攻撃力計算
	多分合ってると思うんですけど、イマイチ自信が持てない・・・
	(参考)みすとれ巣 -スキル関連豆情報
・スペルブレイカーをちょっと修正
・プロボックをMVPmobに効かないよう修正
・バグ報告スレ３ >>8 で報告されたものの取り込み

	(/db)
	create_arrow.txt 修正。
	skill_db.txt 修正。

	(/map)
	battle.c
		battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack() 修正。

	skill.h
	skill.c
		skill_brandishspear_first() 追加。
		skill_brandishspear_dir() 追加。
		skill_castend_nodamage_id() 修正。
		skill_castend_damage_id() 修正。
		skill_unit_group() 修正。

--------------------
//0782 by ぴざまん
・@allskillコマンドの使用条件が参照されていなかったバグ修正
	(/map)
	atcommand.c
		atcommand() 修正。

--------------------
//0781 by Chunglyeng
・バド, ダンサー音楽具現
	(/map)
	skill.c 修正。

--------------------
//0780 by reia
・ペコペコの卵などが孵化するとノビになってしまう問題修正。
・GMコマンド「@kickall」が何時の間にか無効になっていたので修正。

	(/conf)
	atcommand_athena.conf 修正。
	(db/)
	mob_skill_db.txt 修正。
	(map/)
	atcommand.c
		atcommand_config_read() 修正。

--------------------
//0779 by あゆみ

・全スキル取得コマンドの追加。
	・GMで全スキルを覚えられるようにしている場合や、スキルの数が多い職業は一部のスキル表示がおかしくなります。その場合はリログして下さい。
	@allskill : 現在の職業で取得可能な全スキルを取得する。(クエストスキル含む)

	(conf/)
	battle_athena.conf 修正。
	help.txt 修正。
	(map/)
	atcommand.h 修正。
	atcommand.c
		atcommand() 修正。
	pc.h 修正。
	pc.c
		pc_allskillup() 追加。
	(doc/)
	conf_ref.txt 修正。
	help.txt 修正。

--------------------
//0778 by huge

・スペルブレイカーの修正
  ・キャスティングタイムの無いスキルには効かないように修正。
  ・使用された相手の消費SPの修正。

	(map/)
	skill.c
		skill_castend_nodamage_id() 修正。

--------------------
//0777 by ぴざまん

・ギルド攻城戦仮実装
　・基本的な部分だけしか実装してない上、いくつかの点で本鯖と相違があります。
　・攻城戦開始と終了は@コマンドで行います
	@gvgstart : 攻城戦開始
	@gvgend : 攻城戦終了
　・battle_athena.confに項目追加。
	(char/)
	int_guild.c
		inter_guild_init()、inter_guild_readdb()、inter_guild_save() 修正。
		inter_castle_save_sub()、mapif_guild_castle_info() 追加。
		mapif_guild_change_castle()、mapif_parse_GuildCastleInfo() 追加。
		mapif_parse_GuildChangeCastle() 追加。
	inter.c
		inter_config_read() 修正。
		inter_send_packet_length[]、inter_recv_packet_length[] 修正。
	int_guild.h 修正。
	(map/)
	atcommand.c
		atcommand()、atcommand_config_read() 修正。
	battle.c
		battle_config_read() 修正。
	guild.c
		guild_castle_search()、guild_read_castledb()追加。
		do_init_guild() 修正。
		guild_gvg_init()、guild_gvg_final()、guild_gvg_final_sub() 追加。
		guild_gvg_eliminate()、guild_gvg_eliminate_sub() 追加。
		guild_gvg_eliminate_timer()、guild_gvg_empelium_pos() 追加。
		guild_gvg_break_empelium() 追加。
	intif.c
		intif_parse()、packet_len_table[] 修正。
		intif_parse_GuildCastleInfo()、intif_parse_GuildCastleChange() 追加。
		intif_guild_castle_info()、intif_guild_castle_change() 追加。
	mob.c
		mob_damage() 修正。
	atcommand.h 修正。
	battle.h 修正。
	guild.h 修正。
	intif.h 修正。
	mob.h 修正。
	(common/)
	mmo.h 修正。
	(conf/)
	battle_athena.conf 修正。
	inter_athena.conf 修正。
	msg_athena.conf 修正。
	atcommand_athena.conf 修正。
	(db/)
	castle_db.txt 追加。
--------------------
//0776 by 死神

・NPCスキル孵化実装。(mob_skill_db.txtのval1を使います。)
・mob_skill_db.txtの確率を千分率から万分率に変更。(ただmob_skill_db.txtの修正はしてません。)
・モンスターがダブルアタックする問題修正。(修正されたかどうかの自信はありませんが...)
・その他細かい修正。
	(db/)
	mob_skill_db.txt 修正。
	skill_db.txt 修正。
	(map/)
	map.h 修正。
	mob.h 修正。
	mob.c
		mob_spawn_dataset()、mob_spawn() 修正。
		mob_changestate()、mobskill_use() 修正。
		mob_class_change() 追加。
	npc.c
		npc_parse_mob() 修正。
	battle.c
		battle_check_target() 修正。
	clif.h 修正。
	clif.c
		clif_mob_class_change() 追加。
	skill.c
		skill_castend_nodamage_id() 修正。

--------------------
//0775 by 死神

・シーズモードの処理修正。
・シーズモードの無敵時間の間はどんな攻撃も受けないように修正。
・シーズモードの無敵時間が時間切れになる前には解除されないように修正。
・battle_athena.confに項目追加。
・@hideや/hideによるGMハイディング中は自分に自動使用されるスキル以外のスキル使用や攻撃を受けないように修正。
・ハイディング中地属性スキル以外の攻撃を受けないように修正。(トラップやクァグマイア等のスキルは影響を受けるかどうか不明なので今までと同じように影響を受けるように処理。)
・トンネルドライブの移動速度を本鯖に合わせました。
・その他バグ修正や細かい修正。(殆ど未テスト)
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_check_target()、battle_calc_damage() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_calc_misc_attack() 修正。
		battle_config_read()、battle_weapon_attack() 修正。
	pc.h 修正。
	pc.c
		do_init_pc()、pc_authok() 修正。
		pc_attack()、pc_attack_timer() 修正。
		pc_setgvg_ghosttimer()、pc_delgvg_ghosttimer()を
			pc_setgvginvincibletimer()、pc_delgvginvincibletimer()に修正。
		pc_gvg_invincible_timer() 追加。
		pc_attack_timer()、pc_steal_item()、pc_calcstatus() 修正。
	clif.c
		clif_parse_ActionRequest()、clif_parse_UseItem() 修正。
		clif_parse_UseSkillToId()、clif_parse_UseSkillToPos() 修正。
		clif_parse_UseSkillMap()、clif_parse_WalkToXY() 修正。
	map.h 修正。
	map.c
		map_quit() 修正。
	mob.c
		mob_attack()、mob_target()、mob_ai_sub_hard_activesearch() 修正。
		mob_ai_sub_hard_mastersearch()、mob_ai_sub_hard() 修正。
		mob_damage()、mobskill_castend_id()、mobskill_castend_pos() 修正。
	skill.c
		skill_castend_damage_id()、skill_attack() 修正。
		skill_castend_id()、skill_castend_pos()、skill_castend_map() 修正。

--------------------
//0774 by 獅子o^.^o
・Monk job bouns 修正
・ドケビ 修正
(db/)
	job_db2.txt 修正
	pet_db.txt 修正

--------------------
//0773 by 聖

・細かいバグ修正
	(map/)
	skill.c 修正。
	battle.c 修正。

--------------------
//0772 by ぴざまん

・シーズモード下で以下の点を修正
　・連続して攻撃できなくなっていたバグ修正
　・ダメージ軽減率が正しく設定できなかったバグ修正
　・無敵時間実装。battle_athena.confのgvg_ghost_timeで設定できます

・ハイディングで魔法攻撃等を回避できなかったバグ修正

	(map/)
	skill.c
		skill_attack()、skill_unit_onplace()、skill_check_condition() 修正。
	clif.c
		clif_parse_ActionRequest()、clif_parse_UseItem() 修正。
		clif_parse_UseSkillToId()、clif_parse_UseSkillToPos() 修正。
		clif_parse_UseSkillMap()、clif_parse_WalkToXY() 修正。
	pc.c
		do_init_pc()、pc_authok() 修正。
		pc_attack()、pc_attack_timer() 修正。
		pc_setgvg_ghosttimer()、pc_delgvg_ghosttimer() 追加。
		pc_gvg_ghost_timer() 追加。
	map.c
		map_quit() 修正
	battle.c
		battle_config_read()、battle_weapon_attack() 修正。
	battle.h 修正。
	pc.h 修正。

--------------------
//0771 by huge

・スペルブレイカー実装
	(map/)
	skill.c
		skill_castend_nodamage_id() 修正。
	(db/)
	skill_db.txt 修正。

--------------------
//0770 by 聖

・青箱系の処理変更
・その他バグ修正
	(map/)
	battle.c 修正。
	itemdb.c 修正。
	mob.c 修正。
	script.c 修正。

--------------------
//0769 by 死神

・シーズモード修正。
・無敵時間の方はghost_timer以外の方法で実装するつもりなので今は削除しています。
・スクリプトviewpointが正しく動作しない問題修正。
・produce_db.txtを修正。(乳鉢はskill_require_db.txtで処理しています。そしてアイテムの数を0にすれば消耗はされないけど作る時必要なアイテムになります。)
・その他細かい修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(db/)
	produce_db.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_calc_damage()、battle_calc_weapon_attack() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_calc_misc_attack()、battle_check_target()、battle_config_read() 修正。
	skill.c
		skill_unit_onplace()、skill_castend_damage_id()、skill_castend_id() 修正。
		skill_use_id()、skill_use_pos()、skill_check_condition() 修正。
		skill_can_produce_mix() 修正。
	pc.c
		pc_attack_timer()、pc_attack()、pc_isUseitem()、pc_delitem() 修正。
		pc_damage() 修正。
	mob.c
		mob_damage()、mobskill_use_id()、mobskill_use_pos() 修正。
	script.c
		buildin_viewpoint()、buildin_emotion() 修正。
	makefile 修正。

--------------------
//0768 by ぴざまん

・シーズモード下で、以下の点を修正
　・死亡したらセーブポイントに強制送還するように修正
　・特定のアイテムが使用できないように修正(アンティペインメント・ハエの羽)
　・特定のスキルが使用できないように修正(ワープポータル・バックステップ・インティミデイト・テレポート・インデュア)
　・同盟ギルドには無条件で攻撃できないように修正
　・敵対ギルドには無条件で攻撃できるように修正
　・無敵時間中は両者とも攻撃できないように修正

ソースレベルでテレポ、ハエの使用を禁じているため攻城戦MAPのmapflagにnoteleportは必要ありません
また、無敵時間はghost_timer依存です。つまりbattle_athena.conf内のghost_timeが無敵時間になります

	(map/)
	skill.c
		skill_castend_damage_id()、skill_castend_id() 修正
		skill_check_condition() 修正
	pc.c
		pc_damage() 修正
	battle.c
		battle_weapon_attack() 修正

--------------------
//0767 by huge

・ファーマシーで、製造の書が減る問題を修正
・武器製造DBで、いくつか抜けていたのを修正

	(map/)
	skill.c 修正。
	(db/)
	produce_db.txt 修正。

--------------------
//0766 by ぴざまん

・シーズモード下で、以下の点を修正
　・正規ギルド承認がないとエンペリウムに攻撃が効かないように修正
　・エンペリウムに対するスキル攻撃が効かないように修正
　・魔法攻撃、遠距離攻撃、罠のダメージ補正を実装
　　魔法攻撃：50%　遠距離攻撃：75%　罠：60%
　　これは人にもエンペリウムにも適用されます
	(map/)
	battle.c
		#include "guild.h" 追加
		battle_calc_damage()、battle_calc_weapon_attack() 修正

--------------------
//0765 by ぴざまん

・装備制限実装
・装備制限がかかった装備品は該当マップに移動した際に自動的に装備が外れ、
　再装備もできなくなります
・制限できるのは装備品のみです。カード類は制限できません
	(db/)
	item_noequip.txt 追加
	(map/)
	itemdb.h 修正
	itemdb.c
		do_init_itemdb()、itemdb_search() 修正
		itemdb_read_noequip 追加
	pc.c
		pc_checkitem()、pc_isequip() 修正

--------------------
//0764 by 死神

・全てのダメージが1になる防御を10000から1000000に変更。
・battle_athena.confに項目追加。
・モンスターから経験値を貰う処理を本鯖のように修正。
・スキルスローポイズン実装。
・交換バグ修正。
・その他細かい修正。
・テストは殆どしてません。
	(db/)
	mob_db.txt 修正。
	skill_db.txt 修正。
	(doc/)
	conf_ref.txt 修正。
	db_ref.txt 修正。
	(conf/)
	battle_athena.conf 修正。
	(map/)
	makefile 修正。
	battle.h 修正。
	battle.c
		battle_get_def()、battle_get_mdef() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_calc_misc_attack()、battle_config_read() 修正。
	skill.h 修正。
	skill.c
		skill_castend_nodamage_id()、skill_castend_damage_id() 修正。
		skill_check_condition()、skill_status_change_timer() 修正。
		skill_status_change_end()、skill_status_change_start() 修正。
		skill_additional_effect()、skill_produce_mix()、skill_unit_timer_sub() 修正。
		skill_check_unit_sub()を skill_check_unit_range_sub()に変更。
		skill_check_unit_range() 追加。
		skill_castend_pos()、skill_area_sub_count() 修正。
	mob.c
		mobskill_castend_pos()、mob_damage() 修正。
	clif.c
		clif_parse_TradeRequest()、clif_parse_TradeAck() 修正。
		clif_parse_TradeAddItem()、clif_parse_TradeOk() 修正。
		clif_parse_TradeCansel()、clif_parse_TradeCommit() 修正。
	map.h 修正。
	map.c
		do_init() 修正。
	pc.c
		pc_calc_skilltree()、pc_calcstatus() 修正。
	tarde.c
		trade_tradeack() 修正。

--------------------
//0763 by 胡蝶蘭

・サーバーsnapshot
	フォルダを整理したので注意してください。
	以前のセーブデータ(account.txtなど)はsaveフォルダに置いてください
	cnfファイルは各種ファイルのパスが変わってるので、
	この古いものをコピーではなく、新しく書き換えなおしてください。

・フォルダ整理
	confフォルダ
		NPC関連をconf/npc/、MOB配置関連をconf/mob/、WARP関連をconf/warp/
		テストやサンプルをconf/sample/に移動しました。
	dbフォルダ
		sampleフォルダのうちdb関係を db/sampleに移動しました。
	help.txt/motd.txt
		confフォルダに移動しました
	account.txt/athena.txt/guild.txt/party.txt/pet.txt/storage.txt
		saveフォルダに移動しました
	tool/backup
		パス修正

・motd.txt/help.txtのパスをmap_athena.cnfで指定できるように
	map.h/map.c/atcommand.c/atcommand.h修正

・athena-startにrestartオプション追加
	./athena-start restartでAthenaを再起動します

--------------
//0761 by ぽぽぽ

・MOBのMDEFに10000以上指定してもファイアピラーで普通にダメージを与えてしまうのを修正。
	(map/)
	battle.c

--------------
//0760 by ll3y

・文字化け修正
	(map/)
	script.c

--------------
//0759 by 獅子o^.^o
・スピアクイッケン 修正
・Dancer skill tree 修正
(db/)
	cast_db.txt 修正
	skill_tree.txt 修正

--------------
//0758 by hack
・Put GM messages into msg_table which is loaded from msg_athena.conf.
(Easy to translate into other language)
	(map/)
	atcommand.h
	atcommand.c
		msg_conf_read()	Read conf/msg_athena.conf
		Put messages into msg_table which is loaded from msg_athena.conf.
	map.c
		do_init()
	(conf/)
	msg_athena.conf	Store the message of atcommand, easy to translate into other language.
	
--------------
//0757 by Michael
	(map/)
	script.c 
		buildin_viewpoint()
		Fix packet sequence of viewpoint command.

--------------
//0756 by ll3y

・Interix(Windows Services for Unix 3.5)でコンパイルが通るように修正
  Interop Systems(http://www.interopsystems.com/)よりgmakeとzlibを取ってくるか、
  自前でInterix用を用意する必要があります。
	(common/)
	socket.h 修正。

--------------
//0755 by 死神

・バグ修正と説明追加。(報告されたのは多分全て修正されたのかと...)
・0751でスキルの最大レベルを100まで設定できるようにしました。
・cast_db.txtに入っている状態異常の維持時間は自分が適度に入れた物です。本鯖の仕様なんて知りませんので。
	(doc/)
	db_ref.txt 修正。
	(db/)
	cast_db.txt 修正。
	skill_db.txt 修正。
	(map/)
	skill.h 修正。
	skill.c
		skill_check_unit_sub()、skill_castend_id()、skill_use_id() 修正。
		skill_status_change_end()、skill_status_change_start() 修正。
		skill_castend_map() 修正。
	mob.c
		mobskill_castend_id()、mobskill_castend_pos() 修正。
	pc.c
		pc_calcstatus() 修正。
	battle.c
		battle_calc_pc_weapon_attack()
		battle_calc_mob_weapon_attack()
		battle_calc_magic_attack()

--------------
//0754 by 獅子o^.^o
(db/)
	cast_db.txt 修正

--------------
//0753 by 聖

・IWの発生ポイントを指定するとメテオのエフェクトが一切出なくなる
　問題が復活していたので修正。
・warningを出ないようにコード修正。
	(map/)
	skill.c
			skill_castend_pos2() 修正。
	chrif.h

--------------
//0752 by ぴざまん

・changesexスクリプト実装。性別を反転させることができます
　性別反転成功後は、そのプレイヤーは強制的に接続を切断されます
　また、ダンサー・バードの互換性はかなり怪しいです
　ダンサー・バードがスロット内どこかに居るアカウントでの反転は、以下の点に注意して下さい
　・必ず反転させる前にそのキャラクターをスキルリセットしてください
　　そのまま反転させると、共通するスキル(楽器の練習等)しか残らなくなってしまいます
　・ダンサー・バード専用武器を装備している場合は、外してから反転させてください
　　そのまま反転させると、そのキャラクターの開始時に
　　クライアントエラーが出ます（出るだけで、落ちることはないのですが…）
・データベース修正 by 獅子o^.^o
	(map/)
	chrif.c
		packet_len_table[]、chrif_parse()修正
		chrif_changesex()、chrif_changedsex()追加
	chrif.h 修正
	(char/)
	char.c
		parse_frommap()、parse_tologin()修正
	(login/)
	login.c
		parse_fromchar()修正
	(db/)
	cast_db.txt 修正
	skill_require_db.txt 修正

--------------
//0751 by 死神

・skill_db.txtとcast_db.txtの変更とskill_require_db.txtの追加。
・毒にかかるとHPが減るように変更。HPは1秒に最大HPの1%減ります。(未テスト)
・石化を進行中の物と完全な物に分けてHPが減るように変更。(1秒に最大HPの1%)ブレッシングで完全石化だけ治せるように修正。(未テスト)
・ハンターのトラップにエフェクト実装。ただランドマインとショックウェーブは爆発エフェクトが出ないようです。ランドマインはファイアピラーの爆発エフェクトが出るように変えています。
・オートカウンターの方向チェックをするように変更と本鯖仕様に合わせました。
・バックスタブも方向チェックをするように変更。
・インティミデイトの処理変更。
・ディフェンダーの移動速度減少を本鯖に合わせました。ASPDは勝手ながら
(30 - (skilllv*5))%が減るようにしましたが本鯖でいくら程減るのかの情報をお願いします。
・トンネルドライブLV1で移動速度が150から312になるのが確認されて計算を変更しましたがレベルによってどれぐらい増加するかは不明です。情報を求めます。(今の計算式は適度に作った物です。)
・ポーション製造の計算式変更とちょっと修正。
・一部地面スキルの重ね置きを禁止。
・bNoMagicDamageで魔法による異常やステータスアップ効果が出ないように修正。(リザレクション以外の魔法は無効になります。)
・battle_athena.confに項目追加。
・その他色々と修正。
・変更されたskill_db.txt、castdb.txtと追加されたskill_require_db.txtの構造は今の所自分しか知らないのでdb_ref.txtに説明を追加する予定なのでそれまではこれらの変更は控えてください。
	(char/)
	int_guild.c 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(db/)
	skill_db.txt 修正。
	skill_require_db.txt 修正。
	cast_db.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_counttargeted()、battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_weapon_attack()、battle_config_read() 修正。
	skill.h 修正。
	skill.c
		skill_attack()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_status_change_start() 修正。
		skill_check_condition()、skill_castend_pos() 修正。
		skill_use_id()、skill_use_pos() 修正。
		skill_status_change_timer()、skill_status_change_start() 修正。
		skill_check_unit_sub() 追加。
	pc.h 修正。
	pc.c
		pc_damage()、pc_counttargeted()、pc_counttargeted_sub() 修正。
	mob.h 修正。
	mob.c
		mob_countslave()、mob_counttargeted()、mob_counttargeted_sub() 修正。
		mobskill_use()、mob_can_move()、mob_damage() 修正。
		mobskill_use_id()、mobskill_use_pos()、mobskill_castend_id() 修正。
		mobskill_castend_pos() 修正。
	map.c
		map_quit() 修正。

--------------
//0750 by CHRIS

・スキル関係のDBを調整
	(db/)
	skill_db.txt
	cast_db.txt
	skill_require_db.txt

--------------
//0749 by 死神

・色々と変更と修正。
・スキルの仕様変更や実装、状態異常の仕様変更や実装。
・スキルの使用条件をdbに設定できるように変更。
・skill_db.txtとcast_db.txtの仕様変更。
・マップ鯖の無限ループ可能性がある部分を修正。(あくまでも可能性が
あっただけの物です。無限ループの原因とは断言できません。)
・トラップの発動実装。(ただ実際に動作はまだ修正していません。
見た目が変わっただけです。)
・battle_athena.confに項目追加を削除。
・0748の修正削除と文字化け修正。
・skill_db.txt、cast_db.txt、skill_require_db.txtの方がまだ完成されていないので
かなりの量のスキルが正しく動作しません。(db_ref.txtに設定方法を入れないと
 けないのですが時間がなかったので...) そして修正はしましたがテストは
殆んどしてませんので注意してください。
	(char/)
	char.c 修正。
	int_party.h 修正。
	int_party.c 修正。
	int_guild.h 修正。
	int_guild.c 修正。
	int_pet.h 修正。
	int_pet.c 修正。
	int_storage.h 修正。
	int_storage.c 修正。
	charの方は大した修正はしてません。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(db/)
	skill_db.txt 修正。
	cast_db.txt 修正。
	skill_require_db.txt 追加。
	produce_db.txt 修正。
	(map/)
	map.h 修正。
	map.c
		map_check_dir() 追加。
		map_readmap()、map_addblock()、map_delblock() 修正。
		map_foreachinarea()、map_foreachinmovearea() 修正。
		map_addflooritem() 修正。
	pc.h 修正。
	pc.c
		pc_spiritball_timer()、pc_addspiritball()、pc_delspiritball() 修正。
		pc_steal_item()、pc_steal_coin()、pc_calcstatus() 修正。
		pc_checkallowskill()、pc_jobchange()、pc_checkweighticon() 修正。
		pc_damage()、pc_equipitem()、pc_walk()、pc_stop_walking() 修正。
		pc_authok()、pc_counttargeted()、pc_counttargeted_sub() 修正。
		pc_damage()、pc_setpos() 修正。
	skill.h 修正。
	skill.c
		skill_get_range()、skill_get_sp()、skill_get_num() 修正。
		skill_get_cast()、skill_get_delay() 修正。
		skill_get_hp()、skill_get_zeny()、skill_get_time() 追加。
		skill_get_time2()、skill_get_weapontype() 追加。
		skill_get_unit_id()、skill_blown()、skill_additional_effect() 修正。
		skill_attack()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id()、skill_castend_id() 修正。
		skill_castend_pos()、skill_unit_onplace() 修正。
		skill_unit_timer_sub_onplace()、skill_unitsetting() 修正。
		skill_use_id()、skill_use_pos()、skill_check_condition() 修正。
		skill_status_change_end()、skill_status_change_timer() 修正。
		skill_status_change_start()、skill_can_produce_mix() 修正。
		skill_produce_mix()、skill_gangsterparadise() 修正。
		skill_gangster_out()、skill_gangster_in() 修正。
		skill_gangster_count() 追加。
		skill_readdb() 修正。
	battle.h 修正。
	battle.c
		distance()、battle_counttargeted()、battle_get_range() 追加。
		battle_get_dir() 追加。
		battle_get_maxhp()、battle_get_str()、battle_get_agi() 修正。
		battle_get_vit()、battle_get_dex()、battle_get_int() 修正。
		battle_get_luk()、battle_get_flee()、battle_get_hit() 修正。
		battle_get_flee2()、battle_get_critical()、battle_get_baseatk() 修正。
		battle_get_atk()、battle_get_atk2()、battle_get_def() 修正。
		battle_get_def2()、battle_get_mdef()、battle_get_speed() 修正。
		battle_get_adelay()、battle_get_amotion()、battle_get_party_id() 修正。
		battle_get_guild_id()、battle_get_size() 修正。
		battle_check_undead() 追加。
		battle_check_target()、battle_addmastery() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_weapon_attack() 修正。
	clif.h 修正。
	clif.c
		clif_skillinfo()、clif_skillinfoblock()、clif_skillup() 修正。
		clif_item_skill()、clif_changeoption()、clif_parse_LoadEndAck() 修正。
		clif_01ac() 追加。
		clif_parse_WalkToXY()、clif_parse_ActionRequest() 修正。
		clif_parse_TakeItem()、clif_parse_DropItem() 修正。
	mob.h 修正。
	mob.c
		mobskill_castend_id()、mobskill_castend_pos() 修正。
		mobskill_use_id()、mobskill_use_pos()、mob_heal() 修正。
		mob_spawn()、mob_damage()、mob_walk() 修正。
		mob_stop_walking()、mob_warp()、mob_counttargeted() 修正。
		mob_counttargeted_sub()、mob_countslave() 修正。
		mob_attack()、mob_target()、mob_ai_sub_hard_activesearch() 修正。
		mob_ai_sub_hard_mastersearch()、mob_ai_sub_hard() 修正。
	script.c
		buildin_sc_start() 修正。
	path.c
		can_move() 修正。
	pet.c
		pet_data_init()、pet_stop_walking() 修正。
	npc.c
		npc_parse_warp()、npc_parse_shop()、npc_parse_script() 修正。

--------------
//0748 by Michael
	(map/)
	pc.c 
		pc_walk();
		Fix Player cannot move in ICEWALL but have Path.
	mob.c
		mob_walk();
		Fix Monster cannot move in ICEWALL but have Path.
	path.c
		can_move();
		Fix Player&Monster cannot move in ICEWALL.

--------------
//0747 by 聖
・ペットがエモを出すとmap-serverが落ちることがあった問題を修正。
	(map/)
		clif_parse_SendEmotion() 修正。

--------------
//0746 by Michael
	(map/)
	script.c 
		Add Script command - checkoption(type);
		Attach a npc_testchkoption.txt npc script!

--------------
//0745 by ぴざまん
・ギャングスターパラダイス実装
・PvPエリアのmapflagを修正(同士討ちが無くなったかと思います)
・シーズモードでノックバックがあったバグを修正
・インティミの遅延時間を少し調整
	(map/)
	skill.c
		skill_attack()、skill_additional_effect()修正
		skill_gangsterparadise()、skill_gangster_in()、skill_gangster_out()追加
	clif.c
		clif_parse_ActionRequest()修正
	mob.c
		mob_target()、mob_attack()修正
		mob_ai_sub_hard()、mob_ai_sub_hard_mastersearch()修正
		mob_ai_sub_hard_activesearch()修正
	map.h 修正
	skill.h 修正
	(conf/)
	npc_pvp.txt 修正

--------------
//0744 by 聖

・アイスウォール、メテオストームのコンボでメテオストームのエフェクトが表示されなくなる問題を修正。
・HP吸収スキルのエフェクト修正。
・battle_athena.confに項目追加。
・パケ周りの細かい修正。
	(conf/)
	battle_athena.conf
	(doc/)
	conf_ref.txt
	(map/)
	battle.c
	battle.h
	clif.c
	pc.c
	pet.c
	skill.c

--------------
//0743 by J

・取り巻き召喚などを本鯖に似せる為の修正。
　あと本鯖相違スレにあったゴスリンの取り巻きを修正。
　デリーターの空と地のスキルが逆になっていたのを修正。
	(db/)
	mob_skill_db.txt 修正
  
--------------
//0742 by ぴざまん

・インティミデイトを実装
　攻撃とワープの分別がうまくいかなかったので
　SC_INTIMIDATEを使って遅延処理をしました
・skill_dbの誤字等を修正
	(map/)
	skill.c
		skill_additional_effect()、skill_castend_map()修正
		skill_castend_nodamage_id()、修正
		skill_status_change_start()、skill_status_change_end()修正
	map.h 修正
	skill.h 修正
	(db/)
	skill_db.txt 修正

--------------------
//0741 by whitedog

snapshot

--------------
//0740 by ぽぽぽ
・PCがMOBにタゲられたとき3匹目から防御と回避が減るようにした。
　1匹につき回避は10%、防御は5%減ります。
	(map/)
	pc.h
	pc.c
		pc_counttargeted()、pc_counttargeted_sub()追加
	battle.c
		battle_get_flee()、battle_get_def()、battle_get_def2()修正。

--------------
//0739 by 聖
・ファイアーウォール等の設置系スキルが正しく表示されない問題を修正。
・マリンスフィアが自爆するとサンダーストーム等のダメージが表示されなくなる問題を修正。
・HP吸収系スキルで敵が回復してるエフェクトが出るよう修正。
	(map/)
	skill.c
		skill_castend_damage_id() 修正。
	battle.c
		battle_calc_misc_attack() 修正。
	clif.c
		clif_getareachar_skillunit() 修正。
		clif_skill_setunit() 修正。

--------------
//0738 by ぴざまん
・ストームガストを完全に本鯖仕様に修正(3回で絶対凍結＆凍結状態の敵はSGをくらわない)
・サフラギウムが自分にかけられるバグ修正
	(map/)
	skill.c
		skill_additional_effect()、skill_attack()修正
		skill_castend_nodamage_id()修正
	map.h 修正

--------------
//0737 by ぽぽぽ
・アンクルが歩いている敵に効かない&複数の敵に効くのを修正。
	(map/)
	skill.c
		skill_unit_onplace()、skill_unit_onout()修正
	mob.c
		mob_stop_walking()修正

--------------
//0736 by ぴざまん
・状態異常耐性が効果時間にも及ぶ様に修正。発動率と同率で効果時間が割り引かれます
・ストーンカースの効果時間を永久からマジスレテンプレ準拠に
・攻撃を受けた時にペットの支援攻撃を受けられないよう修正(コメントアウトしただけ)
　これはVIT型にペットを付けて放置するだけで自動でレベル上げができるのを
　防ぐための暫定的な処置です
	(map/)
	skill.c
		skill_castend_nodamage_id()、skill_addisional_effect()修正
		skill_status_change_start()修正
	pc.c
		pc_damage() 修正

--------------
//0735 by ぽぽぽ

・敵を倒してレベルが上がったときPT公平範囲のチェックをするようにした。
・オートカウンター仮実装。
　向きや射程チェックはしていません。またタイミングがおかしいかもしれません。
　MOBスキルとして使うときはターゲットをselfにしてください。
	(conf/)
	battle_athena.conf項目追加
	(doc/)
	conf_ref修正
	(map/)
	battle.h
	battle.c
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack()
		battle_config_read()修正
	pc.c
		pc_checkbaselevelup()、pc_attack_timer()修正
	skill.c
		skill_castend_nodamage_id()、skill_status_change_start()修正
	clif.c
		clif_parse_WalkToXY()修正
	mob.c
		mob_attack()修正

--------------
//0734 by 死神

・player_skillup_limitの処理修正と細かい修正。
・player_skillup_limitがyesの場合skill_tree.txtで設定されてるその下位職業の
スキルツリーを使いますのでその職業では無くなるはずのスキルが出ることが
ありますがこれは仕様でありバグではありません。バグ報告されても無視します。
	(doc/)
	conf_ref.txt 修正。
	(char/)
	char.c
		mmo_char_sync_timer()、do_init() 修正。
	inter.c
		inter_init() 修正。
		inter_save_timer() 削除。
	(map/)
	pc.c
		pc_calc_skilltree() 修正。
		pc_resetskill() 修正。

--------------
//0733 by 死神

・バグ修正と細かい修正。
・死んだ後にすぐにセーブポイントに戻らずにしばらく放置してると、
放置してる時間によって経験値が減少するバグ修正。(未テスト)
・mob_availe.txtで設定したモンスターにモンスター情報を使うち鞍落ちする問題修正。
・battle_athena.confに項目追加。
・その他細かい修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	clif.c
		clif_skill_estimation()、clif_parse_Restart() 修正。
	pc.c
		pc_setrestartvalue()、pc_makesavestatus() 修正。
		pc_read_gm_account()、pc_calc_skilltree() 修正。
		pc_calc_skillpoint() 追加。
	map.c
		map_quit() 修正。
	mob.c
		mob_damage() 修正。
	skill.c
		skill_unit_timer_sub()、skill_unit_timer() 修正。
	battle.h 修正。
	battle.c
		battle_config_read() 修正。

--------------
//0732 by Kalen

・npc_town_kafra.txtの全面見直し
	カプラ利用券の廃止
	倉庫利用料を本鯖(jRO)と同一価格に調整
	カート使用料を本鯖(jRO)と同一価格に調整
	ポイント参照変更
	ジュノーのセーブポイント修正
	アマツのセーブポイント修正

--------------
//0731 by ぽぽぽ

・服の色を保存するかbattle_athena.confで選択できるように。
　弊害があるので保存しないようにと書いてあったのでデフォルトでは保存しません。
・スクリプト追加
　strcharinfo(1)	自分のパーティー名を取得します。
　strcharinfo(2)	自分のギルド名を取得します。
　getcharid(1)		自分のパーティーIDを取得します。
　getcharid(2)		自分のギルドIDを取得します。
　getpartyname(ID)	IDで指定したパーティーの名前を取得します。
　getguildname(ID)	IDで指定したギルドの名前を取得します。
	(map/)
	battle.h
	battle.c
		battle_config_read()修正
	pc.c
		pc_makesavestatus()修正
	script.c
		buildin_strcharinfo()修正
		buildin_getcharid()、buildin_getpartyname()、buildin_getpartyname_sub()
		buildin_getguildname()、buildin_getguildname_sub()追加

--------------
//0730 by ぴざまん

・ストームガストの凍結時間を本鯖にあわせて修正(スキルレベルに関係なく一定の凍結時間(10秒)になります)
・スタン、暗闇、沈黙、毒の状態異常時間の「継ぎ足し」ができないように修正
・状態異常が掛かりにくすぎてたのでMOBの状態異常耐性を緩和(また調整するかも)
	(map/)
	skill.c
		skill_castend_nodamage_id()、skill_addisional_effect()修正
		skill_status_change_start()修正

--------------
//0729 by DRG

・カートレボリューションがカートなしで使えた不具合の修正
・カートレボリューションがJOBLV30で覚えれたのを修正
	(conf/)
	npc_event_skillget.txt
		カートレボリューション項修正
	(map/)
	skill.c
		skill_check_condition()修正

--------------
//0728 by ぽぽぽ

・職が変わってもギルドの職業欄が更新されない不具合の修正。

	(char/)
	inter.c
		パケット長リスト修正。
	int_guild.c
		mapif_guild_memberinfoshort()、mapif_parse_GuildChangeMemberInfoShort()、
		inter_guild_parse_frommap()修正
	(map/)
	intif.h
	intif.c
		intif_guild_memberinfoshort()、intif_parse_GuildMemberInfoShort()
		intif_parse()修正
	guild.h
		guild_send_memberinfoshort()、guild_recv_memberinfoshort()修正
	

--------------
//0727 by 聖

・武器研究スキルによってホルグレンなどの精錬NPCが
　正常に動作しない問題を修正。

	(map/)
	pc.c
		pc_percentrefinery() 修正。

--------------
//0726 by 胡蝶蘭

・mob_skill_db2.txtがあればmob_skill_db.txtをオーバーライドするように修正
	オリジナルのMOB使用時や、現行MOBの使用スキルを変更したい場合に。

・mob_skill_db.txtでmob_idの次のダミー文字列が"clear"だった場合、
  そのMOBのスキルを初期化する機能追加。
  	・mob_skill_db2.txtであるMOBのスキルを完全に書き換えるときに使用して
	  ください。
	・clearしなかった場合はmob_skill_db.txtのものに追加されます。
  
	mob.c
		mob_readskilldb()修正


・アイテム名/MOB名が全角12文字（24バイト）あるアイテム/MOBが、
  @コマンドで取り寄せ/召喚できない問題修正。
  	mob.c
		mobdb_searchname()修正
	itemdb.c
		itemdb_searchname_sub()修正

・現在時刻でイベントを起こす「時計イベント」機能を追加
	・OnInitと同じようにそれぞれのNPCで、On〜で始まるラベルを定義します。
		OnMinute??	：毎時、??分にイベントを起こします。(0-59)
		OnHour??	：毎日、??時にイベントを起こします。(0-23)
		OnClock????	：毎日、??時??分にイベントを起こします。
		OnDate????	：毎年、??月??日にイベントを起こします。
	・詳しくは npc_test_ev.txt を参照
	
	(conf/)
	npc_test_ev.txt
		内容追加
	(map/)
	npc.c
		色々修正

・その他
	clif.c
		コンパイル警告が出ないように修正

--------------
//0725 by 死神

・鯖落ちバグ修正。
・モンスターにイベントが設定されていて自殺やなにかでダメージを与えた
物がない場合鯖落ち確定なのでそのマップにあるプレイヤーを利用して
イベントスクリプトを実行するように変更。
	(map/)
	makefile 修正。
	mob.c
		mob_timer()、mob_damage() 修正。

--------------
//0724 by 死神

・バグ修正と安定化の為の修正。
・ペットの攻撃でイベントが処理されず鯖落ちになる問題修正。(未テスト)
・モンスターの大量発生で鯖が落ちる問題修正。(モンスターを10000匹を呼んで
魔法で倒すことを5回程テスト。ただ動かないやつのみ。)
・取り巻きがボスと一緒に死ぬ時アイテムを落とさないように変更。(未テスト)
・battle_athena.confのpc_skillfleeをplayer_skillfreeに変更して処理を変更。
・アイスウォールにskill_unit_settingを使うスキルで攻撃できないように修正。
・その他細かい修正少し。安定化されたかどうかはまだわかりませんがXP1800+、512M、モンスター配置50%で10000匹召喚して異常なかったので大丈夫になったと思います。大丈夫じゃなくても責任はとれませんが...
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	mob.h 修正。
	mob.c
		mob_timer()、mob_deleteslave_sub()、mob_damage() 修正。
	npc.c
		npc_event() 修正。
	skill.c
		skill_area_sub()、skill_unit_onplace()、skill_castend_nodamage_id() 修正。
	clif.c
		clif_parse_GMKick() 修正。
	battle.h
	battle.c
		battle_damage()、battle_check_target()、battle_config_read() 修正。
	pc.c
		pc_calc_skilltree()、pc_checkskill() 修正。
	map.h 修正。
	map.c
		map_foreachinarea()、map_foreachinmovearea() 修正。
		map_foreachobject() 修正。

--------------
//0723 by DRG

・0719の修正
	(map/)
	pc.c		pc_calc_skilltree()修正

--------------
//0722 by パイン

・gcc 2.29系列でもコンパイルが通るように修正。
　これは以前にも直したはずなのですが、なぜか元に戻っていましたので
　皆さん注意をお願いします。
　あと、gcc3系列なら定数はどこに書いても問題ないのですが、
　gcc2.29系列では「必ずブロック要素の一番最初」に書かないとコンパイルが
　通りませんのでこちらもご注意願います。

コンパイルが通る例
void hoge() {
    const char booboo = 1;
    …

コンパイルが通らない例
void hoge() {
    …
    const char booboo = 1;
    …

	(map/)
	skill.h		マクロを修正
	skill.c		skill_addisional_effect()修正

--------------
//0721 by 聖

・ボスにレックスデビーナが効いた問題を修正。
・ボスにカードによる状態異常が効かなかった問題を修正。
　本鯖ではマリナカード等でオークヒーローなどを殴ると時々凍結します。
　(結構微妙な実装方法なので、何か問題があった場合
　 その辺詳しい方おりましたら修正してやってください(^^; ))

--------------
//0720 by 胡蝶蘭

・PCにIWを重ねるとMOBが攻撃してこない問題を修正
	・IWに重なっていても、隣接可能ならMOBが近寄ってきます
	・どんな地形にいても、隣接しているなら攻撃可能になります
	・ただし、MOBが遠距離攻撃可能で、攻撃範囲内にPCがいても、
	  隣接不可能なら攻撃してきません。これの解決はかなり面倒なので。

	mob.c
		mob_can_reach()修正
	battle.c
		battle_check_range()修正

--------------
//0719 by DRG

・下位スキルがない場合は上位スキルがふれないようにしました。
　battle_athena.confのskillfleeで設定可能です。
　下位スキルがないまま上位スキルをふった状態で、このオプションを使う場合はスキルリセットする必要があります。
　一般アカにスキルリセットを解放したいときに使ってやって下さい。
	(conf/)
	battle_athena.conf
	(map/)
	battle.c
	battle.h
	pc.c		pc_calc_skilltree(),pc_checkskill()修正

--------------
//0718 by 死神

・色々と修正。
・毒によって防御が減るように変更。(HPはまだ減りません。)
・アイスウォールに攻撃できるように変更。(今は全ての攻撃に当たります。)
ただ鞍のバグらしくアイスウォールをクリックすると鞍から0x89パケットが30回以上連続で送ってくることが起こりますが原因は不明です。多分鞍のバグだと思いますが...)
・戦闘に関わる計算等を修正。
・ゼニが増えるバグ修正。(多分これでこのバグはなくなると思いますがどうなのか報告をお願いします。)
・二刀流の左手武器の種族、属性、Sizeのダメージ補正を右手武器に適用するかどうかを設定できるように変更。
・その他修正はしたはずですが覚えてません。(修正してない物もありますがdiff当ての途中でどれを作業したのかを忘れたので...)
	(common/)
	mmo.h 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_get_baseatk()、battle_get_speed()、battle_get_adelay() 追加。
		battle_get_amotion() 、battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_get_atk()、battle_get_atk_()、battle_get_atk2() 修正。
		battle_get_attack_element()、battle_get_attack_element2() 修正。
		battle_get_str()、battle_get_agi()、battle_get_vit()、battle_get_int() 修正。
		battle_get_dex()、battle_get_luk()、battle_get_flee() 修正。
		battle_get_flee2()、battle_get_hit()、battle_get_critical() 修正。
		battle_get_def()、battle_get_def2()、battle_get_mdef() 修正。
		battle_get_element()、battle_check_target()、battle_check_range() 修正。
		battle_weapon_attack()、battle_config_read() 修正。
	clif.c
		clif_skill_estimation()、clif_mob0078()、clif_mob007b() 修正。
	pc.c
		pc_attack_timer()、pc_attack()、pc_calcstatus()、pc_payzeny() 修正。
		pc_getzeny() 修正。
	npc.c
		npc_buylist()、npc_selllist() 修正。
	pet.c
		pet_attack()、pet_randomwalk()、pet_ai_sub_hard() 修正。
	mob.h 修正。
	mob.c
		calc_next_walk_step()、mob_attack()、mobskill_castend_id() 修正。
		mobskill_use_id()、mobskill_use_pos()、mob_ai_sub_hard() 修正。
		mob_damage()、mob_changestate() 修正。
		mob_get_adelay()、mob_get_speed() 削除。
	skill.h 修正。
	skill.c
		skill_unitsetting()、skill_unit_ondamaged()、skill_unit_timer_sub() 修正。
		skill_unit_timer()、skill_area_sub()、skill_unit_onplace() 修正。
		skill_status_change_start() 修正。
	chat.c 修正。
	makefile 修正。
	chrif.c 修正。
	guild.c 修正。
	itemdb.c 修正。
	map.c 修正。
	party.c 修正。
	script.c 修正。
	path.c 修正。

--------------
//0717 by 聖

・大量にモンスターを召還して一度に倒すとmap-serverが落ちる問題を修正。
　(カホを100体ずつ召還して50回テストをしたので恐らく大丈夫だと思います。)
・その他結構細かい修正
	(common/)
	mmo.h
	(map/)
	chat.c
	chrif.c
	clif.c
	guild.c
	itemdb.c
	map.c
	mob.c
	npc.c
	party.c
	path.c
	pc.c
	pet.c
	script.c
	skill.c
	skill.h

--------------
//0716 by 聖

・精錬成功率に対してBSの武器研究が正しく適用されていなかった問題を修正。
	(map/)
	pc.c
		pc_percentrefinery() 修正。

--------------
//0715 by 死神

・マップサーバーから表示される物を表示するかどうかの設定ができるようにしました。スキル表示だけでもなくしてやるとサーバーがかなり楽になったりもします。
開発やバグトレースの時は表示することをお勧めします。
・その他細かい修正。
・修正した所を全て書けないのでファイルだけ。
	(doc/)
	conf_ref.txt
	(conf/)
	battle_athena.conf
	(map/)
	makefile
	skill.c
	script.c
	pet.c
	pc.c
	path.c
	party.c
	npc.c
	itemdb.c
	intif.c
	guild.c
	chat.c
	battle.h
	battle.c
	chrif.c
	atcommand.c
	clif.c
	mob.c
	map.c

--------------
//0714 by 死神

・細かい修正。
・シールドブーメランで盾の重量と精錬によってダメージが増えるように修正。精錬ダメージを足す時適用でダメージ+重量+盾精錬*4(この4はrefine_db.txtの防具の過剰精錬ボーナスを使ってるので変更可能です。)になります。
・スキルによる吹き飛ばし処理で0x88パケットを使っていましたがそのパケットの優先順位がかなり低いらしく後で来るパケットによって無視されることもあるようなのでプレイヤーだけに適用してモンスターには0x78を使うように変更しました。
でも位置ずれは完全になくならないようです。(恐らく鞍のバグだと思います。鯖の
座標を確認してみましたが鯖の方は問題がありませんでした。)
プレイヤーの場合0x78(PACKETVERが4以上なら0x1d8)が使えません。分身を作ってしまうので...
・バグ報告スレッド2 の47を取り込みました。
・その他修正した所少しあり。
	(db/)
	refine_db.txt 修正。
	item_db.txt 修正。
	(map/)
	battle.c
		battle_stopattack()、battle_stopwalking() 修正。
		battle_get_attack_element2()、battle_calc_pc_weapon_attack() 修正。
		battle_weapon_attack() 修正。
	path.c
		path_blownpos() 修正。
	pc.h 修正。
	pc.c
		pc_stop_walking()、pc_damage() 修正。
		pc_getrefinebonus() 追加。
	mob.c
		mob_damage() 修正。
	pet.c
		pet_target_check()、pet_stop_walking()、pet_performance() 修正。
	skill.c
		skill_attack()、skill_blown()、skill_status_change_start() 修正。
		skill_castend_damage_id() 修正。
	makefile 修正。

--------------
//0713 by ぽぽぽ

・mob_avail.txt追加。item_avail.txtと同様の指定でモンスターの見た目を他のIDのものに変更します。
　モンスターのID以外を指定したりするとPCやNPCの姿をしたMOBに一方的に攻撃される場合があるので注意。
	(db/)
	mob_avail.txt 追加。
	(map/)
	clif.c
		clif_mob0078()、clif_mob007b() 修正。
	mob.h 修正。
	mob.c
		mob_readdb_mobavail()、mob_get_viewclass()追加。
		do_init_mob()、mob_readdb() 修正。

--------------
//0712 by 死神

・シールドチャージ、シールドブーメラン実装。
・オートガードはとりあえずエフェクトが出るように変更しました。
・0708で書き忘れ。ディフェンダーを使った時ASPDと移動速度は20%低下します。
本鯖で低下するのは確かのようですがどれぐらい下がるのかはさっぱりわかりまんので...
・その他細かい修正。
	(db/)
	cast_db.txt 修正。
	skill_db.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_calc_damage()、battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_calc_magic_attack()、battle_calc_misc_attack() 修正。
	skill.c
		skill_additional_effect()、skill_attack()、skill_castend_nodamage_id() 修正。
		skill_check_condition()、skill_status_change_start() 修正。
		skill_castend_damage_id() 修正。
	pc.h 修正。
	pc.c
		pc_calcstatus()、pc_checkallowskill()、pc_unequipitem() 修正。

--------------
//0711 by npc

・鉱石製造エフェクトの修正
・スクリプト埋め込み変数にHp,MaxHp,Sp,MaxSpを追加(読み込みのみ)
	(map/)
	skill.c
		skill_produce_mix()修正。
	pc.c
		pc_readparam()修正。
	(db/)
		const.txt 修正。

--------------
//0710 by 胡蝶蘭

・名前に半角スペースが入ったパーティーを作成したとき、および、
  半角スペースが入った名前のPCをパーティメンバにしたとき、
  party.txtが正しく読み込めなくなる問題を修正

	(char/)
	int_party.c
		inter_party_fromstr()修正

・Message of the Day 機能追加
	・ログインしたユーザーにMOTDを表示させることが出来ます。
	・map-server.exe実行時のカレントディレクトリ（help.txtと同じ
	  ディレクトリ）にmotd.txtを作ると表示します。
	・MOTDが表示されるタイミングは、
	  「マップサーバーにログインした直後の、マップロード完了時」です。
	  つまり、ログイン直後、キャラセレ直後および、
	  マップサーバー間移動の時(マップサーバーの分散を行っている場合のみ)
	  のマップロードが終わった時に表示されます。
	・表示方法はhelp.txtと同じで普通のメッセージとして送信します。
	  （ギルド告知メッセージは文字数制限があり、GMアナウンスは長時間
	    画面の上部に表示されてしまうため）
	・会話と区別がつくように、"< Message of the Day >"、"< End of MOTD >"
	  の文で上下を囲います。
	
	(map/)
	pc.c
		pc_authok()修正


--------------
//0709 by ぽぽぽ

・スクリプトにemotion追加
　emotion n;と使うとNPCがエモを出します。nは0〜33が使用可能。
・精錬と街ガイドのNPCを本鯖の台詞に合わせて修正。
	(conf/)
	npc_town_refine.txt、npc_town_guide.txt 修正。
	(map/)
	script.c
		buildin_emotion() 追加。

--------------
//0708 by 死神

・スキルキャストキャンセル、ディフェンダー、オートガード実装。
・オートガードの場合ガードしてもエフェクトは出ません。ミスになるだけです。本鯖の方は表示されるかどうかもわからないしパケット情報もないので...
・ディフェンダーは未テスト。bLongAtkDefを使ってるのでホルンカードのようにbLongAtkDefを上げる物を装備して使うと遠距離物理攻撃を全て無効にできます。(これも本鯖の仕様がどうなのかはわかりません。)
・その他細かい修正。
	(db/)
	cast_db.txt 修正。
	(map/)
	map.h 修正。
	map.c
		map_quit() 修正。
	skill.h 修正。
	skill.c
		skill_castend_nodamage_id()、skill_use_id()、skill_check_condition() 修正。
		skill_castend_id()、skill_castend_nodamage_id()、skill_castcancel() 修正。
	pc.c
		pc_calcstatus()、pc_setpos()、pc_damage() 修正。
	battle.c
		battle_calc_damage()、battle_damage() 修正。
	clif.c
		clif_parse_UseSkillToId()、clif_parse_UseSkillToPos() 修正。
	mob.c
		mob_damage() 修正。
	itemdb.c
		itemdb_searchrandomid() 修正。

--------------
//0707 by 死神

・0705の阿修羅覇鳳拳のバグ修正。
	(db/)
	skill_db.txt
	(map/)
	skill.c
		skill_castend_id()
		skill_castend_pos()
	battle.c
		battle_calc_pc_weapon_attack()
	clif.c
		clif_parse_UseSkillToId()

--------------
//0706 by kalen
・修正
	conf/npc_warp_umbala.txt

--------------
//0705 by 死神

・色々と修正。
・プレイヤーのクリティカル計算にバグがあったので修正。
・爆裂波動の処理修正。
・モンクのコンボを修正。
・阿修羅覇鳳拳の使用によってマップ鯖の無限ループバグ修正。(これかなり致命的な物だったようです。)
・コンボで使う阿修羅覇鳳拳は敵をクリックする必要がないように修正。
・猛龍拳で敵を吹き飛ばす距離を5セルに変更。よってコンボで使う阿修羅覇鳳拳は距離チェックをしません。5セル飛ばされた敵は阿修羅覇鳳拳の射程から離れたわけなので距離チェックなしで発動します。(本鯖の仕様なんて知りません。)
・マップの名前を16byteから24bytesに変更。(大した意味はありませんが安全の為の物です。)
・ウェディングキャラによる鞍落ちを防ぐ為に修正。
・その他少し修正。(テストは殆んどしてません。)
	(conf/)
	battle_athena.conf 修正。
	(db/)
	skill_db.txt 修正。
	(common/)
	mmo.h 修正。
	(doc/)
	conf_ref.txt 修正。
	item_bonus.txt 修正。
	(map/)
	battle.h 修正。
	battle.c
		battle_get_flee2()、battle_calc_pet_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_config_read() 修正。
	skill.h 修正。
	skill.c
		skill_status_change_start()、skill_castend_damage_id() 修正。
		skill_check_condition()、skill_use_id()、skill_blown() 修正。
		skill_castend_map()、skill_unit_onlimit()、skill_attack() 修正。
	pc.c
		pc_attack_timer()、pc_setpos()、pc_setsavepoint() 修正。
		pc_movepos()、pc_calcstatus()、pc_bonus() 修正。
	clif.h 修正。
	clif.c
		clif_set0078()、clif_set007b() 修正。
		clif_updatestatus()、clif_initialstatus()、clif_parse_UseSkillToId() 修正。
		clif_skillinfo() 追加。
	map.h 修正。
	map.c
		map_setipport()、map_addmap() 修正。
	その他抜けた所少しあり。

--------------------
//0704 by kalen

・Umbala Warp追加
	conf/npc_warp_umbala.txt

--------------------
//0703 by いど

・サーバーsnapshot

--------------
//0702 by ぽぽぽ

・ファーマシーのエフェクトを本来のものに変更
・スクリプトでの埋め込み変数にBaseExp,JobExp,NextBaseExp,NextJobExp追加
	(map/)
	skill.c
		skill_produce_mix() 修正。
	pc.c
		pc_readparam()、pc_setparam() 修正。
	(db/)
		const.txt 修正。

--------------
//0701 by ぴざまん

・ステータス異常判別式導入。各ステータス異常の発動率がVIT/INT/MDEFに影響するようになります。持続時間短縮はまた今度で_|‾|○
・不死に凍結が効いたバグ修正。
	(map/)
	skill.c
		skill_additional_effect()、skill_castend_nodamage_id() 修正。

--------------
//0700 by 南

・697のバグ修正。
　　　　(db/)
        mob_db.txt

--------------
//0699 by 死神

・装備のボーナスクリティカルは自分の間違いだったのでbCriticalRateをbCriticalに変更。それと0695で書き忘れですがASPDを上げるカードや装備の一部をbAspdAddRateからbAspdRateに変更しました。みすとれ巣のシミュレーターによるとドッペルカードは複数でも一つしか適用されないみたいだったので。
	(db/)
	item_db.txt

--------------
//0698 by 死神

・一部のキャラに重量が０になってカプラなど何もＰＣ，ＮＣＰが表示されなくなるバグ修正。(それだけ)
	(common/)
	mmo.h 修正。
	(map/)
	clif.c
		clif_updatestatus() 修正。
	pc.c
		pc_calcstatus() 修正。

--------------
//0697 by 南

・mob_db修正
　ドロップを中心に修正。
　　　　(db/)
        mob_db.txt

--------------
//0696 by 死神

・バグ修正。
・テレポートやワープ等の時スキルユニットから抜ける処理が入って
なかったのでSAFETYWALL等によって鯖落ちが起こったようです。(確か報告も
あったと思いますが...) よって修正はしましたが確認はしてません。報告を
お願いします。
・スキルによる吹き飛ばし処理をちょっと修正とモンスターのコードを少し修正。
多分変になったことはないと思いますが変だったら報告してください。
・その他細かい修正。
	(map/)
	skill.h 修正。
	skill.c
		skill_blown()、skill_attack()、skill_unit_move() 修正。
		skill_castend_nodamage_id()、skill_castend_damage_id() 修正。
		skill_unit_out_all()、skill_unit_out_all_sub() 追加。
	mob.c
		mob_stop_walking()、mob_spawn()、mob_warp() 修正。
		mob_can_move()、mob_changestate() 修正。
	map.h 修正。
	pc.c
		pc_setpos() 修正。
	battle.c
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack() 修正。

--------------
//0695 by 死神

・少し修正。
・プレイヤーの基本パラメータを2byteに拡張。
・item_db.txtをラグナゲートの説明に合わせて修正。
・bAddEffとbResEffの確率を百分率から万分率に変更。
・スクリプトstatusupとstatusup2追加。
statusup bStr; のように使って機能はステータスポイントを減らして
基本パラメータを1上げる。
statusup2 bInt,n; のように使って機能はステータスポイントを減らさずに
基本パラメータをn上げる。
・その他細かい修正。
	(conf/)
	battle_athena.conf 修正。
	(db/)
	item_db.txt 修正。
	const.txt 修正。
	(doc/)
	item_bonus.txt 修正。
	conf_ref.txt 修正。
	(common/)
	mmo.h 修正。
	(char/)
	char.c
		mmo_char_send006b()、parse_char() 修正。
	(map/)
	map.h 修正。
	clif.h 修正。
	clif.c
		clif_initialstatus()、clif_updatestatus() 修正。
	pc.h 修正。
	pc.c
		pc_bonus()、pc_calcstatus()、pc_equippoint()、pc_equipitem() 修正。
		pc_jobchange()、pc_checkbaselevelup()、pc_statusup() 修正。
		pc_statusup2() 追加。
	battle.h 修正。
	battle.c
		battle_calc_pet_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pc_weapon_attack()、battle_config_read() 修正。
	skill.c
		skill_additional_effect()、skill_status_change_start() 修正。
	script.c
		buildin_statusup()、buildin_statusup2() 追加。
	atcommnad.c 修正。

--------------
//0694 by 死神

・バグ修正と細かい修正。
・bCriticalRateが正しく適用されなかった問題修正。
・ペットによるステータスボーナス追加。ステータスボーナスは装備の
スクリプトによって設定します。ただペットによるボーナスはカードによる物と同じ扱いをします。そして属性の適用は一番優先順位低いです。今は何も入ってませんが...
	(conf/)
	battle_athena.conf 修正。
	(db/)
	const.txt 修正。
	pet_db.txt 修正。
	(doc/)
	item_bonus.txt 修正。
	conf_ref.txt 修正。
	db_ref.txt 修正。
	(map/)
	map.h 修正。
	map.c
		map_quit() 修正。
	battle.h 修正。
	battle.c
		battle_calc_pc_weapon_attack()、battle_weapon_attack() 修正。
		battle_calc_magic_attack()、battle_calc_misc_attack() 修正。
		battle_config_read() 修正。
	pc.c
		pc_calcstatus()、pc_bonus()、pc_setpos()、pc_authok() 修正。
		pc_damage()、pc_autosave_sub() 修正。
	pet.h 修正。
	pet.c
		pet_hungry()、pet_birth_process()、pet_recv_petdata()、pet_food() 修正。
		pet_return_egg()、pet_ai_sub_hard()、read_petdb() 修正。
	clif.c
		clif_sendegg()、clif_parse_LoadEndAck() 修正。
	atcommand.c 修正。
	makefile 修正。

--------------
//0693 by 胡蝶蘭

・SC_*の列挙表をリナンバリング
	クライアントに通知するのを64未満から128未満に増やした
	パケット情報に合うようにリナンバー
	StatusChangeの配列を128から192に増やしたのでメモリ使用量が増えます。
	
	(db/)
	const.txt
		SC_* の数値を変更
	(map/)
	skill.h
		SC_* の列挙の数値を変更
	map.h
		MAX_STATUSCHANGEを128から192に増やした
	skill.c
		skill_status_change_start(),skill_status_change_end(),
		skill_status_change_clear()の通知処理を変更

・演奏/ダンスの処理を変更
	演奏/ダンス中かどうかをSC_DANCINGで判定するように変更
	（判定処理が多少高速化されたはず）
	ワープ(マップ移動や蝿など)すると演奏/ダンスを中断するように変更
	
	skill.h/skill.c
		skill_check_dancing()削除、skill_stop_dancing()追加
		skill_delunitgroup(),skill_initunitgroup()変更
		skill_status_change_start()変更
		skill_castend_nodamage_id()変更
		書き損じがあるかも・・
	pc.c
		pc_calcstatus(),pc_setpos(),pc_damage()変更

・不協和音スキルの修正
	(db/)
	skill_db.txt
		不協和音スキルのHIT数修正
	(map/)
	skill.c
		skill_status_change_timer()変更
	battle.c
		battle_calc_misc_attack()修正

--------------
//0692 by 胡蝶蘭

・アドリブスキルが使用できない問題修正（skill_dbの添付し忘れ）
	(db/)
	skill_db.txt
		アドリブの消費SPを1に修正

・mob_db2.txtがあればmob_db.txtにオーバーライドするように
	オリジナルmobを作ってる人は使うと便利かもしれません。

	mob.c
		mob_readdb()

・鯖落ちバグ報告時のためのスタックバックトレースログ所得方法を紹介
	鯖落ちバグの報告時に、この情報をコピペすると開発者が喜びます。
	Cygwinでcoreの吐かせる方法も紹介してます。

	(doc/)
		coredump_report.txt

--------------
//0691 by 胡蝶蘭

・item_db2.txtがあればitem_db.txtにオーバーライドするように
	オリジナルアイテムを作ってる人は使うと便利かもしれません。

	itemdb.c
		itemdb_readdb()修正

・演奏/ダンス系スキル仮実装
	・演奏/ダンス中は移動が遅く、スキルも使えないようになりました
	・アドリブスキルで演奏/ダンスを中断できるようになりました
	・演奏/ダンスは石化などの異常、MHPの1/4以上のダメージで中断します
	・キャラクターグラフィックは演奏/ダンスしません
	・演奏/ダンス中のSP消費は未実装です
	・移動しても効果範囲はついてきません
	・重複しても不協和音などに変化しません
	・エフェクトが出ても効果は未実装のものがあります
	・ほとんど未テストなので多数の不都合があると思います

	skill.h
		SC_* の列挙表を修正
	skill.c
		skill_check_dancing()追加
		SkillStatusChangeTable[]修正
		skill_unit_onout(), skill_status_change_start(),
		skill_status_change_timer(),skill_unitsetting(),
		skill_castend_id(),skill_castend_pos(),skill_castend_map(),
		skill_castend_nodamage_id()修正
		その他は忘れました
	pc.c
		pc_calcstatus(),pc_damage()修正

--------------
//0690 by 波浪

・細かい修正
	(db/)
	item_db.txt 錐とメギンギョルドのbonusを修正。
	(doc/)
	item_bonus.txt 修正。

--------------
//0689 by 死神

・倉庫バグ修正と細かい修正。
	(map/)
	pc.c
		pc_modifybuyvalue()、pc_modifysellvalue() 修正。
	storage.c
		storage_storageopen() 修正。
		storage_storage_quit()、storage_storage_save() 修正。

--------------
//0688 by 聖

・ディスカウント、コムパルションディスカウント、オーバーチャージが適用されなかった問題を修正。
	(map/)
	pc.c
		pc_modifybuyvalue() 修正。
		pc_modifysellvalue() 修正。

--------------
//0687 by 死神

・少し修正。
・battle_athena.confに項目追加。(詳しいことはconf_ref.txtで)
・item_avail.txtの処理を変更。アイテムIDの後に0を入れると今まで通りに使用不可能になるが0以外の数値を入れると使用不可能ではなくその数値をアイテムのIDとして見た目だけをそれに変更します。よって鞍落ちアイテムを別の物に表示して鞍落ちを防ぐことができます。(表示だけ変えて鯖の処理は本当のアイテムIDの物として認識します。修正は全てしたと思いますが抜けた所があるかも知りませので見た目変更したアイテムで鞍落ちが起こったら報告してください。) 鯖の処理はこれが限界です。(少なくとも自分には) アイテムが同じ物が二つ表示されて間違い安いとかどうこうとかの文句を言いたい人は鞍作れよ。以上。
・ジルタスとアリスのコマントアウト解除。item_avail.txtで卵をルビーとアクアマリンで表示して捕獲アイテムも他の物に表示するように変更しています。
・ダメージ計算のバグ修正。(大した物じゃありませんが弓だけちょっと問題があったようです。)
・青箱等のアイテムで得た装備品は未鑑定になるように変更。
・装備ボーナスの内部処理修正と少し変更。(詳しいことはitem_bonus.txtで)
・キャラ鯖にテータを送る時キャラ、倉庫、ペットのテータを同時に送るように変更。(キャラ鯖とマップ鯖の間の転送量が増えるかも知りれませんがデータを同期化の為です。)
・FWの動作間隔を0.25秒から0.1秒に変更。(これで摺り抜は少し減るはずです。)
・カートレボリュションでどんな状態異常もかからないように変更。
	(conf/)
	battle_athena.conf 修正。
	(db/)
	const.txt 修正。
	item_avail.txt 修正。
	pet_db.txt 修正。
	(doc/)
	conf_ref.txt 修正。
	item_bonus.txt 修正。
	(map/)
	map.h 修正。
	map.c
		map_quit() 修正。
	battle.h 修正。
	battle.c
		battle_calc_pc_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_get_dmotion()、battle_config_read() 修正。
	pc.c
		pc_calcstatus()、pc_bonus()、pc_bonus3()、pc_setpos() 修正。
		pc_makesavestatus()、pc_autosave_sub()、pc_modifybuyvalue() 修正。
		pc_modifysellvalue()、pc_stop_walking() 修正。
	skill.c
		skill_additional_effect()、skill_unitsetting() 修正。
	clif.c
		clif_buylist()、clif_selllist()、clif_set009e()、clif_set0078() 修正。
		clif_set007b()、clif_additem()、clif_itemlist()、clif_equiplist() 修正。
		clif_storageitemlist()、clif_storageequiplist()、clif_changelook() 修正。
		clif_arrow_create_list()、clif_useitemack()、clif_tradeadditem() 修正。
		clif_storageitemadded()、clif_getareachar_item() 修正。
		clif_skill_produce_mix_list()、clif_cart_additem()、clif_cart_itemlist() 修正。
		clif_cart_equiplist()、clif_vendinglist()、clif_openvending() 修正。
		clif_produceeffect()、clif_sendegg()、clif_pet_equip()、clif_mvp_item() 修正。
		clif_pet0078()、clif_pet007b() 修正。
	itemdb.h 修正。
	itemdb.c
		itemdb_searchrandomid()、itemdb_search()、itemdb_readdb() 修正。
		itemdb_read_itemavail()、itemdb_read_itemvaluedb() 修正。
		itemdb_equippoint() 削除。
	storage.h 修正。
	storage.c
		storage_storage_quitsave() ->storage_storage_quit()に変更と修正。
		storage_storageclose() 修正。
	atcommand.c 修正。
	pet.c
		pet_change_name()、pet_equipitem()、pet_unequipitem() 修正。
		pet_birth_process()、pet_return_egg() 修正。
	script.c
		buildin_getitem() 修正。
	mob.c
		mob_stop_walking() 修正。
	makefile 修正。

--------------
//0686 by 聖

・細かい修正。
	(map/)
	pc.h 修正。

--------------
//0685 by 波浪

・0683、0684でのbonusの追加にともなってitem_db.txtを修正
・他色々修正
	(db/)
	item_db.txt 修正。
	(doc/)
	item_bonus.txt 修正。

--------------
//0684 by 死神

・細かい修正。
・死んだふりの時スキルとアイテムが使えないように変更。
・bInfiniteEndure追加。機能は無限インデュア。
・ダメージ表示の処理少し変更。
	(db/)
	const.txt 修正。
	(doc/)
	item_bonus.txt 修正。
	(map/)
	map.h 修正。
	pc.c
		pc_calcstatus() 修正。
		pc_equipitem()、pc_unequipitem() 修正。
	clif.c
		clif_parse_UseItem()、clif_parse_UseSkillToId() 修正。
		clif_parse_UseSkillToPos()、clif_parse_UseSkillMap() 修正。
		clif_damage()、clif_skill_damage()、clif_skill_damage2() 修正。
		clif_parse_LoadEndAck() 修正。
	skill.c
		skill_status_change_timer() 修正。

--------------
//0683 by 死神

・バグ修正とbonus追加。
・倉庫バグ、属性バグ修正とその他のバグ修正。
・スクリプトbonus3追加。今はbAddMonsterDropItemだけが対応になっています。
・bonus bRestartFullRecover;n;等でnは無意味だけど消すのはちょっとまずいですので0にして入れた方がいいです。bonusは2つの数値が必要なスクリプトなので。
・bDefRatioAtkを防御無視に変更。
・0677で書き忘れ。
・武器の属性適用優先順位を製造>カード>武器に変更。製造が最優先です。(属性がある時に話です。属性がない場合属性ある物に上書きされたりはしません。)
・装備で適用される効果の優先順位を右手>左手>体>頭上>頭中>頭下>ローブ>靴>アクセサリー1>アクセサリー2>矢に設定。(本鯖仕様がどうなのか分かることができそうな物でもないのでアテナの仕様と言うことで。) 右手が最優先です。
・武器の射程を右手と左手の武器の中で長い物を適用するように変更。
	(db/)
	const.txt 修正。
	(doc/)
	item_bonus.txt 修正。
	(map/)
	map.h 修正。
	battle.c
		battle_calc_pc_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_calc_pet_weapon_attack()、battle_calc_magic_attack() 修正。
		battle_damage() 修正。
	pc.c
		pc_autosave_sub()、pc_calcstatus() 修正。
		pc_bonus()、pc_bonus2() 修正。
		pc_bonus3() 追加。
	script.c
		buildin_bonus3() 追加。
	mob.c
		mob_once_spawn()、mob_damage() 修正。
	storage.h 修正。
	storage.c
		storage_storage_save() 追加
	atcommand.c 修正。

--------------
//0682 by 聖

・スピードアップポーション系のバグ修正
	(map/)
	pc.c
		pc_calcstatus() 修正。

--------------
//0681 by 死神

・装備バグ修正。
	(map/)
	pc.c
		pc_equipitem() 修正。

--------------
//0680 by 聖

・細かい修正。
・「@monster」コマンドでモンスターIDの指定に「-1」、「-2」等を指定すると
　モンスターをランダムで召還できる機能を追加。
	(map/)
	mob.c
	atcommand.c

--------------
//0679 by 波浪

・0676で新しいアイテム効果が実装されたので、item_db.txtを修正(bonus bAddMonsterDropItem,n,x; は、種族判定ができないのでとりあえず保留しました。)
・他色々修正
	(db/)
	item_db.txt
	job_db1.txt
	(doc/)
	item_bonus.txt

--------------
//0678 by 聖

・召還関連の細かい修正。
	(map/)
	mob.c
		mob_once_spawn_area() 修正。

--------------
//0677 by 死神

・細かい修正。
・アイテム売買によって得られる経験値をカードによるスキルでは得られないように修正。
・毒に掛かると自然回復できないように修正。
・0676で書き忘れ。製造武器の場合製造によって与えた属性が武器の属性より優先して適用されるように変更。(製造武器が無属性の場合は適用されません。)
	(doc/)
	item_bonus.txt 誤字修正。
	(map/)
	npc.c
		npc_buylist()、npc_selllist() 修正。
	pc.c
		pc_calcstatus()、pc_natural_heal_sub() 修正。

--------------
//0676 by 死神

・色々と修正。
・battle_athena.confに項目追加。(詳しいことはconf_ref.txtで)
・みすとれ巣を参考してダメージ計算を少し修正。
・装備bonusに色々と追加。(詳しいことはitem_bonus.txtで)
・自動セーブする時(キャラ鯖にデータを送る時)倉庫のデータも送るように変更。
・0667で言い忘れ。カートを外してもアイテムが消えないように変更。(本鯖で消えるのが仕様だと思っていたけど修正されたみたいなので。)
・取引要請を受ける側は基本スキルをチェックしないように修正。(受ける側の基本スキルチェックは自分が入れた物ではないです。いつの間にか入っていたので削除しました。)
・防具の精錬ボーナスを端数無視に変更。(これが本鯖の仕様みたいなので)
・アンクルの処理少し変更。(かからないと言う報告がありましたので...)
・プレイヤーのステータス計算で問題ありそうな所修正。
・カードのIDで機能が決まっていたカードもスクリプトによって変えることができるように変更。(詳しいことはitem_bonus.txtで)
・aspd計算方法少し変更。
・矢にbCritical、bAtkEle、bHit、bAddEle、bAddRace、bAddSize、bAddEffを適用できるように変更。矢を使うスキルや弓による攻撃だけに矢のbCritical、bAtkEle、bHit、bAddEle、bAddRace、bAddSize、bAddEffが適用されるように修正。
・キリの実装に為に修正はしましたがキリが防御無視なのかどうかがわからなかったので防御無視はしないようになっています。
・テストした物はbAddMonsterDropItemとbGetZenyNumだけなので正常に動作するかどうかの報告が欲しい所です。(ついでにitem_dbの修正も...これで吸収系とオートスペル系以外は殆ど実装できるはずです。多分...)
・その他は覚えてないけど修正した所が少しあるかも...
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	item_bonus.txt 修正。
	(db/)
	const.txt 修正。
	(char/)
	inter.c
		inter_init() 修正。
	int_storage.c
		mapif_parse_SaveStorage() 修正。
	(map/)
	trade.c
		trade_traderequest() 修正。
	pc.h 修正。
	pc.c
		pc_autosave_sub()、pc_calcstatus() 修正。
		pc_bonus()、pc_bonus2() 修正。
		pc_setrestartvalue()、pc_setequipindex() 修正。
		pc_check_equip_wcard()、pc_check_equip_dcard()、pc_check_equip_card() 削除
		その他修正。
	skill.h 修正。
	skill.c 修正。
		skill_castend_nodamage_id()、skill_unit_onplace() 修正。
		skill_check_condition()、skill_additional_effect() 修正。
		skill_attack()、skill_status_change_start() 修正。
	map.h 修正。
	battle.h 修正。
	battle.c
		battle_get_def()、battle_get_mdef2() 修正。
		battle_weapon_attack()、battle_damage() 修正。
		battle_calc_magic_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pet_weapon_attack() 修正。
		battle_calc_misc_attack()、battle_config_read() 修正。
	mob.c
		mob_damage() 修正。
	pet.c
		pet_target_check() 修正。
	clif.c
		clif_set0078()、clif_set007b()、clif_changelook() 修正。
	atcommand.c 修正。

--------------
//0675 by 波浪

・韓鯖で村正の効果が変更されたので報告を元にitem_db.txtを修正
・job_db1.txtを修正
	(db/)
	item_db.txt
	job_db1.txt

--------------
//0674 by npc

・ファーマシーの仮実装。
	(db/)
	produce_db.txt
	(map/)
	skill.c

--------------
//0673 by 南

・集中力向上に装備品の補正が入っていなかったのを修正。
　　　　　(map/)　　　
　　　　　 pc.c

--------------
//0672 by 南

・集中力向上に装備品の補正が入っていなかったのを修正。
　　　　　(map/)　　　
　　　　　 pc.c

--------------
//0672 by 聖

・モンスター系のバグ修正(すみません、まだ残ってました(^^; )
	(map/)
	mob.c

--------------
//0671 by 聖

・IDチェック範囲の修正他。
・@monsterで数を指定しなくても召還できるように修正。
	(map/)
	atcommand.c
	battle.c
	battle.h
	mob.c
	pet.c
	(conf/)
	battle_athena.conf
	(doc/)
	conf_ref.txt

--------------
//0670 by RR

・モンスタードロップ率を修正(本鯖準拠、DBでの設定+1/10000)。
・落下率０に設定したアイテムを落とすかどうかをbattle_athena.confで設定可能に。
	(map/)
	mob.c
		mob_damage() 修正。
	battle.c
	battle.h
	(conf/)
	battle_athena.conf

--------------
//0669 by 聖

・モンスタードロップの修正。
	(map/)
	mob.c
		mob_damage() 修正。

--------------
//0668 by 聖

・モンスターIDの範囲チェックを修正。
	(map/)
	mob.c
		mob_db、mob_once_spawn()、mob_once_spawn_area()、
		mob_summonslave()、mob_read_randommonster()、mob_readdb() 修正。

--------------
//0667 by 死神

・最大HP計算式をミストレ巣を参考して修正。(多分これで本鯖にあっていると思います。)
・防具の精錬ボーナスを0.7に変更。(今は端数を四捨五入していますが本鯖が端数無視なら修正しておきます。)
・@refineコマンドで装備場所IDに0を入れると装備している全ての装備を精錬するように変更。
・その他細かい修正。
	(db/)
	item_db.txt
		7140、7142を元に戻して0666の物はコマントアウトしました。
	job_db1.txt 修正。
	refine_db.txt 修正。
	(map/)
	mob.c
		mob_once_spawn() 修正。
	itemdb.c
		itemdb_read_randomitem() 修正。
	pet.c
		pet_food() 修正。
	pc.c
		pc_readdb()、do_init_pc()、pc_calcstatus()、pc_setoption() 修正。
		pc_calc_sigma() 追加。
		その他修正。
	map.h 修正。
	battle.c
		battle_calc_magic_attack()、battle_calc_misc_attack() 修正。
	atcommand.c 修正。

--------------
//0666 by 聖

・ランダムアイテムの細かい修正。
・battle_athena.confの項目追加。
・古木の枝で召還するモンスターの確率を設定出来るようにしました。
・モンスター召還アイテムを複数作る事が出来るようにしました。
・召還アイテムのサンプルとして
　生命の種子をポリン系召還、
　エンブリオをMVPボス系召還にしてみました。
　あまりいいサンプルを思いつかなかったので、
　何かいい案を思いついた人は書き換えてやってください(^^;
	(conf/)
	battle_athena.conf
	(doc/)
	conf_ref.txt
	(map/)
	mob.h
		mob_db 修正。
	mob.c
		mob_once_spawn()、mob_makedummymobdb()、mob_readdb() 修正。
		mob_readbranch() -> mob_read_randommonster()に変更。
	battle.h
		battle_config 修正。
	battle.c
		battle_config_read() 修正。
	itemdb.c
		itemdb_read_randomitem() 修正。
	(db/)
	item_db.txt
	item_bluebox.txt
	item_cardalbum.txt
	item_giftbox.txt
	item_scroll.txt
	item_violetbox.txt
	mob_branch.txt
	mob_poring.txt 追加。
	mob_boss.txt 追加。

--------------
//0665 by J

・怨霊武士の取り巻きがカブキ忍者になっていたのを酒天狗に修正。
・オットーにフェイクエンジェルが出すはずの取り巻きがついてたのを修正。
	(db/)
	mob_skill_db.txt

--------------
//0664 by 聖

・精錬失敗時他のプレーヤーにもエフェクトが表示されるように修正。
	(map/)
	script.c
		buildin_failedrefitem() 修正。

--------------
//0663 by lide

・ブランディッシュスピア修正
	(map/)
	battle.c
	skill.c

--------------
//0662 by 死神

・細かい修正とバグ修正。
・プロボックによってモンスターは乗算防御と減算防御が減るように修正してプレイヤーは減算防御だけ減るように修正。
・スクリプトgetgmlevel追加。機能はそのNPCと話しているプレイヤーのGMレベルを返します。
・0659の書き忘れですがペットのパフォマンスの種類が親密度によって増えるように変更しました。
	(map/)
	clif.c
	pc.c
	script.c

--------------
//0661 by 死神

・細かい修正。
・接続した時のペットのメッセージを親密度がきわめて親しいの時のみに出るように変更。
・0659で書き忘れですがペットの支援攻撃は親密度がきわめて親しいの時のみに発生します。(それと親密度によって支援攻撃確率が少し変化します。)
・ジルタスとアリスの卵のIDをitem_db.txtに合わせました。(自分が作ったpet_db.txtの方が自分勝手に設定していた物でしたので。て言うか未実装アイテムだから番号がわからなかっただけですが...)
・pet_db.txtのattack_rateが正しく適用されなかったバグ修正。
	(db/)
	pet_db.txt
	(map/)
	clif.c
		clif_parse_LoadEndAck() 修正。
	pc.c
		pc_attack_timer() 修正。

--------------------
//0660 by いど

・サーバーsnapshot

--------------
//0659 by 死神

・ペットを色々と修正。(ペットのコードをほとんど変えました。)
・手動的だったペットの動きをモンスターのようにAIとして処理。
・接続した時のペットのメッセージ実装。(本鯖はどうなのかわかりませんが
Athenaは接続すると100%話すようになっています。)
・ペットのスペシャルパフォマンス実装。(ただ台詞がちょっと変です。いくら探しても該当するパケットが見つからなかったので。)
・ペットの台詞を他のペットの物に変更する機能追加。(詳しいことはdb_ref.txtとpet_db.txtで。)
・ペットによる支援攻撃変更。pet_db.txtで攻撃する時と攻撃を受けた時の支援攻撃
確率を別々に設定できます。攻撃する時の場合攻撃する度にチェックをしますので
攻撃速度が速いと支援攻撃を受けやすくなります。攻撃を受けた時も同じです。(こちらはダメージを喰らう度になりますが。) 支援攻撃確率はソヒー、ジルタス、アリスだけ自分勝手に設定しています。(他のは全部1%に。ペットの支援攻撃は同じモンスターにはできないようになっています。そしてペットの戦闘能力はモンスターと同じです。)
・/hideコマンド実装。
・プロボックによって乗算防御も減るように修正。
・フリーキャストのバグ修正。
・ノービスのステータスボーナス削除。
・battle_athena.confの項目追加と削除。
・修正したファイルだけ。未テストした物もかなりありますので問題があったら報告をお願いします。
	(conf/)
	battle_athena.conf
	(doc/)
	conf_ref.txt
	db_ref.txt 追加。(今説明が入っているのはpet_db.txtのみです。 )
	client_packet.txt
	(db/)
	pet_db.txt
	job_db2.txt
	(map)
	clif.h
	clif.c
	map.h
	map.c
	pet.h
	pet.c
	pc.c
	mob.h
	mob.c
	npc.c
	atcommand.c
	skill.c
	battle.h
	battle.c

--------------
//0658 by huge

・ペットがとどめをさすと、飼い主に経験値が入るようにしました。
・固定値ダメージじゃ味が無いのでATK1〜ATK2の間で乱数を取るようにしました。
・あと、ペットがとどめをさすかどうかの設定を、battle_athena.confに加えました。

	(conf/)
	battle_athena.conf pet_finish追加。
	(map/)
	battle.c
		battle_config_read() 修正。
	battle.h 修正。
	pet.c
		pet_attack() 修正。
	(doc/)
	conf_ref.txt 説明追記。

--------------
//0657 by huge

・ペットによる攻撃を実装。
・ペットを持っていて、ペットが装備品をつけてて、さらにランダムによる判定で発動します。
・ただの遊び心ですｗ
・battle_athena.confで頻度を設定できます。詳細はdocで。

	(conf/)
	battle_athena.conf pet_attack追加。

	(map/)
	battle.c
		battle_config_read() 修正。
	battle.h 修正。
	pc.c
		pc_attack_timer() 修正。
	pet.c
	pet.h
		pet_attack() 追加。
	(doc/)
	conf_ref.txt 説明追記。

 とりあえず、ペットが動いてるなぁって感じと、ダメ回数を増やした程度です。

--------------
//0656 by 死神

・グランドクロスの修正。(おいおい何度目だ...)
・グランドクロス計算式間違いで修正。(÷3がまずかったみたいです。)
でもまだ反射ダメージがみすとれ巣よりちょっと高いです。(10ぐらいだから
関係ないかも)
・モンクの気球を必中に修正。(自分の間違いのようですので...)
	(map/)
	skill.c 修正。
	battle.c 修正。

--------------
//0655 by 死神

・グランドクロスの修正。
・自分なりに情報を収集してみた結果グランドクロス反射ダメージは
プレイヤーキャラがそのキャラ自身にグランドクロスを使った時の
ダメージだそうなので修正しました。(みすとれ巣の計算とはかなり違うような
気もしますが...)
・魔法とトラップ、鷹の攻撃にも属性耐性と種族耐性を適用するように修正。
(本鯖の仕様にあっているかどうかは不明ですが適用した方が正しいと思ったので
修正しました。)
	(map/)
	skill.c 修正。
	map.h 修正。
	battle.c 修正。

--------------
//0654 by 死神

・グランドクロスの修正と細かい修正。(計算式間違いで修正。)
・0653で書き忘れ。気功による追加ダメージは必中ではないらしいので
修練の加算と同じ所に計算するように変更しました。
・カートにバグがありそうだったのでちょっと修正。
・ダメージ計算をほんの少し修正。(ダメージ量が変わったりはしません。)
	(map/)
	battle.c
		battle_calc_magic_attack() 修正。
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
	skill.c
		pc_damage_feedback() -> skill_damage_feedback()に変更。
		skill_unit_timer() 修正。
	pc.c
		pc_setoption() 修正。
	atcommand.c 修正。

--------------
//0653 by 死神

・0652の修正と細かい修正。今まで通り未テストも多いです。
・グランドクロスの処理修正。(本鯖にあっているかどうかの自身はありません。)
ラグナーゲートの説明によると始めに現在HPの20%が消耗されてその後敵に与えた
ダメージの中で一番高い物が戻ってくるようです。そしてその戻ってきた
ダメージは聖の属性を持ちトラストによって聖の耐性が50%になっているので
半分を喰らうことになるようです。(聖の耐性上がる装備をしていれば戻ってくる
ダメージは受けないようです。)
問題なのはプレイヤーの防御属性を計算するかどうかです。今は防御属性計算の
後で聖の属性を計算しています。そして戻ってくるダメージはHPバーは減るけど
表示はされません。本鯖の方がどうなのか不明なので...
それと一応モンスターもグランドクロスの使用が可能です。ただモンスターの場合
現在HPの20%消耗の後のダメージは受けません。(モンスターが使う
グランドクロスのテストはしてません。)
・ダメージによるディレイ中にまたディレイがかからないように修正。(大した意味はないかも...)
・値段がゼロのアイテムも売れるように変更。
・@コマンドhealの処理少し修正。
・移動コード少し修正。
	(map/)
	clif.c
		clif_selllist() 修正。
	battle.c
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_calc_magic_attack()、battle_calc_misc_attack() 修正。
	skill.c
		skill_additional_effect()、skill_unit_onplace()  修正。
		skill_status_change_start()、skill_unit_onplace() 修正。
		skill_castend_damage_id()、skill_castend_id()、skill_attack() 修正。
		skill_unitsetting()、skill_check_condition() 修正。
		skill_use_id()、skill_use_pos() 修正。
	npc.c
		npc_parse_script() 修正。
	pc.h 修正。
	pc.c
		pc_walk()、pc_walktoxy_sub()、pc_stop_walking() 修正。
	map.h 修正。
	mob.h 修正。
	mob.c
		mob_stop_walking()、mob_changestate()、mob_walk() 修正。
	pet.c
		pet_changestate() 修正。
	atcommand.c 修正。
	(db/)
	skill_db.txt グランドクロス修正。
	cast_db.txt グランドクロス修正。

--------------
//0652 by 月詠み

・グランドクロスを仮実装
	(db/)
	skill_db.txt
	cast_db.txt
	(map/)
	battle.c
		Damage  battle_calc_misc_attack
		Damage  battle_calc_magic_attack
	skill.c
		skill_additional_effect
		skill_castend_damage_id
		skill_castend_pos2
		skill_unit_group *skill_unitsetting
		skill_unit_onplace
		skill_check_condition

--------------
//0651 by 波浪

・item_db.txtを修正
	(db/)
	item_db.txt
		装備品のアイテム効果を修正

--------------
//0650 by 死神

・三段掌の発動条件を弓と二刀流以外に変更。
・表示をせずに内部で処理だけするNPCのCLASSを111から32767に変更。
・細かい修正。
	(map/)
	clif.c
		clif_getareachar_npc()、clif_spawnnpc()、clif_pcoutsight() 修正。
	npc.h 修正。
	battle.c
		battle_calc_pc_weapon_attack()、battle_calc_mob_weapon_attack() 修正。

--------------
//0649 by 波浪

・DBとDOC修正
	(db/)
	item_db.txt
		グングニールはLV4武器なので、韓国のデータにあわせて風属性ではなくします。
	mob_db.txt
	size_fix.txt
		楽器は大型に対して75%だそうです。
	(doc/)
	item_bonus.txt

--------------
//0648 by 死神

・ショップの値段に-を入れると鯖が落ちる問題修正。(itemdbの初期化をnpcより
先にするように変更。) それだけです。
	(map/)
	map.c
		do_init()

--------------
//0647 by nini

・item_db修正
・スナッチャー仕様変更。弓以外のすべての武器で出るようになってます。
	(/map/)
	battle.c
		三段掌の発動条件追加
	skill.c
		スナッチャーの発動条件追加
	(/db/)
	item_db.txt
		シルクハットにSP上昇追加

--------------
//0646 by last

・item_db.txtの修正(属性関連)
	(/db/)
	item_db.txt

--------------
//0645 by るるる（＆ree_ron）

・item_value_db.txtにディスカウント＆オーバーチャージ等のスキルによる価格変動を受けるかどうかのフラグメントを追加。
　実際の形式はサンプルとして用意したitem_value_db.sample.txtを見てください。（設定価格は完全に独断と偏見です）
　同様のサンプルとしてＮＰＣ設置スクリプトも添付しておきます。
・item_value_db.txtのアイテム価格設定で、売値と買値の設定を独立。（item_db.txtは従来どおり買値は売値の半額として自動処理）
・ＮＰＣショップにて、１ＮＰＣで扱えるアイテム数を最大64から最大100に変更。（クラ自体は120ぐらいまで可能ですが）
	(/db)
	item_value_db.txt
		カラム数を整理しただけです。内容はまったく変更していません。
	(/map/)
	clif.c
		clif_buylist() clif_selllist()  変更
	itemdb.h
		item_data 構造体変更
		itemdb_value_buy() itemdb_value_sell() itemdb_value_notdc() itemdb_value_notoc() マクロ追加
	itemdb.c
		itemdb_search() itemdb_readdb() itemdb_read_itemvaluedb()  変更
		itemdb_sellvalue()  削除
	npc.c
		npc_buylist() npc_selllist() npc_parse_shop()  変更
	(/sample/)
		オマケです。次回SnapShotには含まないで宜しいです。

コメント
原型は私の友人ree_ronが行い、私が更に細かいミスを直しただけですが、テストはしましたので大丈夫でしょう。
元々この処理を導入する理由として、特定アイテムの売値が1z固定にできないものか、という点だったからです。
そしてやっていくうちに、ＮＰＣショップを利用したレアアイテムの販売とかで本鯖露店に近いことが出来るのではないか、
ということが判ってきたわけです。
それで一応はデータを用意しましたが、あくまでもサンプルとして利用してください。もし可能ならば、
さらに修正を加えてアテナ独自として本採用としたデータをパッチアップしてくれればとも思いますがｗ


--------------
//0644 by nini

・DBの間違い、643で追加されたスクリプト追加。
	(/db/)
	item_db.txt
	cast_db.txt
		チャージアローのキャスト追加。
	exp_guild.txt
		46-50までのexp抜けに追加。
	size_fix.txt
		楽器、鞭、ナックルのサイズ補正修正。

--------------
//0643 by 死神

・色々と修正。
・bMVPaddAtkRate削除。bAddRaceで処理するように変更。
・bIgnoreDefEleとbIgnoreDefRace追加。
bonus bIgnoreDefEle,n;	n属性の敵の防御無視
bonus bIgnoreDefRace,n;	n種族の敵の防御無視
・bMatkRate追加。魔法攻撃力を+n%上げます。よってbattle.cで計算していたロッドによる魔法攻撃力増幅の計算はなくしました。ステータス画面に上がった数値は表示されません。ダメージ計算の時に適用しています。
・bCriticalDefに-を入れるとクリティカルを喰らう確率が上がるように変更。
・NPC番号111は透明NPCですが落とし穴等のことを考えて表示を一切せずに
内部で処理だけするように変更。(flagを使うと何とかなりそうですがその
処理が全然わからなかったので透明NPCにクリックや名前の表示もできないように変更しました。)
・ショップの値段に-を入れるとitem_db.txtもしくはitem_value_db.txtの物を使うように変更。
・スキルルアフのエフェクトがサイトと同じだったので修正。ついでにルアフの
ダメージも修正。
・みすとれ巣によるとモンスター情報で表示される防御と魔法防御は乗算ではなく減算みたいなので修正。
・他力本願ですがitem_db.txtの修正をお願いします。(全てのロッドにbonus bMatkRate,15; を入れる必要があります。その他の修正も必要です。)
・テストしていない物もかなりありますので問題があったら報告してください。
	(map/)
	map.h 修正。
	map.c
		map_quit() 修正。
	pc.h 修正。
	pc.c
		pc_walk()、pc_stop_walking()、pc_setpos()、pc_authok() 修正。
		pc_calcstatus()、pc_bonus()、pc_natural_heal_sub() 修正。
	npc.h 修正。
	npc.c
		npc_touch_areanpc()、npc_parse_shop() 修正。
	clif.c
		clif_quitsave()、clif_getareachar_npc()、clif_spawnnpc() 修正。
		clif_skill_estimation() 修正。
	battle.c
		battle_calc_magic_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_calc_mob_weapon_attack() 修正。
	mob.c
		mobskill_use() 修正。
	skill.c
		skill_status_change_end()、skill_status_change_timer() 修正。
		skill_status_change_start() 修正。
	(db/)
	const.txt 修正。
	(doc/)
	item_bonus.txt 修正。

--------------
//0642 by 死神

・装備バグ修正。(それだけ)
	(map/)
	pc.c
		pc_authok()、pc_checkitem() 修正。

--------------
//0641 by 死神

・bAspdRateとbSpeedRateのバグ修正。(それだけ)0640で計算をちょっと変えて見ましたがそれがまずかったみたいです。今度も計算式を変えましたがもう大丈夫だと思います。(多分)
	(map/)
	pc.c
		pc_calcstatus()、pc_bonus()、pc_delitem()

--------------
//0640 by 死神

・バグ修正と少し修正。
・みすとれ巣を参考してダメージ計算を少し修正。
・battle_athena.confに項目追加。(詳しいことはconf_ref.txtで)
・キャラのHPとSPを2byteから4byteに変更。(テストはしていますがバグが出る
可能性もかなりあります。ただキャラセレクト画面でHPやSPが32768を越える時
表示は32768になるけど内部の処理は正常に動きますのでそれはバグではありません。
パケットの長さのせいでそれ以外手段がなかったので...)
・bCriticalDef(クリティカルを喰らわない確率+n%)の処理変更。100にすれば
クリティカルを喰らわないようになります。)
・bInnerAtkをbBaseAtkに変更。みすとれ巣でカードの攻撃は基本攻撃力の方に足されるとありましたので変更しました。今度は上がった攻撃力が表示されます。
・bDoubleRateの処理変更。確率を足さずに一番高い物だけ適用します。それと左手
装備の場合無視するように変更しまた。(左手はダブルが適用されませんので)
・bDoubleAddRate追加。機能はダブルアタック確率+n%(武器無視)です。
左手装備は無視されます。
・0635で攻撃力表示を本鯖にあわせました。そして今度は弓だけではなく
楽器とムチもdexによって攻撃力が上がるように変更しました。
・装備した武器が消えるバグ修正の為に少し修正はしましたが本当に
大丈夫なのかは不明です。報告をお願いします。
	(conf/)
	battle_athena.conf 修正。
	(db/)
	const.txt 修正。
	item_db.txt 修正。
	(doc/)
	item_bonus.txt 修正。
	conf_ref.txt 修正。
	(map/)
	map.h 修正。
	pc.c
		pc_calcstatus()、pc_bonus()、pc_equipitem() 修正。
	battle.h 修正。
	battle.c
		battle_calc_mob_weapon_attack()、battle_calc_pc_weapon_attack() 修正。
		battle_config_read() 修正。
	clif.c
		clif_updatestatus()、clif_parse_LoadEndAck()、clif_party_hp() 修正。
	(common/)
	mmo.h 修正。
	(char/)
	char.c
		mmo_char_send006b()、parse_char() 修正。

--------------
//0639 by 胡蝶蘭

・ladminの修正など
	・プロンプトの入力にTerm::ReadLineを使うようにした
	　（入力履歴やコマンドラインの編集が可能に）
	・POSIX関係の処理の例外エラーをトラップするようにしました
	　（POSIXが全く使えない環境でも最低限、動くようになったかもしれない）
	・細部修正

	(tool/)
	ladmin
		Ver.1.04に。

・MODバージョンがおかしい問題を修正
	(common/)
	version.h
		ATHENA_MOD_VERSIONが８進数で記述されている問題を修正
		数字の頭に0をつけると８進数になるので注意してください

--------------
//0638 by 波浪

・0635・0637で新しくアイテム効果が実装されたので、それに伴ってitem_db.txtを修正
・item_bonus.txtを修正
	(db/)
	item_db.txt 修正
	(doc/)
	item_bonus.txt 修正

--------------
//0637 by 死神

・0635のバグ修正。
・battle_athena.confに項目追加。(詳しいことはconf_ref.txtを見てください。)
・時間が遅すぎて0635で説明してなかったです。(寝不足だったので...)
まず仕様が変わったのは二刀流のダメージを武器別に完全に分けて行うように
変更とアサシンじゃなくても左手修練を覚えていれば二刀流を使えるように
変更しました。それとダメージの計算をちょっと修正。
そしてbonusに追加されたのは
bonus bInnerAtk,n;		内部攻撃力+n
カードの引き上げダメージ用です。表示はされないけどダメージに計算されます。
bonus bSpeed,n;		移動速度+n
移動速度をn上げます。
bonus bAspd,n;		攻撃速度+n
攻撃速度をn上げます。
bonus bSpeedRate,n;		移動速度+n%
移動速度をn%上げます。
bonus bAspdRate,n;		攻撃速度+n%
攻撃速度をn%上げます。
bonus bHPrecovRate,n;	HP自動回復率+n%
自動回復するHPの量をn%上げます。スキルによる回復には影響がありません。本鯖の仕様とあっているかは不明です。
bonus bSPrecovRate,n;	SP自動回復率+n%
自動回復するSPの量をn%上げます。スキルによる回復には影響がありません。本鯖の仕様とあっているかは不明です。
bonus bCriticalDef,n;		クリティカルを喰らわない確率+n%
クリティカルの耐性をn上げます。10000以上にするとクリティカルを喰らいません。
bonus bMVPaddAtkRate,n;	MVPモンスターにn%の追加ダメージ
ボスモンスターにn%の追加ダメージを与えます。深淵の騎士カード用。
bonus bNearAtkDef,n;		近距離攻撃のダメージをn%の減らす
全て近距離攻撃のダメージをn%の減らします。(魔法とトラップ、鷹を除く)
bonus bLongAtkDef,n;	遠距離攻撃のダメージをn%の減らす
全て遠距離攻撃のダメージをn%の減らします。(魔法とトラップ、鷹を除く)
bonus bDoubleRate,n;	ダブルアタック確率+n%(武器無視)
武器に関係なく発動するダブルアタック確率をn%上げます。
ダブルアタックスキルと別の判定を行う為ダブルアタックスキルが
あってもスキルによるダブルアタック確率が上がるわけではありません。
サイドワインダーカード用。
	(map/)
	pc.c
		pc_bonus()、pc_calcstatus() 修正。
		pc_natural_heal_sub() 修正。
	battle.h
		struct Battle_Config {} 修正。
	battle.c
		battle_calc_pc_weapon_attack()、battle_calc_mob_weapon_attack() 修正。
		battle_config_read() 修正。
	(db/)
	skill_db.txt
		スティールのSPを10に修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。

--------------
//0636 by Sin

・デバッグ用ポタ子さんスクリプト(npc_pota.txt)のアマツ・コンロンへの対応。
　すでに自力実装されていらっしゃる方々も多いかと思いますが…。
　コンロンダンジョンの名前がわからないため「崑崙D1」などとさせていただいています。
	(conf/)	npc_pota.txt

--------------
//0635 by 死神

・battle_athena.confに項目追加。(詳しいことはconf_ref.txtを見てください。)
・bonusにbInnerAtk(カード等で表示はされないけど実際には攻撃力に反映される物用です。)等を追加。他のはitem_bonus.txtを見てください。(追加はしたけどitem_db.txtは殆んど修正してません。)
・その他バグ修正や仕様変更もやりましたが一々書く時間がないので...
	(map/)
	makeile 修正。
	pc.c 修正。
	map.h 修正。
	clif.c 修正。
	battle.h 修正。
	battle.c 修正。
	itemdb.c 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	item_bonus.txt 修正。
	(db/)
	const.txt 修正。
	item_db.txt 修正。

--------------
//0634 by 死神

・weddingクラスには転職できないように修正。
・スーパーノービスの為にexpテーブルをbase 4つjob 4つに拡張。
exp.txtが変わりスーパーノービスだけの経験値を設定できます。(exp.txtの
4つ目がスーパーノービスのbase expで8つ目がjob expです。今は2次職業の物を
コピーした物に過ぎませんが。) exp.txtの設定方法も知らない方はいないと
思いますので説明は省略します。
・スーパーノービスは転生のテストの為に韓国サクライだけ実装している物と
思われますが(転生が実装されればなくなると予測しています。)それを
実装していいのかと思ったりもしますが...
・結婚衣裳は既に0629で実装しているのにまたパッチとして
アップされるのもちょっと変(？)ですね。そういえば説明してなかったんですね。
・装備専用スクリプトであるchangebaseの追加によってタキシードと
ウェディングドレスが実装しています。これは職業を変更せずに見た目だけ
変える物です。weddingクラス以外の適用も可能で変装セットとかも作れる
わけですが内部処理は変更せずに見た目だけ変えているので0631で説明したように
装備できない物を装備している場合鞍落ちが起こる可能性がありますので
他の職業で使うのはお勧めしません。仮実装なのは今の仕様はタキシードと
ウェディングドレスを装備するだけで見た目が変わるからです。韓国サクライの
方では何かの条件が必要だと思っているのでその条件がまだ実装されいないから
仮実装です。それにweddingクラスを職業にしてしまうと結婚するとスキル等が
リセットされるか変になるかのどちらなので変だと思ってなかったのでしょうか？
	help.txt 修正。
	(db/)
	job_db1.txt 修正。
	exp.txt 修正。
	(map/)
	pc.c
		pc_jobchange()、pc_readdb() 修正。
		pc_nextbaseexp()、pc_nextjobexp() 修正。

--------------
//0633 by 波浪

・装備の設定修正。結婚衣裳の職は、実際に転職するのではなくペコナイト(13)、ペコクルセ(21)のように画像を使うだけだと思うので
　何も装備できない設定にしました。スパノビはノビが装備できるものだけ設定しました。
・古木の枝の出現モンスターを追加
・アマツのモンスの沸き具合を本鯖に近くなるように修正(まだまだ違いますが・・・)
	(conf/)
	npc_monster.txt		モンス名修正
	npc_monster_amatsu.txt	修正
	(db/)
	item_avail.txt		鞍落ちアイテム追加
	item_db.txt		装備設定を修正、他多数
	mob_branch.txt		修正
	mob_db.txt		モンス名修正
	skill_tree.txt		修正

--------------
//0632 by nini

・@jobchangeで結婚衣裳とスーパーノービスになれるように。(注意：韓国桜井クライアントのみ)
・Sノビのステ、スキルなども暫定追加。(ノービスのコピーですが)
　とりあえず見た目だけということで、結婚衣裳でも攻撃できますが(ただしノーモーション)、本来はできません。
・上にあわせてitem_db編集。
　結婚衣裳で武器もつとact、sprエラー出すので、結婚衣裳では武器を持てないようにした(はず)。
	(db/)
	job_db1.txt
	job_db2.txt
	item_db.txt
		結婚衣裳、Sノビのデータ
	skill_tree.txt
		Sノビのスキル
	(map/)
	map.h
		MAX_PC_CLASSに追加

--------------
//0631 by 死神

・細かい修正。
・タキシードとウェディングドレスの表示をbattle_athena.confで設定できる
ように変更。
・武器グラパッチについてですがパッチ前は使えない職業が装備をしても表示は
されないだけで鞍落ちまでは起こらなかったけど武器グラパッチの後はその武器を
装備することができない職業(本鯖で)が装備してしまった場合鞍落ちが起こる
ことがありますので注意してください。
	(db/)
	item_db.txt
		1161、2338、7170 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	battle.h
		struct Battle_Configにwedding_modifydisplay 追加。
	battle.c
		battle_config_read() 修正。
	pc.h
		pc_cart_delitem() 修正。
	pc.c
		pc_jobchange()、pc_additem()、pc_delitem()、pc_cart_delitem() 修正。
		pc_checkitem()、pc_getitemfromcart() 修正。
	clif.c
		clif_changelook()、clif_send()、clif_parse_GlobalMessage() 修正。
	script.c
		buildin_changebase() 修正。
	storage.c
		storage_storageaddfromcart() 修正。
	vending.c
		vending_purchasereq() 修正。

--------------
//0630 by 引退人

・ギルド脱退時にcharサーバが落ちることがあるのを修正
・water_height.txtを更新
・0627に関連してmodifydisplay関連を削除
	(char/)
	int_guild.c
		mapif_guild_leaved()のバッファ容量が足りなかったので、
		unsigned char buf[64]; -> unsigned char buf[128];
		と修正。
	(conf/)
	battle_athena.conf
		equip_modifydisplayを削除
	water_height.txt
		prt_fild04.gatとmoc_fild01.gatの分を追加
	(doc/)
	conf_ref.txt
		equip_modifydisplayの説明を削除
	(map/)
	battle.h
		struct Battle_Config からequip_modifydisplayを削除

--------------
//0629 by 死神

・0627のバグ一部修正と新しい移動パケットに対応。(自分の間違いでした。
モンスターやNPCも新しい移動パケットを使うと思っていたのですが
新しい移動パケットはプレイヤーのみのようです。)
・タキシードとウェディングドレス仮実装。(韓国のサクライ鞍じゃないと
鞍落ちされます。使用する時はitem_db.txtのコマントアウトされている
2338と7170を解除して使ってください。)
・SP回復アイテムもintによって効果が増えるように変更。
・0627で書き忘れですがカートのアイテム計算とitemdb_を呼ぶのを最小化する
処理を入ってるせいでpc_additem()、pc_delitem()、pc_cart_additem()、pc_cart_delitem()以外の方法でカートアイテムやアイテムに変動がある場合
正常に動作する保証がないので修正のさいには注意してください。
	readme0754をreadme0574に修正。
	makefile 修正。
	(map/)
	map.h 修正。
	clif.c 修正。
	pc.c 修正。
	battle.c 修正。
	mob.c 修正。
	script.c 修正。
	(db/)
	item_db.txt 修正。
	class_equip_db.txt 修正。
	skill_db.txt 修正。(誤字を治しただけです。)
	(conf/)
	npc_event_doll.txt 修正。(流浪人さんありがとうございます。)

--------------
//0628 by NOCTURNE

・snapshot
・snapshotからsnapshotまでのReadme分割
・要望が多かったのでsnap作成（プログラム的な変更点は無し

--------------
//0627 by 死神

・コードの最適化と少し修正。(少しは軽くなると思います。)
・ @modifydisplayコマンド削除。
・新しい移動パケットに対応だと思ったら0x1d8、0x1d9、0x1daパケットの一部が
0x78、0x79、0x7bと変わってるみたいです。つまり今のままでは対応できません。
X,Yの座標の部分の書式が変わったのかと予測はしていますが...
情報を求みます。(makefileのDPACKETVERを4にすれば0x1d8、0x1d9、0x1daを
使いますが座標がずれたらしく何も標示されません。)
・100000からだったchar_idを150000からに変更。(ペットの卵の問題で武器の名前がちょっと変になったので修正しました。)
・ペットのコード少し修正。(pet_idをcard[2]とcard[3]からcard[1]とcard[2]に変更しました。よって前に作った卵は使えません。鞍でcard[3]の機能が変わったので
仕方なく修正しました。今度はconvertツールがありません。作る時間がなかったので...)
・最適化の為に修正した所が多いですが全て正常動作する保証はありません。
鯖落ちバグが発生したら報告お願いします。(batte.cはまだ最適化してません。)
カートのアイテム計算やアイテムの重量の計算を最初にだけするようにしているので表示に少し問題があるかも...
・修正したファイルだけ書いておきます。
	makefile
	help.txt
	(common/)
	mmo.h
	(map/)
	map.h
	atcommnad.h
	atcommnad.c
	pc.h
	pc.c
	clif.c
	script.c
	trade.c
	itemdb.h
	itemdb.c
	battle.h
	battle.c
	pet.c
	map.c
	mob.c
	(char/)
	char.c
	(conf/)
	battle_athena-conf
	atcommand_athena.conf 

--------------
//0626 by 引退人

・パケット長テーブル（新移動パケットなど）修正
	(doc/)
	client_packet.txt	パケット解析スレ Mさんの情報を反映
	conf_ref.txt		0624に合わせて修正
	(map/)
	clif.c
		packet_len_table[]	client_packet.txtに合わせて修正

--------------
//0625 by 引退人

・@hide透明化をBOSSなどに見破られないように修正
	(map/)
	pc.h
		#define pc_iscarton(sd)	修正
		#define pc_isinvisible(sd)	追加
	mob.c
		mob_attack()
		mob_target()
		mob_ai_sub_hard_activesearch()
		mob_ai_sub_hard_mastersearch()
		mob_ai_sub_hard()
			透明（pc_isinvisible(sd)!=0）で死人と同様に判定されるように修正
	(conf/)
	npc_cTower.txt	修正（thx to holyzardさん）

--------------
//0624 by るるる

・武器画像表示処理の一新（新移動パケット使用）
・上と関連して、@modifydisplayコマンドを設けた
　　　　機能としては、現在のアサシン武器などのがおかしい場合に、または気に入らないとかで、
　　　　キャラ毎に旧パケを使用するようにしている。

	(map/)
	atcommand.c
		atcommand()  @modifydisplayコマンドを追加
	atcommand.h
		struct Atcommand_Config {
'7d  変更
	clif.c
		clif_set0078_and01d8() , clif_set007b_and01da()  関数名＆処理の変更
		clif_spawnpc() , clif_movechar() , clif_changelook() , clif_getareachar_pc() , 
		clif_fixpcpos() , clif_parse_LoadEndAck()  変更
	map.h
		struct map_session_data ・b}  変更
	pc.c
		pc_setnewpc() , pc_calcstatus() , pc_equiplookall() , pc_changelook()  変更

	(conf/)
	atcommand_athena.conf
		equip_modifydisplay  追加

	変更箇所は全てキーワード「modifydisplay」でサーチすればほぼわかるかと。

コメント：もうこれで問題は無いはず。実は大いなる勘違いをしてた個所があったのは内緒（マテw

--------------
//0623 by 引退人

・@hideで透明化（見られない＆MOBにタゲられない）するように修正など
	(map/)
	atcommand.c
		@hideのoption設定を0x04から0x40に変更
	mob.c
		mob_attack()
		mob_target()
		mob_ai_sub_hard_activesearch()
		mob_ai_sub_hard_mastersearch()
		mob_ai_sub_hard()
			option判定を0x06から0x46に修正
	(conf/)
	npc_event_potion.txt	MORISON_MEAT修正（thx to holyzardさん）

--------------
//0622 by 引退人

・mobがスキル使用に失敗した場合、通常攻撃するように
	(map/)
	mob.c
		mobskill_use_id()	スキル使用失敗で0、成功で1を返すように修正
		mobskill_use_pos()	スキル使用失敗で0、成功で1を返すように修正
		mobskill_use()		上記を反映して失敗時には0を返すように修正

--------------
//0621 by 胡蝶蘭

・アイテムチェックを行うかどうかconf/battle_athena.cnfに書けるように
・アイテムチェックで不正と判断するかどうかをdb/item_avail.txtに書けるように
・@itemcheckで明示的にアイテムチェックできるように

	デバグやテストなどで色々なアイテムIDを使用したい場合は
	アイテムチェックを無効にして下さい。(item_check: off)
	無効にした場合でも@itemcheckコマンドでチェックすることが出来ます。
	cnfファイルは用意してないので必要なら各自適当に書き換えてください。

	(db/)
	item_avail.txt
		新規追加。不正アイテムの列挙に使用。未完成。他力本願。
		item_db.txtに定義されてるが実際には使用できないアイテムを書く。
	(doc/)
	conf_ref.txt
		battle_athena.cnfとatcommand_athena.cnfの説明修正
	(map/)
	itemdb.c/itemdb.h
		itemdb_availableマクロ追加
		itemdb_read_itemavail()追加
		itemdb_readdb()でavailable=1にするように
		itemdb_search()で存在しないIDはavailable=0でデータを作るように
		do_init_itemdb()でitemdb_read_itemavail()を呼ぶように
	pc.c/pc.h
		pc_checkitem()をエクスポート
		pc_checkitem()でavailableとbattleconfigをチェックするように
	atcommand.c/atcommand.h
		@itemでbattleconfigをチェックするように
		@itemcheckコマンド追加
		atcommandconfigにitemcheckメンバ追加
	battle.c/battle.h
		battle_configにitem_checkメンバ追加

・ladminの修正など
	アカウント追加、パスワード変更の際にパスワードを省略すると、
	パスワード用のエコーしない専用プロンプトで入力できます（＆入力確認）。
	追加の際にパスワードが表示されたら困る場合などに。
	パスワード入力中はCtrl+Cが効かないので注意してください。

	パスワードの不正文字の表示が、何文字目かで表示するようになりました。
	その他微妙にチェック追加など。

	Cygwinでしか動作確認していません。POSIXモジュールを使っているので、
	POSIXでない(＆エミュレーションもできない)プラットフォームだと
	動かないかもしれません。
	UNIX系ではnkfなどで改行コードを変換しないとだめかも？

	(tool/)
	ladmin
		Ver.1.03に。

-------------
//0620 by 月詠み

・ホーリークロス実装

	(db)
		skill_db.txt 修正
	(map)
		skill.c
			skill_additional_effect()修正(コメントのみ)
		battle.c
			Damage battle_calc_weapon_attack()修正

-------------
//0619 by るるる

・パッチ0617のでやり忘れと微妙な修正

	clif.c
		clif_movechar(),clif_parse_LoadEndAck() 修正

--------------
//0618 by nini

・リザレクションの詠唱、ディレイ追加。回復量修正。
・消費SP修正
・アローシャワーの範囲を5*5にして2セル吹き飛ばし。
・チャージアローの使用武器条件無し。
・スピアスタブの飛距離を6セルに。
	(/db)
		cast_db.txt 修正
		skill_db.txt 修正
	(/map)
		battle.c
			battle_calc_weapon_attack() 修正
		skill.c
			skill_castend_damage_id() 修正
			skill_check_condition() 修正
			skill_castend_nodamage_id() 修正

--------------
//0617 by るるる

・武器画像表示で他キャラが表示されないのを「とりあえず」修正
・靴表示のパケットを送信停止（現時点ではムダ。コメントしただけですが）
	clif.c
		clif_spawnpc(),clif_getareachar_pc(),clif_fixpcpos(),clif_changelook()修正
	pc.c
		clif_changelook()がある部分を修正（武器ー＞盾と順になるように処理の入れ替え）

コメント。
新マップ移動パケ(0x1d8〜0x1da）を色々とやったが、そのパケ１つで武器表示が新式のに対応してる
というわけではないっぽい。旧移動パケだと自分以外のキャラが移動すると旧式表示になってしなう。
更に、新武器表示パケは武器と盾の同時処理が出来てない。おそらくクライアントの問題だと思う。
とりあえず、キャラが動くたびに新武器パケ＝＞旧盾パケの２つの装備パケを送ることで解決させている。
本鯖ではどうなのかの実際のところのデータが無いため、これ以上のことはムリ。

--------------
//0616 by 胡蝶蘭

・water_height.txtを読んでいないとサーバーが落ちるバグ修正
	map.c
		map_waterheight()修正

・PCのマップ移動時のアイテムチェックでアイテムIDの存在をチェックするように修正
・一部の＠コマンドでアイテムIDの存在をチェックするように修正
	pc.c
		pc_checkitem()修正
		pc_authok()修正 pc_checkitem()追加
	clif.c
		clif_parse_LoadEndAck()修正
	itemdb.c
		itemdb_exists()追加（itemdb_searchと同じだが、dbに存在しない
			場合は新しいデータを作らずにNULLを返す）
		itemdb_read_classequipdb()修正 itemdb_search=>itemdb_exists
		itemdb_read_itemnametable()修正 itemdb_search=>itemdb_exists
		itemdb_read_itemvaluedb()修正 itemdb_search=>itemdb_exists
	atcommand.c
		@item修正 itemdb_search=>itemdb_exists
		@produce修正 itemdb_existsでチェックするように

--------------
//0615 by 波浪

・アイテムDATA大幅修正
　主な修正箇所は、回復アイテムの回復量の修正、消費アイテムをclass_equip_db.txt無しでも使用できる様に修正、
　装備品の装備可能職を全て修正、カード効果を修正、etc・・・です。

--------------
//0614 by Nikita

・アイテムDATAの修正（主に回復量）
・スキル解毒の射程修正
・0612の細かい修正
	(conf/)
		npc_town_prontera.txt 修正
	(db/)
		item_db.txt 修正
		skill_db.txt 修正

--------------
//0613 by 引退人
・checkweight修正
	(conf/)
		npc_event_making.txt checkweight部分を修正
		npc_event_potion.txt ポーション、ジュースNPCのcheckweight修正

--------------
//0612 by nini

・アイテムDATA修正
	(db/)
		item_db.txt 修正
	(conf/)
		npc_town_***.txt 修正
		R.O.M776さんを参照しました。

--------------
//0611 by 死神

・アイテム使用条件があわない時0xa8パケットを送るように変更。(バグ報告スレッド 243のno nameさん情報提供ありがとうございます。)
・QMで集中力向上と速度上昇、アドレナリンラッシュ、ラウドボイス、スピアクイッケン、ツーハンドクイッケンを解除するように修正。
・速度上昇と速度減少で逆のスキルが解除されるように修正。
・0609で書き忘れ。モンスターがQMの範囲から抜けても効果が維持するように
変更とブレッシングで呪いと石化が解除されるように修正。
	clif.c
		clif_useitemack() 修正。
	skill.c
		skill_status_change_start() 修正。
	pc.c
		pc_insert_card() 修正。(これはカードバグとは関係ない修正です。そのバグの修正は自分が05xx当たりで修正しましたので。)

--------------
//0610 by 波浪

・アイテムDATA修正
	(db/)
		item_db.txt 修正

--------------
//0609 by 死神

・色々と修正。
・モンスターが止まるように動く問題修正。
・指弾のディレイ修正。
・矢作成のコード片付け。
・敵がスキル範囲から逃げた場合スキルが失敗するように変更。
・class_equip_db.txtの仕様変更。
	性別と装備レベルも設定可能に変更と使用アイテムの使用職業、性別と使用
	レベルの設定ができるように変更。(ただデータが多いせいで修正した
	class_equip_db.txtはサンプル程度の物です。埋めてください。他力本願ですが...)
	それとアイテム使用条件があわないとアイテムが使わないようにしては
	いますが01c8パケットの<type>を0にしてもアイテムを使用した時と同じ
	エフェクトが出ます。本鯖のアイテム使用パケットが分からないままじゃ
	こうするしかなかったのですが...
・battle_athena.confに項目追加。
・その他スキル少し修正と細かい修正。
・修正した所を全て覚えてませんのでファイルだけ。
	(map/)
	clif.c 修正。
	mob.c 修正。
	mob.h 修正。
	pc.c 修正。
	map.h 修正。
	skill.c 修正。
	skill.h 修正。
	itemdb.c 修正。
	battle.c 修正。
	battle.h 修正。
	(conf/)
	battle_athena.conf 修正。
	(db/)
	cast_db.txt 修正。
	skill_db.txt 修正。
	create_arrow_db.txt 修正。
	class_equip_db.txt 修正。
	item_db.txt 修正。
	(doc/)
	client_packet.txt 修正。
	conf_ref.txt 修正。

--------------
//0608 by sk
・アマツNPC追加
	(conf/)
		npc_town_amatsu.txt 城内NPC追加
		npc_warp_amatsu.txt 城内ワープポイント追加

--------------
//0607 by J
・アサルトタートルの手下召喚のバグ修正(報告ありがとうございます るるるさん)
	(db/)
		mob_skill_db.txt アサルトの修正ついでにテレポを使うMOBのスキルディレイも修正

--------------
//0606 by 引退人
・スキルレベル最大値以上にクリックした時点で他スキルが上げられなくなるバグを修正（Thanx to 227さん）
	(map/)
	clif.c
		clif_skillup()
		スキルレベルが最大値のとき、パケット末尾を0にするように修正

--------------
//0605 by るるる

・武器属性付与スキルの不都合修正
	武器を持ち替えたり外したりした場合も、属性付与を解除するようにしました。
	但し、素手＝＞武器装備のみ状態維持します。
・スピアクイッケンのステータスアイコンを正しく表示
・２ＨＱ、スピアクイッケン、アドレナリンラッシュで該当以外の武器持ち替えで状態消滅
	スピアクイッケンは未確認ですが、２ＨＱは確実なので２ＨＱと不公平な仕様とは
	考えにくいので同様なパターンとしました。本鯖と相違がある場合は報告願います。
・敵のＱＭで集中力向上と速度上昇を解除
	ＱＭで影響するスキルはこれ２つだけかな？　私の記憶と掲示板での報告とで
	判断したのですが、もし相違がありましたら報告願います。

	(map/)
	clif.c
		clif_parse_UnequipItem()  修正
	pc.c
		pc_checkallowskill() pc_equipitem()  修正
	skill.h
		skill_encchant_eremental_end()  追加
	skill.c
		skill_status_change_start() skill_status_change_end()
		skill_status_change_clear() skill_encchant_eremental_end()  修正
	その他細かいところ少々

--------------
//0604 by J
・MOBスキル再修正
・MOBDB修正
	(db/)
	mob_skill_db.txt
		アークエンジェリングとタートルジェネラルが1回に2種類までしか
		MOBを出さなかったのを修正
	mob_db.txt 
		ロードオブデスのドロップでエラーが出るのを修正(未確認)
		怨霊武士のドロップとMVPを追加(未確認)
--------------
//0603 by 引退人
・新規アイテム時にも所持可能個数チェックをするように修正
	(map/)
	pc.c
		pc_checkadditem()
			新規アイテム時にMAX_AMOUNTを超えていたら
			ADDITEM_OVERAMOUNTを返すように修正

--------------
//0602 by 引退人
・Geffen鍛冶屋で落ちる問題を修正
	(conf/)
	npc_town_geffen.txt	if (!checkweight(,)) から if (!(checkweight(,))) に修正

--------------
//0601 by J
・MOBスキルの危ない所をいくらか修正
・覚醒と狂気の使える職を修正
・ゲフェニアダンジョンの配置をカボチャイベントで入れたときの配置に修正
	ただしボスがDOP2体ではなくドラキュラにしています。
	(conf/)
		npc_monster.txt モンスター配置微変更
	(db/)
		mob_skill_db.txt	怪しい設定などの修正
		item_db.txt		増速POTの修正

--------------
//0600 by 引退人
・プロンテラ精錬所の横のファンに話し掛けると固まる問題を修正
・MOBスキル取り込み（Thanx to Jさん）
	(conf/)
		npc_event_skillget.txt	ファンのLabelを修正
		npc_town_prontera.txt	ファンが重複していたので削除
	(db/)
		mob_skill_db.txt	ジュノー以降のMOBスキル追加

--------------
//0599 by るるる

・セージの武器属性付与スキルの不都合修正とステータスアイコン表示
	アスペルシオとエンチャントポイズンとで多重にかかってしまってたので、
	最後に付与したもの１つになるようにしました。
	そのついでにステータスアイコンも表示するようにもしました。
	（未テストですが、アイコン出なかったスピアクイッケンもでるはずです。）
・アイテムDBにて、増速ポーションの使用制限を追加
	Jazzさん提供です。
	それと私の趣味でラグナロクTシャツをアレナニしましたがｗ　気に入らなければ
	消すなり元通りに修正するなりしてしちゃってくださいませ〜。

	(conf/)
		battle_athena.conf  598での入れ忘れ
	(map/)
		skill_encchant_eremental_end()  追加
		skill_status_change_end() skill_status_change_start() skill_status_change_clear()  修正
	(db/)
		iten_db.txt  修正

--------------
//0598 by るるる

・装備武器の画像変更に対応
	一応ながらクルセイダーの両手槍とかプリーストの鈍器とかはテストしましたが、
	全ての職をチェックはいません。またこの時点ではクライアント自体の表示データに
	問題の有るのが多いのも付け加えておきます。
	あと、靴も一応は対応しました。但しこれは現時点では本鯖すらも未対応なのですが。
	表示が化けて嫌だという場合は従来のやり方も出来ます。

	(conf/)
	battle_athena.conf
		オプション equip_modifydisplay を追加
	(map/)
	battle.h
		Battle_Config  修正
	battle.c
		battle_config_read()  修正
	clif.c
		packet_len_table[]  clif_changelook()  修正
	map.h
		enum {} 修正
	pc.c
		pc_calcstatus() pc_equiplookall() pc_changelook()  修正
	(common/)
	mmo.h
		mmo_charstatus {}  修正

--------------
//0597 by 波浪

・アマツに関する修正＆微修正
	(conf/)
	npc_mob_job.txt
	npc_monster.txt
	npc_monster30.txt
		モンス名修正
	npc_monster_amatsu.txt
		追加（モンス数がかなり手抜きです・・・
	npc_town_amatsu.txt
			ショップNPCを統合（npc_shop3.txtを消してもOKです
	(db/)
	mob_db.txt
		アマツのモンスデータを現在分かる範囲で修正＆草ときのこのdef,mdefを修正

--------------
//0596 by 死神

・0595の修正と細かい修正。
・フリーキャストでキャストしている間は攻撃可能ですがキャストした後の
ディレイタイムでは攻撃できないようになっています。本鯖の仕様がどうなのかは
わかりません。
・動いているPCにモンスターが攻撃できない問題修正。(テストしてませんが
多分これで大丈夫かと。)
	(map/)
	skill.h
		SC_FREECAST 削除。
	skill.c
		skill_use_id()、skill_use_pos() 修正。
		skill_castend_id()、skill_castend_pos() 修正。
		その他少し修正。
	pc.c
		calc_next_walk_step()、pc_attack_timer()、pc_calcstatus() 修正。
	clif.c
		 clif_parse_ActionRequest()、clif_parse() 修正。
	map.h
		struct map_session_dataにprev_speed追加。
	mob.c
		mob_ai_sub_hard()、mob_changestate()、mob_attack() 修正。

--------------
//0595 by PRevEv
・フリーキャスト修正、実装(キャスティング中攻撃もできます。)
	(/map)
	pc.c
		pc_calcstatus() 修正。
		calc_next_walk_step() 修正。
		pc_attack_timer() 修正。
	skill.c
		skill_castend_id()、skill_castend_pos()、skill_use_id()、skill_use_pos() 修正。

--------------
//0594 by 死神

・韓国鞍のパーティ問題修正と細かい修正。
・@partyコマンド修正と@guildコマンド追加。
・battle_athena.confにguild_emperium_check追加。
・スキル使用が失敗してもディレイがかかる問題修正。
	help.txt 修正。
	(map/)
	clif.c
		clif_parse_CreateParty2() 追加。
		clif_parse_ItemIdentify() 修正。
		その他少し修正。
	atcommand.h、atcommand.c 修正。
	battle.h
		struct Battle_Configにguild_emperium_check追加。
	battle.c
		battle_config_read() 修正。
	guild.c
		guild_create()、guild_created() 修正。
	skill.c
		skill_castend_id()、skill_castend_pos() 修正。
	Makefile 修正。
	(doc/)
	client_packet.txt
		パケット0x01e8 追加。
	conf_ref.txt 修正。
	(conf/)
	atcommand_athena.conf 修正。
	battle_athena.conf 修正。

--------------
//0593 by 死神

・メテオとバミリオンのダメージ修正と細かい修正。
・メテオの隕石が落ちてくる範囲を7*7から5*5に変更。(これで中央は全ての隕石の
ダメージを受けることになります。)
・自動回復計算式変更。
	スキルレベル*5 + (max_hp/50)から
	スキルレベル*5 + (max_hp*スキルレベル/500)に変更。(SPと息吹も同じように変更。)
・GM右クリック命令「使用者強制終了」でatcommand_athena.confのkickの
レベルをチェックするように変更。
	(db/)
	skill_db.txt
		スキル気功のspを10から8に修正。
	(map/)
	map.c
		NO_WATERを100から1000000に変更。
	battle.c
		battle_calc_magic_attack() 修正。
	skill.c
		skill_castend_pos2() 修正。
	pc.c
		pc_natural_heal_hp()、pc_natural_heal_sp()、pc_spirit_heal() 修正。
	clif.c
		clif_parse_GMKick() 修正。
	(doc/)
		conf_ref.txt 修正。

--------------
//0592 by 引退人

・水場の有り無しをwater_height.txtだけで決めるように変更。npc_water.txtは不要に。
・カードスキルではレベル上げできないようになったため不要になった処理を削除。
	(conf/)
	map_athena.conf
		npc: conf/npc_water.txt 消去
	water_height.txt
		デフォルト高さ3のマップ分を追加＆all_waterを高さ-100としてコメントで追加
	(map/)
	map.c
		waterlistはmap_readwater()内でメモリ確保
		gat設定後は不要なのでmap_readallmap()でメモリ開放しています
	map.h
		struct map_dataのflagからwater_flagを消去
	npc.c
		npc_parse_mapflag()
			マップフラグwaterとall_waterを消去
	pc.c
		pc_skillup()
			裏でスキルLvUPできなくなったのでskill[id].flagの分は消去
	skill.c
		skill_check_condition()
			map_getcellで水場判定するように修正

--------------
//0591 by CHRIS

・モンクが氣弾をもっているとき、氣弾*3の必中ダメージが入る様になりました。─　battle.c修正
・モンクスキル「指弾」と「発勁」と「気孔」の詠唱時間が正しく修正されました。─　cast_db.txt修正

--------------
//0590 by 死神

・grf-files.txtやconfファイル、account.txtファイルの名前と位置を変えるように変更。
・マップ移動による鯖落ちを防ぐ為に修正。(マップが二度ロードされて鯖落ちが
起こったとの報告を受けたので。)
・0586をちょっと修正。装備によるスキルの場合レベル上げができないように修正。
ただ装備によるスキルをスキルポイントを使って上げる時は装備を外す必要が
あります。
・@partyちょっと修正。(名前に空白があっても大丈夫なように。)
・水場の高さをwater_height.txtで読み込むように変更。
・confファイルで設定する物をファイルのパスに空白があっても大丈夫な
ように変更。
・GM右クリック命令「使用者強制終了」でモンスターを倒せるように変更。
(原因は不明ですがこれでモンスターを殺すと鯖がめちゃくちゃに遅くなることが
あります。)
・その他少し修正。
・テストは殆んどしてませんので注意してください。
	athena-start 修正。
	(map/)
	pc.c
		pc_skill()、pc_resetskill()、pc_setpos()、pc_read_gm_account() 修正。
		pc_set_gm_account_fname() 追加。
	pc.h
		pc_set_gm_account_fname() 追加。
	clif.c
		clif_skillinfoblock()、clif_parse_LoadEndAck()、clif_parse_GMKick() 修正。
		clif_changemap() 修正。
	atcommand.c
		@partty 修正。
	skill.c
		skill_castend_nodamage_id() 修正。
	map.c
		map_config_read()、map_readwater() 修正。
	script.c
		script_config_read()、do_init_script() 修正。
	script.h
		script_config_read() 追加。
	(common/)
	version.h 修正。
	grfio.h
	grfio.c
		grfio_init() 修正。
	mmo.h
		GRF_PATH_FILENAME 追加。
	(conf/)
	map_athena.conf 修正。
	npc_water.txt 修正。
	water_height.txt 追加。
	login_athena.conf 修正。
	(login/)
	login.c
		login_config_read()、read_gm_account() 修正。
	(char/)
	char.c
		do_init() 修正。
		char_config_read() 追加。
	inter.c
		inter_config_read() 修正。
	(doc/)
	conf_ref.txt 修正。

--------------
//0589 by 胡蝶蘭

・GMの右クリックで切断される問題を修正
	とりあえず01dfパケットを無視するようにしました。
	なんとなくこのパケットはチャット禁止回数とは関係無いような気も……

	clif.c
		clif_parse_GMReqNoChatCount()追加

・startをathena.shでなくathena-startを使うように変更
	start
		athena.sh => athena-start startに置き換えしただけ

--------------
//0588 by Kalen

・AmatsuNPC追加

--------------
//0587 by 胡蝶蘭

・loginサーバーの管理パケットの仕様を変更（0579のログイン拒否情報に対応）
	(login/)
	login.c
		アカウントバン状態変更パケット追加(7936,7937)
		アカウントリスト所得パケット修正(7921)
	(doc/)
	admin_packet.txt

・ladminの機能追加
	・バン状態を変更するコマンド追加
	・リスト表示と検索でバン状態も表示されるようになった
	・"?"でもヘルプが出るように修正
	・シンボリックリンクにstateaccountが追加されました。
	  使う人はladminの--makesymlinkをもう一度実行してください

	(tool/)
	ladmin
		機能追加

--------------
//0586 by 引退人
・カードスキルを修正
	(/map)
	pc.c
		pc_calc_skilltree()
		pc_skill()
			覚えられないスキルならskill[id].flag=1とする
			またはskill[id].flagに本来のlvを+2して記憶
		pc_skillup()
			skill[id].flagも増やす
	clif.c
		clif_skillinfoblock()
			skill[id].flag==1なら覚えられないスキル
	(/char)
	char.c
		mmo_char_tostr()
			skill[id].flagから本来のlv値を保存する

--------------
//0585 by kalen
・script修正
	npc_town_guid.txt	外見変更

--------------
//0584 by 引退人
・カードスキルを修正
	(/map)
	pc.c
		pc_calc_skilltree() cardスキルを忘れさせる処理を追加
		pc_skill() 整理

--------------
//0583 by kalen
・script修正
	npc_event_doll.txt	抜けていた部分の会話追加
	npc_town_guid.txt	町の案内要員の画像を表示できるように修正
				基本的に最新jROで問題なしです。

--------------
//0582 by PRevEv
・580のバグ修正。
	(/map)
	skill.c
		skill_use_pos() 修正。
--------------
//0581 by 引退人
・水場高さ設定関連を少し修正
	(/map)
	map.c
		map_waterheight()
		map_readwater()
		map_readmap()
			waterlist[512] -> *waterlistにして、mallocでメモリ確保するように修正。
		map_readallmap()
			free(waterlist);追加

・バグ報告スレッドの修正パッチを取り込み
	(conf/)
	npc_town_refine.txt セミコロン抜け修正
	(db/)
	item_db.txt 1161,バルムン修正

--------------
//0580 by PRevEv
・フリーキャスト仮実装(キャスティング中攻撃は不可能)
	(/map)
	clif.c
		clif_parse_WalkToXY() 修正。
	pc.c
		pc_calcstatus() 修正。
	skill.c
		skill_castend_id()、skill_castend_pos()、skill_use_id()、skill_use_pos() 修正。
--------------
//0579 by Aの人
・ログインを弾く処理を仮実装
	conf/login.c
		auth_dat構造体にstateを追加
		mmo_auth関数修正
		mmo_auth_new関数修正
		mmo_auth_sync関数修正
		mmo_auth_init関数修正

	この値を変更するツール、改善策。他力本願です（＞＜；
--------------
//0578 by 引退人
・バグ報告スレッドの修正パッチを取り込みなど（thanx to るるるさん,Athefansさん,sageさん,zupportさん）
	help.txt	@goの説明ちょっと修正
	(conf/)
	npc_mob_job.txt	第4列目をTab区切りに修正
	npc_water.txt	水場高さ修正
	(db/)
	item_db.txt	640,...,{ pet 1155; },{},,に修正
	mob_db.txt	1162,RAFFLESIA,ラフレシア...修正

--------------
//0577 by るるる
・@コマンドを追加＆修正
	atcommand.c
		atcommand()		@itemresetコマンド追加  @goコマンド修正（アマツ・コンロンを追加）
		atcommand_config_read()	上に合わせてitemreset使用レベル指定を追加

	doc/conf_ref.txt
	conf/atcommand_athena.conf	itemreset使用レベル指定を追加
	help.txt			@itemresetの説明追加と@goの説明修正

-------------
//0576 by V&S 
・ゴーストリングカードとバースリーカードの効果が逆になっていたのを修正
	{ bonus bDefEle,7; }→ゴーストリングカード(念)
	{ bonus bDefEle,8; }→バースリーカード(闇)
	↑だったのを↓に修正
	{ bonus bDefEle,7; }→バースリーカード(闇)
	{ bonus bDefEle,8; }→ゴーストリングカード(念)

	鋼鉄の重量を修正

--------------
//0575 by 引退人
・水場ファイルが"conf/npc_water.txt"固定だったのを修正
（conf/map_athena.confのnpc:に書かれているファイルをみて水場高さ設定するように）
	map.c
		struct waterlist[512];	新規追加。マップファイル名と水場高さを記憶。
		map_waterheight()	新規追加。水場の高さを返す。
		map_readwater()		水場ファイルをみてwaterlistを設定するように修正。
		map_readmap()		map_waterheight()を呼ぶように修正。
		map_config_read()	"npc"でmap_readwater(w2);追加。

--------------
//0574 by いど

・サーバーSnapshot
・conf/shop_*.txtの内容をconf/npc_town_*.txtに統合

--------------
//0573 by Jazz

・mapの penalty, nomemo, noteleport, nobranchの optionを設定。
・map サーバーが cpuを無限占有することを検査するための script 添付. cygwin環境で作成と実験をしました.
	(/conf)
	mapflag.txt 追加。
	(/tool)
	mapcheck.sh 追加。

--------------
//0572 by 引退人
・"conf/npc_water.txt"の第4列で水場高さ設定
　（ちゃんとした水場判定が実装されるまでのつなぎとして・・・）
	(/conf)
	npc_water.txt サンプル修正。
		・第4列で水場の高さを設定します。
		・高さを書かなかった場合のデフォルト値は3になります。
	(/map)
	map.c
		・水場高さ設定関数 map_readwater() 追加。

--------------
//0571 by code
天津フィールドのMOBの配置とワープポイントの設定の修正
天津パッチに崑崙が含まれているのを確認したので崑崙のワープとmobを配置

conf/npc_monster35.txt
     mobの配置

conf/npc_warp_amatsu.txt
　　 天津warp pointの設置

conf/npc_warp_gonryun.txt
     崑崙warp pointの設置

conf/npc_town_amatsu.txt
　　 暫定的にプロンテラ噴水前←→天津港／プロンテラ噴水前←→崑崙の接続NPC

--------------
//0570 by code
天津フィールドのMOBの配置とワープポイントの設定です。
conf/npc_monster35.txt
     mobの配置

conf/npc_warp_amatsu.txt
　　 warp pointの設置

conf/npc_town_amatsu.txt
　　 暫定的にプロンテラ噴水前←→天津港の接続NPC

--------------
//0569 by 死神

・0561の@jobcange での♀バード＆♂ダンサーによる鞍落ち防止をpc_jobchange()でするように変更。
・@コマンド@party追加。パーティを作る命令です。韓国鞍を使うとパーティを作る時止まるので臨時的にこれを使ってパーティを作ってください。
・水の判断処理修正。
・マップフラグにwaterとall_water追加。詳しくはnpc_water.txtを参考してください。
iz_dun0xだけ入力していますので他のは埋めてください。マップフラグwaterかall_waterが入ってないとセルのtypeが3でも水として認識しません。そして水だらけのiz_dun02から04までは全て水として認識するようにall_waterを入れています。(これ以外は方法がなかったので...)
・battle_athena.confに項目追加。一部はWeissを参考して作った物です。
・テストしてない物も少しあります。
	(/conf)
	atcommand_athena.conf 修正。
	battle_athena.conf 修正。
	map_athena.conf 修正。
	npc_water.txt 追加。
	(/doc)
	conf_ref.txt 修正。
	(/map)
	atcommand.h、atcommand.c 修正。
	battle.h 修正。
	battle.c
		battle_config_read() 修正。
	pc.c
		pc_jobchange()、pc_stop_walking() 修正。
	npc.c
		npc_parse_warp()、do_init_npc()、npc_parse_mapflag() 修正。
	mob.c
		mob_ai_sub_hard() 修正。
	pet.c
		pet_food() 修正。
	skill.c
		skill_check_condition() 修正。
	map.h
		struct map_data 修正。

--------------
//0568 by 引退人

・アクアベネディクタ水場判定など
・ウォーターボール水場判定（read_gat(m,x,y)==3で水場と判定）
	skill.c
		skill_castend_nodamage_id()
			case AL_HOLYWATER:	アクアベネディクタ（聖水取得）
		skill_check_condition()
			case AL_HOLYWATER:	アクアベネディクタ（水場判定）
			case WZ_WATERBALL:	ウォーターボール（水場判定）

--------------
//0567 by るるる

・アコライトのアクアベネディクタを仮実装（水場限定使用のみ未実装）
・プリーストのアスペルシオ、セージのフレイムランチャーでスキル使用時にアイテム消費
・ミストレスカード装備時にセージの属性原石＆ハンターの罠が消費されないバグを修正

	(/map)
	skill.c
		skill_check_condition() 修正

--------------
//0566 by パイン

・0563のスキル解除条件が間違っていたので修正。武器をはずす&武器を変えた場合は
　無条件で解除するようにした。

# pc_checkallowskill について(前回説明書くのを忘れていたので…)
　一応今後の含みとしてreturnを返すようにしていますが、現在は(戻り先では)使っていません。
　今現在は騎士・クルセイダーくらいしかスキル使用時の武器制限がありませんが、今後出てこない
　とも限らないので、もし(2次上位か3次？)出てきたらここでチェックしてください。

	(/map)
	pc.c
		pc_checkallowskill() 修正

--------------
//0565 by 引退人

・マップ移動時に矢装備が外れないように修正
・ログイン時に矢装備が表示されるように修正
	(/common)
	mmo.h
		（矢装備は0x8000なので）shortだとintへのキャスト時などに
		負値となってしまうためunsigned shortに修正
		struct item
			short equip; -> unsigned short equip;
	(/map)
	clif.c
		clif_itemlist() アイテムリストの矢のついでに矢装備もチェック
		clif_arrowequip() シンプル化
	pc.c
		pc_equipitem() 修正

--------------
//0564 by 紅葉

・@modelの服染め不可能判定修正。
・@modelで、選べるハズの髪形に変更出来なかった部分を修正。
　上記変更点に合わせてhelp.txtの修正。

--------------
//0563 by パイン

・MOBの暗闇スキルを食らった後に回復しないのを修正。…なんだけど、適正な値が分からないので
　毒や沈黙と同じ時間にしてあります
　今後、また手を加えるかもしれません。
・2HQとスピアクイッケンを使用中に武器を変えた場合は解除するように変更。

	(/map)
	skill.c
		skill_castend_damage_id() 修正。
		skill_status_change_timer() 修正。
	pc.c
		pc_checkallowskill() 新設。
		pc_equipitem() 修正。
	pc.h
		pc_checkallowskill() 新設。

--------------
//0562 by huge

・矢を弓装備時以外でも装備できるように戻しました。
・矢の属性を適用するのを弓装備時のみに修正。

	pc.c
		pc_equipitem() 修正。
		pc_calcstatus() 修正。

--------------
//0561 by 引退人

・Linuxでもコンパイルできるように
	(/map)
	skill.c
		skill_castend_damage_id()	変数dx,dyの宣言位置変更
	Makefile
		LIBS に -lm 追加

・@jobcange での♀バード＆♂ダンサーによる鞍落ち防止。 by (no name)さん
	atcommand.c
		@jobchange,@charjobに性別チェック追加

// ナナスさん修正
・clif.c内でatcommand.hを２度includeしていたので一つ削除。
・パーティー会話、ギルド会話でも@コマンドをチェックするように修正。
	(/map)
	clif.c
		clif_parse_PartyMessage()、clif_parse_GuildMessage 修正。

--------------
//0560 by パイン

・0559 の athena-start を Unix Like OS でも動くようにリファイン。

--------------
//0559 by rowla

・athena.shを全面的に書き直し、athena-startに。athena-start startで開始、athena-start stopでサーバー停止。cygwinでテスト、*BSD|Linuxでは未テスト(環境がないため)。

--------------
//0558 by 死神

・ブリッツビートを自動だけ弓を装備していないと発動できないように変更。(手動は武器に関係なく使えます。) 未テスト。
・トラップの重さ修正。(何故かは知らないけど100になっていたのを10に修正。因みに倉の表示は100が10で10が1です。)
・弓で使うスキルの場合矢が減らないのが仕様だったと覚えているので矢をチェックしないように修正。
・モンクスキル三段掌の表示をパッシブに変更。
・マップフラグをセットする時dummyがなくてもセットできるように修正。
(mapflag nomomo dummyからmapflag nomemoでも大丈夫なように変更。)
未テスト。
	(/db)
	item_db.txt 修正。
	skill_db.txt 修正。
	(/map)
	skill.c
		skill_check_condition()、skill_additional_effect() 修正。
		skill_status_change_start() 修正。
	npc.c
		do_init_npc() 修正。

--------------
//0557 by huge

・矢を、弓装備時のみ装備できるように修正。
・弓を装備から外したら、矢も外れるように修正。
・矢を消費するスキルをいくつか修正。
・鷹を、弓を装備しているときのみ発動するように修正。(未テスト)

	pc.c
		pc_equipitem() 修正。
		pc_unequipitem() 修正。
	skill.c
		skill_additional_effect() 修正。
		skill_check_condition() 修正。

--------------
//0555 by 死神

・細かい修正とプレゼントボックス、古い巻物のバグ修正。
・@コマンド@refine、@produce少し修正。
・サーバーのIPにDNS名を使えるように変更。(今さらですがYareから
持ってきた物です。)
・スティール計算式変更とMVPアイテム処理変更。
・店NPCを利用によるジョブ経験値獲得計算式変更。
	獲得ジョブ経験値 = ln(金*スキルレベル) * shop_exp / 100
・ほとんどテストしてないのでバグの可能性があります。
	help.txt 修正。
	(/conf)
	atcommand_athena.conf 修正。
	battle_athena.conf 修正。
	(/db)
	item_db.txt 修正。
	(/doc)
	conf_ref.txt 修正。
	(/char)
	char.c
		do_init()、check_connect_login_server() 修正と少し修正。
	(/map)
	mob.c
		mob_damage() 修正。
	pc.c
		pc_getitemfromcart()、pc_steal_item() 修正。
	pet.c
		pet_return_egg()、pet_get_egg()、pet_unequipitem() 修正。
	script.c
		buildin_getitem() 修正。
	skill.c
		skill_produce_mix() 修正。
	storage.c
		storage_storageget() 修正。
	atcommand.c 修正。
	map.c
		map_config_read() 修正と少し修正。
	chrif.c
		check_connect_char_server()、do_init_chrif()、chrif_setip() 修正と少し修正。
	npc.c
		npc_buylist()、npc_selllist() 修正。

--------------
//0554 by NOCTURNE
・サーバーSnapShot
・too/addaccountの削除
・help.txtの更新

--------------
//0553 by 胡蝶蘭

・ladminのバグ修正と機能追加
	・キーワードによるアカウント検索機能追加
	・シェルコマンドとして使用できるようにプロンプトを使わないモード追加
	・追加機能についてはladminを見てください
	・ ladminの--makesymlinkにより、シンボリックリンクとしてaddaccountを
	  作成するため、以前のaddaccountは削除する必要があります。
	  これらのシンボリックリンク(Cygwinではショートカット)と、
	  古いaddaccountは鯖snapshotには含まないで下さい。
	
	(tool/)
	ladmin
		機能追加と修正

・女性アカウントしか作成できないバグ修正
・ladmin、checkversion使用時loginサーバーが暴走するバグ修正
・GMアカウント周辺のIDを避けるためにSTART_ACCOUNT_NUMを変更
	(既にGMアカウントは避ける仕様になっていますが、混乱防止のため)

	(login/)
	login.h
		START_ACCOUNT_NUMを500000から2000000に変更
	login.c
		7532(切断)パケットの処理修正
		mmo_auth_new()修正

・backupがバックアップするファイルにpet.txtを追加
	(tool/)
	backup
		ファイル追加修正

--------------
//0552 by 死神

・安定性を上げる為の修正ですが本当に安定性上がったか
どうかは不明です。
・PVPによりクライアントが落ちる問題修正。
	atcommand.c
		@pvpoff、@pvpon、@gvgon、@gvgoff 修正。
	script.c
		buildin_pvpon()、buildin_pvpoff()、buildin_gvgon()、buildin_gvgoff() 修正。
	clif.c
		clif_pvpset() 修正。
	skill.c
		skill_attack()、skill_unit_onplace()、skill_unit_onout() 修正。
		skill_unit_ondelete() 修正。

--------------
//0551 by Kalen
・DB修正
	db/create_arrow_db.txt 完成
	SourceID順にソートしました。

--------------
//0550 by huge

・矢作成スキル実装

	clif.c
	clif.h
		clif_arrow_create_list() 追加
		clif_arrow_created() 追加
		clif_parse() 修正

	pc.c
		pc_search_inventory() 修正

	skill.c
	skill.h
		skill_arrow_db() 追加
		skill_readdb() 修正
		skill_castend_damage_id() 修正

	db/create_arrow_db.txt 追加
	db/skill_db.txt 修正

	まだdbは未完成です。

--------------
//0549 by Kalen

・map_athena.conf
	オリジナルスクリプト、季節限定スクリプトを整頓
	shop3.txt追加

・各種NPC追加＆修正
	npc_event_yuno.txt	[追加]ジュノーイベント(青石5個GET)
	npc_cTower.txt		[追加]地上地下の鍵NPC
	npc_town_yuno.txt	[修正]台詞修正

	npc_event_carnival.txt	[追加]旧鯖カーニバルイベント時のNPC

--------------
//0548 by huge

・矢を装備した時の表示バグ問題を修正。
	clif.c
		clif_arrowequip() 修正。
	pc.c
		pc_equipitem() 修正。

あとは、マップを移動するたびに装備が外れちゃう点ですね・・・。

--------------
//0547 by 死神

・安定性を上げる為の修正と細かい修正。
・スキルユニットの判定をしている間メモリーを解除できないように変更。
	map.c
		map_foreachinarea()、map_foreachinmovearea() 修正。
		map_foreachobject() 修正。
		block_free_maxを32000から50000に変更。
	pc.c
		pc_calcstatus()  修正。
	skill.c
		do_init_skill()、skill_unit_timer()、skill_status_change_clear() 修正。
	skill.c、battle.c、battle.h
		struct battle_configのsanctury_typeをsanctuary_typeに変更。
		(英語スペル間違いで修正。)
	battle_athena.conf
		sanctury_typeをsanctuary_typeに変更。
	conf_ref.txt
		sanctury_typeをsanctuary_typeに変更。

--------------
//0546 by 獅子o^.^o

conf/npc_shop2.txt
．バ一ド、ダンサ一用の武器。コモドの武器屋で販売している。
．モンク用の武器。カピト一リナ修道院で販売している。

--------------
//0545 by 死神

・ブリッツのダメージを自動で分散、手動で普通になるように変更。
・オートブリッツバグ修正。(これで大丈夫だといいけど...)
	map.c
		block_free_maxを16000から32000に修正。
		block_list_maxを4096から5120に修正。
	battle.c
		battle_weapon_attack() 修正。
	skill.c
		skill_attack()、skill_castend_damage_id() 修正。

--------------
//0544 by Diex
・猛龍拳から阿修羅覇凰拳へのコンボ実装。
・阿修羅覇凰拳発動後、敵の背後に移動するよう、修正。
・三段掌のダメージ修正。
	(/map)
	skill.c
		skill_castend_damage_id() 修正。
		skill_check_condition() 修正。
		skill_use_id() 修正。
	pc.c	
		pc_attack_timer() 修正。
		pc_authok() 修正。
	battle.c
		battle_calc_weapon_attack() 修正。
	battle.h
		struct Battle_Config 修正。
	map.h
		struct map_session_data 修正。
	(/conf)
	battle_athena.conf 修正。

はっきりいってコンボ繋げづらいです。そのため阿修羅へのコンボはかなり甘い判定に
してます（一時的にですが）。繋げづらければbattle_athena.confのほうでデュレイ時
間を大きくしてみてください。
  動画見てて気づいたのですが、阿修羅覇凰拳は猛龍拳が発動した後、即時発動のスキ
ルに変わってるようなのです。他力本願ですが、阿修羅までのコンボのパケを記録した
物をどなたかアップしてもらえないでしょうか？詳細がわかり次第、修正します。

--------------
//0543 by 死神

・ブリッツのダメージを分散されるように変更。
・普通のアカウント作りではGMアカウントを作れないように変更。
(前に自分が入れた物がなくなったので戻しただけですが...)
・取り巻きが主と一緒に死ぬように変更。(ただちょっと重くなる
可能性があります。) 未テスト。
・MVP経験値が表示だけされて実際には入ってない問題修正。
	(/login)
	login.c
		mmo_auth_new() 修正。
	(/map)
	skill.c
		skill_castend_damage_id() 修正。
	battle.c
		battle_calc_misc_attack() 修正。
	mob.c
		mob_damage() 修正。
		mob_deleteslave()、mob_deleteslave_sub() 追加。

--------------
//0542 by 死神

・オートブリッツバグ修正。(今度こそ大丈夫のはず...)
・自分に使ったヒールでは経験が入らないように変更。
・店NPCを利用によるジョブ経験値獲得計算式変更。
	獲得ジョブ経験値 = ln(金) * shop_exp / 100
になります。
logを使うことで金が多くても入る経験値が多く入らないように変更しました。
	(/map)
	battle.c
		battle_damage() 修正。
	skill.c
		skill_attack()、skill_castend_damage_id() 修正。
		skill_castend_nodamage_id 修正。
	npc.c
		npc_buylist()、npc_selllist() 修正。
	map.c
		map_foreachinarea()、map_foreachinmovearea()、map_foreachobject()
		修正。(大した修正ではないです。)
	(/conf)
	battle_athena.conf 修正。
	(/doc)
	conf_ref.txt 修正。

--------------
//0541 by huge

・矢をまとめて持てるように修正。
・弓で攻撃したときに、装備している矢を消費するように修正。

	itemdb.c
		itemdb_search() 修正
		itemdb_isequip() 修正

	battle.c
		battle_weapon_attack() 修正
		battle_calc_weapon_attack() 修正

	clif.c
	clif.h
		clif_arrow_fail() 追加
		clif_parse_EquipItem() 修正

--------------
//0540 by 死神

・バグ修正と問題ありそうな所修正。(これでWZ_FIREPILLARとブリッツに
よる鯖ダウンはなくなるはず...)
	map.c
		map_foreachinarea()、map_foreachinmovearea() 修正。
	skill.c
		skill_unitsetting()、skill_delunitgroup() 修正。
	pc.c
		pc_damage() 修正。
	battle.c
		battle_damage() 修正。
	npc.c
		npc_parse_mob() 修正。
	mob.c
		mob_spawn_dataset() 修正。

--------------
//0539 by 死神

・clif_pvpset()をマップからAREAかマップかを設定できるように変更。(pvpの時の処理は0535以前の物に戻そました。自分だけに転送してもいいような気もしますが...)
	clif.h、clif.c
		clif_pvpset() 修正。
		clif_parse_LoadEndAck() 修正。
	script.c
		buildin_pvpoff() 修正。
		buildin_pvpon() 修正。
	atcommand.c 修正。
・攻撃途中でアイテムを拾うと攻撃が止まるように修正。
	pc.c
		pc_takeitem() 修正。
・0535説明が爆裂波動になっているがそれは金剛に間違いです。
・0537で説明を忘れましたがモンスターのdefとmdefを10000以上に設定すれば全ての攻撃に1ダメージになるモンスターになります。そしてモンスター情報でdefと
mdefが10000以上の場合def 100、mdef 99に表示するように変更。本鯖仕様に
するにはmob_db.txtを修正してください。

--------------
//0538 by huge

・グリムトゥースを範囲攻撃に修正
・サプライズアタック実装 (有効範囲って、これであってるのかな？)
・バックスタブの仮実装
	本鯖でやってる人から話を聞いて、場所指定じゃなくて
	タゲ取っても良さそうだったので変更しました。（やりやすかったので (^^;
	まだ、mobの後ろに居るかどうかの判定は入ってません。

・battle.c
	battle_calc_weapon_attack() 修正

・skill.c
	skill_additional_effect() 修正
	skill_castend_damage_id() 修正
	skill_check_condition() 修正
	skill_use_id() 修正
	skill_castend_nodamage_id() 修正

・skilldb.txt
	バックスタブの種類を[場所]から[敵]へ変更

--------------
//0537 by 死神

・スティールバグ修正とbattle_athena.confの項目追加、仕様変更と細かい修正です。
(スティールは計算式に問題があったので修正して確率を更に落としました。)
	battle.h
		finger_offencive_typeをfinger_offensive_typeに修正。(英語スペル間違いで修正しました。)
		struct battle_configにrestart_hp_rate、restart_sp_rate 追加。
	battle.c
		battle_calc_weapon_attack()、battle_calc_magic_attack() 修正。
	skill.c
		skill_attack() 修正。
		clif_skill_nodamage()にスキルレベルを送るように変更。(Mさんの指摘により修正。)
	clif.c
		clif_skill_estimation() 修正。
	conf_ref.txt
		finger_offencive_typeをfinger_offensive_typeに修正と少し追加。
	mob.c
		mob_ai_sub_hard()、mob_target()、mob_damage() 修正。
	pc.c
		pc_steal_item() 修正。
	atcommnad.c、atcommnd.h
		@コマンド@gvgon , @gvgoff 追加。
	battle_athena.conf
		finger_offencive_typeをfinger_offensive_typeに修正と少し追加。

--------------
//0536 by hogefuga3 (Athena staff)

・新GRFファイルフォーマット対応
　- Athena staff 様の作成されたパッチを適用しました。
    更新履歴の部分はパッチミスになったので手動で組み込み。

（変更）
	common/
		grfio.c

--------------
//0535 by 死神

・0533の問題がありそうな部分全て修正。修正した所を全部チェックしてなかったので修正したファイルだけ...
・スクリプトsetmapflagnosave 追加。
	setmapflagnosave マップ名、セーブするマップ名、座標(X、Y)
		nosaveフラグをonにします。
・battle_athena.confに追加と一部仕様変更。(詳しくはconf_ref.txtを参考してください。)
・モンスターのdefとmdefが10000以上の場合全ての攻撃(クリティカル含めて)が1ダメージになるように変更。(トラップやブリッツの場合両方が10000以上の場合のみ1になります。) 草とキノコに１ダメージ固定は削除しました。(元々本鯖でも1固定ではないです。精練等による引き上げダメージはそのまま出ますので... 固定したいのならdefとmdefを10000にしてください。実はこれはクリスタルに為に作ろうとした物ですが...)
・爆裂波動の時アイテムによるスキルは使用できるように修正。
・その他少し修正。(修正の物の中にテストしてない物もあります。)
	(/doc)
	conf_ref.txt 修正。
	(/conf)
	battle_athena.conf 修正。
	(/map)
	battle.h 修正。
	battle.c 修正。
	mob.h 修正。
	mob.c 修正。
	skill.c 修正。
	npc.c 修正。
	pc.c 修正。
	script.c 修正。
	clif.c 修正。
	chrif.c 修正。

--------------
//0534 by Diex

・コンボシステム仮実装
	map/
		battle.c
			battle_weapon_attack()	修正。
		clif.c
		clif.h
			clif_combo_delay()　関数追加。
		map.h
			map_session_data　変数追加。
		pc.c
			pc_authok()　変数追加。
			pc_attack_timer()　修正。
		skill.c
			skill_castend_damage_id()　修正。
			skill_check_condition　修正。
			skill_use_id　修正。
	db/
		skill_db.txt　修正。

注）猛龍拳から阿修羅覇鳳拳にはまだつなげません。
    阿修羅覇鳳拳を放った後、PCはMOBの背後(?)に移動してるっぽいのですが、
　　そこらへんの情報が足りません。情報提供お願いします。

--------------
//0533 by るるる

・草とキノコに１ダメージ固定
battle.c の battle_weapon_attack() と battle_calc_attack() を修正
battle.c の battle_get_mobid() を追加
mob.c の mob_makedummymobdb() と mob_readdb() を修正

・スキルログにモブの固有番号＆ＰＣのＩＤ番号を表示
（battle.c の battle_get_mobid() を追加したのでそのついでに）
mob.c skill.c の変更箇所多数（汗
（"MOB %d" もしくは "PC %d" で検索すれば変更箇所がわかるかと）

・ハンターの罠を使ったスキルで罠を消費するようにした
batttle.c の skill_check_condition() を修正
（ジェム消費処理の流用っぽいことをやってるんだけど処理中身は理解してないｗ）

・サンクチュアリ＆マグヌスのダメージ判定を不死属性＆悪魔種族に再度修正
0532で再び元に戻ってしまったのをなおしました。
ただし、回数＆人数判定には手を加えていません（ってか自分にはまだムリ）

以上。
切った貼ったの見様見真似でやったので言語的に果たしてこれでよいのか。。。
もし処理方法に問題有りだったら修正なりをしていただけると嬉しいです。

--------------
//0532 by 死神

・修正した所を全然チェックしてなかったので修正したファイルだけ...汗
・mapflagにnopenalty追加。使用方法は
	mapflag	nopenalty	dummy
です。機能はそのマップで死んだ時経験が減らないようにします。
・mapflagにpvp_noparty、pvp_noguild、gvg、gvg_noparty追加。
pvp_nopartyはPVPモードで同じパーティに攻撃が当たらない、pvp_noguildはPVPモードで同じギルドに攻撃が当たらない、gvgはシーズモードに、gvg_nopartyはシーズモードで同じパーティに攻撃が当たらない物です。
・可動してないタイマーは全て-1になるように変更。
・吹き飛ばし処理修正。
・マップロード直後気功が見えない問題修正。
・残影の処理修正。
・マップをロードすると死んだふりが解除されるように変更。
・PVPを少し変更。
・古木の枝で出るモンスターを自分のレベルより高い物は出ないように変更。
・加速ポーションのsc_start SC_SpeedPot0,1,0;をsc_start SC_SpeedPot0,1800,0;のように変更。SC_SpeedPot？の後の数値は持続時間です。(単位は秒)
・@コマンド@pvpを@pvponに変更と@pvponと@pvpoff、@gatの機能変更。
・battle_athena.confのpvp削除。
・battle_athena.confにdeath_penalty_type追加。
・ペナルティの適用を死んだ時から死んだ後リスタートした時に変更。(リザで復活すると経験が減りません。本鯖の仕様がかなり気にいらなかったので変更しました。)
・スクリプトsetmapflag、removemapflag、pvpon、pvpoff、gvgon、gvgoff追加。
	setmapflag マップ名、マップフラグタイプ
		指定したマップフラグをonします。(ただpvp、gvgはpvpon、gvgonでできるので指定しても動作しません。あとnosaveの場合処理がちょっと複雑になるので対応してません。)
	removemapflag マップ名、マップフラグタイプ
		指定したマップフラグをoffします。(ただpvp、gvgはpvpoff、gvgoffでできるので指定しても動作しません。こちらはnosaveも可能です。)
	pvpon マップ名
		指定したマップをPVPモードにします。
	pvpoff マップ名
		指定したマップのPVPモードを解除します。
	gvgon マップ名
		指定したマップをシーズモードにします。
	gvgoff マップ名
		指定したマップのシーズモードを解除します。
ただ全てのスクリプトの動作は確認してませんので注意してください。
・サンクチュアリ、マグヌスエクソシズムの処理を0529に戻しました。
自分の調査ではサンクチュアリは人数の制限があります。(レベル1で4名で
1レベルに一人ずつ増えます。)
・その後少し修正。(したはず...)
	(db/)
	const.txt 修正。
	item_db.txt 修正。
	(conf/)
	battle_athena.conf 修正。
	(doc/)
	conf_ref.txt 修正。
	(map/)
	clif.h、clif.c 修正。
	mob.c 修正。
	pc.h、pc.c 修正。
	skill.c 修正。
	pet.c 修正。
	npc.c 修正。
	map.h、map.c 修正。
	battle.h、battle.c 修正。
	atcommand.h、atcommand.c 修正。
	script.c 修正。
	makefile 修正。

--------------
//0531 by 獅子o^.^o

conf/npc_turtle.txt
．タートルアイランドに行く時、サ一バ一を落って問題修正
．npc_turtle.txtの508行目
set Zeny - 10000,0; --> set Zeny,Zeny-10000; 修正

--------------
//0530 by RR
・スキル「サンクチュアリ」で攻撃対象をアンデット/悪魔種族から不死属性/悪魔種族に変更
・スキル「マグヌスエクソシズム」で攻撃対象をアンデット/悪魔種族から不死属性/悪魔種族に変更
・スキル「サンクチュアリ」の回復回数を人数からカウントに変更
	skill.c
		skill_unit_onplace()修正
		skill_unit_onout()修正

多分この仕様で合ってるはずです…。

--------------
//0529 by 胡蝶蘭

・MOBがスキル「ヒール」を使用するとサーバーが落ちる場合があった問題を修正
・スキル「サンクチュアリ」で攻撃対象を不死属性からアンデット/悪魔種族に変更

	skill.c
		skill_unit_onplace()修正
		skill_castend_nodamage_id()修正

・ログインサーバーのアカウントデータベース保守ツールを添付
	Perl製なので実行にはPerlが必要です。
	使用方法などはエディタで開いて見てください。
	使い方が良くわからない人は手を出さないほうがいいです。
	
	特に理由が無い限りアカウント作成もこちらのツールを使ってください。
	addaccountはパケットの都合上パスワード文字数の制限がきついので。

	アカウントを削除してもキャラクターデータ、倉庫データ、
	その他のアカウント以外のデータは消えません。相手がログイン中だった場合
	強制切断はされませんが、次回からはログインできないはずです。
	（つまりは、単にlogin-server上のアカウントを消しているだけです）

	(login/)
	login.c
		parse_admin()追加、parse_login()修正
	(doc/)
	admin_packet.txt
		新規追加。管理パケット情報
	(tool/)
	ladmin
		login-server administration toolのPerlスクリプト


--------------
//0528 by RR
・スキル「ヒール」を使用した際に回復量に比例した分だけジョブ経験値が獲得できるように変更
・商人系職業が店NPCを利用した際にジョブ経験値が獲得できるように変更
・両方ともbattle_athena.confで調整可能にしました。初期設定は0倍（非適用）
・map_athena.confにてかぼちゃクエストのものが入ってなかったのでコメントアウトしながら追加。

	map_athena.conf

	battle.c  battle_config_read()
	battle.h  Battle_Config
	battle_athena.conf
		以上、battle_athena.conf利用ために変更

	pc.c pc_heal()
		戻り値をhp+spに。戻り値を利用してる部分がなさそうだったので使わせて貰いました。バグが起きたらすみません。

	skill.c skill_casted_nodamage_id()のヒール部にてジョブ経験値獲得するよう変更

	npc.c npc_buylist()
	      npc_selllist() 変更
	      これらとの兼ね合いでskill.hをinclude。


商人の店利用ジョブ経験値獲得ですが、計算式はまだ考え中なので仮で。
計算式はアイテム購入が　代金 * スキルレベル（ディスカウント）/ ((1＋300/アイテム個数) * 4000)
アイテム売却が　代金 * スキルレベル（オーバーチャージ） / ((1＋500/アイテム個数) * 4000)です。
常に矢をたくさん一緒に購入することで経験値を多量に稼ぐことが可能ですね…。
どなたかいい式を思いついたら変更お願いします。

ところで転職NPCが一部かぶってるんですが修正しないでいいんでしょうか？

--------------
//0527 by 死神

・0526のバグ修正。(テストの為に変えていた物を入れたままアップしてしまったのが原因でした。)
	skill.c 修正。
	pc.c 修正。
	mob.c 修正。
	clif.c 修正。

--------------
//0526 by 死神

・0525のリザレクションを死んだキャラに使えないバグ修正。(テストはしてませんが治ったはずです。多分...)
	skill.c 修正。
	clif.c 修正。

--------------
//0525 by 死神

・dmotionの間はキャラが動かないように変更。(テストしてません。)
・メテオのダメージ表示タイミング修正。(少し遅い気もしますが...)
・バックスライディングの時にモーションが出るように変更。(スキル使用後
0.2秒後にスキル使用パケットを送るように変更しました。ラグ等によって変な動作をする可能性もあります。)
・0524の修正。
・ハイディングしている時自然回復しないように変更。
・0519で間違ったconfの修正と細かい所修正。
	map.h
		struct map_session_dataのcanmove_tickをcanact_tickに変更。
		skillcanmove_tickをcanmove_tickに変更。
	skill.c 修正。
	pc.c 修正。
	pc.h 修正。
	clif.c 修正。
	battle.c 修正。
	battle.h 修正。
	mob.c 修正。
	mob.h 修正。
	char_athena.conf 修正。
	map_athena.conf 修正。

--------------
//0524 by huge

・ローグ トンネルドライブ実装
	clif.c
		clif_parse_WalkToXY()
	pc.c
		pc_calcstatus()

	どのくらい速度減少するのか分からなかったので、暫定的に
	speed += speed * (20-スキルレベル)/40
	と、しました。本鯖仕様が分かる方居ましたら修正お願いします。

--------------
//0523 by NOCTURNE

・npc_event_rental.txtにクルセイダー用のペコペコ管理兵を追加
--------------
//0522 by 波浪

・mob_db.txtをジュノー後のデータに修正

--------------
//0521 by 胡蝶蘭

・mapサーバーに繋がらない問題を修正
	clif.c
		clif_parse()の修正

--------------
//0520 by 胡蝶蘭

・charサーバーログの「set map X.Y HOGE.gat」が表示されなくなりました
	変わりに、「set map M from XX.YY.ZZ.WW:PP (CC maps)」
	というふうに何個のマップをセットしたかだけを表示するようになります。

	char/char.c
		parse_frommap修正

・複数mapサーバーに仮対応
	・NPCのマップサーバー変数は鯖間では共有されません。共有すべき変数を
	  持つNPCがいるマップ同士は同じmapサーバーで動かすべきです。
	  おそらくPCのグローバル変数は共有できると思います(未テスト)
	・暫定的に動くようにしただけなので、不都合があるかもしれません。
	  特に、パーティ/ギルド/倉庫/ペット/Wisなどのinterサーバーを使う機能が
	  正しく作動するか全くチェックしていません。
	・「recv map on XX.YY.ZZ.WW:PP (CC maps)」というログが表示されます。
	  これは他のmapサーバーが担当するマップのリストが、このmapサーバーに
	  正常に受信されたという意味です。

	(char/)
	char.c/char.h
		parse_frommap()修正
		mapif_sendallwos()追加
	(map/)
	map.c/map.h
		map_setipport()を修正
		struct map_session_dataのstateメンバにwaitingdisconnect追加
	chrif.c/chrif.h
		色々追加
	clif.c
		waitingdisconnectが１ならパケットを無視するようにした
	pc.c
		pc_setpos()修正（マップサーバー変更処理など）
		pc_setnewpc()修正

--------------
//0519 by 死神

・サーバーsnapshotと色々修正。
・死んだキャラに攻撃が当たるバグ修正。(テストしてません。本当に治ったかどうか報告お願いします。)
・0517のアイスウォールの処理を少し変更。
・メテオをモンスターも使えるように変更。(テストしてません。報告お願いします。) でもちょっとメモリーの使用量が増えました。(約10M程上がるようです。)
・ボスの取り巻きがボスと一緒に行動するように変更。(テストしてませんのでどんな動きをするかは確認してません。攻撃も受けてないのにボスの隣から勝手に離れるかどうかの確認をお願いします。)
・その他細かい物修正。
	client-packet.txt 修正。
	map.h
		AREA_SIZEを15から20に変更。
		struct map_session_data、struct mob_data、struct skill_timerskill 修正。
	map.c
		map_quit() 修正。
	clif.h
		clif_changemapcell() 修正。
	clif.c
		clif_getareachar_skillunit()、clif_clearchar_skillunit()、clif_changemapcell() 修正。
	skill.c
		skill_unitsetting()、skill_unit_onlimit()、skill_castend_pos2() 修正。
		skill_castend_nodamage_id()、skill_check_condition()、skill_attack() 修正。
		skill_timerskill()、skill_addtimerskill()、skill_cleartimerskill() 修正。
		その他少し修正。
	skill.h
		skill_addtimerskill()、skill_cleartimerskill() 修正。
	pc.c
		pc_movepos()、pc_walk()、pc_authok() 修正。
	mob.c
		mob_spawn_dataset()、mob_spawn() 修正。
		mob_changestate()、mob_damage() 修正。
		mob_ai_sub_hard_mastersearch()、mob_ai_sub_hard() 修正。
		その他少し修正。
	battle.c
		battle_calc_weapon_attack()、battle_weapon_attack() 修正。
		その他少し修正。

--------------
//0518 by Kalen
・Event_pumpkin関連のフラグ不具合修正

--------------
//0517 by 死神

・アイスウォールで摺り抜る問題修正と少し修正。(Mさんパケットの提供ありがとうございます。)
	clif.h
		clif_changemapcell() 追加。
	clif.c
		clif_changemapcell() 追加。
	skill.h
		SC_STEELBODYを84から87に変更。
	skill.c
		skill_unitsetting()、skill_unit_onlimit() 修正。
		skill_status_change_end()、skill_status_change_start() 修正。
	client_packet.txt 修正。

--------------
//0516 by 死神

・モンスターのメテオによる鯖ダウンを臨時に防いで置きました。(テストはしてません。) モンスターのスキルについてちょっと分析不足ですので分析した後に修正して置きます。
・スキル指弾の仕様をbattle_athena.confで決めるように変更。(0515の物がちょっともったいなかったので...)
	skill.c
		skill_castend_pos2() 修正。
	battlc.h、battle.c
		battle_configにfinger_offencive_type 追加。
		battle_calc_weapon_attack() 修正。
	battle_athena.conf 修正。
	conf_ref.txt 修正。

--------------
//0515 by 死神

・スキルメテオと指弾修正とパケット修正、0512の落とし物修正と少しだけの仕様変更です。
・指弾の場合説明を見てこんな感じかなと思って作った物です。以前の物が本鯖にあっているなら元に戻します。
・メテオの1発の範囲は5*5セル(range = 2)です。
・アイテム使用パケットを新しい物に変更したがエフェクトが出ない物は出ないようです。(色々エフェクトが入っているみたいだから後は使って確認ですけどね。)
・0512でhitrateが10000以上で必中ではなく100000以上で必中ですのでコードの修正のさいには気をっつけてください。
・battle_athenaに設定されている武器の製造率とペットの捕獲確率の計算方法を少し変えました。(気にする必要もない物ですけどね。)
	skill.h
		skill_addtimerskill()、skill_cleartimerskill 追加。
	skill.c
		skill_attack() fix、skill_use_id()、skill_use_pos() 修正。
		skill_castend_damage_id()、skill_castend_nodamage_id() 修正。
		skill_timerskill()、skill_addtimerskill()、skill_cleartimerskill 追加。
		skill_castcancel()、skill_castend_pos2()、skill_unitsetting() 修正。
		skill_produce_mix()、do_init_skill() 修正。
	mob.c
		mob_damage() 修正。
	battle.c
		battle_calc_weapon_attack() 修正。
	map.h
		struct skill_timerskill 追加。
		struct map_session_data 修正。
	map.c
		map_quit() 修正。
	pc.c
		pc_authok() 修正。
		pc_damage() 修正。
	clif.c
		clif_parse_WalkToXY() 修正。
		clif_useitemack() 修正。(資料提供: Kalenさん)
	pet.c
		pet_catch_process2() 修正。
	skill_db.txt
		気功のSPを10に変更。(ネットの検索では10だったので変更しました。韓国蔵では15と表示されますが...)
	client_packet.txt
		01c8の変更です。Kalenさん情報提供ありがとうございます。

--------------
//0514 by Kalen

・script修正+追加
	
	conf/npc_event_pumpkin.txt	(新規)カボチャイベント
	conf/npc_town_guide.txt		(修正)Junoの「+」アイコンカラー修正
	conf/npc_town_lutie.txt		(一部追加)カボチャイベントに影響するNPCの会話追加

--------------
//0513 by RR

・転職時に装備が全て外れるようにしました。関数位置の変更してないので、ひょっとしたらおかしくなってるかもしれません。うちの環境(win2k cygwin)では平気でしたのでそのままにしてあります。。
・ノービス時の死亡では、最大HPの２分の１で復活できるよう修正。(スキルによる復活は未確認)
・デスペナルティによる経験値減少を追加。battle_athena.confにて、減少率を変更できるように設定。減る経験値は小数点以下切り捨てなので、必要経験値が低いうちにはちょうどその％分引かれるという風にはなりません。
	battle.h
		Battle_Configにdeath_penalty_baseとdeath_penalty_jobを追加。
	battle.c
		battle_config_readでdeath_penalty_baseとdeath_penalty_jobを読むように修正。
	pc.c
		pc_makesavestatus() 修正。
		pc_damege() 修正。
		pc_jobchange() 修正。
	battle_athena.conf
		death_penalty_base,death_penalty_job追加。

--------------
//0512 by 死神

・問題になりそうな部分の修正と新しいパケットの対応がメインです。後バグも少し治しました。(動けない状態異常になっても動く問題の修正等です。)
	athena.sh 修正。(いつも鯖を個別に実行していたので気がつきませんでした。)
	makefile
		DPACKETVERを2から3 に修正。ジューノ以後の蔵を使うのなら3にして使ってください。(その以前なら2か1)
	clif.c
		DPACKETVER=3に対応(今の所0x114を0x1deに変換と0x11fを01c9に変換するのみ対応)
		clif_skill_damage3() 削除。
		clif_skillcastcancel() 追加。
		clif_skill_damage()、clif_getareachar_skillunit()、clif_skill_setunit() 修正。
		clif_fixmobpos()、clif_fixpetpos()、clif_fixpcpos() 修正。
		他に少し修正。
	clif.h
		clif_skill_damage3() 削除。
		clif_skillcastcancel() 追加。
	battle.c
		battle_calc_weapon_attack() 修正。
		hitrateを10000以上にすれば必中になるように変更。(今の仕様ではモンスターの必中攻撃以外は必中になりません。)
		他に少し修正。
	client_packet.txt
		新しいパケット情報追加。
	pc.c
		pc_spiritball_timer()、pc_delspiritball() 修正。
		pc_damage()、pc_skill() 修正。
	skill.h
		SC_EXPLOSIONSPIRITSを89から86に変更。(86 = 0x56)
		SC_DELUGEを86から89に変更。
	skill.c
		skill_castcancel()、skill_use_id()、skill_use_pos() 修正。
		skill_check_condition() 修正。
		skill_castend_damage_id()、skill_castend_nodamage_id 修正。
		skill_status_change_end()、skill_status_change_start() 修正。
	skill_db.txt
		気功の消費SPを修正。(前の15が本鯖にあっているみたいですので...)
	mob.c
		mobskill_use_id()、mobskill_use_pos() 修正。
	map.c
		map_quit() 修正。
	atcommand.h
	atcommand.c
		@コマンド@spiritball追加。(機能は使えばわかります。ただ1000以上は入れない方がいいです。蔵がパンクしますので...)
	atcommand_athena.conf
		修正。
	conf_ref.txt
		修正。
・0x196パケットに新しい物が追加されているので状態変化に直接に関係ないSC_xxxxの番号を調整する必要があります。(今はSC_EXPLOSIONSPIRITSにだけ対応しました。) それとskill_status_change_end()、skill_status_change_start()でclif_status_change()を呼ぶtypeの範囲が64(0x40)未満になっているがそれも追加されている物に合わせて修正する必要がありますが追加されている物が全てわかったわけでもないのでSC_EXPLOSIONSPIRITSにだけ対応しました。今度からは爆裂波動の解除が正確に見えます。金剛はデータを見つけられませんでした。
※新しいパケットに対応する作業をしていますが情報が不足です。
イグドラシルの実やイグドラシルの種のエフェクトが出るようにする為に01c8を使ってみましたが駄目でした。client_packet.txtのデータでは何も起こらないので何方が本鯖でイグドラシルの実やイグドラシルの種を使った時のパケットを提供してくれませんか？S 00a7の後00a8が来るのかそれとも01c8が来るのかの確認と00a8の後に01c8が来るのかの確認ができれば何とかなると思いますが...
それと01c9の後に来る?.81bがわかればアイスウォールを摺り抜る問題も解決できると思いますが...
情報提供をお願いします。

--------------
//0511 by Diex

・指弾の攻撃回数修正。
・阿修羅覇鳳拳、発勁が修練を無視し、無属性になるように修正。
・金剛使用時、MDEFが正しく表示されてなかったバグを修正。
・気功の消費SPを修正。
	pc.c
		pc_calcstatus() 修正。
	battle.c
		battle_calc_weapon_attack() 修正。
	skill.c
		skill_check_condition() 修正。

	skill_db.txt 修正。

--------------
//0510 by Diex

・三段掌の表示バグ修正
・指弾が気弾が無くても撃てるバグを修正
	map.h
		struct map_session_dataにspiritball_old変数追加。
	skill.c
		skill_check_condition() 修正。
	clif.c
		clif_skill_damage3() 修正。
	battle.c
		battle_weapon_attack()、battle_calc_weapon_attack 修正。

--------------
//0509 by 

・npc_warp.txt
	プロ城→プロフィールドになっていたのを、
	プロ城→ヴァルキリーレルムに修正。
	プロフィールド→プロ城になっていたのをプロフィールド→ヴァルキリーレルムに修正

--------------
//0508 by 死神

・バグ修正と息吹、気功、気奪の修正がメインです。(今度からは他の人にも気がちゃんと見えます。)
・死んだキャラに経験値が入る問題修正。(テストはしてません。どうなのか報告をお願いします。)
	pc.h
		pc_addspiritball()、pc_delspiritball() 追加。
		pc_is50overweight() 修正。
	pc.c
		pc_gainexp() 修正。
		pc_insert_card()、pc_item_identify() 修正。(大した修正じゃありませんが...)
		pc_authok() 修正。
		pc_addspiritball()、pc_delspiritball() 追加。
		pc_spiritball_timer() 追加。
		do_init_pc()、pc_calcstatus()修正。
		pc_spirit_heal() 追加。
		pc_natural_heal()に関わる物の修正。
	map.h
		struct map_session_data 修正。
	map.c
		map_quit() 修正。
		map_addflooritem() 修正。
	clif.h
		clif_spiritball_int()をclif_spiritball()に変更。
		clif_spiritball_ext() 削除。
	clif.c
		clif_spiritball_int() をclif_spiritball()に変えて修正。
		clif_spiritball_ext() 削除。
		clif_set01e1() 追加。
		clif_getareachar_pc() 修正。
	skill.h
		SC_CALLSPIRITS 削除。
	skill.c
		SC_CALLSPIRITS 削除。
		skill_castend_nodamage_id()、skill_check_condition() 修正。
		skill_status_change_start() 修正。
・床に落ちたアイテムが消えるまでの時間を設定できるように変更。
	battle.h、battle.c
		battle_config_read() 修正。
	conf_ref.txt 修正。
	battle_athena.conf 修正。

--------------
//0507 by Diex
0505の修正
・三段掌のエフェクト実装

--------------
//0506 by hoenny
全体的に少し式修正
セイジのスキルがアイテムを消耗するように修正
(スキルのDBに zeny, spiritball, item, equipを入れたいが時間がなくて臨時的に ...)

--------------
//0505 by Diex

・阿修羅覇鳳拳のダメージ修正
・猛龍拳のダメージ修正
・指弾実装
・発勁実装
・金剛が減算DEFと減算MDEFが90に固定されていたのを乗算DEFと乗算MDEFが90になるように修正
・三段掌実装（ただしコンボは未実装）
	map/clif.c
	map/clif.h
		clif_skill_damage3()追加
	map/pc.c
	map/skill.c
	map/battle.c
		修正・及び追加
（計算式は+ Acolyte Maniax +を参考にしました。）

--------------
//0504 by 死神

・atcommand.c 修正。(たった2文字を追加しただけです。)
atcommnad_gm_onlyがnoじゃなくても使用レベル設定を0にしたコマンドはGMじゃないキャラでも使えます。テストはしてません。

--------------
//0503 by nabe

・精錬修正とLinux用にちょっと変更など
	conf/map_athena.conf
		npc_event_doll.txt,
		npc_turtle.txt,
		//npc_pota.txt項目追加
	conf/npc_pota.txt追加（socieさん作のダンジョンポタ子さん）
	conf/npc_shop.txt
		イズルード武器商人の価格修正
	conf/script_athena.conf
		0499での文字化け？修正
	login/login.c
		#include <time.h>追加
	map/script.c
		buildin_getequipname()
			精錬メニューのmallocを修正
		buildin_getequipisenableref()
			精錬可能条件修正（Athefansさんの条件文にしてみました）
	map/skill.c
		skill_check_condition()変数宣言位置の変更のみ

--------------
//0502 by 死神

・カプラの倉庫もbattle_athena.confのbasic_skill_checkによって基本スキルが足りなくても使用することができるように修正しました。(プロンテラ中央のカプラのみ確認。)
・クェストスキルの取得は0492のせいです。0481にskillの最後が,2じゃなく,0だと書いたのですが何故か0492で,2になっていたので,0に修正しました。
・スクリプトgetbaseskillcheckをbaseskillcheckに変更と自分で修正しましたが命令の後になんの数値も入らない場合はスクリプトが正しく作動しなかったので使用する場合はbaseskillcheck(0)にして使わないと正しい結果を得ることができません。
(詳しくはnpc_town_kafra.txt参照。)
	npc_event_skillget.txt 修正。
	npc_town_kafra.txt 修正。
	script.c 修正。
・GM_account.txtに自分がテストの為に使っていた500000が入っていたので削除しました。(GM_account.txt作った理由は自分勝手にアカウントをGMにすることができるようにする為です。つまりGMとして表示されなくてもGMとして色んな権限を使うことができます。さすがにGM専用の右クリックコマンドは使えませんが... でもこれを活用している方はいないみたいなんですね...)

--------------
//0501 by hoenny

・500の問題点修正
-HP回復力向上,SP回復力向上
	map/pc.c
		pc_natural_heal_hp()修正
		pc_natural_heal_sp()修正

500SP回復力向上
--------------
//0500 by hoenny

・修道僧の息吹実装
-基本的に座った時 10秒ごとに回復します.
-所持量が 50%をオーバーした場合 20秒ごとに回復します.
・修道僧の気奪実装
-他の修道僧の氣球も吸収が可能です.
・修道僧の金剛実装
-金剛状態ではすべてのアクティブスキルを使うことができないです.
	db/skill_db.txt
		気奪修正
		金剛修正
	map/pc.h
		pc_is50overweight()追加
		pc_is90overweight()追加
	map/pc.c
		pc_calcstatus()修正
		pc_spheal()修正
		pc_hpheal()修正
		pc_natural_heal_hp()修正
		pc_natural_heal_sp()修正
		pc_natural_heal_sub()修正
	map/skill.c
		skill_check_condition()修正
		skill_castend_nodamage_id()修正
		skill_status_change_start()修正

--------------
//0499 by 死神

・サーバーsnapshotとバグ修正。
・スティールコインのゼニ量をモンスターレベル*10 + rand(100)に変更。
・キャスティングタイムがないスキルはタイマーを使わないように変更。
・カードの使用によるマップ鯖ダウンを防ぐ為に修正。(今度こそ治ったはず...) そして拡大鏡も同じようなことができるので修正。(これは鯖ダウンまでは起こさないようですが...)
・キャラにマップのロードが終わるまでペットのデータが来ないとマップ鯖が落ちる問題修正。(滅多なことがない限り起こらないですけどね。)
・オートバーサーク、重さのアイコンとチェックが正しく適用されるように修正。
・増速ポーションの適用順番変更。今まではスピードアップポーションが最優先で次がハイスピードポーション、最後がバーサークポーションだったのですが順番を逆に変更しました。
・アイテムで使うスキルはキャスティングタイムとディレイが0になるように変更。
・アイテムで使うスキルのレベルがitem_dbに設定しているレベルより高くなるバグ修正。
	pc.h
		pc_move()をpc_movepos()に変更。
	pc.c
		pc_steal_coin()、pc_insert_card()、pc_item_identify()、pc_authok()、
		pc_calcstatus()、pc_checkweighticon()、pc_damage() 修正。
	skill.c
		skill_castend_pos2()、skill_check_condition()、skill_use_id()、
		skill_use_pos() 修正。
	pet.c
		pet_recv_petdata()、pet_change_name() 修正。
	map.h
		struct map_session_dataにskillitemlv 追加。
	script.c
		buildin_itemskill() 修正。
	clif.c
		clif_parse_UseSkillToId()、clif_parse_UseSkillToPos()、
		clif_parse_LoadEndAck() 修正。
	mob.c
		mobskill_use_id()、mobskill_use_pos() 修正。

--------------
//0498 by hoenny

．氣球がすっかり見えるように修正(消耗スキル使用の時消耗するように修正)
．スキル残影を使用の時氣球を消耗するように修正
	doc/client_packet.txt
		0x1d0追加
	map/map.h
		sdのstructureに spiritball追加
	map/clif.h
		clif_spiritball_del() -> clif_spiritball_int()修正
		clif_spiritball_cre() -> clif_spiritball_ext()修正
	map/clif.c
		packet_len_table[]修正
		clif_spiritball_del() -> clif_spiritball_int()修正
		clif_spiritball_cre() -> clif_spiritball_ext()修正
	map/pc.h
		pc_item_steal() -> pc_steal_item()修正
		pc_coin_steal() -> pc_steal_coin()修正
	map/pc.c
		pc_item_steal() -> pc_steal_item()修正
		pc_coin_steal() -> pc_steal_coin()修正
		pc_calcstatus()修正
	map/skill.c
		skill_check_conditon()修正

--------------
//0497 by 死神

・0491のスキル残影のバグ修正とスティールとスティールコイン、スナッチャーの修正、mob_targetのバグ修正。
・交換、座り、パーティ結成等の時に基本スキルをチェックするように修正。(battle_athena.confでチェックするかどうかを決めることができます。)
ただカプラの倉庫はスクリプトで制限をかけるしかありません。
・スクリプトgetbasicskillcheck追加。
	使用方法＞ getbasicskillcheck
	戻り値はbattle_athena.confのbasic_skill_checkです。0の場合は基本スキルのチェックなしで1の場合は基本スキルをチェックするのを意味します。
	skill.c
		skill_castend_pos2() 修正。
		skill_additional_effect() 修正。
	pc.c
		pc_move() 追加。
		pc_item_steal()、pc_coin_steal() 修正。
	pc.h
		pc_move() 追加。
	map.h
		struct mob_data 修正。
	mob.c
		mob_spawn() 修正。
		mob_target() 修正。
	clif.c
		clif_pcinsight()、clif_pcoutsight() 修正。
		clif_parse_ActionRequest()、clif_parse_Emotion()、
		clif_parse_TradeRequest()、clif_parse_CreateParty()、
		clif_parse_ReplyPartyInvite() 修正。
	battle_athena.conf 修正。
	conf_ref.txt 修正。
	skill_db.txt
		スティールの射程を3から1に修正。
	battle.h、battle.c
		battle_configにbasic_skill_check 追加。
		battle_config_read() 修正。
	trade.c
		trade_traderequest() 修正。
	script.c
		buildin_getbasicskillcheck() 追加。
	map/makefile 修正。
※スティールとスティールコインの計算式は適当に作った物です。本鯖の方がどうなのか全然わからないので...

	スティール率 = (モンスターのアイテムdrop率 * (キャラレベル*0.5 + dex*0.4 +スキルレベル*5))%
	スティールコイン率 = (スキルレベル + (キャラレベル - モンスターのレベル)*0.3 + dex*0.2 + luk*0.2)%
	スナッチャー発動率 = (5.5 + スキルレベル*1.5 +スティールのスキルレベル)%

本鯖の計算式がわかる方は情報提供をお願いします。
スティールコインのゼニの量はモンスターのレベル*100になっています。これについても情報提供をお願いします。
※残影の場合使った後普通に歩く前にはペットの装備が見えないバグがありますが原因がわからないので放置することにしました。
※基本スキルが足りない時出るメッセージは殆ど合わせていますがパーティに入る時に基本レベルが足りない時に合う物がなかったのでパーティを作れない(基本スキルレベル7の物)と表示して勧誘した方には拒絶されたと表示されます。

--------------
//0496 by hoenny

．WZのメテオストーム実装
．スティールコイン修正
	db/skill_db.txt
		メテオストーム修正
	map/pc.c
		pc_coin_steal()修正
	map/skill.c
		skill_castend_pos2()修正

--------------
//495 by nini

・ARが片手斧、両手斧でしか発動しなかったところ修正→片手斧、両手斧、鈍器
	map/skill.c
		skill_check_condition()　修正

前回修正のとき鈍器入れ忘れてたようです。	

--------------
//0494 by 獅子o^.^o

conf/mpc_warp.txt
．ハンタ一転職地出ていない修正

--------------
//0493 by 波浪

・script修正
	npc_town_comodo.txt	コモド案内要員部分を削除(npc_town_guide.txtと重複していたので)
	npc_town_guide.txt	ジュノー案内要員を追加(viewpointの色が…)
	npc_town_kafra.txt	ジュノーカプラ部分をnpc_town_yuno.txtから移動
	npc_town_refine.txt	ジュノー精錬所部分をnpc_town_yuno.txtから移動
	npc_town_yuno.txt	案内要員とカプラと精錬所部分を削除
	npc_turtle.txt		会話を微修正

--------------
//0492 by Kalen

・script修正+追加
	
	conf/npc_event_doll.txt		(新規)
	conf/npc_turtle.txt		(新規)亀島関連NPC+亀島クエスト(航海日誌)追加

	conf/npc_event_skillget.txt	(修正)応急処置の不具合+へんなtab削除etc..
	conf/npc_town_alberta.txt	(修正)Turtle分離、ちびっ子削除(Event_dollへ移動)
	conf/npc_town_guide.txt		(修正)台詞がかなり変更されていたので、修正


--------------
//0491 by 死神

・スキル残影(韓国クライアントでは弓身彈影)実装。(ただ気弾のチェックはしてません。)
	pc.h
	pc.c
		pc_can_reach() 追加。
	skill.c
		skill_check_condition()、skill_castend_pos2() 修正。
	skill_db.txt
		残影修正。
・script.c
	set_posword() 修正。
※一人でテストは済んでいますが他の人に正しく見えるかどうかは未確認です。
変なのかどうか報告をお願いします。

--------------
//0490 by nabe

・場所スキルエフェクトでマップ鯖が落ちることがあったのを修正。
	clif.c
		clif_skill_poseffect()の
		unsigned char buf[16];を、unsigned char buf[32];に修正。

--------------
//0489 by 死神

・0483のバグ修正。battle_athena.confのquest_skill_learnが正しく適用されるように変更と問題があった部分の修正。(テスト済み)
	pc.c
		pc_calc_skilltree()、pc_skill() 修正。
	atcommand.c
		@lostskill 少し修正。
・カードの使用によるマップ鯖ダウンを防ぐために少し修正。(ただカードの使用によるマップ鯖ダウンを再現できなかったので本当に治ったかどうかは不明...汗)
	pc.c
		pc_insert_card() 修正。
・pc.h
	pc_ishiding() 修正。

--------------
//0488 by hoenny

・RGのスティールコイン実装
・スティール修正
(二スキル皆一度スチールした場合またスチールすることができない.そしてスキル成功の時モンスターは攻撃するように修正した.エフェクトは成功の時だけ出るように修正した.)
	db/skill_db.txt
		スティールコイン修正
	map/pc.h
		pc_coin_steal()追加
	map/pc.c
		pc_coin_steal()追加
		pc_item_steal()修正
	map/skill.c
		skill_castend_nodamage_id()修正

--------------
//0487 by hoenny

・485の問題点ちょっと修正
	map/pc.c
		pc_item_steal()修正
	map/skill.c
		skill_castend_nodamage_id()修正

--------------
//0486 by 獅子o^.^o

db/class_equip_db.txt修正
裂けた大地の書、燃える太陽の書、乾いてる風の書、默示録、プリーストは装備することができない問題修正

--------------
//0485 by hoenny

・ RGのスナッチャー実装
・ スティール修正
・ 露店開設の時 skill_check_conditionで状態をチェクするように修正
	map/pc.h
		pc_ishiding()追加
		pc_item_steal()追加
	map/pc.c
		pc_item_steal()追加
	map/skill.c
		skill_castend_nodamage_id()修正
		skill_additional_effect()修正
		skill_check_condition()修正

--------------
//0484 by 胡蝶蘭

・覚えてないクエストスキルにスキルポイントを振れる問題修正
	pc.c
		pc_calc_skilltree()でクエストスキルのチェック追加
	skill.c
		skill_readdb()でinf2を読むように修正

・ペコペコ騎乗、ファルコンのアイコンがログイン直後には表示されない問題修正
	clif.c
		clif_parse_LoadEndAck()修正

--------------
//0483 by 死神

・0482の適用。
	npc_event_skillget.txt 修正。
	script.c 修正。
	skill.c 修正。
	pc.c 修正。

--------------
//0482 by 胡蝶蘭

・クエストスキルのスクリプト少し修正
・スクリプトgetskilllvを呼ぶとマップサーバーが落ちるバグ修正
	(conf/)
	npc_event_skillget.txt
		出来るだけ変数を使わないように修正（未テスト）
	(map/)
	script.c
		buildin_getskilllv()修正

・スティールで失敗時のエフェクト変更
・同じMOBには１回しかスティールできないように修正
	(map/)
	skill.c
		skill_castend_nodamage_id()修正
	map.h
		struct mob_dataにsteal_countメンバ追加
	mob.c
		mob_spawn()修正、steal_countを0に初期化するように

・イドゥンの林檎でHPが32767を超えるとサーバーが落ちるバグ修正（未テスト）
	(map/)
	pc.c
		pc_calcstatus()修正

--------------
//0481 by 死神

・これの適用には気をつけてください。0478の胡蝶蘭さんの物を Athena.txtのデータ形式変更せずにクェストスキルを覚えるように作った物です。自分が作ってる最中に胡蝶蘭さんが同じ物をアップしてくれたのですがデータは変えない方がいいと思って自分の物もアップしました。注意することは0478のathena.txtは使えないと言うことです。0478前の物を使ってください。
・skill_db.txtにinf2を追加してこれを使ってクェストスキルかどうかを判断する仕組みです。
	skill.h 修正。
	skill.c
		skill_readdb()修正と少し修正。
		skill_get_inf2() 追加。
	skill_db.txt 修正。
	skill_tree.txt 修正。(0478前の物)
	clif.c
		clif_skillinfoblock() 修正。
	char.c 修正。(0478前の物)
・battle_athena.confにquest_skill_learn追加。
	battle.h 修正。
	battle.c
		battle_config_read() 修正。
	battle_athena.conf 修正。
・/resetskillをbattle_athena.confにquest_skill_learnの設定に合わせてquest_skill_learnがyesの場合はスキルポイントに加算してquest_skill_learnがnoならリセットはされるがスキルポイントに加算されません。
	pc.c
		pc_skill()、pc_resetskill() 修正と少し修正。
	pc.h 修正。
	atcommand.c 修正。
	atcommnad_athena.conf 修正。
・スクリプトのskillコマンドでクエストスキルを覚えられるのは同じですが最後のフラグが2から0に変わってますので注意してください。
	npc_test_skill.txt 修正。
	npc_event_skillget.txt 修正。
	conf_ref.txt 修正。
	client_packet.txt 修正。

--------------
//0480 by Kalen

・Eventskill追加
	conf/npc_event_skillget.txt

・map_athena.conf変更
	warp.txtの読み込み優先度を変更
	prt_castle等、旧EPのワープと異なる場所に変更された場合
	先に読み込んだ方が優先されるので、EPの高い順のがよろしいかと
	conf/map_athena.conf

--------------
//0478 by 胡蝶蘭

***
 Athena.txtのデータ形式変更!! (自動的に変換されます)
 バックアップを忘れずに!
 Data format of athena.txt is changed!! (convert automatically)
 DONT FORGET BACKUP!! 
***

・クエストスキル実装
・スクリプトでスキルレベルをチェックできるように
	・スクリプトのskillコマンドでクエストスキルを覚えられます。
	  使用方法＞ skill スキルID,スキルLV[,フラグ]
	  フラグは省略可能で、省略すると１を指定したことになります。
	  １で装備品による一時的な習得、２でクエストによる恒久的な習得です。
	  恒久的な習得の場合、skill_tree.txtに依存します
	・getskilllvコマンド追加
	  使用方法＞ getskilllv(スキルID)  戻り値はレベルです。0で未習得。
	
	(conf/)
	npc_test_skill.txt
		サンプル
	(db/)
	skill_tree.txt
		クエストスキルとして必要スキルIDに-1を設定。
	(char/)
	char.c
		フラグもathena.txtに保存するように。
		以前の形式のデータも読み込めます。
	(map/)
	pc.c/pc.h
		pc_skill(),pc_calc_skilltree()など修正
	script.c
		buildin_skill(),buildin_getskillid()など修正

・@questskill,@lostskill追加
	・@questskill スキルID でクエストスキルを覚えます。(クエストスキルのみ)
	・@lostskill スキルID でスキルを忘れます。(クエストスキル以外もOK)

	atcommand.c/atcommand.h
		struct Atcommand_Configにlostskill,questskillメンバ追加
		@questskill,@lostskill処理追加

--------------
//0477 by nabe

・一部変数の宣言位置の変更のみ（Linux等でコンパイルしやすいように）。
	atcommand.c,battle.c,clif.c,mob.c,npc.c,skill.c

--------------
//0476 by nabe

・conf/ ちょっと整理
	conf/map_athena.conf修正。
	tortoise.txtをnpc_town_alberta.txt中に移動。
	npc_script2.txtのコモドガイドをnpc_town_comodo.txt中に移動。

・npcがキャラ名を喋るときのバグ修正
	map/script.c
		buildin_strcharinfo()でキャラ名用のメモリを
		staticに確保してしまっていたのを、mallocに修正。

--------------
//0475 by hoenny

泥棒のスティール実装。
ギルド生成の時エンペリウム消耗するように修正。
	map/guild.c
		guild_create()修正。
		guild_created()修正。
	map/skill.c
		skill_castend_nodamage_id()修正。

--------------
//0474 by 死神

・0471の精練の時表示される文字の設定をmap_athena.confからscript_athena.confに変更。
	script.c
		do_init_script() 修正と少し修正。
	script.h 修正。
	script_athena.conf 追加。
	map_athena.conf 修正。
	map.c
		map_config_read() 修正。
・古い巻物、プレゼントボックス実装と少し仕様変更。
ランダムでアイテムを得る物にデフォルトで出るアイテムを設定できるように変更。今の仕様では1000回までアイテムが選択されなかったらデフォルトアイテムが出るようになっています。デフォルトアイテムが0の場合はアイテムを得られません。
設定する確率を*1000から*10000に変更。ただitem_~.txtの修正はやっていません。誰かやってください。(他力本願)
	itemdb.c
		temdb_read_randomitem() 修正。
		itemdb_searchrandomid() 修正。
	item_purplebox.txt から item_violetbox.txt に修正。
	item_giftbox.txt、item_scroll.txt 追加。(moveさんありがとう。)
	item_db.txt
		古い巻物、プレゼントボックス 修正。
・trade.c
	trade_tradecommit() 修正。pc_delitem()を使うように変更。
※テストはやっていませんので問題があったら報告してください。

--------------
//0473 by Kuro

・class_equip_dbを一部修正
	db/class_equip_db.txt

--------------
//0471 by hoenny

製錬の時出る文を変えることができるようにしました.(map_athena.confで調節可能)
気功の数字が市廛の時実際水路表示図緑修正
	conf/map_athena.conf
		refine_posword:追加。
	map/map.c
		map_config_read()修正。
	map/script.h
		do_set_posword()追加。
	map/script.c
		do_set_posword()追加。
		buildin_getequipname()修正。
	map/skill.c
		skill_status_change_start()修正。

--------------
//0470 by 死神

・製造の時属性石が二度減る問題修正。(実は二度減るように見えるだけでマップを移動すると正しく表示されますが...)
	pc.h、pc.c
		pc_delitem() 修正。
	npc.c、script.c、storage.c、pet.c
		pc_delitem()を全て修正。
	skill.c
		skill_produce_mix() 修正。

--------------
//469 by 波浪

・npc_mob_job.txt、npc_monster.txt、npc_monster30.txt、mob_db.txtのモンス名を修正
・item_db.txtの回復アイテムの回復量をジュノー後のものに修正

--------------
//468 by Kuro

・魔剣製作クエスト追加
	conf/npc_event_ma_sword.txt

--------------
//467 by nini

・BBが両手剣でしか発動しなかったところ修正→すべての武器で
・ARが両手斧でしか発動しなかったところ修正→片手斧、両手斧、鈍器
・スピアクイッケン発動を槍だけに
・キャストキャンセルされないものにグランドクロス、ローグのストリップシリーズ追加
・ブリッツビートがキャストキャンセルされなくなってた点修正
	map/skill.c
		skill_use_id()　修正
		skill_check_condition()　修正
・2-2職スキルのキャスト・ディレイ追加		
	db/cast_db.txt	
		

--------------
//466 by hoenny

・阿修羅覇鳳拳修正(公式修正及び sp消耗がすぐ見えるように)
・蓄気の時気弾が見えるように修正(Mr.NO NAME様のパケ情報ありがとうございます.気弾が消えるパケ情報が不足です.)
・パリの羽やテレポート1を連続使用の時,鯖オーバーが発生しないように仮初めで修正
	doc/client_packet.txt
		0x1e1パケ情報追加
	map/battle.c
		battle_calc_weapon_attack()修正
	map/clif.h
		clif_spiritball_cre()追加
		clif_spiritball_del()追加
	map/clif.c
		packet_len_table[]修正
		clif_spiritball_cre()追加
		clif_spiritball_del()追加
		clif_changemap()修正
	map/skill.c
		skill_castend_nodamage_id()修正
		skill_check_condition()修正

--------------
//0465 by 死神

・リザレクションとハイディング、ブリッツビートのバグ修正。(ブリッツビートは報告はなかったのですが分析したら問題があったので修正。)
	skill.c
		skill_use_id() 修正。
		skill_castend_nodamage_id() 修正。
・0455のNPCを元に戻しました。
	npc_event_ice.txt 修正。
	npc_event_potion.txt 修正。
	npc_town_geffen.txt 修正。（454の物に戻しました。）
・0451のαマップをコマントアウトしました。必要な方はコマントアウトをなくして使ってください。
	map_athena.conf 修正。
・リザレクションは0442の問題でハイディング、ブリッツビートは0445の問題でした。それと0445の修正でスキル番号をenumで宣言した文字に変えていますがそれに落としがあるようです。(ハイディング、ブリッツビートはそのせいでした。)前の番号ソースと比べて問題がある部分は修正する必要があります。ちょっと面倒ですが...

--------------
//464 by 波浪

・モンクスキルの部分について修正(未実装スレに書かれていたものを追加しただけです。
	skill.c
		skill_use_id()修正
	cast_db.txt
		モンクスキル追加

--------------
//463 by 胡蝶蘭

・462のバグ修正
	・NPCのSHOPの不都合修正
	・READMEの間違い修正（warpwaitingpcがwarpwaitingroomになっていた）
	
	map.h
		struct npc_dataのchat_idの位置を修正

--------------
//462 by 胡蝶蘭

・NPCチャット作成
	・waitingroom命令でNPCチャットを作成します。
	  引数は waitingroom "チャット名",制限人数,イベント名 です。
	  イベント名は人数が最大になったときに起こすイベント名で、省略可能。
	・warpwaitingpc命令で、チャット内にいるPC全員をワープできます。
	  引数はwarpと同じで、warpwaitingpc "マップ名",x,y です。

	map.h
		struct npc_dataとchat_dataを修正
	script.c
		buildin_waitingroom(),buildin_warpwaitingpc()追加
	chat.c/chat.h
		色々修正
	clif.c
		clif_getareachar_npc()、clif_joinchatok()など修正
	
・NPCのOnInitイベントをサーバー起動時に呼ぶように。
・エクスポートするときのNPC名と表示上のNPC名を別々に設定可能に。
	・同じNPC名のイベントは重複できないため、エクスポート用NPC名を使い、
	  同じNPC名でも別のNPCとして識別できるようにしなければなりません。
	  (もちろん、イベント処理を行わない場合はその必要はありません。)
	・npc_*.txtのscript命令でNPCの名前を設定するとき、
	  「表示名::エクスポート名」とすると、表示する名前と、イベント用に
	  エクスポートする名前を別々に指定できます。
	  表示名が全く同じ別々のNPCでイベントを動作させるときに使用します。
	・ややこしいのでPVPのnpcスクリプトを見てイメージを掴んでください。

	npc.c/npc.h
		npc_parse_*()の修正
		npc_event_do_oninit(),npc_event_do_oninit_sub()など追加
	map.c/map.h
		do_init()でnpc_event_do_oninit()を呼ぶように
		struct npc_data修正

・スクリプトgetmapusers、getareausersの致命的なバグ修正
	・該当マップが存在しない場合、マップサーバーが落ちるのを修正。
	・マップが存在しないと、-1を返すようにした。
	
	script.c
		buildin_getmapusers(),buildin_getareausers()修正

・pvpのスクリプト修正
	・チャットルームを作るようにした
	
	(conf/)
	npc_pvproom.txt
		全てのNPCのエクスポート名(pvp??r)設定
		OnInit:でwaitingroomを実行するように

--------------
//461 by Kuro
・アコライト転職クエスト一部修正
	conf/npc_job_aco.txt

--------------
//460 by sagitarius
・item_dbの間違い修正
	4032,Ambernite_Card,アンバーナイトカード,6,20,,10,,2,,,,,32,,,,{},{},,修正

--------------
//459 by hoenny
・アドレナリンラッシュ使用の時斧チェック(自分だけ)
・Old_Blue_Boxの確率が高いという報告によって修正
・Script.cは0455以前ことで引換(NPCをここに合わせて修正してください)
・阿修羅覇鳳拳修正(公式を修正したんですが, 正確かはよく分からないですね.)
・修道僧の蓄気,爆期の仮実装.(阿修羅覇鳳拳使用の時蓄気,爆期状態をチェックします. )
・ペコペコに乗った後に、ADPDが間違ったこと修正(バグを直してあげたが, 直す前ことに変わるせいでまた修正)
その外にも修正をしたようなのに覚えないですね.そして誤った部分があれば指摘してください.
	conf/npc_event_ice.txt
		checkweight修正
	conf/npc_town_geffen.txt
		checkweight修正
	db/item_purplebox.txt
		Old_Blue_Box修正
	map/battle.c
		battle_calc_weapon_attack()修正
	map/pc.c
		pc_spheal()修正
		pc_calcstatus()修正
	map/script.c
		buildin_checkweight()修正
	map/skill.h
		SC_ EXPLOSIONSPIRITS追加
	map/skill.c
		SkillStatusChangeTable[]修正
		skill_castend_nodamage_id()修正
		skill_check_condition()修正

--------------
//458 by Kuro
・アコライト転職クエスト追加
	conf/npc_job_aco.txt
		会話文が分からなかったので適当にしてあります。また、NPCの外見の変え方が分からなかったので適当にしてあります。
		分かる方は修正しておいて下さい。	

--------------
//0457 by Kalen

・PVP関連のNPC追加
	conf/npc_pvp.txt
	conf/npc_pvproom.txt

--------------
//0456 by 死神

・モンスターの最初攻撃時間が長すぎる問題修正。
モンスターの最初攻撃時間を今まではmob_dbのaDelayを使っていましたがこれをaMotionに変更しました。今まではmob_dbのaMotionはゴミでしたが今度からはゴミではありません。aMotionさえ正しければモンスターの攻撃のモーションの前にダメージが出てくる問題もなくなるはずです。
	mob.c
		mob_changestate() 修正。
・アイテムを入手できない時その理由に当たるメッセージが出るように変更。
	pc.c
		pc_additem() 修正。
・job_db1.txtので問題になった.を,に修正。

--------------
//455 by Mr.NO NAME
・NPCとのアイテム交換や買い物関係のScriptが出来上がった当初の
　NPCデータ(npc_event_making.txt、npc_town_geffen.txt等)に乗っ取り、以下を修正。
	conf/npc_event_ice.txt
	     npc_event_potion.txt
	     npc_town_geffen.txt（454以前の物に戻しました。）
	map/script.c
		buildin_checkweight()を修正。

--------------
//454 by Kuro
・ゲッフェン鍛冶屋で買い物が出来るように修正
	conf/npc_town_geffen.txt

--------------
//0451 by code
・ 今更ですがαクライアントに対応(αクライアントのdata.grfをadata.grfとしてgrf-files.txtのadataのところに書いてください)
     common/grfio.c
		grfio_setadatafile()追加
           /grfio.h
		grfio_setadatafile()追加
     conf/map_athena.conf
		αクライアントのマップを読み込むように変更
         /npc_warp_a.txt
                αマップのワープポイントの設定(ちょっとずれてるかも)
         /grf-files.txt
		αクライアントのdata.grfをadata.grfとして読み込むように設定
		adata: に記述
※αクライアントは
　ttp://www.castledragmire.com/ragnarok/
　あたりから入手してください。

--------------
//0450 by hoenny
・ 騎兵修練実装
・ コムパルションディスカウント実装
・ ディスカウント・オーバーチャージ修正(数が高い場合計算法が間違ったことを直しました.)
・ 鉄拳修正(素手な時も適用されるように)
・ 斧修練修正(片手斧な時も適用されるように)
・ ボンゴンが攻撃するように修正
 	map/pc.c
 		pc_calcstatus()修正
 		pc_modifybuyvalue()修正
 		pc_modifysellvalue()修正
 	map/battle.c
 		battle_addmastery()修正
 	db/mob_db.txt
		ボンゴン修正 

--------------
//0449 by 死神

・変になった所修正。
	const.txt
		bAtkとbDef 追加。
	battle.c
		battle_calc_weapon_attack()を元に戻しました。(0445の物)
	map.h
		map_session_dataを元に戻しました。(0445の物)
	pc.c
		pc_calcstatus() 修正。
		pc_bonus() 修正。
	item_db.txtを元に戻しました。(0446の物)

--------------
//0448 by hoenny
・増速修正(pc_walk()から pc_calcstatus()に移動)
・最大所持量修正
	map/pc.c
	pc_calcstatus()修正。

--------------
//0447 by ゆう
・二刀流・矢の属性を正しく適応
・ATKの上がるカードの効果を武器サイズ修正なしの底上げに変更
・ATK・DEFの上がるカードの効果の適応の仕方を変更

map.h
	map_session_dataにcatk(カードATK)を追加

pc.c
	pc_calcstatus()
	  アサシンの二刀流の攻撃速度を修正した
	  スクリプトによる属性を左右正しく適応するようにした
	  矢の属性を正しく適応するようにした（弓の属性優先）
	  ただし、矢がすべての攻撃に適応されます
	  カードATKの処理を追加した

battle.c
	battle_calc_weapon_attack()
	  カートATKを底上げダメージとして計算するようにした

item_db.txt
	カードの bonus bAtk、bDef を削除
	かわりに、装備と同様にATKとDEFを設定
	（変更前をitem_db2.txtとしているので、不具合があれば戻してください）


--------------
//0446 by hoenny
・ミストレスカード実装。
・スキル使用の時ジェムストーン消費。
・スキル使用の時装備チェック。(ハンマーフォールだけ修正しようとしたが...)
・ハンマーフォールの範囲を 半径5セル(全25セル)ロ修正
	map/skill.c
		skill_check_condition()修正。
		skill_castend_pos2()修正。

・ミストレスカード修正。
	db/item_db.txt

--------------
//0445 by Aya

・基本ASPDと計算処理を修正。
	db/job_db1.txt
	map/pc.c
・SP係数と計算処理を修正。
	db/job_db1.txt
	map/pc.c
・スキル名をenumで宣言し、それを使うように変更。
	map/skill.h
	map/battle.c
	map/pc.c
	map/skill.c
・リカバリーのスキルIDがスローポイズンになっていたのを修正。
	map/skill.c
・集中力向上にカード効果が適用されていた問題の修正。
	map/pc.c
・リムーブトラップ、スプリングトラップ、ポイズンリアクトのターゲットを修正。
	db/skill_db.txt
・GMアカウントをjROのclientinfo.xmlから追加。
	conf/GM_account.txt
・warning修正。
	map/party.c
・キャラセレ認証時にlogin_id2はチェックしないように変更。
	login/login.c
・object_def.bat以外全ファイルの改行コードをLFに変更。
・*.cnfファイルを*.confファイルに名前変更。

--------------
//0444 by 死神

・GMコマンドや@コマンドにコマンド別に使用レベルを設定できるように変更と@コマンド少し修正。(@whereと@day、@nightの修正と他のキャラに使うコマンドの場合GMレベルが自分以上の場合使えないように修正。)
	atcommand.h 修正。
	atcommand.c 修正。
	clif.c 修正。
	map/makefile 修正。
	map.c
		do_init() 修正。
	conf/atcommand_athena.cnf 追加。
・細かい修正。
	pc.c
		pc_setghosttimer()、pc_skill() 修正。
	script.c
		buildin_skill() 修正。
・conf_ref.txt 修正。
・item_db.txt
	彼女の想い修正。

--------------
//0442 by 胡蝶蘭

・増速ポーション実装
	・Lvや職業判定は行いません

	(db/)
	const.txt
		SC_SpeedPot0,SC_SpeedPot1,SC_SpeedPot2追加
	item_db.txt
		増速ポーションのスクリプト追加
	(map/)
	skill.c
		skill_status_change_start()修正
	pc.c
		pc_calcstatus()修正

・PvPシステムの仮実装
	・pvpマップでは自動的に、PCのpvpフラグon、順位通知などを行います。
	・マップにpvpフラグをつけるサンプルをnpc_pvp.txtとして添付しています。
	・pvpの詳しいルールがよくわからなかったので、次のようにしています。
		・最初の持ち点は5点、倒すと1点、倒されると-5点。
		・0点以下のPCはリザレクションが掛からない
	・GMはpvpマップにいても足元にサークルが出現しないようです。
	  （クライアントの仕様？）
	・pvpマップで@pvpoff/@pvpすると休憩したり、休憩をやめたりできますが、
	  使用するべきではありません。
	
	(conf/)
	npc_pvp.txt
		pvpフラグを入れるサンプル。
		nosaveフラグや受け付けnpcなどを追加するとよいと思われる。
	(map/)
	clif.c
		clif_parse_LoadEndAck()修正
	npc.c
		npc_parse_mapflag()修正
	skill.c
		skill_castend_nodamage_id()修正
	pc.c
		pc_damage()引数修正
	atcommand.c
		pc_damage()引数修正に伴う修正
	battle.c

・その他修正
	・@pvpoff/@pvpで順位やサークルの表示をやめた
	・@jumptoでスペースの入ったキャラクターも指定できるように
	・@kamibコマンド復活（青文字天の声）
	・非PVPのときに、対象が敵のスキル使用時、敵味方判定を行うように
	
	skill.c
		skill_castend_id()で敵味方判定
	atcommand.c
		各コマンド修正

--------------
//0440 by 中の人

・本家を再現する方向なら意味はないかもしれませんが
　pc.c「スクリプトによるスキル所得」を若干変更して
  カードによるスキル一時習得の際でも1レベル以上を設定できるように致しました。

　単純に符号を変えてごまかしただけですので
　必要にあわせて修正をして下さい。

--------------
//0439 by hoenny
・阿修羅覇鳳拳の修正。
	db/skill_db.txt
・モンスター情報の修正。
	map/clif.c
・見切りの実装。
	map/pc.c

--------------
//0438 by Ａの人
・古木の枝が使える場所をＮＰＣスクリプトから制御可能
　mapflagにnobranchとすればそのマップは古木の枝使用不可になります。
	map.h
		enumにMF_NOBRANCH 追加。
	npc.c
		npc_parse_mapflag() 修正。
	pc.c
		pc_useitem() 修正。
ソース汚くしてしまったかも・・・.
勉強不足です

--------------
//0437 by 波浪
・item_db.txtの英名を大幅修正。(s付きとそうでない武器の英名がいつの間にやら
　同じになっていたのでそれを直すついでに他の部分も修正しました。
  まったく違う名前になってるものもありますが、こっちの方が正しいと思います。
・item_purplebox.txtを本家仕様っぽく作成(大体こんな感じかと
・アルベルタとイズルードNPCを修正

--------------
//0436 by hoenny
・morocc 宝石商人の修正
	conf/npc_shop.txt
・ハンマーフォールの実装(Alchemist氏ソースを参照ありがとう！)
	map/skill.c
以前に文字化けは低のせい!
次から気を付けます.

--------------
//0434 by Avethes

・タートルアイランドへ行くNPC修正
・ユノーNPC修正
（前回のバグはすみませんでした）

--------------
//0433 by 死神

・製造バグ修正。
	何故かはわからないがskill.cのskill_readdb()が変になっていたので修正。(自分がやった修正ではありませんが...)
	skill.c
		skill_readdb() 修正。

--------------
//0432 by 死神

・0429で一部のアイテムのスキルが出ない問題修正。
	clif.c
		clif_parse_UseSkillToId()、clif_parse_UseSkillToPos() 修正。
・skill.c
	skill_use_id() 修正。(大した修正ではないです。)
・item_db.txtの文字化け修正。言語設定が日本語ではない場合保存する時には気をつけましょう。
・攻撃されたモンスターの反撃が早すぎる問題修正。始めての攻撃がモンスターの攻撃ディレイに関係なく100ms後になっていたので攻撃ディレイに合わせるように変更。(ただ少し反撃が遅いと思われたりもしますが...)
	mob.c
		mob_changestate() 修正。
・鯖に接続する最大人数を決めるように変更。
	char.c 修正。
	conf_ref.txt 修正。
	char_athena.cnf 修正。

--------------
//0430 by Avethes

・ＮＰＣ関係。ほとんどテスト。
本家会話情報が揃えば修正。

--------------
//0429 by 死神

・ギルドのレベルアップをキャラのレベルアップのように変更。
	int_guild.c
		guild_calcinfo() 修正。
		guild_next_exp() 追加。
	exp_guild.txt 修正。(レベルが上がらないようにしたいレベルのexpに0を入れればそれ以上にレベルが上がらなくなります。)
・スクリプトresetstatus、resetskill 追加。
	pc.c
		pc_resetskill() 修正。
	script.c
		buildin_resetstatus()、buildin_resetskill() 追加。
・0425の続きで少し修正。
	clif.c
		clif_parse_ を少し修正。
・ショートカットに覚えているスキルレベル以上のスキルが登録されていても覚えているスキルレベルまでのスキルを使うように変更。
	clif.c
		clif_parse_UseSkillToId()、clif_parse_UseSkillToPos() 修正。
・メモの最大数を10個に変更。(あくまでも拡張の為の物です。まだ機能はしません。)
	mmo.h
		struct mmo_charstatusのmemo_pointを3から10に変更。
	char.c
		mmo_char_tostr() 修正。
・mob,c
	mob_once_spawn()、mob_summonslave() 修正。(別に意味がある修正じゃありませんが...)
・@monster コマンドで座標を指定しない時モンスターが一か所に集中して出るのをキャラの10*10マス以内にランダムで現れるように変更。
	atcomand.c 修正。

--------------
//0428 by Avethes

・conf/npc_smilegirl.txt
	スマイルマスクガールスクリプト。
	0427のおかしい部分とか修正。
	提供された各都市の座標に配置。（NONAMEさん提供ありがとう！）

--------------
//0426 by 胡蝶蘭

・アイテムの名前をdata.grfから読み込むようにした
	itemdb.cのITEMDB_OVERRIDE_NAMEを定義しなければ読み込みません。
	ITEMDB_OVERRIDE_NAME_VERBOSEはitemdb.txtのデバグ用にどうぞ。
	普通は変える必要はないと思うのでbattle_configには入れていません。
	
	itemdb.c
		itemdb_read_itemnametable()追加
		do_init_itemdb()修正

・データベース読み込み部の不安定性の修正(結構致命的だったみたいです)
	なくても問題ないDB（item_value_db.txtなど）のファイルがない場合に
	鯖が落ちたりする現象が発生していた場合はこれで直っているかもしれません.

	skill.c
		skill_readdb()でNULLポインタチェックを追加
	itemdb.c
		item_readdb()を複数に分けた。
		ランダムアイテムデータベースの読み込み部を１つに纏めた。
		do_init_itemdb()修正

・細かいバグ修正
	・ワープポータルの開くまでの秒数調整
	
	skill.c
		skill_unitsetting()修正

・その他修正（by 某M氏）
	db/job_db1.txt
		ちょこっと修正
	db/job_db2.txt
		2-2次職の足りないJobボーナスを追加(参考:R.O.M 776)
	conf/npc_town_kafra.txt
		オークD前と炭鉱前にカプラ配置(動作未確認)
	conf/npc_shop3.txt
		ジューノ販売NPC(拾い物)
	conf/npc_town_yuno.txt
		ジューノNPC(拾い物を改良。動作未確認)

--------------
//0425 by 死神

・0419で書き忘れた物ですがスキルラーニングポーションがSP回復アイテムにも効果があるように変更。
・今度はバグ修正がメインです。鯖落ちがなりそうな所の修正とテレポートの時死んだまま移動できる問題と0419でアクティブモンスターの先攻問題修正、死んでいるのに他の人には死んだように見えない問題の修正です。少しテストはしましたが本当に治ったかどうかは不明です。報告をお願いします。
	pc.c
		pc_attack_timer()、pc_damage()、pc_walk() 修正。
	map.c
		map_quit() 修正。
	mob_db.txt
		ビッグフットのmodeを修正(アクティブになっていた為)
	clif.c
		clif_parse_WalkToXY()、clif_pcoutsight()、clif_pcinsight()、
		clif_getareachar_pc()、clif_getareachar_mob()、clif_getareachar_pet() 修正。
	mob.c
		mob_ai_sub_hard_activesearch()、mob_ai_sub_hard_mastersearch()、
		mob_walk() 修正。
	pet.c
		pet_walk() 修正。

--------------
//0424 by hoenny

・クリップボーナス SP 10追加
	db/item_db.txt
・warp_test_yuno.txtを npc_warp30.txtに含んで, ちょっと修正
	conf/npc_warp30.txt
・他のサーバーが落ちても復旧されるように修正
	/startクリップ

--------------
//0420 by 紅葉

・EP 3.0でのカード効果変更に解る範囲で対応。
　ほぼ全ての変更点について、出来る限り修正してあります。
　ATK修正が正しく適用されているようなので追加してあります。(アンドレCなど)

--------------
//0419 by 死神

・0414で書き忘れた物ですが MOBのmodeで0x20(32)を復活させました。ボスじゃなくてもmodeに0x20が入っている場合普通のMOBでも死んだふりを破れます。
(今の所機能はそれだけです。本鯖はAI強化みたいですが...) ただゴーストはボスでも破ることはできません。
それと取り巻きのAIで取り巻きがターゲットした時主がターゲットしてないと主が取り巻きのターゲットをターゲットする部分をコマントアウトしました。(これが本鯖にあっていると思いましたので...)
・古い青い箱、古い紫色の箱、古いカード帖で出るアイテムをファイルで設定できるように変更。
	script.c
		buildin_getitem() 修正。
	item_db.txt
		古い青い箱、古い紫色の箱、古いカード帖修正。
	item_bluebox.txt、item_purplebox.txt、item_cardalbum.txt 追加。(使用例程度の物です。どのアイテムが出るようにするかは自分で設定して使ってください。ただクライアントを落とすアイテムは出ないように設定してください。)
	itemdb.h
		struct random_item_data 追加。
	itemdb.c
		itemdb_searchrandomid()、itemdb_readdb() 修正。
・mob.c
	mob_target()、mob_ai_sub_hard() 修正。(問題がありそうな部分だけ修正。)
・pc.c
	 pc_itemheal()、pc_walktoxy_sub() 修正。
・ペットの出現をMOBと同じように変更。
	clif.c
		clif_spawnpet() 修正。
	pet.c
		pet_change_name() 修正。
・0418を少し修正。(if文の条件を少し修正しただけです。)

--------------

//0418 by hoenny
・ /mm(/mapmove) /nb /b /bb /resetskill /resetstate GM 命令語使用の制限
clif_parse_MapMove ,clif_parse_ResetChar ,clif_parse_GMmessage 修正
	map/clif.c

--------------
//0417 by れあ

・0412でitem_db.txtがおかしくなっていたのを修正

--------------
//0416 by 紅葉

・ジュノー周辺のワープ定義と敵の配置。
　ワープ定義はnpc_warp30.txtとし、追加する形にしてあります。
　敵の配置についてもnpc_monster.txtとは統合せず、npc_monster30.txtとしてあります。
　問題が無いようであれば統合して下さい。
・上記定義ファイル追加に従いmap_athena.cnfを変更。
・@goコマンドへジュノー追加。
　要望があったようなので追加しました。

--------------
//0415 by 中の人

・今は亡き旧ROエミュ鯖開発スレッド Lv02での死神氏の説明に従って
　モンスター定義データを若干変更させて頂きました。
	・過去のnpc_monster.txtから通常マップ上（ルティエ等除く）にいるサンタポリン、アンソニを抽出し
	　新たに作った「npc_x-masmonster.txt」に移転
	・上記の修正にあわせてmap_athena.cnfを修正。
	　map_athenaにコメントアウト状態で「npc: conf/npc_x-masmonster.txt」を追加しました。
	　必要にあわせてコメントアウトをして下さい。

--------------
//0414 by 死神

・strcasecmpをstrcmpiに変更。
・dbや設定ファイルを読む時// をコマントアウトとして認識するように修正。
・ペットと離れすぎるとペットが早く動くように変更。(キャラの2倍の速度で動きます。)
・ルートモンスターがアイテムをターゲットした時攻撃を受けても攻撃してこない問題修正。
・同族モンスターのAIを変更。今まではtraget_idを使うせいでモンスターが攻撃した相手を攻撃する仕組みだったが今度はattacked_idを使う為攻撃してきた相手を攻撃するように変更。
ただ今の仕様だと同族モンスターを攻撃して逃げる場合攻撃を受けた時その場になかったモンスターはついて来なくなっています。本鯖の仕様にあってるかどうかは不明ですので情報提供をお願いします。(attacked_idはいつもリセットされる為です。対策がいないわけでもないですが本鯖の仕様を知らないので...)
・メモリーの使用量を減らす為struct mob_dataとstruct npc_dataを変更。(0412で
map-serverのメモリーの使用量が164???KBytesだったが0414では152???KBytesになりました。ほんの少し減っただけですが増えるよりはましだと思いますので...)
・ゴーストタイム実装。
 マップ移動やテレポート、復活した時に敵に狙われない時間を重力ではゴーストタイム呼んでいます。そのゴーストタイムの実装です。
battle_athena.cnfで時間を設定できます。時間を0にするとゴーストタイムは作動しません。ただこのゴーストタイムは攻撃行動、スキル使用、アイテム使用をするとなくなります。
	char/int_guild.c
	char/int_party.c
	conf/battle_athena.cnf
	db/mob_db.txt
	doc/conf_ref.txt
	login/login.c
	map/atcommand.c
	map/battle.c
	map/battle.h
	map/clif.c
	map/itemdb.c
	map/map.c
	map/map.h
	map/mob.c
	map/npc.c
	map/pc.c
	map/pc.h
	map/pet.c
	map/skill.c を修正。(db/mob_db.txtは//を入れただけですが...)
		修正した所を全て覚えてませんのでファイルだけ知らせます。

--------------
//0412 by いど

・モンスター定義データ(日本語)の再整理
　	旧掲示板で指摘のあった事項について大体の範囲で修正
	snapshot387のバージョンをベースに修正しました。
		conf/npc_monster.txt

・アイテム名の定義を大幅修正
	(root)
		item.list
	(db/)
		item_db.txt
		item_value_db.txt

・マップデータの定義でコメントアウトしていたジュノー関連マップのコメントアウトを解除
	conf/map_athena.cnf

--------------
//0411 by 死神

・鯖snapshotです。それとlogin_port、char_port、map_portの設定がなくても
デフォルトで6900、6121、5121を使うように変更。
・login.c、char.c、chrif.c、clif.c 少し修正。
・conf_ref.txt 修正。
・login_portを6900から他の物に変えた場合はclientinfo.xmlを変える必要があります。

--------------
//0410 by 死神

GM用右クリックメニュー「（name）使用者強制終了」実装。(テストはしてません。@コマンドはテスト済みですが...)
0407のEXPに関する修正に問題があるらしいので修正しました。今度はテスト済みです。
GMのアカウントIDを設定できるように変更とGMをレベル別に分けるように変更。
(GMのレベルによる@コマンド等に制限をかけるつもりですが今制限がかけている物は@kick、@kickallのみになっています。)
・pc.c
	pc_readdb()、pc_gainexp()、pc_nextbaseexp()、pc_nextjobexp()、
	pc_checkbaselevelup()、pc_checkjoblevelup() 修正。
	pc_isGM()、pc_read_gm_account() 追加。
・pc.h
	pc_isGM() 修正。
	pc_read_gm_account() 追加。
・exp.txt
	レベルが上がらない数値を999999999から0以下に変更。
	レベルを上げる為に必要なEXPを999999999以上にすることも可能。
・clif.c
	clif_GM_kickack()、clif_GM_kick()、clif_parse_GMKick() 追加。
・clif.h
	clif_GM_kickack()、clif_GM_kick() 追加。
・atcomand.c
	strncmpiをstrcmpiに変更。
	@kick、@kickall コマンド追加。
	@kick <キャラ名>
		自分以外のキャラの接続を強制終了させる。(自分よりGMレベルが
		低いキャラにしか使えない。GMではないキャラのGMレベルは0)
	@kickall
		鯖に接続している全てのキャラの接続を強制終了させる。(自分と
		GMを含めて) 鯖ダウン用のコマンドです。GMレベルが99じゃないと
		使えない。
・conf/GM_account.txt 追加。
	GMとして認識するアカウントIDを設定するファイルです。
・mmo.h
	DEFAULT_WALK_SPEEDを140から150に変更。(これが本鯖にあってる数値
	みたいですので...)
	struct gm_account 追加。
・client_packet.txt
	パケット0x00cd 追加。
・login_portをcnfで読むように変更。(ただ6900からポートを変えるとクライアントが認識できない模様なので無駄なことだったりもしますが...)
	char.c、login.c、char_athena.cnf、login_athena.cnf 修正。
・普通のアカウント作成ではGMになれないようにlogin.cを変更。
・login/makefile、map/makefile 修正。

--------------
//0408 by 胡蝶蘭

・405の新しい＠コマンドを以前のatcommand.cに取り込みました。
	・@kamiを修正
	・@kill,@recall,@charjob,@revive,@charstats,@charoption,@charsave,
	  @night,@day,@doom,@doommap,@raise,@raisemap,@charbaselvl,@charjlvl
	  を追加＆メッセージを日本語に変更＆少し修正

	atcommand.c
		追加と修正

・一部のスキルの効果実装
	・不死身のジークフリード、イドゥンの林檎、幸運のキス、
	  フレイムランチャー、フロストウェポン、ライトニングローダー、
	  サイズミックウェポン
	
	map.h
		struct skill_unitにrangeを追加。
	skill.c
		色々修正
	skill.h
		enumの修正など
--------------
//0407 by 死神

・ペットのバグ修正。(ただ自分で再現できなかったので問題になりそうな所だけ修正しました。)
・ペットの移動速度をpet_dbに追加。
	pet.h
		struct pet_dbにspeed追加。
	pet.c
		pet_catch_process2()、read_petdb() 修正。
	pet_db.txt
		移動速度追加。
		(コマントアウトしているのはジルタスとアリスです。捕獲用の
		アイテムが存在することとパフォーマンスをすることから考えて
		追加される予定の物と考えられます。ただその捕獲用のアイテムが
		あるとクライアントを落ちますので注意してください。追加しても
		台詞はポリンの物ですので... 捕獲用のアイテム以外は適当に入れた
		物です。)
・pc.c、clif.c
	pc_equipitem() 修正。
	clif_parse_EquipItem() 修正。
	pc_equipitem()の未鑑定アイテムのチェックをclif_parse_EquipItem()に
		移動しました。(ペットの装備もありますので...)
・レベルを99以上にあげるように変更と職業別にベースレベルの限界レベルを設定できるように修正。
	map.h
		MAX_LEVEL追加。
	pc.c
		pc_nextbaseexp(), pc_nextjobexp() 修正。
		pc_readdb() 修正。
・exp.txt 修正。職業レベルと同じようにベースレベルもEXPテーブルを3つ作りました。レベルアップを止めたいレベルのexpを999999999にすればそれ以上レベルが上がりません。つまりnovice、1次職業と2次職業のベースレベルの限界を違うように設定できます。そしてベースレベル99以上に上がるようにすることもできます。(exp.txtの修正が必要ですが本鯖と違うように設定したい場合に修正して使ってください。)
・属性による回復をbattle_athena.cnfで設定できるように変更。
	attr_fix.txt 修正。
	battle.h
		struct Battle_Configにattr_recover 追加。
	battle.c
		battle_config_read() 修正。
	battle_athena.cnf 修正。
・conf_ref.txt 修正。
・client_packet.txt 修正。ペットパケット追加と少し修正。

--------------
//0402 by 胡蝶蘭

・400のバグを一部修正
	・掛かってないスキル効果によるステータス計算が行われてしまうバグ修正
	・効果修正：あくまで効果の計算の修正で、使えないスキルは使えません。
	  スピアクィッケン、プロヴィデンス、戦太鼓の響き、
	  夕陽のアサシンクロス、口笛、不死身のジークフリード、
	  イドゥンの林檎、サービスフォーユー、幸運のキス
	・効果追加：あくまで効果の計算の追加で、使えないスキルは使えません。
	  ハミング、私を忘れないで…、ニーベルングの指輪(武器レベル無視)、
	  エターナルカオス、ドラゴノロジー
	・効果付加系はちょっとでも怪しいスキルは全て使用できないように修正
	・攻撃系スキルはほとんど見てないのでたぶんバグ多いです。
	・全て未テストです。怪しすぎる部分を修正しただけです。
	
	map.h
		MAX_STATUSCHANGEを128に修正
	pc.c
		pc_calcstatus()修正
	skill.c/skill.h
		enumを修正
		skill_status_change_start()修正
	battle.c
		battle_calc_weapon_attack()など修正

--------------
//0400 by AppleGirl

Can Someone Help Me.
2-2 Skills added.
All The Mastery Skills.
SpearQuicken,Providence
New Bard Skill Assassin Cross Of Sunset
Providence
Frost Joke
Apple of Idun
Service For You
Meteor Strike (Different Style)
Assassin Cross Of Sunset (not tested)
All Masteries Done
Providence
Musical Strike
Throw Arrow
Frost Weapon << (Problems with elements)?
Flame Launcher << (Problems with elements)?
Seismic Weapon << (Problems with elements)?
Lightning Loader << (Problems with elements)?
Spirit Recovery
Potion Pitcher (Tato)
Axe Mastery (Tato)
Spear Quicken
Not Totally Working:
Combo Finish
Quadruple strike
Triple Attack
(skills in skill.c) (need to be finished.)
CP_ARMOR
CP_HELM
CP_SHIELD
CP_WEAPON
STRIP_HELM
STRIP_WEAPON
STRIP_SHIELD
STRIP_ARMOR

* 適当な和訳 *
2-2次職スキルを追加しました
全ての修練スキル、スピアクイッケン、プロヴィデンス、
夕陽のアサシンクロス（未テスト）、寒いジョーク、イドゥンの林檎、
サービスフォーユー、メテオストライク（少し違う）、
ミュージカルストライク、矢撃ち、フロストウェポン(属性が問題あり？)
フレームランチャー(〃)、サイズミックウェポン(〃)、ライトニングローダー(〃)
息吹、ポーションピッチャー
完全には働かないスキル：
猛龍拳、漣環全身掌、三段掌
(skills in skill.c) (完了される必要がある)
ケミカルアーマーチャージ、ケミカルヘルムチャージ、
ケミカルシールドチャージ、ケミカルウェポンチャージ、
ストリップヘルム、ストリップウェポン
ストリップシールド、ストリップアーマー

*注意 !! CAUTION !! by 胡蝶蘭*
この400にはバグが大量に含まれています。注意してください。
there are many many BUGS in this update(400) !! Be careful !!

--------------
//0399 by 胡蝶蘭

・MOBスキル使用条件や行動を修正
	・無行動MOBが待機時のスキルを使用できない問題を修正
	・条件スキル反応(skillused)がどのスキルにも反応していたバグ修正
	・非移動MOBが追撃してくる問題を修正

	mob.c
		mob_ai_sub_hard()修正
		mobskill_event()修正
		mobskill_use()修正
	skill.c
		skill_attack()修正

・MOBスキル一部実装
	・自決(エフェクト無し?)、自爆、タバコを吸う、範囲攻撃
	  HP吸収２つ(通常/魔法）（回復エフェクト無し?）実装

	(db)
	skill_db.txt
		スモーキングなどを修正
	(map/)
	skill.c
		skill_castend_damage_id(),skill_castend_nodamage_id()修正
	battle.c
		battle_calc_misc_damage()修正

・未鑑定アイテムが装備できなくなりました
・未鑑定アイテムにカードがさせなくなりました

	pc.c
		pc_equipitem(),pc_insert_card()修正
	clif.c
		clif_use_card()修正

・battle_athena.cnfにMOBの配置割合を定義できるようになりました
	・配置数が１のMOBについては適用されません
	・計算後の配置数が１未満の場合１に修正されます。
	
	(conf/)
	battle_athena.cnf
		mob_count_rate追加
	(doc/)
	conf_ref.txt
		修正
	(map/)
	battle.c/battle.h
		struct BattleConfig に mob_count_rate メンバ追加
	npc.c
		npc_parse_mob()の修正

・ボーリングバッシュが相手が１匹でもとりあえず当たるようになった。

	skill.c
		skill_castend_damage_id()修正

・学生帽作成イベントの修正

	(conf/)
	npc_event_making.txt
		アロエベラ(606)をアロエ(704)に。

・パケット情報修正

	(doc/)
	client_packet.txt
		0199パケット修正

--------------
//0397 by いど

・モンスター定義データ(日本語)の整理
	・npc_monster25.txtをnpc_monster.txtにリネームし、内容を整理(現在mob数:13450)
	・その軽量版としてnpc_monster_lite.txtを作成(現在mob数:11959)
	・上記の修正にあわせてmap_athena.cnfを修正

--------------
//0395 by 胡蝶蘭

・取り巻きMOBの行動修正
	・アンクルなどで移動できない場合主に近づかないように修正
	・ロックしていると主に近寄る処理をしないように修正
	・主がテレポートすると追いかけるように修正(付近10x10マス程度)
	・主のそばにいるときはランダム歩行をしないように修正

	mob.c
		mob_ai_sub_hard_mastersearch()修正
		mob_can_move()追加
		mob_ai_sub_hard()修正

・MOBの行動修正
	・スキル使用ディレイ処理がおかしかったのを修正
	・詠唱のないスキルはtimerを使わないように修正(死亡時処理対策)
	
	mob.c
		mobskill_use(),mobskill_use_id()修正

・MOBエモーションの実装
	・エモーションの種類がわからないものは全て「!」になります。
	  抜けているデータを埋めてくれるとうれしいです。
	
	(db/)
	mob_skill_db.txt
		いくつかのMOBのエモーションの項目の値1に種類を入れた。

	(map/)
	skill.c
		skill_castend_nodamage_id()修正
	clif.c/clif.h
		clif_emotion()追加

・パケット解析.txtをclient_packet.txtに改名＆修正

	(doc/)
	client_packet.txt
		エモーションの説明追加

・どうやら取り巻きMOBの種類は古いデータだったっぽいです。
  しかもMOB召喚では手下召喚と違うMOBを召喚するみたいですね。
  詳しい人はmob_skill_db.txtを直してくれると。

--------------
//0393 by いど

・char鯖でのlogin鯖のポート設定を6900に固定し、変更できないようにした
　(login側でポート6900固定になっていたのでchar側もそれに合わせました。)
	char/char.c
	conf/char_athena.cnf
	doc/conf_ref.txt

--------------
//0392 by 胡蝶蘭

・MOBの行動修正
	・何故かlast_thinktickが初期化されていない問題修正
	・上に関連してPCが近くにいても手抜き処理が行われる問題修正
	  （どうやら初期からのバグだった模様？  このバグと、
	    新しい手抜き処理の仕様がタッグを組んで残像を作っていた模様）
	・取り巻きMOB用のAI処理追加（まだ怪しいです）
	・MOBのスキルディレイをスキル項目ごとに持つように変更
	・スキルディレイが大きな項目ではオーバーフローしていた問題を修正
	
	map.h
		struct mob_dataの skilldelayを配列にしてunsigned intに変更
	mob.h
		struct mob_skillのcasttime,delayをintに変更
	mob.c
		mob_ai_sub_hard_mastersearch()追加
		mob_changestate(),mob_delete(),mob_catch_delete(),mob_damage(),
		mobskill_use(),mobskill_use_id(),mobskill_use_pos(),
		mobskill_castend_id(),mobskill_castend_pos(),
		mob_ai_sub_hard(),mob_ai_sub_lazy()など修正

・MOBスキルの手下召喚とモンスター召喚実装
	・mob_skill_db.txtの書式変更（最後に値を１つ追加、取り巻きMOBのID）
	・取り巻きMOBがわからなかったものはコメント化しています
	  わかる人は入力よろしくお願いします。
	・現在は取り巻きは一度倒したら沸きなおしません。
	・ボスがテレポートしても取り巻きは追いかけません。
	・本鯖でどうなってるのか知らないので、間違ってる場合は教えてください。
	
	(db/)
	mob_skill_db.txt
		手下召喚などのデータ修正
	
	(map/)
	skill.c
		skill_castend_nodamage_id()修正

--------------
//0391 by 死神

・ペットの移動中にパフォーマンスをするとペットが停止するように変更。
	(ペットの位置がずれるため修正しました。)
	pet.c
		pet_performance() 修正。
・死んだモンスターはどんな行動もとれないように変更。(これで無敵
	モンスターがいなくなるといいですが...)
	mob.c
		mob_changestate(),mob_delete(),mob_catch_delete(),mob_damage(),
		mob_ai_sub_hard(),mob_ai_sub_lazy()  修正。
・PC、NPC、床アイテムが使うIDの範囲を調整。
	床アイテムは0から500000まででPCは500000から100000000、NPC
	(モンスターを含めて)は110000000から約21億までになります。
	(-を含めるともっと範囲が広くなりますがさすがにそこまでは必要ないと
	思いますので...)
	map.h
		MAX_FLOORITEM 追加(これを変えると床アイテムの最大数を変える
		ことができます。今は100000になっています。ただこれは必ず
		500000以下にしてください。そうしないと正しく動くかどうか
		保証できません。)
	map.c
		map.hに合わせて少し修正。
	npc.h
		START_NPC_NUM 追加。
	npc.c
		npc.hに合わせて少し修正。
	login.h
		START_ACCOUNT_NUMとEND_ACCOUNT_NUM 追加。
	login.c
		login.hに合わせて修正。END_ACCOUNT_NUM以上にaccountを
		作れないように変更。
・カートレボリューションに武器研究を２回適用するように変更。
	(結局は元に戻すことになりました...^^;)
	battle.c
		Damage battle_calc_weapon_attack()  修正。
・mobのスキル使用をbattle_athena.cnfで決めるように変更。
	mob.c
		mobskill_use() 修正。
	battle.h
	battle.c
		struct Battle_Configにmob_skill_use追加。
	battle_athena.cnf
		mob_skill_use追加。(設定しないとnoです。)
・battle_athena.cnf
	mobを二重で読めないようにnpc: conf/npc_monster.txtを削除。
	(最新はnpc_monster25.txtなので...)

--------------
//390 by 胡蝶蘭

・バージョン情報所得部分を少し変更
	・MODバージョンを定義できるようになりました。詳細はversion.hを。
	  気が向いたときか、大きな更新があるときなどに変更してください。
	・バージョンcheck時のset eofログが出ないようにパケット7532追加。
	
	(common/)
	version.h
		MODバージョンを定義できるように。
	(tool/)
	checkversion
		MODバージョンを表示するように。
	(login/char/map)
	login.c/char.c/clif.c
		MODバージョンの処理追加、
		パケット7532（切断）処理追加。

・その他色々修正
	・こまごました修正ばかりですが、あまり覚えていません。
	・MOBスキル条件でslavelt,attackpcgt処理実装（未テスト）。
	・MOBの手下召喚のための機構追加（まだ召喚できません）。
	・範囲スキル効果範囲に死亡PCがいると鯖が落ちるバグ修正。
	・MOB残像が出なく…なってたらいいな。
	
	(map/)
	mob.c/mob.h/map.h/battle.c
		色々追加

	(db/)
	mob_skill_db.txt
		ルート時処理と、属性変更スキルのコメントを外した。
		（属性変更は本鯖で動いてないらしいものもコメントを外してます。
		  問題がある場合は再びコメント化してください）

--------------
//389 by いど

・388の変更
	バージョン情報をcommon/version.h内の定数を使用するように変更

--------------
//388 by 胡蝶蘭

・バージョン情報所得ツール添付
	Perl製なので実行にはPerlが必要です。
	使用方法などはエディタで開いて見てください。
	使い方が良くわからない人は手を出さないほうがいいです。

	バージョンを確認する用途よりは、サーバーの生存確認用といったかんじです
	パケット7530/7531の詳細はソースを見てください。

	(tool/)
	checkversion
		バージョン確認ツールPerlスクリプト

	(login/)
	login.c
		パケット7530/7531の処理追加
	(char/)
	char.c
		パケット7530/7531の処理追加	
	(map/)
	clif.c
		パケット7530/7531の処理追加

・384以前のathena.txtも読み込めるようにしました
	・convertが面倒な人向け。
	・正しく読み込める保証無し。バックアップを忘れずに。
	
	(char/)
	char.c
		384の方式で読み込めないデータは384以前の方式も試すように。

・conf_ref.txt/help.txt/getaccount修正
	help.txt
		petコマンドの説明追加
	(doc/)
	conf_ref.txt
		pet関連の設定の説明追加
	(tool/)
	getlogincount
		表示の修正

--------------
//387 by いど
・confフォルダ内のNPC定義データの整理
	以下のファイルを削除しました
		npc_kafraJ.txt
		npc_mind_prtmons.txt
		npc_script2J.txt(npc_event_mobtim.txtに同じものがあったため)
		npc_testJ.txt(ほぼ同じことが@コマンドで出来るため)
		npc_warp25.txt(npc_warp.txtに統合)

	以下のファイルの名前を変更しました
		npc_monster3.txt	-> nop_monster2E.txt
		npc_monster3J.txt	-> npc_monster25.txt
		npc_monster.txt		-> npc_monsterE.txt
		npc_monsterJ.txt	-> npc_monster.txt
		npc_sampleJ.txt		-> npc_sample.txt
		npc_script3j.txt	-> npc_script2.txt
		npc_script25J.txt	-> npc_town_lutie.txt
		npc_shop1J.txt		-> npc_shop_test.txt
		npc_shop2J.txt		-> npc_shop_mobtim.txt
		npc_shop3J.txt		-> npc_shop2.txt
		npc_shop.txt		-> npc_shopE.txt
		npc_shopJ.txt		-> npc_shop.txt
		npc_testJ.txt		-> npc_test.txt
		npc_warp3.txt		-> npc_warp2.txt
		npc_warp4.txt		-> npc_warp25.txt

・マップ定義の追加
	ジュノーアップデートで追加されるマップと、韓鯖独自(?)のクイズゾーン
	(コモドアップデート)と天津アップデートのマップ定義を追加
	現在、日鞍に無いものに関してはコメントアウトしていま。
		conf/map_athena.cnf

--------------
//385 by 胡蝶蘭

・MOBの行動修正
	・手抜き処理で移動しないモードのMOBも歩く問題修正
	・MOBを倒したとき、再spawn時刻がおかしな値になる場合がある問題修正
	  （MOBが沸かなくなる問題が修正されたはず）
	・MOBのワープで場所検索に1000回失敗したら元の場所に出るように修正
	・MOBを詠唱中に倒すと、タイマーを削除するように修正
	
	mob.c
		mob_delete(),mob_catch(),mob_damage(),
		mob_ai_sub_lazy(),mob_ai_sub_hard()など修正
		mobskill_deltimer()追加

--------------
//0384 by 死神

・ペット実装。
思ったより長くかかりました。一周もかかったせいで何処を修正したか
覚えてない問題がありますが... それで念の為にmapとcharのファイルは全て
含めてアップします。
それとmakefileとathena.shは自分が使ている物です。
Yare-launcherは使てませんがいつも鯖の実行ファイルで実行していますので...
	char/char.c、char/char.h、char/inter.c、char/makefile 修正。
	char/int_pet.c、char/int_pet.h 追加。
	map/makefile 修正。
	map/intif.c、map/intif.h、map/map.c、map/map.h、map/mob.c、map/mob.h、
	map/npc.c、map/npc.h、map/battle.c、map/battle.h、atcomand.c、map/pc.c、
	map/clif.c、map/clif.h、map/script.c 色々修正。
	map/pet.c、map/pet.h は殆どを自分の物に書き換えました。
	common/mmo.h 修正。
	db/pet_db.txt 修正。
	db/item_db.txt 修正。(携帯卵孵化機のbpet スクリプトが抜けていたので
		入れただけですが...)
	doc/INTER鯖パケット.txtの名前をinter_server_packet.txtに変更とペットの
		保存等に使うパケットを追加。
* 今度のペット実装によりキャラファイルの構造が変わり以前の物と互換できない
	ので tool/convert.c を追加しました。
	単独でコンパイルできますのでコンパイルしたあと実行してキャラ
	ファイルを変換してください。そうしないとキャラが全部飛びますので...
* ペットの親密度が0になるとペットはその場で動けなくなりその状態で他の
	マップに移動するか終了するとペットは消滅します。一応ペットの逃走を
	実装するつもりで作ったのですが本鯖にあってるかどうかはわかりません。
* 移動速度が遅いペットの場合離れ過ぎるとついて来れなくなります。でも
	この場合マップを移動してもちゃんとついて来ます。
	消滅したりはしません。
* 移動速度が速いペットはキャラより先に移動します。本鯖の方がどうなのか
	わからないのでペットの移動はモンスターの移動速度で移動する
	ようにしました。
・battle_athena.cnf
pet_catch_rate 追加。
	ペットの捕獲倍率を設定します。(設定しないと100)
	基本的にペットの捕獲に使ってる公式は
		(pet_db.txtの捕獲率 + (キャラレベル - モンスターレベル)*0.3 + luk *0.2)
		* (2 - モンスターの現在HP/モンスターの最大HP)
	になります。自分なりに作った物ですので本鯖とはかなりの
	違いがあるかも知れません。(モンスターのHPを減らせば減らす程捕獲率が
	上がる仕組みですが...)
pet_rename 追加。
	ペットの名前を変更するかどうかを決めます。(設定しないとno)
	yesは何度でも名前の変更が可能。
	noは一度変更するともう変更不可能になる
pet_hungry_delay_rate 追加。
	ペットの腹が減る時間の倍率です。(設定しないと100)
	倍率が高いと腹が減り難くなります
mvp_exp_rate 変更。
	すでにstruct mob_dbのmexpperはゴミになっているので(MVP EXPは
		MVPアイテムが取れなかった場合入るので意味がありません。)
	MVP EXPの量の倍率になるように変更。(mob.cを修正)
・char_athena.cnf
autosave_time 追加。
	自動保存する時間を決めます。(設定しないと300)
	單位は秒です。(ファイルに保存する時間の間隔です。)
・map_athena.cnf
autosave_time 追加。
	自動保存する時間を決めます。(設定しないと60)
	單位は秒です。(キャラ鯖にデータを送る時間の間隔です。これは
		ファイルに保存する時間の間隔じゃありません。)
・inter_athena.cnf
pet_txt 追加。
	ペットのデータを保存するファイルを決めます。(設定しないとpet.txt)
・@makepet コマンド追加。
	ペットの実装によって@itemで作った卵は使っても無駄になりますので
	これを使って卵を作ってください。
	@makepet <モンスターのID or 卵のID>
・@petfriendly コマンド追加。
	@petfriendly <数字>
	ペットを連れている時にペットの親密度を変更。(0~1000)
・@pethungry コマンド追加。
	@pethungry <数字>
	ペットを連れている時にペットの満腹度を変更。(0~100)
・@petrename コマンド追加。
	@petrename
	ペットを連れている時にペットの名前を変更できるように変更。
・int_guild.c、int_party.c 読み込むファイルにエラーがあってもプログラムを
	終了せずに進むように変更。
・pc_walk 123 != 1234 等のエラーが出ないように
	if((i=calc_next_walk_step(sd))>0) {
		sd->walktimer=add_timer(tick+i/2,pc_walk,id,sd->walkpath.path_pos);
	を
	if((i=calc_next_walk_step(sd))>0) {
		i = i/2;
		if(i <= 0)
			i = 1;
		sd->walktimer=add_timer(tick+i,pc_walk,id,sd->walkpath.path_pos);
	のように変更しました。
	tickが同じ数値になるのを防いたのですがこれでどんな影響が出るかは
	さっぱりわかりません。
	pc.c、mob.cを修正。
	でもこの修正をしても連続でクリックしたりするとキャラがしばらく
		止まるようです。(ペットのせいと思いましたがペットがなくても
		同じだったので他の原因かと...)
* doc/code_ref.txtとhelp.txtは面倒くさいので修正してません。
・gm_all_skill: yesで2-2のスキルも表示されるように変更。(試いせはいませんが...)
	pc.c
		pc_calc_skilltre()  修正。
・カートレボリューションのダメージ計算を修正。
	武器研究を二重計算していたので修正。
	battle.c
		Damage battle_calc_weapon_attack() 修正。

--------------
//381 by 胡蝶蘭

・MOBの行動修正
	・PCのいないマップのMOBは時々ワープするようになりました
	・PCのいるマップのMOBは歩く以外に、時々沸き直すようになりました
	（これまたパフォーマンスに影響があるかもしれません：少し重くなるかも）
	・手抜き処理でブロックの有効判定を行うようにしました
	（HP無限MOB問題修正？）
	・ルート時スキル使用機構実装

	mob.c/mob.h
		mob_ai_sub_lazy(),mob_ai_sub_hard()修正
		MSS_LOOT追加,mob_readskilldb()修正

・MOBスキルの属性変更を実装しました。
	
	map.h
		struct mob_dataに def_eleメンバ追加
	mob.c
		mob_spawn()でdef_eleをセットするように変更
	battle.c
		battle_get_element()でdef_eleを読むように変更
	skill.c
		skill_castend_nodamage_id()修正

・クァグマイアの効果範囲から出ると効果が切れるようになりました

	skill.c
		ユニット系処理修正

--------------
//380 by Ａの人

・カートレヴォリューションのダメージ計算実装
	battle.cを変更。

CHRISさん、ありがとう御座います。
ノックバック実装できなくて、困ってました（＞＜；

--------------
//379 by CHRIS

・カートレヴォリューションの実装
	skill.cとbattle.cを変更。

・マグナムブレイクにノックバックを追加。
	battle.cを変更。

（ソースを弄ったのは初めてなので、有ってるかどうか分かりませんが、自分では出来ました。）
（プログラム関係の書籍を買って勉強して初めて弄ったのです・・・。ガンバリマス！。）

--------------
//377 by 胡蝶蘭

・MOBの行動修正
	・近くにPCのいないMOBが時々ワープする仕様を止めました。
	・PCのいないマップのMOBは全く動かなくなりました。
	・PCのいるマップで、近くにPCのいないMOBは時々歩くようになりました。
	・その他細かいところ修正
	（パフォーマンスに影響があるかもしれません：少し重くなるかも）

	mob.c
		mob_randomwalk()追加
		mob_ai_sub_lazy(),mob_ai_sub_hard()修正など

・スキル修正
	・MOBがテレポートできるようになりました
	
	mob.c
		mob_warp()追加
	skill.c
		skill_castend_nodamage_id()修正

・ステータス異常の一部を実装/修正
	・PC/MOBともに速度減少の効果が現れるように（AGIの表示は変わらず）
	・PCのエンジェラス、インポシティオマヌス、速度上昇の効果を修正
	・MOBの2HQ、アドレナリンラッシュ、エンジェラス、インポシティオマヌス、
	  速度上昇/減少、グロリア、ブレッシングなどの効果実装
	・睡眠、凍結、スタンの必中効果実装
	・睡眠のクリティカル倍効果実装
	・暗黒の命中率、回避率減少効果実装
	・呪いのATK減少効果、LUK減少効果実装
	
	battle.c
		battle_get_*()修正
		battle_calc_weapon_damage()修正
	mob.c
		mob_get_speed(),mob_get_adelay()追加
	pc.c
		pc_calcstatus()修正

・item_value_db.txtでアイテムの価格を設定できるようになりました
	・価格データをオーバーライドできるようにしました。
	・これでitem_db2.txtを用意する必要がありません。
	
	(db/)
	item_value_db2.txt
		item_db2.txtの価格データ。
		item_value_db.txtにリネームすると読み込みます。
	(map/)
	itemdb.c
		itemdb_readdb()修正

・古木の枝を使うとMOBの名前が 0 になる問題の修正

	(db/)
	item_db.txt
		古木の枝のデータ修正

--------------
//375 by 胡蝶蘭

・MOB専用スキルの効果をいくつか実装
	多段攻撃、毒などの追加効果付与攻撃、属性付き攻撃、魔法打撃攻撃
	必中攻撃、防御無視攻撃、ランダムATK攻撃など。
	ただし、**全くテストしてません**。
	
	(db/)
	skill_db.txt
		MOB用スキルのデータを修正
	mob_skill_db.txt
		少し追加
	(map/)
	skill.c
		skill_castend_damage_id()修正
		skill_status_change_start()修正
		skill_additional_effect()修正
	battle.c
		battle_calc_weapon_attack()修正
	
・スキルを少し修正
	・ウォーターボールで敵が死んでいても撃つモーションをする問題修正
	
	skill.c
		skill_status_change_timer()修正

・MOBデータが変なので某Ｗのデータベースを流用してみる
	・データの並び順とか全く同じなんですね

	(db/)
	mob_db.txt
		某Ｗのmob_db.txt

・各種confのリファレンスを添付
	あくまでリファレンスなので、HowToなんかは書いてません。

	(doc/)
	conf_ref.txt
		confのリファレンス＋α


--------------
//373 by 胡蝶蘭

・MOBスキル使用機構仮実装
	・スキル使用時の処理はプレイヤーと共用(skill.c)です。
	・不都合が多いと思うので報告お願いします。
	・mob_skill_db.txtを埋めてくれる人も募集。
	  このデータは「ラグナロクのたまご」を参考にしています。
	
	(db/)
	mob_skill_db.txt
		MOBスキルデータベース(未完成)
		テスト用のデータしか入ってません。
	(map/)
	mob.c/mob.h
		mobskill_*追加、その他多数修正
	map.h
		struct mob_data に skill* 追加
	skill.c/skill.h
		skill_castcancel()やスキルユニット処理をMOBに対応させた
	battle.c
		battle_calc_damage()など修正

・ギルドのスキルが触れない問題修正
	・いつのまにかpc_skillupが古いものに変わっていたので修正
	
	pc.c
		pc_skillup(),pc_checkskill()修正

--------------
//368 by 胡蝶蘭

・MOB系の修正など
	・MOBが策敵範囲内のPC/アイテムを等確率でロックするようになりました
	  （アクティブ、ルート：いままでは該当ブロックのリンクリストの順などに
	    依存していた）
	・射程範囲内かつ、到達不可能地帯のPCをMOBがロックすると、
	  MOBが停止したり、その場で暴れだしたりする問題の修正
	・MOBロック中にIWなどで到達不可能になった場合、ロックを解除するように。
	・AEGIS方式で敵の移動を計算して移動不可能なら、Athena式で計算するように
	・ロックが解除されるときに数秒その場で停止するようにした
	・歩行が遅いMOBがとまらない/次の歩行開始が早すぎる問題を修正しました
	・ルート関連処理を少し修正

	mob.c
		mob_ai_sub_hard*()修正
		mob_can_reach()追加

・スキル使用時にターゲットブロックの有効性判定を行うように修正
・ルアフのダメージが武器計算になっているのバグを魔法計算に修正

	skill.c
		skill_castend_id()修正
		skill_status_change_timer_sub()修正


----------
//364 by いど
・以下のパケットの説明を変更
	doc/パケット解析.txt
		R 006a <error No>.B
		R 0081 <type>.B

・363でビルド時にwarningが出る不具合を修正
	map/guild.h

--------------
//363 by 胡蝶蘭

・ギルドの修正
	・ログインしていないPCを追放するとマップ鯖が落ちるバグ修正
	・メンバー追加直後に追加されたPCがギルド表示に追加されない問題修正
	・同じギルドに同垢別キャラが要るPCが脱退する/追放されると別キャラが
	  脱退してしまう場合があるバグ修正
	・メンバーがいるのに解散しようとするとマップ鯖が落ちるバグ修正
	
	(char/)
	int_guild.c
		guild_calcinfo(),mapif_parse_GuildAddMember()修正
	(map/)
	guild.c
		guild_member_leaved(),guild_member_added()
		guild_recv_info(),guild_break()修正

--------------
//362 by 胡蝶蘭

・ギルド解散実装

	(char/)
	int_guild.c
		解散処理を追加
	(map/)
	guild.c/guild.h
		guild_break(),guild_broken(),guild_broken_sub()など追加
	clif.c/clif.h
		clif_guild_broken(),clif_parse_GuildBreak()追加
	intif.c/intif.h
		intif_parse_GuildBroken()追加

--------------
//361 by いど

・360での@healの変更間違いを訂正
	map/atcommand.c

--------------
//360 by いど

・353の修正を削除
・@healで変更後の値がマイナスにならないように修正

--------------
//359 by いど

・class_equip_db.txtの文字化け修正

--------------
//358 by 胡蝶蘭

・ログイン時のdelete_timerのエラーを出ないようにした
	pc.c
		pc_authok()の修正

・ギルド関係の修正
	・メンバ勧誘時に最大人数の確認を行うように
	・データ通知処理をいくつか修正

	(char/)
	int_guild.c
		色々修正
	(map/)
	clif.c/clif.h
		clif_guild_inviting_refused()をclif_guild_inviteack()に改名
	guild.c/intif.c
		色々修正
	
・@guildlvupコマンド作成。ギルドレベルが調整できます。

	(char/)
	int_guild.c
		色々修正
	(map/)
	atcommand.c
		@guildlvup処理追加

・Makefikeのclean部分を修正
	
	(char/ map/ login/)
	Makefile
		・削除する実行ファイルのパスを ../athena/ から ../ に修正

--------------
//357 by 胡蝶蘭

・pc.cの文字化け修正
	文字化けしたファイルをアップするのも、それを改造するのも禁止しませんか？
	直すの面倒くさすぎます。

	pc.c
		文字化けの修正

・パーティやギルドに勧誘された状態でマップ移動やログアウトすると、
  勧誘を拒否するように修正
 
	pc.c
		pc_setpos()修正
	map.c
		map_quit()修正

・I-Athena自動復旧システム(B-NSJ氏作)をAthena用に改造して添付しました
	プログラムの性質上./toolフォルダではなく./にあります。
	athena.shの変わりにstartで起動するとmap鯖が落ちても10秒程度で復旧します
	プロセスは「map」で調べてますが他のプロセスに反応するときは
	「map-server」などに変えてみてください。

	start
		map鯖自動復旧システムのシェルスクリプト


--------------
//0356 by 死神

・athena.shを使わなくてもYare-launcherを使えるように変更。(自分試してましたが
一応動きました。でも窓の場合login-server.exeがlogin-server.exに登録されてしまい
Yare-launcherがlogin-server.exe続けて実行する問題があります。これはathenaの
問題ではありませんが...)
	comm/makefile以外のmakefile全てを修正。
	athena.sh修正。
	実行ファイルは.,/athena フォルダーじゃなく./ フォルダーに作られます。
・ 新規accountの許容するかどうかをlogin_athena.cnfで決めるように変更。(これは
	YareCVSを参考した物です。)
	login.c
		int mmo_auth() 修正。
	login_athena.cnf
		new_account 追加。
・char.c、login.c、inter.c、map.c、battle.cで一部のstrcmpをstrcmpiに変更。

--------------
//355 by ゆう

・左手装備も考慮した二刀流に修正
　（ダメージ計算のみで見た目等は変更なし）

map.h
	map_session_dataに左手用の変数を追加

battle.h
	battle_get_attack_element2()追加

battle.c
	battle_get_attack_element2()追加
	battle_calc_weapon_attack()に
	　二刀流の処理を追加修正
	　クリティカルよりダブルアタックを先に判定するように修正
	　過剰精錬の追加ダメージを精錬ダメージの次に処理するように修正
	　（これらは独自に調べたもので間違っている可能性あり）

pc.c
	pc_calcstatus()に左手用の変数に値を入れる処理を追加		
	pc_equipitem()の二刀流装備の場所がおかしかったのを修正

--------------
//353 by いど

・Yare-launcherを使うことが出来るようにMakefileとathena.shを変更

--------------
//352 by 胡蝶蘭

・詠唱中にクライアントを終了するとmap鯖が落ちる問題の修正
	skill.c
		skill_castend_id(),skill_castend_pos(),skill_castend_map()修正
	map.c
		map_quit()修正


・データバックアップ用のツール添付
	Perl製なので実行にはPerlが必要です。
	使用方法などはエディタで開いて見てください。
	使い方が良くわからない人は手を出さないほうがいいです。
	データが消えても責任は持ちません

	(tool/)
	backup
		データバックアップ用Perlスクリプト

--------------
//0351 by 死神
skill.c
	skill_use_id()に詠唱反応モンスターの処理を変更。(攻撃状態以外の場合
		詠唱反応を最優先にします。)
mob.c
	mob_ai_sub_hard_castsearch() 詠唱反応モンスターを二重処理して
		いたので削除。
	mob_ai_sub_hard() 詠唱反応モンスターを二重処理しないように変更。
pet.c - 0344に戻しました。(修正は少し分析をしてからにします。)
pet.h - 0344に戻しました。
char.h 
	CHAR_CONF_NAME 追加。
char.c
	do_init() 実行する時ファイル名が入力されていないとCHAR_CONF_NAMEを
		使うように変更。
map.h
	MAP_CONF_NAME 追加。
map.c
	do_init() 実行する時ファイル名が入力されていないとMAP_CONF_NAMEを
		使うように変更。
これでlogin.exe、char.exe、map.exeをathenaフォルダーにコピーした後名前を
login-server.exe、char-server.exe、map-server.exeに変更するとYare-launcherを使う
ことができます。これを使うと鯖が落ちる度に自動的に再実行してくれます。

--------------
//0345 by 死神
・キャスティング探知実装。
	mob.c
		mob_ai_sub_hard_lootsearch() 修正。
		mob_ai_sub_hard() 修正。
		mob_ai_sub_hard_castsearch() 追加。
		mob_target(), mob_ai_sub_hard_activesearch() ボスモンスターを
			mvp経験値によって認識するように変更。
		mob_ai_sub_hard_linksearch() 修正。
		mob_attack() 死んだふり、ハイディングをチェックするように変更。
		mob_readdb() 修正。
・pet.h
	MAX_PET_DBを100に変更。
・pet.c
	read_petdb() 修正。

--------------
//0344 by　過去の人i1
・　ペット腹減り実装およびそのほか色々修正
・　ペット餌やり実装

	pet.c
		pet_calcrate(struct map_session_data *sd);
		ペットの獲得確率計算
		pet_food(struct map_session_data *sd);
		ペット餌やりシステム
		pet_hungry_change( int tid, unsigned int tick, int id,int data );
		ペットが腹を減るロジック
		pet_status_int(struct map_session_data *sd);
		親密度計算
		pet_status_hungry(struct map_session_data *sd);
		満腹度計算
		pet_status_1a3(struct map_session_data *sd);
		パケット1a3設定関数
		pet_initstate(struct map_session_data *sd);
		ペットが初めて生まれたときの初期ステータス設定
	pet.h
		int pet_calcrate(struct map_session_data *sd);
		int pet_food(struct map_session_data *sd);
		int pet_hungry_change( int tid, unsigned int tick, int id,int data );
		int pet_status_int(struct map_session_data *sd);
		int pet_status_hungry(struct map_session_data *sd);
		int pet_status_1a3(struct map_session_data *sd);
		int pet_initstate(struct map_session_data *sd);
		を追加
	clif.c
		clif_pet_emotion(int fd,struct map_session_data *sd)
		餌をあげたときにエモーションを行う
	clif.h
		clif_pet_emotion(int fd,struct map_session_data *sd);

--------------
//0341 by 死神
・ルートモンスター実装。
	map.h
		LOOTITEM_SIZEを20に修正。
		struct mob_dataにint lootitem_count 追加。
	mob.c
		mob_spawn() 少し修正。
		mob_ai_sub_hard_lootsearch() 追加。
		mob_ai_sub_hard() 修正。
		struct delay_item_drop2 追加。
		mob_delay_item_drop2() 追加。
		mob_damage() 修正。
	battle.h
		struct Battle_Configにint monster_loot_type 追加。
	battle.c
		battle_config_read() 修正。
	battle_athena.cnf
		monster_loot_type: 0 追加。(基本的に0になっています。
			0の場合はLOOTITEM_SIZEまでアイテムを食べても
			またアイテムを食べて前のアイテムが消える仕様です。
			1の場合はLOOTITEM_SIZEまでアイテムを食べると
			もうアイテムを食べなくなります。

--------------
//0340 by 死神
・mvpバグ修正。
	mob.c
		mob_damage()でjに変えたはずの物に見落としありましたので
		修正しました。これでmvpアイテムで変な物が出なくなるはずです。
・class_equip_db.txt
	EUC-JISをS-JISに変更。(意味はありませんが他のファイルは
	全部S-JISだったので...単なるミスですが...)

----------
//339 by いど

・338を適用した状態でビルドエラーが発生する不具合を修正

----------
//338 by 過去の人i1

・　pet_db.txtに対応しました。
・　pet_dbをつかったプログラムの書き方に修正しました。
・　ペットの名前を変更する事が出来ます
・　ペットにアクセサリーをつける事が出来ます。
・　現在ペット餌やり進行中

	(map/)
	clif.c/clif.h
	・ pet関連の関数をほぼ修正及び追加いたしました。
	・ clif_parse_EquipItem()内部でペット用装備であるかどうかの判定を行ってます
	・ clif_parse()を修正しました。

	battle.h/battle.c
	・　battle_config.pet_rate変数を増やしました。mobに対する卵の獲得率
	　　を設定する事が可能となります

	pet.c/pet.h
	・ pet_initstate(struct map_session_data *sd);
	　初期のペットステータスを設定する関数です
	・ pet_npcid(struct map_session_data *sd,int egg_name_id);
	　ペットに割り当てられたnpc_idを返します
	・ pet_itemid(struct map_session_data *sd,int mob_id);
	　モンスターIDから卵のIDを割り出します
	・ pet_equip(struct map_session_data *sd,int equip_id);
	　ペットのアクセサリー装備です
	・ pet_unequip(struct map_session_data *sd);
	　ペットのアクセサリー解除です
	・ pet_calcrate(struct map_session_data *sd);
	　卵獲得確率計算を行い1or0を返します。
	・ pet_food(struct map_session_data *sd);
	　ペット餌やり考案です。まだ正常に動作しません。
	・ read_petdb()
	　pet_db.txtを読み込みpet_db[]に値を入れる関数です
	
	・ do_init_pet()
	　map鯖初期化でよびだしpet_db[]を使えるようにする為の
	ペット情報初期化関数です。
	
	map.c/map.h
	・　BL_PET変数を加えました
	・　map鯖初期化の時にdo_init_pet()を呼び出します。
	
	mmo.h
	・　s_pet構造体に変数追加。キャラクターがペットのデータを保持する為のシステム
	　の為今後も変数はそのつど増加する予定

	npc.c
	改善しました。

	(conf/)
	battle_athena.cnfに卵の獲得確率pet_rateを加えました。

----------
//337 by 胡蝶蘭

・ギルドの追加と修正
	・ギルドに経験値を上納すると、上納されるEXPが異常な値になるバグ修正
	・ギルドの敵対関係の追加

	guild.c/guild.h
		guild_payexp()の修正(上納EXP処理)
		guild_opposition()追加
		guild_allianceack(),guild_reqalliance(),
		guild_reply_reqalliance()の修正
	clif.c/clif.h
		clif_guild_oppositionack(),clif_parse_GuildOpposition追加

・ディレイ時間がdexの影響を受けるかどうかをbattle_athena.cnfに書けるように
	
	(conf/)
	battle_athena.conf
		delay_dependon_dex を追加
	(map/)
	skill.c
		skill_delay_fix()の修正
	battle.c/battle.h
		struct Battle_Configにdelay_dependon_dex追加
		battle_config_read()の修正(読み込み処理も変えてます)

--------------
//0336 by 死神
・スキルインデュアを少し修正。
・clif.c
	clif_skill_damage()、clif_skill_damage2() インデュア合わせて修正。
		(ただスキルや魔法になるとモーションが出ないパケットを
		見つけなかったので完全じゃありません。)
	clif_parse_ActionRequest()、clif_parse_UseSkillToId()、clif_parse_UseSkillToPos() 
		スキルディレイの時にメッセージが出るように修正。
・バックステップ実装、オリデオコン研究実装。
・skill.c
	skill_castend_damage_id()にあったスキルバックステップの処理を
		skill_castend_nodamage_id()に移動しました。
	スキルバックステップの処理でclif_skill_damage2()を呼ぶのをclif_fixpos()を
		呼ぶように変更。(これでダメージのモーションが出ずに
		移動できます。)
	バックステップと叫ぶように変更。
	 skill_produce_mix() オリデオコン研究適用。武器レベルが3以上の時に
		スキルレベル*1%がボーナスとして製造確率に付きます。
		エルニウムの確率判定追加。
・skill_db.txt - バックステップのnkを0から1に変更。(スキル番号150の物です。)
・produce_db.txt オリデオコン,エルニウムを追加。(これは本鯖にはない物です。
	よってクライアントには必要なアイテムが表示されません。)
	オリデオコン研究を少し使える物にするために追加しました。
	オリデオコンの場合はオリデオコン原石3つと石炭1つが必要で
	エルニウムはエルニウム原石3つと石炭1つが必要です。
・pc.c 少し修正。
	pc_heal()pc_percentheal() 少しだけ修正。
	pc_gainexp() ギルドにexpを上納する時にexpがマイナスにならないように
		修正。同時に2つ以上のレベルが上がるように変更。
		最大レベル以上にレベルが上がらないように修正。
	pc_checkbaselevelup()、pc_checkjoblevelup() 追加。レベルアップを
		チェックします。
	pc_itemheal() 追加。アイテムを使う時にVITとスキルによってボーナスが
		付く物です。スキルラーニングポーション実装。
・pc.h
	pc_checkbaselevelup(),pc_checkjoblevelup() 追加。
	pc_itemheal() 追加。
・script.c - スクリプトfixhealを除去。itemhealを追加。healがfixhealの機能をする
	ように変更。
	buildin_fixheal() を消しbuildin_heal()を元の物に戻しました。(つまり
		buildin_heal()がbuildin_fixheal()になりました。)
	buildin_itemheal() 追加。アイテムによる回復はこれを呼ぶようにして
		ください。
	buildin_heal()からボーナスの計算を除去。
・item_db.txt、 item_db2.txt - healをitemhealに変更。
・mob.c
	mob_damage() 0335でmvpに少し間違いがありましたので修正しました。
・skill.h
	MAX_SKILL_PRODUCE_DBを64から100に変更。


//0335 by 死神
・char/char2.cの一部にRETCODEが適用されてなかったのでそれを修正。
・char/char2.cのparse_char()でキャラを消す時に問題がありそうな所を修正。
・char/cha2.c,login/ login2.cをchar/cha.c, login/login.cに変更。
・char/makefile,login/makefileを変更。
・makefileとcommon/mmo.hを変更してOSを自動認識してRETCODEを自動に
	適用するように変更。
・common/grfio.cのgrfio_init()を修正。(コードをちょっときれい(？)に
	しただけですが,,,)
・インデュア実装。よってアンティペインメントも実装。
・map/clif.c
	clif_parse_LoadEndAck() 韓国クライアントのパッチに合わせて少し変更。
		(マップが変わる度に武器とシールドが見えなくなるためです。まだ
		日本クラとは関係ありませんが...)
	clif_skillinfoblock() upはいらないと思うので消しました。スキルポイントが
		256、512等の時スキルツリーが正しく表示されないことは
		もうありません。
	clif_guild_skillinfo() 同じようにupを消しました。
	clif_birthpet() pc_delitem() 呼ぶように変更。
	clif_damage() インデュアに対応するように変更。
・map/pc.c
	pc_percentheal() マイナスを入れても動くように変更。少し修正。
	pc_heal() 少し修正。
	natual_heal() 少し修正。
	do_init_pc() natual_healの修正に合わせて変更。
	pc_calcstatus() 弓を装備してないとワシの目が適用されないように変更。
		トラスト実装。
	pc_damage() インデュアに対応するように変更。
・map/pc.h
	pc_checkoverhp(), pc_checkoversp()を追加。
・map/map.h
	MAX_PC_CLASSを+1に。
・map/atcomand.c
	comandをcommandに変更。
	strncmpをstrcmpiに変更。よってコマンドが大文字、小文字を区別する
		必要がなくなりました。
・map/npc.h
	npc_parse_mob()を追加。(意味はありませんが...)
・map/temdb.c
	itemdb_readdb()でclass_equip_db.txtを読むように変更。
・db/class_equip_db.txt を追加。ここで装備するクラスを指定します。ない場合は
	item_db.txtにあるjobを使います。含まれてる物は完全な物ではなく
	使用例程の物です。
・map/skill.c - skill_status_change_start() インデュアの時間を正しく変更。
・map/battle.h
	battle_configのexp_rateをbase_exp_rateに変更。,job_exp_rateを追加。
	battle_get_mexp()を追加。
・map/battle.c
	battle_configのexp_rateをbase_exp_rateに変更。,job_exp_rateを追加。
	battle_get_mexp()を追加。
	battle_calc_magic_attack()を変更。ダーンアンデッドでボスの認識をmvp
		expでするように変更。
・map/mob.c
	mob_readdb() base_exp_rate,job_exp_rateに対応。
	mob_readdb() ボスの認識をmvp経験値でするように変更。
	mob_damage() mvpを取る時の処理を変更。重さが50%を越えると床に
		落ちるように変更と色々。
・conf/battle_athena.cnf
	base_exp_rate、,job_exp_rateを追加。
・0308で忘れた物
	古く青い箱、古いカード帖、古い紫色の箱の使用で得られたアイテムを
	持ってなくなったらアイテムを床に落とすように変更。
	製造はすでに0302で適用。

----------
//334 by C}{RIS

・あぷろだの332.txtをpet_db.txtとして同梱。

・各種テキストファイルのミスを修正
	・attr_fix.txt　属性修正がマイナスに働いて敵が回復する問題を修正。
		＞元の回復仕様に戻したい場合attr_fix.txtをリネームし、attr_fix_old.txtをattr_fix.txtにリネームして下さい。
	・mob_db.txt　モンスターの日本語名を本鯖と統一。
	・cast_db.txt　詠唱時間、ディレイを本鯖と統一。

----------
//333 by 胡蝶蘭

・ギルド機能追加
	・ギルドの同盟と同盟解消

	(char/)
	inter.c/int_guild.c
		パケット長/ギルド処理追加
	(map/)
	clif.c/clif.h
		clif_guild_reqalliance,clif_guild_allianceack,
		clif_guild_delalliance,clif_parse_GuildRequestAlliance,
		lif_parse_GuildReplyAlliance,clif_parse_GuildDelAlliance追加
		（ギルド同盟関係のパケット処理）
	intif.c/intif.h
		ギルド同盟関係のパケット処理追加
	guild.c/guild.h
		ギルド同盟関係の処理追加
	map.h
		struct map_session_dataにguild_alliance,guild_alliance_account追加

・ギルドエンブレムの変更がマップ鯖を再起動しないと有効にならないバグ修正

	guild.c/guild.h
		guild_emblem_changedの修正

----------
//331 by 過去の人i1

・ペットシステム修正(完成度25%)

	・各種捕獲用アイテムをそれぞれ対応する敵に対して使用することで
	　正しく卵が手に入るようになりました。
	・各種捕獲用アイテムを対応しない敵に使用した場合はルーレットが必ず失敗します。
	・ペットが瞬時に表示されるようになりました。
	・ペットを右クリックするとメニューが出るようになりました
	・他色々危険な要素を修正しました。(アイテムの数の減少等のバグを直しました)
	
	(db/)
	item_db.txt
	各種捕獲用アイテムに対応するようpetコマンドを正しく書きました。
	
	(common/)
	mmo.h
		s_pet	ペット構造体にpet_item_idを追加

	(map/)
		clif.c
		clif_birthpet()を修正。正しく卵が減る、正しい卵のIDを取得するよう修正
		これによって、正しくnpc_pet関数が動きます。
		
		clif_spawnnpc()を修正（WBUFPOS(buf,36,nd->bl.x,nd->bl.y)と、数値を26から36へ変更しました)
		これによってペットが瞬時に表示されるようになりました。

		npc.c
		npc_pet()を修正。

		pet.c/pet.h
		ペット関連の細かな関数をこちらにまとめる為、追加しました。
		現在はペットの判定関係をまとめてあります。

		script.c
		特に大きな修正はありません。
----------
//330 by 過去の人i1

・ペットシステム導入(完成度２０％)
	・敵に対して捕獲用アイテムを使用する事が可能となりました。
	　(まだ熟していないリンゴのみ使用可能、敵につかってもポリンの卵が手に入ります。)
	・各種卵に対してペットを表示する事ができます、ただしなぜか一度画面外に
	　でないとペットが表示されません。
	　(恐らくペット表示の際に行っているNPCステータスが正しく入っていない)
	・表示されたペットがパフォーマンスを行います。

	(db/)
	 item_db.txt
		携帯卵孵化機を使用可能に bpetコマンド(携帯卵孵化機使用)
		「まだ熟してないリンゴ」を使用可能に petコマンド(あるmobに対して使用可能にする)
	(common/)
	mmo.h
		s_pet　ペット構造体追加
		mmo_charstatus　ペット構造体宣言変数追加(pet)
	(map/)
		clif.c/clif.h
		
		int clif_catchpet(struct map_session_data *sd,int pet_id);
		void clif_ruletpet(int fd,struct map_session_data *sd);
		int clif_judgepet(struct map_session_data *sd,int target_id);
		int clif_sendegg(struct map_session_data *sd);
		void clif_listpet(int fd,struct map_session_data *sd);
		int clif_birthpet(struct map_session_data *sd,int pet_id);
		void clif_menupet(int fd,struct map_session_data *sd);
		
		以上の関数を追加しペットに関する処理を行っております。
		(ルーレット、卵選択窓、パフォーマンス、そのほか色々)

		npc.c/npc.h
		int npc_pet(struct map_session_data *sd,int name_id);
		ペット表示の為の関数を追加
		(この関数内部でペットの表示処理を行っています。適切に修正してください)

		script.c
		int buildin_catchpet(struct script_state *st);
		int buildin_birthpet(struct script_state *st);
		を追加しました。スクリプトにpet,bpetを追加しました。
----------
//329 by 胡蝶蘭

・ギルド機能追加
	・ギルドへのEXPの上納
	・ギルドレベルアップ
	・ギルドスキルの割り振り

	(db/)
	exp_guild.txt
		ギルドレベルの経験値データベース
	(common/)
	mmo.h
		GBI_*,GMI_*の定義の追加など
	(char/)
	int_guild.c
		EXPやレベルアップ、スキルアップ処理追加など
	inter.c
		パケット長追加
	(map/)
	guild.c/guild.h
		ギルド処理追加
	intif.c/intif.h
		ギルドパケット処理追加
	clif.c
		clif_guild_skillinfo()修正
		clif_guild_skillup()追加
	pc.c
		pc_skillup()でギルドスキルの場合はguild_skillup()を呼ぶように
		pc_gainexp()で上納EXPのためにguild_payexp()を呼ぶように

・ギルド機能修正
	・ギルドメンバーがログインやログアウトすると、
	  ログイン中のギルドメンバーにギルド系パケットが送られなくなる問題修正

	guild.c
		guild_recv_memberinfoshort()の修正

----------
//328 by 胡蝶蘭

・ギルド機能の追加など
	・追放機能仮実装（追放したキャラも再加入可能＆一部情報がダミー）
	・スキルの表示（表示だけです。上げたりは出来ません）

	(common/)
	mmo.h
		struct guild_explusionの変更
	(char/)
	int_guild.c
		追放処理追加
		空ギルドチェックなど追加
	(map/)
	guild.c/guild.h
		ギルドスキル関係のアクセサなど追加
	clif.c
		clif_guild_skillinfo()の修正
		clif_guild_explusionlist()追加

・ターンアンデッドがボス系アンデッドでMISSになるバグ修正
	・ターンアンデッド失敗時のダメージが使われます

	battle.c
		battle_calc_magic_damage()の修正

----------
//327 by いど
・経験値テーブルに１箇所間違いがあったので修正
	db/exp.txt

----------
//326 by いど
・char鯖の新鯖,メンテナンス中のフラグ情報を設定できるようにした
・char鯖の鯖名の長さが16バイトになっていた部分を20バイトに修正

	(login/)
		login2.c
			parse_login()の修正
		login.h
			struct mmo_char_serverの修正
	(char/)
		char2.c
			check_connect_login_server(),do_init()の修正
	(conf/)
		char_athena.cnf
　			・char_maintenanceを1にするとログイン人数の後ろに(点検中)がつく
　			・char_newを1にすると鯖名の前に[新]がつく
	(doc/)
		パケット解析.txt
			・今回の変更に伴う一部修正

----------
//325 by Mind Twist(224&0293)
・敵(NPC)スキルの追加（ツリーに追加のみ）
	db/skill_db.txt
	・ギルドスキル相変わらず不明…この形式じゃないのかな？

----------
//324 by non

・mobのターゲット後移動を修正
・mobの移動速度をDBから反映させるように

	(map/)
	mob.c
		mob_ai_sub_hard()の修正

・斜め判定を修正
	・FW等での斜め範囲を本鯖仕様に

	(map/)
	map.c
		map_calc_dir()の修正

----------
//322 by 胡蝶蘭

・ログイン時に必ずパーティーから除名されるバグ修正
	・0318の「パーティを除名されたのに〜」での修正ミス

	(char/)
	int_party.c
		パーティー競合時のメッセージに改行追加
	(map/)
	party.c
		party_check_member()の修正

・ギルド会話実装＆修正など
	(char/)
	int_guild.c
		ギルド競合時のメッセージに改行追加
	(map/)
	guild.c/guild.c
		guild_send_message(),guild_recv_message()など追加
	intif.c/intif.h
		intif_parse_GuildMessage()など追加
	clif.c/clif.h
		clif_guild_message(),clif_parse_GuildMessage()など追加
		clif_guild_basicinfo()のパケットを0150から01b6に変更

・バックステップがものすごく怪しいけど仮実装
	・使うとダメージを１喰らったように見えます。(実際はダメージ０です)

	skill.c
		skill_castend_damage_id()修正

------------------
//321 by　過去の人i
・弓矢装備効果のみ実装(多々おかしい点は存在するが装備が出来、矢の効果が出る)
	map/clif.c map/clif.h
		clif_itemlist()追加
		持ち物の中で弓矢に割り当てるパケット番号を0x8000とする処理追加

		clif_arrowequip(struct map_session_data *sd,int val); //self
		を追加。この中で弓矢装備パケット処理を行ってます
	map/pc.c
		pc_equipitem()　弓矢装備追加
	
	残された問題点：
	・　矢が減らない
	・　リログすると矢が１になる
	・　装備している矢が表示されない(←多分装備posの設定をしていない為かと)
	・　矢を装備解除できない(他の矢を装備しなおせば装備した矢の効果になります

----------
//320 by いど
・以下のパケットのエラーコードの説明を追加
	doc/パケット解析.txt
		R 006a <error No>.B
		R 0070 <error No>.B
		R 0081 <type>.B

----------
//319 by mk
・NPCとの会話中に装備変更、アイテム、スキルを使用できないようにしました
	map/clif.c
		各所でsd->npc_idをチェックしてます

・一部の被り物でも精錬後に装備箇所がおかしくなるバグを修正
	map/script.c
		buildin_successrefitem のコードを修正

・カードによる追加効果および異常耐性発動処理の修正
	map/skill.c
		インデックス初期値が間違っていると思われるので修正（SC_POISON -> SC_STONE）

・ボウリングバッシュの仮実装、グリムトゥースの使用条件追加
	・ボウリングバッシュを仮実装。吹き飛ばし処理やってるので
	　battle.c のblewcountをコメントアウトしました
	・グリムトゥースの使用条件（ハイディング＆カタール装備）チェック追加
	　こんな感じで他のスキル使用条件も追加してもよいのかな？
	・skill_blown の吹き飛ばし方向をターゲットとの位置が重なっているときは
	　ランダムではなくキャラクターを後ろへ吹き飛ばすように変更しました
	map/skill.c
		skill_castend_damage_id()変更
		skill_check_condition()変更
		skill_blown()変更

・アサシン二刀流処理に関する修正?
	・装備一覧へdrag&drop時に両手が赤くマーキングされるように修正
	　アサシンでは武器装備箇所が両手になるようitem_equippointを変更
	　それに伴いpc.cのpc_equipitemを修正
	・逆手ダメージを表示してみました
	　まともにダメージ計算やってないので攻撃回数の確認だけです
	・カタール追撃と左手攻撃のMISSを無理やり表示
	(map/)
	itemdb.c (itemdb.h、clif.c、pc.c)
		itemdb_equippoint() を変更 （二刀流を考慮）
		引数を(int nameid) -> (struct map_session_data *sd,int nameid)に
		引数変更に伴い宣言(itemdb.h)と呼び出し側(clif.c ,pc.c)も変更
	pc.c
		pc_equipitem(), pc_checkitem()装備チェックを修正
	battle.c
		battle_calc_weapon_attack(),battle_weapon_attack()
		上にも書きましたが左手のダメージ計算は行ってません
		(カード、属性等も未適用)右手と同じダメージ入れて左右修練適用してます
		カタール追撃と左手ダメージをミスさせる方法(パケット?)がわからないので
		計算後のダメージが-1の場合、damage=0を送るようにしています
		もっとよい方法があるのでしたら修正お願いします

・完全回避の計算をLukではなくFlee2で判断するように修正
	map/battle.c
		battle_calc_weapon_attack()
	
	(db)
	item_db.txt、item_db2.txt
		装備品の一部ボーナス効果を追加
	mob_db.txt
		某所でうｐされていたものを少し修正
		まだModeやDropに問題点があるかもしれません

----------
//0318 by 胡蝶蘭

・ある公平分配PTとそのPTに属さないPCが共闘すると鯖が暴走するバグ修正
	
	mob.c
		mob_damage()のEXP分配処理修正

・パーティを除名されたのに所属しているように見えるバグ修正
	・該当キャラがログアウト状態の時に除名され、その後、同垢別キャラが
	  同パーティに所属しなおし、さらに元のキャラでログインすると、
	  除名判定に失敗してパーティに所属したままであるとされてしまう問題修正
	
	party.c
		party_check_member()の修正
	

----------
//0317 by nabe

・「〜さんから取引を要請されました。」が自分の名前になっていたのを修正
	trade.c/clif.c/clif.h
		clif_traderequest()で取引相手のキャラ名を渡すように変更

----------
//0316 by nabe

・両手武器を精錬すると片手装備になるバグを修正
	script.c
		buildin_successrefitem()で、両手武器の場合等に装備箇所チェック

----------
//0315 by 胡蝶蘭

・PCのSPAWNタイミングを変更
	・マップ移動(ログイン)時、ローディング終了後にSPAWNするように。
	・ロード中に攻撃されたりしなくなります。
	・ギルド/パーティ情報読み込み前に名前解決パケットが来る問題も
	  修正されるはずです。
	
	pc.c
		pc_setpos()でmap_addblock,clif_spawnpcの呼び出しを止めた。
	clif.c
		clif_parse_LoadEndAckでmap_addblock,clif_spawnpcを呼ぶように。

・inter鯖パケット処理の重大な問題を修正
	・一度にパケットを送信できなかった場合、無限ループに陥る問題修正

	(char/)
	char2.c
		parse_frommap()修正
	inter.c
		inter_parse_frommap()修正
	(map/)
	chrif.c
		chrif_parse()修正
	intif.c
		intif_parse()修正

・ギルドの機能追加
	・他人のエンブレムが見えるように。
	・ログイン直後の自分のエンブレムが見えるように。
	・脱退できるように。（追放はまだです）
	
	<パケット情報引き続き模集>
	・016c,016d,0163,015cなどの詳細な情報
	・ギルドスキルのIDがわかる人、教えてほしいです。
	  158,205,331あたり調べましたがダメな模様。
	
	(common/)
	mmo.h
		MAX_GUILDを36に。
	(char/)
	int_guild.c
		脱退のパケット変更
	inter.c
		パケット長修正
	(map/)
	clif.c/clif.h
		clif_set0078,clif_set007bの修正
		clif_guild_belonginfoの修正
		clif_guild_skillinfo追加
	guild.c/guild.h
		脱退などの処理追加
	intif.c/intif.h
		脱退などの処理追加など


----------
//0314 by いど

・char鯖とmap鯖の鯖数上限を30に引き上げ
	login/login.h
	char/char.h

・map_athena1.cnfをmap_athena.cnfにリネーム
　それに伴い、athena.shを変更

・パケット解析資料をdoc/に移動

	
----------
//0313 by 胡蝶蘭

・ギルドの機能追加
	・ギルド勧誘/役職内容変更/メンバーの役職変更など
	・guild.txtの書式がまた変わりましたが、前のデータも読み込めるはずです。
	
	<パケット情報引き続き模集>
	・016c,016d,0163,015cなどの詳細な情報
	・自分以外のPCの所属ギルドIDを通知するパケット
	
	(common/)
	mmo.h
		struct guild を変更
	(char/)
	int_guild.c/inter.c
		処理追加/パケット長追加
	(map/)
	guild.c/guild.h/intif.c/intif.h
		処理追加
	clif.c/clif.h
		ギルド関係のパケット処理追加

・help.txtを修正
	help.txt

・0311による文字化けを修正
	README
	map/pc.c

----------
//0312 by いど

・@hコマンドを@helpに変更
・読み込むマップデータの定義部分を変更

----------
//0311 by tk44
・Assassin 二刀流装備、ASPD問題修正
	- map\pc.c
		pc_equipitem(), pc_calcstatus(), pc_checkitem()

・二刀流傷害計算修正まだ処理中

----------
//0310 by 胡蝶蘭

・ログやデータに使う改行コードをmmo.hで設定可能に
	(common/)
	mmo.h
		RETCODEで改行コードを文字列で定義します。
		Windows系だとCR/LFなので"\r\n",UNIX系だと"\n"です。
		別に正しく指定しなくてもAthena自体は問題なく動作するはずです。
	(login/)
	login2.c
	(char/)
	char2.c/int_storage.c/int_party.c/int_guild.c
		保存する改行コードをRETCODE依存に変更。
		改行コードに依存せずに読めるように修正。

・クライアントから不明なパケットが来たらダンプするように
	・#define DUMP_UNKNOWN_PACKET 1 をコメント化すればダンプしません。
	
	clif.c
		不明パケットの処理でダンプ処理を追加。

・ギルド機能の追加
	・エンブレム変更/告知変更実装
	・guild.txtの書式が変わりましたが、前のデータも読み込めるはずです
	
	(char/)
	int_guild.c/inter.c
		ギルドパケット処理、パケット長
	(map/)
	guild.c/guild.h
		機能追加
	intif.c/intif.h
		ギルド関係パケット追加
	clif.c/clif.h
		ギルド関係パケット追加

----------
//0309 by C}{RIS

・ボウリングバッシュを範囲攻撃化しました。
・プロンテラに装備品販売NPCを追加しました。
	map_athena1.cnfの
	npc_shop1J.txtをコメントアウトすれば無効に出来ます。
・アイテムの名前とIDを書いたテキストファイルを添付。（item.list）

----------
//0308 by 死神
・自然回復のプログラムを修正しました。
	これで大丈夫だといいですが...
	pc.c
		pc_natural_heal()等を修正。
		pc_percentheal()を少し修正。
		pc_checkskill()を少し修正。スキルがない場合0を返すように
		変更しました。他の.cファイルも修正する必要がありましたので
		修正しました。
・4人目と5人目のキャラを消せない問題を修正。
・始めからナイフとコットンシャツを持つように変更。
・LOOK_SHEILDをLOOK_SHIELDに修正。
・mmo_charstatusのsheildをshieldに修正。
・.logファイルやaccount.txtファイルをnotepadで開くと列が全部繋いでいる
	問題を修正。
・乱数を時間によって初期化するように変更。
	map.c
		do_init()を少し修正。

他に変更したファイルもありますが全部覚えてませんので...

----------
//0307 by 胡蝶蘭

・新規PCの初期位置をchar_athena.cnfに書けるようにした
	start_point: マップ名,x,y のように指定します。
	<例> start_point: new_1-1.gat,53,111

	(char/)
	char2.c

・ギルドの一部機能
	・ギルド作成くらいしか動きません
	・勧誘/脱退/解散/情報の変更/エンブレム/告知などはすべて未実装です
	
	<切実な要望>
	ギルド関係のパケット情報が全然足りません。わかる人は教えてください。
	現在のままではエンブレムと告知くらいしか実装できない可能性が…。

	(common/)
	mmo.h
		ギルド関係の構造体と定数追加
	(char/)
	inter.c
		パケット長情報追加
	int_guild.c/int_guild.h
		実際の処理追加
	(map/)
	map.h
		struct map_session_dataにギルド関係のメンバ追加
	guild.c/guild.h
		新規追加。ギルド機能用
	pc.c
		pc_authok()でギルド所属時、guild_request_info()を呼ぶように。
	clif.c/clif.h
		ギルドパケット追加
	intif.c/intif.h
		ギルドパケット追加

・0303での修正「MAXHPなどがサーバーとクライアントで〜」を元に戻した
	・新PCを作るときに正しくHPなどを計算してくれるようになったので
	  戻しても平気だろうと予測。
	・ログイン直後に重量警告が出てしまうため。

	pc.c
		pc_authok()の修正

・範囲指定沸きの処理修正
	・できるだけ指定した数と同じだけ沸くように
	  (障害物などによる沸き妨害の回避失敗時、前の回避結果を使う)

	mob.c
		mob_once_spawn_area()の修正

----------
//0305 by いど
・新規PCの位置を初心者修練場に変更。
・map鯖がchar鯖に接続できない不具合の修正。

----------
//0304 by 死神
・自然回復の量と時間を変更。韓国鯖に適用されてる物ですが日本にも
	適用されてるはずです。(多分... やってませんのでわかりません。汗)
	HPは毎4秒に 1 + vit/6 + max_hp/200 を回復、
	SPは毎8秒に 1 + int/6 + max_sp/100 を回復します。
・スキルHP回復力向上による回復を
	スキルレベル*5 + max_hp/50に変更。
・スキルSP回復力向上による回復を
	スキルレベル*3 + max_sp/50に変更。
・スキル移動時HP回復実装。
	今の所止まってるのと比べて1/4の量を回復します。(時間は同じです。)
・vitとintによって回復時間が短くなるのではなく回復量が増えます。
・最大HPと最大SPの計算公式を変更。
	map.h
		int inchealtickの変わりにint inchealhptick;と int inchealsptick;を追加。
		int parame[6] を追加。最大SPの計算の為の物で装備によって上がった
		パラメータを持っつ。
	pc.c
		pc_hpheal(),pc_spheal(),pc_natural_heal_sub(),pc_natural_heal()を
		自分のコードに書き換えましたが一応正常に動きますが
		他のコードに影響がないかどうかはわかりません。
		pc_additem()を少しだけ修正。
		hp_coefficientをintからdoubleに変更。
		pc_calcstatus()とpc_readdb()を修正。
	job_db1.txt
		職業の計数を変更しました。(クルセイダー等のデータは
		完全な物じゃありません。)

・char2.cを少しだけ変更。
	char2.c
		make_new_char()を少しだけ変更。(作った直後にHPとSPが完全に
		回復してるように変えました。)
		parse_char()を少しだけ修正。韓国のクライアントで繋いても
		異常がないようにしました。(0x187パケットの処理を入れただけ
		ですが... これはYareから持ってきた物です。)
・strcmpi等のdefineをatcomand.hからmmo.hに移動しました。
	atcomand.h, mmo.h 修正。
・回復アイテムを使用する時vitとスキルHP回復力向上によるボーナスが付く
	ように変更。ボーナスは
	回復量 *(1 + HP回復力向上スキルレベル*0.1 + vit/100)
	になります。
・イグドラシルの実とイグドラシルの種を仮実装。(回復はしますがエフェクトが
	出ません。item_dbでタイプを変えても駄目でした。)
	script.c
		buildin_fixheal()とbuildin_percentheal()を追加。
		buildin_fixheal()はbuildin_heal()がスキルとvitによって回復量が変わる
		仕様になったので元のbuildin_heal()の名前だけを変えた物です。
		buildin_percentheal()は入力された数字を%としてHPとSPを最大HPと
		最大SPを %比率に回復します。
		スクリプトfixheal 、 percentheal 追加。使用方法はhealと同じです。
		fixhealはvitとスキルHP回復力向上によるボーナスがない物で
		percentheal は後の数字を %に認識します。
	pc.h
	pc.c
		pc_percentheal()を追加。
	item_db.txt、item_db2.txt
		イグドラシルの実とイグドラシルの種を変更。

----------
//0303 by 胡蝶蘭

・*.grfのパスをmap_athena.cnfにも書けるようにした。
	・map_athena.cnfに「data_grf: ../data/data.grf」や
	  「sdata_grf: ../sakurai/sdata.grf」のようにパス指定できます。
	・grf-files.txtがある場合そちらの設定が優先されます

	(common/)
	grfio.c/grfio.h
		grfio_setdatafile(),grfio_setsdatafile()追加。
		data_file,sdata_fileをファイルローカルなグローバル変数に変更。

・@stpoint,@skpointに負値指定の範囲チェックを追加
・@zenyコマンド追加（ゼニーの調整）
・@str,@agi,@vit,@int,@dex,@lukコマンド追加（基本パラメータ調整）

	atcommand.c
		@stpoint,@skpoint修正
		@zeny,@str,@agi,@vit,@int,@dex,@luk追加

・メマーナイトを使うとぼったくられていた問題を修正
・武器製造部分のコードを多少変更
	・材料消費処理をアイテムが複数インデックスに分かれている場合に対応させた
	  （３万個限界を超えると別インデックスを使う仕様だった気がするので）
	・失敗時にも周りに通知するようにした

	skill.c
		skill_check_condition()の修正
		skill_produce_mix()の修正

・武器製造確率をconfファイルで倍率指定できるように修正

	(conf/)
	battle_athena.cnf
		weapon_produce_rate追加
	(map/)
	skill.c
		skill_produce_mix()の修正

・武器ATKサイズ補正テーブルを外部から読み込むようにした
・精錬成功確率/精錬ボーナスなどを外部から読み込むようにした
・過剰精錬ボーナスによる追加ダメージ実装

	(db/)
	size_fix.txt
		サイズ補正テーブル
	refine_db.txt
		精錬関係データ
	(map/)
	pc.c
		pc_readdb()で読み込み
	battle.c
		battle_calc_weapon_attack()に過剰精錬ボーナス処理追加

・MAXHPなどがサーバーとクライアントで違う値に見えるバグ修正
	ログイン直後のステータス計算の結果を直ちに送信するようにした

	(map/)
	pc.c
		pc_authok()でのpc_calcstatus()のフラグを0にした
		これでpc_calcstatus()のフラグパラメータは未使用？

・item_dbの「忍者ス−ツ」を「忍者スーツ」に修正
	(db/)
	item_db.txt/item_db2.txt
		忍者スーツの名称変更

・ログイン人数を調べるツールを添付
	Perl製なので実行にはPerlが必要です。
	使用方法などはエディタで開いて見てください。
	使い方が良くわからない人は手を出さないほうがいいです。

	(tool/)
	getlogincount
		ログイン人数所得Perlスクリプト

----------
//0302 by 死神
・アイテム製造 確率判定実装。
	鉄の場合成功率は
		(20 + base_level*0.3 + DEX*0.2 + LUK*0.1 + 要求スキルレベル*6)%
	鋼鉄と属性石、星のかけらの場合
		(10 + base_level*0.3 + DEX*0.2 + LUK*0.1 + 要求スキルレベル*5)%
	武器は
		((2.5 + base_level*0.15 + DEX*0.1 + LUK*0.05 + 要求スキルレベル*5 +
		金敷 -  属性石と星のかけら) * (1 - (武器レベル - 1)*0.2) +
		スキル武器研究レベル*1)%
			金敷: ない場合 -5%で金敷は 0%、オリデオコンの金敷は
			2.5%、黄金の金敷は 5%、エンペリウムの金敷は 7.5% 
			属性石と星のかけら: 属性石がある場合 5%で更に
			星のかけらの数 * 5%を足します。
	になりますがちょっと確率が低すぎる気もしますので
	base_level*0.3 + DEX*0.2 + LUK*0.1をbase_level*0.5 + DEX*0.4 + LUK*0.3に
	base_level*0.15 + DEX*0.1 + LUK*0.05をbase_level*0.4 + DEX*0.3 + LUK*0.2
	程度に変えた方がいいかも知りません。
	skill.c
		skill_can_produce_mix() と skill_produce_mix() を修正。
	produce_db.txt
		星のかけらをスキル属性石製造が必要に変更。
・*.grf等を設置せずディレクトリからの読み込むように修正。(これはYareから
	持ち込んだ物ですが...)
	grfio.c
		grfio_init()を修正。
	grf-file.txt
		新規追加。grfファイルがあるディレクトリ設定用。
・読み込むマップの最大数を512に修正。
	mmo.h
		MAX_MAP_PER_SERVERを384から512に修正。
・pc.cにpc_search_inventory()を追加。
	機能はitem_idのアイテムを持ってるかどうかを確認して
	持ってる場合そのindexを返す。
	item_idが0の場合は空けてる所のindexを返す。
	pc_additem()とpc_takeitem()だけを少し修正。
・GMコマンドに@stpointと@skpointを追加。
	@stpoint 数字 - ステータスポイントを上げる。
	@skpoint 数字 - スキルポイントを上げる。
	atcomand.c
		修正。
	atcomand.h
		strcmpi等をLinuxでも使えるように修正。

----------
//0301 by 胡蝶蘭

・最大HPが32767を超えると異常な値になる問題の修正
・Lvが99を超えるときもエフェクトを出すようにした(自分には見えない模様)
・配置MOBによるイベントでイベント名が４バイト以上という制限をつけた
・teleport時に取引中断、チャット退室、倉庫保存処理をするようにした

	pc.c
		pc_calcstatus()の修正(HP計算)
		pc_setpos()の修正(取引中断など)
	clif.c
		clif_set0078(),clif_set007b(),clif_spawnpc()の修正(Lv99エフェクト)
	npc.c
		npc_parse_mob()の修正

・@hでhelp.txtが読めないときに落ちるバグ修正
・@lvup/@joblvupで負値を入れるとLvダウンが可能になった

	atcommand.c
		@h,@lvup,@joblvup処理の修正

・テレポートなどの消滅エフェクトの修正

	skill.c
		テレポの消滅エフェクトを変更

・状態異常に関するスクリプト実装 [sc_start]と[sc_end]。
・緑POT、緑ハーブなど実装
・装備ボーナスデータ追加
	
	(db/)
	item_db.txt/item_db2.txt
		装備ボーナスデータを追加
		緑POT、緑ハーブなどのスクリプト追加
	(map/)
	script.c
		buildin_warp()で消滅エフェクトを変更
		buildin_sc_start(),buildin_sc_end()追加

----------
//0299 by 胡蝶蘭

・NPCイベントでエクスポートされたラベルを指定できるようにした
	NPCスクリプトでOn〜で始まるラベルを定義すると、エクスポートします。
	NPCイベントで"NPC名(orイベント名)::ラベル名"とすると、
	指定したラベルから実行できます。
	ラベル名は24バイト以内にして下さい。
	あとプログラム的にメモリ効率悪いです。後日修正予定
	<例>
		NPC「test」のスクリプト内で OnEvent: とラベル定義した場合、
		NPCイベント「test::OnEvent」で指定位置から実行できます。

	(conf/)
	npc_test_ev.txt
		ラベル指定のサンプルもちょこっと追加
	(map/)
	script.c/script.h
		script_get_label_db()などの追加。
		parse_scriptでscriptlabel_dbにラベルデータを追加する
	npc.c/npc.h
		npc_event_export()など追加
		npc_parse_scriptでラベルデータをエクスポートする
	map.h
		struct map_session_data のeventqueueのイベント名のサイズを
		50バイトにした。

・AGIとDEXによるASPD計算の最大値を180から190に変更
	pc.c
		pc_calcstatus()のASPD計算修正

・skill_db.txt/cast_db.txtの読み込みをskill.cに変更

	pc.c
		pc_readdb()の修正
	skill.c
		skill_readdb()の追加

・アイテム製造仮実装
	確率判定が未実装です。必ず成功します。
	
	(db/)
	item_db.txt/item_db2.txt
		アイテム製造に対応（携帯用溶鉱炉、金槌など）
	produce_db.txt
		新規追加。製造リスト。
	(map/)
	skill.c/skill.h
		struct skill_produce_db追加
		skill_readdb()でproduce_db.txtを読むように
	clif.c/clif.h
		clif_skill_produce_mix_list(),clif_parse_ProduceMix()追加
	script.c/script.h
		製造用コマンド[produce]作成。
		引数は製造用数値で、1-4が武器製造(Lv)、16が鉱石


----------
//0298 by 胡蝶蘭

・Login鯖のパスワード暗号化タイプを自動認識できるように変更
	login.hのPASSWORDENCを3にすると自動認識します。
	最初にpasswordencryptでチェックし、失敗すれば
	passwordencrypt2でチェックします。

	(login/)
	login2.c/login.h
		暗号化パスワードの照合部分を修正

・アカウント作成ツールを添付
	Perl製なので実行にはPerlが必要です。
	使用方法などはエディタで開いて見てください。
	使い方が良くわからない人は手を出さないほうがいいです。

	(tool/)
	addaccount
		アカウント作成ツールPerlスクリプト

・スキルの追加修正
	・ファイヤーウォールの回数制限をグループ毎からユニット毎に修正
	・クァグマイア仮実装 （敵の移動速度、キャラの表示数値は変化せず）
	・ウォーターボール仮実装（動作が正しいのか不明）
	・フロストノヴァ仮実装（エフェクトが良くわからないので適当）
	・ベノムダスト仮実装（範囲とかが正しいかどうか不安）
	・プロボック、オートバーサーク、聖体降福、砂まき、石投げの実装
	・エンチャントポイズンの毒付与実装
	
	*注意* 毒状態は見た目だけで効果は未実装
	
	(db/)
	skill_db.txt
		砂まき/石投げ/ウォーターボールなど修正
	(map/)
	skill.c/skill.h
		色々修正
	mob.c/mob.h
		mob_target()追加。MOBのタゲ用
	battle.c
		battle_get_*()系修正など
	pc.c
		pc_calcstatus()修正

----------
//0297 by 胡蝶蘭

・Login鯖がパスワード暗号化に対応
	暗号化keyは鯖起動時に一度だけ作成します。
	
	**注意**
	暗号化パスワードを使っている場合は、アカウントを作成できません。
	アカウントを作る場合はclientinfo.xmlを編集するなどして、
	パスワードを暗号化しないクライアントを使う必要があります。
	
	(login/)
	login2.c/login.h
		暗号化パスワードのパケット処理追加
		暗号化keyの生成処理追加
	md5calc.c/md5calc.h
		新規追加。md5計算用


・スキル使用ディレイにDEXが反映されないように修正
	skill.c
		skill_delay_fix()の修正

・死亡後も一部の状態異常の効果が持続する問題を修正
	pc.c
		pc_damage()で死亡時にpc_calcstatus()を呼ぶように修正
	atcommand.c
		死亡時処理を一本化するため@dieではpc_damageを呼ぶように修正


----------
//0295 by 胡蝶蘭

・クレイモアートラップなどにスキルを使うとマップ鯖が落ちる問題の修正

	battle.c
		battle_get_*()などでBL_PC,BL_MOBじゃないときの処理を追加
	skill.c/skill.h
		skill_unit_ondamage()追加

・約21Mzを超えるアイテムをNPCで扱うときOC,DC計算で値段がおかしくなるバグ修正
	DCでは20Mz、OCでは70Mzを超えるアイテムはdouble型にして計算します

	pc.c
		pc_modifysellvalue(),pc_modifysellvalue()の修正

----------
//0294 by 胡蝶蘭

・スクリプトコマンドでエリア指定のMOB沸き命令を作成
	areamonster "マップ名",x0,y0,x1,y1,"MOB表示名",MOBのclass,数,"イベント名"
	座標指定が(x0,y0)-(x1,y1)の任意ポイントになるだけで他はmonster命令と同じです

	script.c
		buildin_areamonster()追加
	mob.c/mob.h
		mob_once_spawn_area()追加

・アイスウォールの鯖側処理仮実装
	攻撃できないなどの問題はあるものの、鯖側ではとりあえず動きます。
	ただ、クライアントに進入不可能エリアを教えるパケットがわからないので、
	鯖側ではIWの回り込みを行う場合でも、クライアント側ではすり抜けている
	ように見えます。

	skill.c
		該当処理追加など

----------
//0293
・2-2次職のスキルコメントの修正（一部追加）
	(db/)
	skill_db.txt
	skill_tree.txt


----------
//0292 by 胡蝶蘭

・SHOP NPCに話し掛けるとNPCが反応しなくなる問題のまともな？修正Part2
	・売買できなかった問題修正
	
	map.h
		struct map_session_data にnpc_shopidメンバ追加
	npc.c
		npc_click()など修正

・スクリプト命令追加
	・指定エリアのユーザー数の所得
	  getareausers("マップ名",x0,y0,x1,y1)
	  指定マップの(x0,y0)-(x1,y1)にいるPCの数を計算
	・指定エリアのユーザーのワープ
	  areawarp "転送元マップ名",x0,y0,x1,y1,"転送先マップ名",x,y;
	  指定マップの(x0,y0)-(x1,y1)にいる全PCを指定マップの(x,y)に転送。
	
	script.c
		buildin_areawarp(),buildin_getareausers()追加

・スキル修正
	・テレポート使用時に「テレポート!!」と叫ぶように。
	・ストーンカースの成功率が低いのを修正
	
	skill.c
		skill_castend_nodamage_id()修正

----------
//0291 by 胡蝶蘭

・スクリプト命令追加
	・NPCの有効無効が切り替えられるようになりました
	  disablenpc "NPC名"で無効化、enablenpc "NPC名"で有効化。
	  NPC名が重複しているときの動作は不定です。
	  主にワープポイントを無効化するときに使います。
	
	・タイマーのカウントを変更するスクリプト命令追加
	  addtimercount "イベント名",ミリ秒
	  で、タイマの期限を延ばせます（負値を指定して減らすことも出来ます）

	・アナウンスの拡張
	  mapannounce "マップ名","アナウンス文字列",フラグ
	  で指定マップにアナウンスを流します。フラグは0で黄色、16で青です。
	  areaannounce "マップ",x0,y0,x1,y1,"文字列",フラグ
	  で指定マップの(x0,y0)-(x1,y1)のエリアにアナウンスを流します。
	  フラグはmapannounceと同じで、0で黄色、0x10で青です。
	
	(conf/)
	npc_test_arena.txt
		サンプルの修正
	(map/)
	script.c
		buildin_disablenpc(),buildin_enablenpc(),
		buildin_mapannounce(),buildin_areaannounce(),
		buildin_addtimercount()の追加
	npc.c/npc.h
		NPCの有効無効処理追加
	map.h
		struct npc_dataにflagメンバ追加(1ビット目が無効フラグ)
	clif.c
		clif_getareachar_npc()の修正
	pc.c/pc.h
		pc_addeventtimercount()追加

・SHOP NPCに話し掛けるとNPCが反応しなくなる問題のまともな？修正
	SHOP NPCと取引中でもイベントが起こるようになります。
	これはROの仕様上避けるのが難しいためこのような結果で落ち着きました。
	
	npc.c
		npc_click()等の修正

・スキッドトラップで残像が残る問題修正
	skill.c
		skill_blown()でclif_walkok()などを呼ぶように。
		skill_unit_onplace()のclif_fix*pos()を削除。

----------
//0290 by 胡蝶蘭

・スクリプトでMAP鯖内共有変数が使えるようになりました。
	変数名を$で開始すると、MAP鯖内の全員で共有する変数になります。

	言葉の問題ですが、PCのglobalregは「大域的」というより「永続性のある」
	変数であって、MAP鯖内共有変数のほうが大域的ってイメージが強いんですが…

	script.c
		mapval_db定義
		buildin_set(),buildin_input()の修正
		do_init_script()追加
	map.c
		do_init()でdo_init_script()を呼ぶように。

・イベントキューが実装されました
	・キューサイズは２です。必要なら増やしますが。

	サンプルの[ev_doテスト]がちゃんと動くようになったと思います。

	map.h
		struct map_session_dataにeventqueueメンバ追加
	npc.c
		npc_event_timer()追加
	script.c
		run_script()でEND処理でキューの処理追加

・スクリプトでタイマーが使用できるようになりました
	使用方法は、addtimer ミリ秒,"イベント名" でタイマー追加、
	deltimer "イベント名" でタイマー削除。

	(common/)
	timer.c/timer.h
		get_timer(),addtick_timer()追加
	(map/)
	map.c/map.h
		struct map_session_dataにeventtimerメンバ追加
		map_quit()でpc_cleareventtimer()を呼ぶように。
	pc.c
		pc_addeventtimer(),pc_deleventtimer(),pc_eventtimer(),
		pc_cleaereventtimer()追加
		pc_authok()でeventimerの初期化
	script.c
		buildin_addtimer(),buildin_deltimer()追加

・スクリプトの追加
	・getusers,getmapusers,killmonsterの追加
	  getusers(x)はユーザー数所得、x=0でPCのMAP,1=全MAP,8=NPCのMAP。
	  getmapusers("マップ名")は指定マップのユーザー数を所得する。
	  killmonster "マップ名","イベント名"で該当のマップにいる、
	  該当のイベント駆動指定モンスターを全て削除。
	・announceコマンド拡張
	  フラグの0x08ビットが1ならマップやエリア計算にPCでなくNPCを使う

	mob.c/mob.h
		mob_delete()追加
	script.c
		buildin_getusers(),buildin_getmapusers(),
		buildin_killmonster()追加
	clif.c/clif.h
		clif_GMmessage()の引数変更

・イベントサンプル追加
	簡単なアリーナのサンプルを追加。

	(conf/)
	npc_test_ev.txt
		従来のサンプルの修正
	npc_test_arena.txt
		簡単なアリーナのサンプル
		ワープポイントの無効化コマンドなどが必要と思われる。

・SHOP NPCに話し掛けるとNPCが反応しなくなる問題修正
	
	npc.c
		npc_buylist(),npc_selllist()修正

----------
//0289 by 胡蝶蘭

・イベント駆動型スクリプトの修正など
	・他のNPCに話し掛けているときはイベントが無視されるようになりました
	  =>キューに入れるなどの処理がいると思われる。

	この関係で、サンプルの[ev_doテスト]NPCをクリックしても
	IDエラーが出て何も起きません。イベントキューを作れば直るはず。

	npc.c
		npc_event(),npc_click()にnpc_idチェックを追加
	script.c
		終了時にnpc_idをクリアするように

・スクリプトコマンド[announce]の追加
	・GMメッセージによるannounce。
	  第1引数は文字列、第2引数はフラグで、
	  フラグの下位４ビットが0=全て、1=同じマップ、
	  2=画面内、3=自分のみ、4=同じマップ鯖に送信。
	  フラグの４ビット目は色フラグで、0x10=青、0x00=黄色

	script.c
		buildin_announce()の追加
	clif.c
		clif_send()でSELFの処理追加
		clif_GMmessage()の引数変更
	intif.c
		intif_GMmessage()の引数変更

・メモ禁止、テレポ禁止、セーブ禁止マップが指定できるようになりました。
	・NPCで、mapflagというタイプで、名前を nomemo 、 noteleportで
	  メモとテレポ禁止。nosave で、引数にセーブするマップ名と座標を指定。
	  
	詳しくは同梱のconf/npc_test_ev.txtを参照。

	(conf/)
	npc_test_ev.txt
		修正
	(map/)
	map.h
		struct map_data にflag,savemap,savex,saveyメンバ追加
	npc.c
		npc_parse_mapflag()追加
		do_init_npc()の修正
	pc.c
		pc_memo()でメモ禁止かどうかを確認
		pc_makesavestatus()でセーブ禁止ならマップを変更
		pc_randomwarp()でテレポ禁止かどうか確認
	skill.c
		テレポとポタでテレポ禁止か確認


・ファイヤーウォールで落ちる問題修正…だといいな
	
	skill.c
		さらにチェックを追加
		skill_blown()に落ちる原因っぽいもの発見したので修正

----------
//0288 by 胡蝶蘭

・自動鷹発動時に「ブリッツビート!!」と叫ばなくなりました
	skill.c
		skill_attack(),skill_additional_effect(),
		skill_castend_damage_id()の修正

・イベント駆動型スクリプトが記述できるようになりました
・モンスターを倒したときにイベントスクリプトを動かせるようになりました

	NPC定義のscriptで表示クラスを-1にするとイベント扱いになります。
	NPC定義のmonsterにイベント名を設定できます。
	スクリプトのmonsterコマンドにイベントを起こす引数追加。
	詳しくはサンプルを見てください。
	今後タイマーでイベントを起こせるようにしようと思っています。

	現状では、NPCウィンドウ操作中にイベントがおきて、
	そのイベントのスクリプトでNPCウィンドウを出すと問題が起きます。
	この辺は今後の課題ということで。

	(db/)
	item_db.txt/item_db2.txt
		monsterコマンドの変更による修正（古木の枝）。
	(conf/)
	npc_test_ev.txt
		サンプル
	(map/)
	npc.c
		npc_event()追加
		npc_parse_script()修正
		npc_checknear()修正
	clif.c
		clif_getareachar_npc()修正
	map.h
		struct mob_dataにnpc_eventメンバ追加
	mob.c/mob.h
		mob_once_spawn()の引数変更
		mob_damage()で死亡時にイベントを起こすように
	atcommand.h
		mob_once_spawn()の引数変更
	script.c
		buildin_monster()の修正

----------
//0287 by 胡蝶蘭

・モンスター情報スキルでＨＰが65535を越えていると正常な値が見れないバグ修正

	clif.c
		clif_skill_estimation()の修正

・古木の枝アイテムでクライアントがリソースエラーを出す問題が修正されました
・古木の枝アイテムで召喚できる敵が指定できるようになりました

	(db/)
	mob_branch.txt
		召喚可能な敵のリスト
	(map/)
	mob.c/mob.h
		struct mob_dataにsummonflagメンバ追加。召喚可能性。
		mob_once_spawn()の修正
		mob_readbranch()の追加
		do_init_mob()でmob_readbranch()を呼ぶように。

・古く青い箱、古い紫色の箱が実装されました。
	一部の未実装アイテムも出ます。item_db.txtにあるデータを検索しています。
	スクリプトgetitemで負の値を指定すると、その絶対値をフラグとして
	ランダムにアイテムを選択します。

	(db/)
	item_db.txt/item_db2.txt
		該当部分のスクリプト修正
	(map/)
	script.c
		buildin_getitem()の修正
	itemdb.c/itemdb.h
		itemdb_searchrandomid(),itemdb_searchrandomid_sub()追加

・詠唱データの一部修正
	(db/)
	cast_db.txt
		速度上昇などの修正

・NPCの向き修正など
	(conf/)
	npc_*.txt

----------
//0286 by 胡蝶蘭

・モンスター情報スキルでクライアントが落ちるバグ修正
	clif.c
		clif_skill_estimation()の修正

・詠唱反応モンスターが反応しないことがある問題を修正
	skill.c
		skill_use_id(),詠唱反応時、最低追跡距離を13に設定するように。

・スクリプトコマンド[warp]でセーブポイント移動やランダム移動が可能になりました
・ハエの羽、蝶の羽アイテムが実装されました
	スクリプトwarpでマップ名に"SavePoint"や"Random"が指定できます。

	(db/)
	item_db.txt/item_db2.txt
		ハエの羽、蝶の羽のスクリプト修正
	script.c
		buildin_warp()の修正

・@monsterコマンドによるMOBが復活しないようになりました
・スクリプトコマンド[monster]でMOBを発生させることができるようになりました
・古木の枝アイテムが実装されました

	スクリプト引数は monster マップ名,x,y,MOB名,MOBのID,数 です。
	マップ名が"this"の場合、スクリプトを実行したプレイヤーのいるマップ、
	x,yが-1ならプレイヤーの座標（どちらか一方のみそろえることも可能）、
	MOB名が"--en--"の場合、本来の英語名になり、"--ja--"の場合、
	本来の日本語名になります。MOBのIDが-1の場合、適当なIDになります。

	(db/)
	item_db.txt/item_db2.txt
		古木の枝のスクリプト修正
	(map/)
	mob.c/mob.h
		mob_once_spawn()追加
		mob_setdelayspwan()で復活禁止処理追加。
	npc.c/npc.h
		npc_get_new_npc_id()追加
	script.c
		buildin_monster()追加
	atcommand.c
		@monsterの修正

・@itemコマンドの修正（装備品などの問題）

	atcommand.c
		@itemの修正

----------
//0284 by 胡蝶蘭

・障害物があると遠距離攻撃ができなくなりました
・対地スキルが障害物上に使用できなくなりました

	path.c
		path_search(),can_move()の修正、can_place()の追加
	battle.c/battle.h
		battle_check_range()追加、射程と障害物判定。
		battle_weapon_attack()でbattle_check_range()を呼ぶ。
	skill.c
		skill_use_id()、skill_use_pos()でbattle_check_range()を呼ぶ。
	mob.c
		mob_ai_sub_hard()の処理を修正

・詠唱反応/リンクモンスターが実装されました
	skill.c
		skill_use_id()に詠唱反応モンスの処理追加
	mob.c
		mob_ai_sub_hard_linksearch()の追加
		mob_ai_sub_hard()にリンク処理を修正

----------
//0283 by れあ
・リザレクションの修正
	0282で生きてるＰＣにリザがかけれるのに、
	死んでるＰＣにはリザがかからなくなって
	いたのを修正しました。

----------
//0282 by 胡蝶蘭

・スキルの修正と追加実装
	・キリエエレイソンのエフェクトの問題修正。
	・リザレクションが生きているPCには掛けられないようになりました
	・ターンアンデッド/攻撃リザレクションがBOSSには効かないようになりました
	・ファイヤーウォールのヒット数制限を実装
	・ストームガストの実装
	  ただし、本鯖と違い凍結は確率のみで、最大ヒット数などが変です。
	
	skill.c
		skill_castend_nodamage_id()の修正
		ストームガストの処理追加

・スキルユニット処理に意地になって安全性チェックを追加。
	（落ちなくなる日は遠い？？）

	map.h
		MAX_SKILLUNITGROUPを32に増やした
	skill.c
		skill_status_change_*()にNULLチェック追加
	battle.c
		battle_calc_damage()に生存チェック追加
	map.c
		map_freeblock_unlock()にロック数チェックを追加

・その他修正
	・PCの最大HPが30000に制限されました。
	・PCの回復処理が修正されました
	・吹き飛ばし処理の修正
	・0281のitem_db.txtの変更をitem_db2.txtにも適用
	
	(map/)
	pc.c
		pc_heal(),pc_calcstatus()の修正
	path.c
		path_blownpos()の修正
	(db/)
	item_db2.txt
		0281の名前修正などを適用

----------
//0280 by 胡蝶蘭

・管理者のシステムを作成
	"conf/login_athena.cnf"の作成、管理者パス、GMパスの設定。
	アカウントを作るとき、
	＜例＞	ID: hoge_M	Pass: foobar@admin
	のように、パスワードの後ろに「@管理者パス」が必要に。
	login_athena.cnfのadmin_passの欄を消せば、今までのようにもつかえます。
	（その場合、admin_passの後ろだけでなく、行ごと消してください）
	
	(login/)
	login.h
		設定ファイルのデフォルト名追加
	login2.c
		アカウント作成のところを修正
		設定ファイルの読み込み追加

・@GMコマンド復活
	ただし、「@gm GMパス」として使います。
	GMパスはlogin_athena.cnfのものです。
	鯖の再起動の必要はありませんが、
	クライアントはリログする必要があります。
	
	＜注意＞
	同じアカウントの全てのキャラはPTから抜けて置いてください。
	また、倉庫のアイテムは全部引き出して置いてください。
	そうしないとゴミデータが残ります。

	(login/)
	login2.c
		アカウントID変更処理追加
	(char/)
	char2.c
		アカウントID変更処理追加
	(map/)
	chrif.c/chrif.h
		chrif_changegm(),chrif_changedgm()追加

・@pvpoffコマンド復活
	clif.c/clif.h
		clif_pvpoff()追加
	atcommand.c
		@pvpoffの処理追加

・空の倉庫データは保存されないように変更
	(char/)
	int_storage.c
		inter_storage_save()、storage_tostr()を修正

・@memoコマンド追加。
	任意の記憶域にメモを取れるようになりました。
	
	atcommand.c
		@memoの処理追加
	

----------
//0279 by 胡蝶蘭

・スキルユニット処理の問題対策
	とりあえずひたすらチェックを入れました。
	
	skill.c
		skill_unit_timer_sub(),skill_unit_move_sub(),
		skill_delunit()にユニットの生存判定を追加。
		skill_unitgrouptickset_search(),skill_unitgrouptickset_delete()
		skill_delunitgroup()にNULLポインタチェックを追加。

・スキルの追加実装と修正
	テレポート、ワープポータルの実装
	キリエエレイソンをMOBに掛けると落ちるバグ修正

	(db/)
	cast_db.txt
		ワープポータルの詠唱時間設定
	(map/)
	map.h
		struct skill_unit_groupのvalstrをポインタに変更
	clif.c/clif.h
		clif_parse_UseSkillMap(),clif_skill_warppoint()、
		clif_parse_Memo(),clif_skill_memo()追加
	skill.c/skill.h
		skill_castend_map(),skill_unit_onlimit()の追加
		skill_unit_*系の処理いろいろ追加。
		skill_status_change_start()のキリエの処理修正
	pc.c/pc.h
		pc_randomwarp(),pc_memo()追加

----------
//0278 by nabe

・スキルポイントを振ったときにステータスを更新
	pc.c
		pc_skillup()でpc_calc_skilltree()の代わりにpc_calcstatus()
・所持量増加を修正
	pc.c
		pc_calcstatus()の所持量増加によるmax_weight増分をskill*1000に

----------
//0277 by nabe

・付属品（カート、鷹、ペコ）の付け外しを改良
	(conf/)
	npc_event_rental.txt
		鷹、ペコを付けるスクリプトコマンドを変更
	(map/)
	battle.c
		battle_addmastery(),battle_calc_weapon_attack()で
		ペコペコ騎乗時の槍攻撃力補正を実装
	clif.c
		clif_parse_CartOffをclif_parse_RemoveOptionに変更
	pc.c/pc.h
		pc_calcstatus()でカート、ペコペコ乗りによる速度変化を計算
		pc_setoption(),pc_setcart()改良
		pc_setfalcon(),pc_setriding()追加
		pc.hにpc_isfalcon(),pc_isriding()マクロ追加
	script.c
		buildin_setfalcon()	鷹付加
		buildin_setriding()	ペコペコ乗り

----------
//0276 by nabe

・精錬NPC実装
	(conf/)
	npc_town_refine.txt
		精錬NPCスクリプトファイル新規追加
	(map/)
	pc.c/pc.h
		精錬成功率の表percentrefinery[5][10]を追加
		script.cから呼ばれる関数
			pc_percentrefinery()	精錬成功率
			pc_equipitemindex()	装備品インデックス
		を追加
	script.c
		buildin_getequipname()	装備名文字列（精錬メニュー用）
		buildin_getequipisequiped()	装備チェック
		buildin_getequipisenableref()	装備品精錬可能チェック
		buildin_getequipisidentify()	装備品鑑定チェック
		buildin_getequiprefinerycnt()	装備品精錬度
		buildin_getequipweaponlv()	装備品武器LV
		buildin_getequippercentrefinery()	装備品精錬成功率
		buildin_successrefitem()	精錬成功
		buildin_failedrefitem()	精錬失敗
		を追加

・スクリプトにWeight,MaxWeightパラメータを追加
	const.txt
		Weight,MaxWeightを追加

・スクリプトでのキャラ名表示方式を変更
	(conf/)
	npc_job_merchant.txt/npc_job_thief.txt/npc_town_kafra.txt
		mes "$charaname"; を mes strcharinfo(0); に変更
	(map/)
	script.c
		buildin_strcharinfo()を追加

----------
//0275 by 胡蝶蘭

・MVPの実装
	MVPの判定にはdmglogを使ってます。すなわち与ダメだけが計算対象です。
	被ダメは考慮されてません。
	経験値は無条件で入り、確率でさらにアイテムが入ります。
	アイテムは複数手に入ることもあります。

	clif.c/clif.h
		clif_mvp_effect(),clif_mvp_item(),clif_mvp_exp()追加
	mob.c
		mob_damage()にMVP処理追加

・スキルの追加実装と修正
	・マグナムブレイク、アローシャワー実装
	・吹き飛ばし系スキルが一部使用されないバグ修正
	・ダブルストレイフィングのダメージ計算式修正
	・武器攻撃系属性付きスキルで属性が反映されない問題修正
	・場所指定スキルが攻撃しながら詠唱できた問題を修正

	battle.c
		battle_calc_weapon_attack()の該当個所修正＆追加
	skill.c
		skill_castend_damage_id()に処理追加
		skill_use_pos()に攻撃停止処理追加

・カードスキルがカードを外しても使用可能な問題を修正
	pc.c
		pc_calc_skilltree()を修正

・アイテムドロップ率、exp所得倍率などの調整機能追加
	battle_athena.cnfで調整できる項目が増えました。
	詳しくはそちらを参照してください。
	
	(conf/)
	battle_athena.cnf
		mvp_hp_rate,item_rate,exp_rate,mvp_item_rate,mvp_exp_rate追加
	(map/)
	battle.c/battle.h
		増えた項目を読み込むように処理追加
	mob.c
		mob_db.txt読み込み時、データを調整する処理追加

----------
//0274 by 胡蝶蘭

・スキルの追加実装
	スキッドトラップ、ランドマイン、ブラストマイン、クレイモアートラップ、
	フリージングトラップ、サンドマン、アンクルスネア
	
	睡眠や凍結などの確率は適当です。
	罠発動時のエフェクトが出ません。ていうか出し方がわかりません。
	わかる人は教えてください。もしくは本鯖で罠発動時の複合化済みの
	生パケットデータでもいいので教えてください。
	
	(db/)
	skill_db.txt
		属性の修正
	(map/)
	skill.c
		該当個所
	battle.c/battle.h
		battle_calc_misc_damage()の該当個所
		battle_stopwalking()追加
	clif.c/clif.h
		clif_fixpcpos()追加
		clif_parse_WalkToXY()にアンクルで動けなくする処理追加
	mob.c
		mob_ai_sub_hard()にアンクルで動けなくする処理追加

・装備などのクリティカルボーナスが1/10になっているバグが修正されました
	battle.c
		battle_calc_weapon_attack()に追加分を計算する処理修正

・ブリッツビートの計算式が全然違うバグが修正されました
	battle.c
		battle_calc_attack()のBF_MISCの処置が間違っていたのを修正

・SWとニューマが武器攻撃ならどんなレンジの攻撃でも防いでいた問題を修正
	battle.c
		battle_calc_damage()のレンジ判定を修正

・オーバートラストとウェポンパーフェクションがPTメンバにもかかるように修正。
	効果は使用者とPTメンバで違いはありません。

	skill.c
		skill_castend_nodamage_id()の修正。

----------
//0273 by 胡蝶蘭

・キャラクターが消失したり幻影が出る問題が修正されました
	・吹き飛ばしスキルを受けると発生していた
	・斜め以外の歩行で発生していた

	map.c
		map_foreachinmovearea()の修正。
	skill.c
		skill_blown()に表示範囲更新処理を追加。
	mob.c
		mob_walk()で歩き終わったときに位置を再送信するように修正
	pc.c
		pc_walk()で歩き終わったときに位置を再送信するように修正

・スキルの追加実装と修正
	ファイヤーウォール、ファイヤーピラーの実装
	サンクチュアリでのノックバック方向を修正

	(db/)
	skill_db.txt
		ファイヤーピラー、ブリッツビートのヒット数修正
	(map/)
	skill.c
		skill_blown()に対象の向きによるノックバック処理追加
		その他必要な場所修正
	mob.c
		mob_walk(),mob_attack()で向きを保存
	pc.c
		pc_walk(),pc_attck()で向きを保存
	map.c
		map_calc_dir()追加。相対的な方向を求める


・クリティカル増加装備が戦闘時に計算されてないバグが修正されました
	battle.c
		battle_calc_weapon_attack()に追加分を計算する処理追加


・防御ユニット（SW/ニューマ）が敵に影響を及ぼすかどうかを
  battle_athena.cnfで制御できるようになりました
  	デフォルトは「及ぼさない」です。
  
	(conf/)
	battle_athena.cnf
		項目defunit_not_enemyを追加
	(map/)
	battle.c/battle.h
		struct Battle_Config に defnotenemyメンバ追加。
		battle_read_config()の処理を修正。
	skill.c
		skill_unitsetting()でSW/ニューマの処理を修正

・フェンカード装備時、死んでも詠唱が続くバグを修正
	（詠唱終了前に復活すれば魔法が発動する問題も修正になります）

	pc.c
		pc_damage()で死亡時skill_castcancel()を呼ぶように修正

・敵味方判定処理にバグがあったのを修正
	battle.c
		battle_check_target()の修正

----------
//0272 by 胡蝶蘭

・スキルの追加実装と修正
	・セイフティウォール、ニューマが実装されました。
	・ロードオブバーミリオン発動中に効果範囲外から範囲内に入ってきたとき、
	  敵味方の区別無く攻撃が当たる問題が修正されました。
	・サンクチュアリの射程が修正されました。
	・範囲魔法で倒した敵がHP0で残る場合がある問題が修正されました。

	(db/)
	skill_db.txt
		セイフティウォールとサンクチュアリの射程を8に変更
	(map/)
	skill.c
		skill_unit_onplace(),~ondelete(),~onout()などに、
		セイフティウォールとニューマの処理追加。
		skill_unit_move()にターゲットの敵味方判定を追加。
		skill_unit_timer_onplace(),~ondelete()にユニット生存判定を追加.
		skill_clear_unitgroup()追加。ユニットグループの全削除をする。
	battle.c
		battle_calc_damage()にセイフティウォールとニューマの処理追加。
		map_foreachinarea()など修正
	map.c
		map_quit()でskill_clear_unitgroup()を呼ぶように。

・スキルの吹き飛ばし処理を実装
	ユピテルサンダー、サンクチュアリ、スピアスタブ、
	ボーリングバッシュ、チャージアローの吹き飛ばし処理実装

	path.c/map.h
		path_blownpos()追加
	battle.c/battle.h
		struct Damageにblewcountメンバ追加
		battle_calc_*_damage()でblewcountをセットするように。
	skill.c/skill.h
		skill_blown()追加。吹き飛ばし処理。
		skill_attack()でskill_blown()を呼ぶように。
		skill_attack()のflagの吹き飛ばしビットは未使用に。

・歩行中のモンスターに攻撃したとき、モンスターにディレイが入るようになりました
	（攻撃のモーションの遅延を考えてないのであんまり意味がないかも？）

	(map/)
	mob.c/mob.h
		stateにMS_DELAYを追加。
		mob_damage(),mob_timer()などの修正

・歩行中のモンスターに攻撃したとき、位置がずれる問題の応急処置
	（まだ位置はずれるようです）

	clif.c/clif.h
		clif_fixmobpos()を追加
	mob.c
		mob_attack()でclif_fixmobpos()を呼ぶように。

・その他修正
	pc.c
		pc_stop_walking()でpath_lenを初期化するように。

----------
//0271 by れあ

・PTに関して少しだけ修正
	公平にしてからキャラを加入させると公平が解除されないバグを修正

----------
//0270 by 胡蝶蘭

・スキルの追加実装と修正
	ロードオブバーミリオン、サンクチュアリ、マグヌスエクソシズム

	(db/)
	skill_db.txt
		マグヌスのヒット数、属性調整
		サンクチュアリの属性調整
	(map/)
	map.h
		struct map_session_dataの修正
	clif.c/clif.h
		clif_skill_setunit(),clif_skill_delunit()、
		clif_getareachar_skillunit(),clif_clearchar_skillunit()追加
		clif_pcoutsight(),clif_pcinsight(),clif_getareachar()修正
	skill.c/skill.h
		忘れるほど多数変更。主にスキルユニット関連部分。
	pc.c
		pc_authok()でskillunit,skillunittickを初期化するように。
		pc_walk()でskill_unit_move()を呼ぶように。
	mob.c
		mob_spwan()でskillunittickを初期化するように。
		mob_walk()でskill_unit_move()を呼ぶように。
	battle.c/battle.h
		battle_calc_magic_attack()修正
		battle_check_target()修正
	map.c
		map_foreachobject()など修正

・こまかいバグ修正など
	・mobが回復しない問題修正

	battle.c
		battle_damage()修正

----------
//0266 by 胡蝶蘭

・魔法計算式の修正
	魔法倍率をダメージに掛けていたのをMATKにかけるようにしました。
	…こっちが正しいとしていいのかな？違うなら教えてください。
	
	battle.c
		battle_calc_magic_attack()の修正

・スキルの追加実装
	サイト、ルアフ、ロードオブヴァーミリオン
	
	ロードオブバーミリオンは３回の判定時に詠唱音が鳴ります…。
	clif_skill_damage()のtypeを色々変えてみましたがどうもうまくいきません。
	直せる人は直してくれるとうれしいです。
	（うーん、ひょっとしたら本来はグラフィックのないスキルユニットを
	  設置して、そのユニットのIDでダメージを与えるのかも？？）
	
	(db/)
	skill_db.txt
		ロードオブバーミリオンのヒット数を３から10に変更。
	(map/)
	skill.c
		skill_status_change_timer_sub()追加。
		skill_status_change_*()に処理追加。

・blockのメモリ解放の安全性の向上
	map_foreachinarea,party_foreachsamemapで回っているときに
	blockをチェインから削除すると、うまく回らない可能性がある問題修正。
	さらに、blockをメモリから解放すると危険な問題も修正。

	・foreach内で関数を呼ぶ前にblockがチェインから外れてないかチェック。
	・foreachに入ったときにロックしてメモリから解放されないようにする。
	  これはユーザーがfreeじゃなくmap_freeblockによって解放するように
	  プログラムする必要がある。（ループから呼ばれる可能性のある関数を作る
	  場合のことで、普通はfreeでもいちおう動く。）
	・map_foreachinmoveareaについては改良していないが、
	  このループでblockを削除することはありえない気がするのでいいとする。
	
	これは今後を見越した改良であって、現在の不安定さを直すものではない。
	（現在はforeach内でメモリを解放していない…はずなので。
	  ただ、スキルユニットなど一時オブジェクトを多用し始めると効果がある）
	
	map.c
		map_freeblock(),map_freeblock_lock(),~_unlock()追加。
		map_delobject()のfree()をmap_freeblock()に置換。
		map_foreachinareaでロックと安全性チェック。
	party.c
		party_foreachsamemap()でロックと安全性チェック


・スキルユニット機構実装
	設置系のスキルのための機構実装。実際のスキルの実装はまだです。
	
	skill.c
		なんかもう色々追加しました。
	map.c
		do_init()でdo_skill_init()を呼ぶように。
	map.h
		struct skill_unit,skill_unit_groupなど追加。
		map_session_dataの書き換えなど。

・その他細かいところを修正したと思うけど忘れました。

----------
//0264 by nabe

・$charanameを喋るNPCと話した時、map鯖が落ちることがあるバグを修正しました。
	script.c
		replacestr()がおかしかったのを手直ししました。

----------
//0263 by nabe

・露店開設中にカートアイテムを出し入れできないよう修正
	pc.c
		pc_putitemtocart(),pc_getitemfromcart()に、露店判定を追加

・露店アイテム購入のチェックを追加
	vending.c
		vending_purchasereq()で諸々の条件判定を追加

----------
//0261 by 胡蝶蘭

・拡大鏡、イグドラシルの葉が実装されました
	スクリプトにitemskillコマンド作成。一時的にスキルが使用できます。

	(map/)
	script.c
		buildin_itemskill()の追加など。
	skill.c
		アイテムスキルならSPなどを検査＆消費しないように修正
	clif.c/clif.h
		clif_item_skill()の追加。
	(db/)
	item_db.txt/item_db2.txt
		スキル使用アイテムのスクリプト修正

・パーティスキルの実装
	アンゼルス、マグニフィカート、グロリア、アドレナリンラッシュが
	画面内のパーティ全員に効果を及ぼすようになりました。
	
	skill.c
		skill_castend_nodamage_id()の該当個所の修正
	party.c
		party_foreachsamemap()の修正

・スキル関係の修正	
	キリエエレイソンが即時発動になっているのを修正。
	ストーンカースでエフェクトが存在しないバグ修正。

	(db/)
	skill_db.txt
		キリエエレイソイン修正
	(map/)
	skill.c/skill.h
		skill_check_condition()追加。スキル使用条件検査の一本化。
		skill_castend_nodamage_id()でストーンカース修正
		
・スクリプトのコードを整理
	get_val()でconst.txtの定数を所得できるように修正。

	(map/)
	script.c
		get_val()の修正（const.txtのtype==0の値が所得可能に）
		bonus(),bonus2()などの修正。
	(db/)
	const.txt
		type=1である必要が無いものを0に。
	item_db.txt/item_db.txt
		const.txtの変更に伴う修正。

----------
//0260 by 胡蝶蘭

・戦闘関係の設定がファイルに書けるになりました
	map鯖の第2引数にファイル名が設定されていると、それを使い、
	設定されてない場合は "conf/battle_athena.cnf"を使います。

	あと、一応範囲攻撃スキルについて説明。
	鯖が常にPVPに設定されている場合、パーティメンバじゃないPCにも範囲攻撃が
	あたります。嫌な場合はパーティを組むか、常にPVPをoffにして下さい。
	常にPVPがoffでも、@pvpでpvpフラグを入れた人の間では攻撃が当たります。
	ただし、一度pvpをonにすると、リログするまでonのままなので注意。

	(conf/)
	battle_athena.cnf
		中に説明書いてるので各自好きなように書き換えてください。

	(map/)
	battle.c/battle.h
		struct Battle_Configの定義。
		battle_config_read()など追加。
	skill.c
		CASTFIX,DELAYFIXの廃止とBattle_Configによる修正の追加。
	atcommand.c
		@pvpコマンドでpvpフラグをセットするように。
		（鯖設定の常にPVPがoffの時、両人がpvpをonにしてたら戦闘可能）
	map.c/map.h
		struct map_session_dataにpvp_flagを追加
		do_init()でbattle_config_read()を読むように。

・戦闘関係のコードが少し整理されました
	battle.c/battle.h
		battle_weapon_attack()追加。
		battle_calc_weapon_attack()の引数変更
		battle_calc_attack()を追加してbattle_calc_*_attack()を一本化。
	skill.c/skill.h
		skill_weapon_attack(),~_magic_~(),~_misc_~()の廃止、
		skill_attack()に一本化。
	pc.c/mob.c
		攻撃処理をbattle_weapon_attack()に一本化。

・アイテム鑑定スキルを実装
	商人のスキルの方です。虫眼鏡はまだです。
	
	skill.c
		スキル処理追加
	pc.c/pc.h
		pc_item_identify()追加
	clif.c/clif.h
		clif_item_identify_list(),clif_item_identified()追加
		clif_parse_ItemIdentify()追加
	
・スキルデータベースのコメント修正
	(db/)
	skill_db.txt
		商人のスキルのコメントがずれていたのを修正

----------
//0259 by れあ
・mob_db.txtの修正
	亀島モンスターやBOSSのステータス調整
	亀島モンスに適当にドロップを付けました。
	本鯖と異なる物を落とす場合もあります。
	
----------
//0258 by 胡蝶蘭

・パーティで一度公平にしたら各自所得に戻せないバグ修正
	(char/)
	int_party.c
		mapif_parse_PartyChangeOption()の判定修正

・スキルの追加実装（主に範囲攻撃系）
	ナパームビート（分散対応）、ファイヤーボール、
	サンダーストーム、ヘブンズドライブ、
	ブリッツビート（自動鷹込み）、スチールクロウ
	スキンテンパリング
	
	(db/)
	skill_db.txt/skill_tree.txt
		一部修正
	(map/)
	battle.c/battle.h
		battle_check_target()を追加。対象になるかを検討する。
		battle_calc_magic_damage()の引数変更。ダメージ分散処理追加。
		battle_calc_misc_damage()追加。
		battle_calc_weapon_damage()修正。
	clif.c/clif.h
		clif_skill_damage(),clif_skill_damage2()の引数変更。
		clif_skill_poseffect()追加。
	skill.c/skill.h
		skill_weapon_attack(),skill_magic_attack()に微妙に処理を纏めた.
		skill_area_sub()追加。範囲スキル用。
		skill_area_sub_count()追加。skill_area_sub()用、敵カウント。
		skill_castend_damage_id()修正。引数と処理を追加。
		skill_castend_nodamage_id()修正。引数と処理を追加。
		skill_misc_attack()追加。
		skill_additional_effect()修正（自動鷹）
		skill_castend_pos()修正。
		skill_castend_pos2()追加。

・弓で攻撃したとき計算にDEXでなくSTRが使われる問題を修正。
	battle.c
		battle_calc_weapon_damage()修正。

----------
//0257 by 胡蝶蘭

・item_db.txtの職業フラグと、カードの装備個所フラグを修正
	装備品はI-Athenaのデータを参考にして機械的にコンバートさせました。
	I-Athena側にない装備品は、あきらかに変なのは修正しましたが、
	知らないものが多すぎて、ほとんど放置です。
	カードは、武器用カードの装備個所が0になってるのを2(左手)に修正。
	両手武器の場合は別に判定してるので両手武器も問題ないはず。

	(db/)
	item_db.txt/item_db2.txt
		該当個所修正

・カード追加実装
	スタンなどの追加効果、それらへの耐性系統、オークヒーローカード実装

	(db/)
	item_db.txt/item_db2.txt
		スクリプトの修正
	(map/)
	map.h
		struct map_session_dataにaddeffなどのメンバを追加
	pc.c
		pc_calcstatus()、pc_bonus2()の修正
		pc_attack()でskill_additional_effct()を呼ぶように。
	skill.c/skill.h
		skill_additional_effect()でカードによる判定追加
		skill_status_change_start()で耐性を付けた。
	battle.c
		battle_calc_weapon_attack()でオークヒーローカード
		（クリティカル耐性）の処理を追加

・回避判定の修正
	攻撃者がPCの場合、最大命中率９５％制限をなしにしました。
	battle.c
		battle_calc_weapon_attack()を修正
	

・完全回避を実装
	へんてこな処理してます＆計算式適当です。

	battle.c
		battle_calc_weapon_attack()に処理追加。

・倉庫を開いたままログアウトしたときmap鯖内では開きっぱなしになってる問題を修正
	storage.c
		storage_storage_quitsave()を修正

・@item,@monster,@produceで名前指定できるように変更
	英語名、日本語名どちらでもOK。英語の場合は大文字小文字区別しません。
	
	atcommand.c
		該当個所修正
	itemdb.c/itemdb.h
		itemdb_searchname(),itemdb_searchname_sub()追加
	mob.c/mob.h
		mobdb_searchname()追加

・@refineで上げる数値を指定できるように変更
	atcommand.c
		該当個所修正

・@produceによる製造時のエフェクトを正しいものに修正
	clif.c/clif.h
		clif_produceeffect()追加
	atcommand.c
		該当個所修正

・露店スキル使用時の処理を少し修正
	skill.c
		skill_castend_id()でなく、skill_castend_nodamage_id()で
		露店開設を呼ぶようにした。

・stricmpの変わりにstrcasecmpを使うようにした
	（_WIN32か__EMX__が定義されているとstricmpを使います）

	(char/)
	int_party.c
	(map/)
	itemdb.c/mob.c
		マクロ定義の修正など

・スキルを少し修正
	グリムトゥースがハイディングで使えない問題修正
	武器研究の命中修正を実装

	skill.c
		skill_use_id()の修正
	pc.c
		pc_calcstatus()で武器研究に従って命中修正

----------
//0256 by nabe

・露店アイテム購入のバグ修正
	clif.c
		clif_vendinglist()で売り切れたアイテムは表示しないように

----------
//0255 by nabe

・露店アイテム購入のバグ修正
	vending.c
		vending_purchasereq()でzeny,weight部分修正

----------
//0254 by nabe

・露店を実装
	vending.c/vending.h
		新規追加。露店メイン処理
	skill.c
		skill_castend_id()に露店開設スキル処理を追加
	clif.h/clif.h
		露店関連パケット処理を追加
	map.h
		struct map_session_dataに、
			int vender_id;
			int vend_num;
			char message[80];
			struct vending vending[12];
		を追加

----------
//0253 by 胡蝶蘭

・stricmp未定義エラーがでる環境用の修正
	エラーが出た場合、int_party.cの最初のマクロ定義のコメント化のうち、
	どちらかを外してやり直してみると、うまくいくかも。
	最悪、下を有効にしたらうまくいくはず。（大文字小文字を区別するようになります）

	(char/)
	int_party.c
		コメント化済みのマクロ定義追加

----------
//0252 by 胡蝶蘭

・カードの一部実装
	（ステータス変化全般、武器属性、スキルはすでに実装済み）
	防具属性、詠唱時間変化、属性攻撃耐性、種族耐性、種族追加ダメージ、
	属性追加ダメージ、サイズ追加ダメージ、MAXHP、MAXSP増減、使用SP変化系、
	フェン、ドレイク、ホルン、深淵の騎士、黄金蟲、オシリスカードを実装

	(db/)
	const.txt
		bonus用の定数追加、bonus2の定数も追加
	item_db.txt/item_db2.txt
		カードのスクリプト追加
	(map/)
	map.h
		struct map_session_dataにhprateなど多数メンバ追加
	script.c
		bonus2コマンド追加
		buildin_bonus2()追加
	pc.c/pc.h
		pc_bonus2()追加
		pc_bonus()の処理追加
		pc_calcstatus()で各種追加メンバの初期化を行うようにし、
		hprateやsprateに従いmax_hp,max_spの調整もするように変更。
		pc_makesavestatus()でオシリスカード修正
	skill.c
		skill_castfix()でcastrateに従い、詠唱時間を調整。
		skill_castend_id()でdsprateに従い、使用SPを調整。
		skill_castend_nodamage_id()でカード修正を追加
	battle.c
		battle_calc_weapon_attack()でカード修正を追加
		battle_calc_magic_attack()でカード修正を追加
		battle_damage()でフェンカード修正を追加

・ステータス割り振りの表示上の問題修正
	STRを上げてもATKが変わらない問題、INTを上げてもMATKが変わらない問題修正

	map.h
		struct map_session_dataにmatk1,matk2メンバ追加
	pc.c
		pc_calcstatus()の修正
	clif.c
		clif_initialstatus()の修正
	battle.c
		battle_calc_magic_attack()の修正


----------
//0251 by nabe

・0250のバグ修正など
	カートを付けずにログインまたはマップ移動した後にカートを付けると、
	カートの中身が2倍の量に表示されてしまっていたのを修正。
	カートのアイテム数を更新するように修正。
	pc.h/pc.c
		pc_iscarton()マクロを追加
		pc_cart_additem(),pc_cart_delitem()にそれぞれ
		sd->cart_num++;とsd->cart_num--;処理を追加
	clif.c
		clif_parse_LoadEndAck()で、
		カートを付けているときのみカート情報を送信するようにした

----------
//0250 by nabe

・カートOFF、チェンジカート実装。
	(map/)
	pc.c/pc.h
		pc_setcart()を追加
	script.c
		buildin_setcart()を追加
		スクリプトコマンド「setcart;」でカートがつく
	clif.c/clif.h
		clif_parse_CartOff()追加。（カートをはずす）
		clif_parse_ChangeCart()追加。（チェンジカートのカート選択）
	(conf/)
	npc_town_kafra.txt
		カートサービスを「setcart;」に置換


----------
//0249 by 胡蝶蘭

・パーティのデータベースの矛盾を出来るだけ抑えるように。
	複数パーティに所属してるデータの検査、追加に失敗したときに脱退など。
	
	(char/)
	int_party.c
		party_check_conflict(),party_check_conflict_sub(),
		mapif_parse_PartyCheck()追加
	inter.c
		パケット長リストに0x3028追加
	INTER鯖パケット.txt
		パケット0x3028追加
	(map/)
	party.c/party.h
		party_check_conflict()追加。
		party_invite()で同アカウント所属チェックを行うように。
		party_member_added(),party_send_movemap()で
		party_check_conflict()を呼ぶように。
	intif.c/intif.h
		intif_party_checkconflict()追加

・パーティの座標、ＨＰ通知を実装
	変化があれば１秒に一回送信。

	map.h
		struct map_session_dataにparty_x,~_y,~_hpの３メンバ追加
	party.c/party.h
		party_send_xyhp_timer_sub(),party_send_xyhp_timer(),
		party_send_xy_clear(),party_send_hp_check()追加。
		party_recv_movemap()でsd->party_*を初期化するように。
	clif.c/clif.h
		clif_sendのPARTY*フラグを有効に。
		（PARTY,PARTY_SAMEMAP,PARTY_AREA,PARTY*_WOSの６種）
		clif_party_xy(),clif_party_hp()追加。
	pc.c/pc.h
		pc_authok()でsd->party_*を初期化するように。
		pc_walk()でパーティメンバが視界内に入ってきたときに
		party_hpを初期化するように。

・パーティのexp公平分配を実装
	party.c/party.h
		party_share_exp()追加
	mob.c/mob.h
		mob_damage()で公平分配処理追加

・スキルの修正と追加実装
	バッシュ、ピアースの命中率修正実装
	ピアースのサイズによる回数変動実装（プレイヤーは中型と仮定）
	バッシュ、ソニックブロウのスタン効果実装
	ストーンカース、フロストダイバ、インベナム、
	アスペルシオ、エンチャントポイズン、レックスデビーナ実装

	skill.c
		skill_additional_effect()追加
		skill_castend_damage_id()該当個所修正
		skill_castend_nodamage_id()該当個所修正
		skill_use_id(),skill_use_pos()でスキルが使用できないときは
		何もしないように修正。
	battle.c
		battle_calc_weapon_attack()の該当個所修正
		battle_get_dmotion(),battle_get_attack_element()修正
	clif.c
		clif_mob007b(),clif_mob0078でoptionなどを送るように修正
	pc.c
		pc_attack(),pc_walktoxy()で行動不可能なときは何もしないように。
	mob.c
		mob_stopattack()修正
		mob_ai_sub_hard()で行動不能なときは何もしないように。

・攻撃射程の判定追加
	相手が移動して届かないときは、移動パケットを送信

	clif.c/clif.h
		clif_movetoattack()追加
	pc.c
		pc_attack()で射程判定、届かないならclif_movetoattack()を呼ぶ。

----------
//0248 by nabe

・パーティ作成時に既にパーティに所属していた場合の処理を追加
	party.c
		party_create()に、既にパーティに所属していた場合
		clif_party_created(sd,2)を追加

・ディスカウント、オーバーチャージを計算
	pc.c
		pc_modifybuyvalue()、pc_modifysellvalue()で値段を計算


----------
//0247 by 胡蝶蘭

・パーティ実装
	公平分配は設定しても実際には公平分配されてない。
	パーティスキルはまだ自分にしかかからない

	(char/)
	int_party.c/int_party.h
		まともに実装
	inter.c
		パケット長リスト追加
	INTER鯖パケット.txt
		パーティのパケット追加
	(map/)
	party.c/party.h
		新規追加
	map.c/map.h
		struct map_session_dataにparty_sendedメンバ追加
		do_init()でdo_party_init()を呼ぶ
		map_quit()でparty_send_logout()を呼ぶ
	intif.c/intif.h
		パーティ関連の部分追加
	clif.c/clif.h
		パーティ関連の部分追加
		clif_parse_LoadEndAck()でparty_send_movemap()を呼び出す
	pc.c
		pc_authok()でparty_request_info()を呼ぶようにし、
		party_sendedを初期化するように。
	
・詠唱妨害されたとき画面上で詠唱をやめるように修正
	(map/)
	skill.c
		skill_castcancel()で詠唱中止パケ(合ってるのかな？)を送信

・超遠距離攻撃だと敵が反撃してこない問題を修正
	(map/)
	map.h
		struct mob_dataにmin_chaseメンバ追加（最低追跡距離）
	mob.c
		mob_attack()でmin_chaseを13に初期化する
		mob_walk()でmin_chaseが13より大きいなら少しずつ引いていく
		mob_ai_sub_hard()でmin_chaseにより追跡を判断、
		攻撃を受けた時にmin_chaseを彼我距離+13に設定

----------
//0246 by 胡蝶蘭

・カート実装
	map.h
		struct map_session_dataにcart_weightなど４つメンバ追加
	pc.c/pc.h
		pc_cart_additem(),pc_cart_delitem(),
		pc_cart_putitemtocart(),pc_cart_getitemfromcart()追加
		pc_calcstatus()でカート重量や個数などの情報を計算
	clif.c/clif.h
		clif_cart_itemlist(),clif_cart_equiplist(),
		clif_cart_additem(),clif_cart_delitem(),
		clif_parse_PutItemToCart(),clif_parse_GetItemFromCart()追加
		clif_parse_LoadEndAck()でカート情報、内容送信
		clif_updatestatus()でSP_CARTINFOでカート情報を送れるように
		clif_parse_MoveFromKafraToCart(),~ToKafraFromCart()追加
	storage.c/storage.h
		storage_additem(),storage_delitem()追加
		storage_storageadditemfromcart,~getitemtocart()追加
		storage_storageadd(),storage_storageget()で、
		storage_additem(),storage_delitem()を呼ぶように変更

・スキル詠唱ディレイなど実装
	clif.c
		clif_parse_WalkToXY()にskilltimerによる移動可否を追加
		clif_parse_UseSkillToId(),clif_parse_UseSkillToPos()に
		canmove_tickによる攻撃可否追加
	skill.c/skill.h
		skill_castcancel()を追加
		skill_use_id(),skill_use_pos()でディレイ時間計算および、
		canmove_tickの設定
	battle.c
		battle_damage()でskill_castcancel()の呼び出し追加

・0245のアイテムデータベース修正の通常価格版用意
	(db/)
	item_db.txt
		item_db2.txtに前のitem_db.txtの価格情報をマージしただけです。

----------
//0245 by れあ
	また例によって、相場修正版のみです。
・item_db2.txtの修正
	亀島新装備の効果を実装しました。
	ウィザードが杖を装備できないのを修正
	ウィザードがマジシャンハット、とんがり帽を
	装備できないのを修正
----------
//0244 by れあ
・mob_db.txtの修正
	亀島モンスターのデータをいれました。
	ただ、間違ってる部分がかなりあります。
	Speed,Delayは適当です。
	また、わからないのは韓国版のデータなので
	Mdefとか異常に高い気も。
----------
//0242 by 胡蝶蘭

・取引関連の変更と修正
	取引に使う変数をmmo_charstatusからmap_session_dataに移動しました
	
	(common/)
	mmo.h
		struct mmo_charstatusから取引関係のメンバ削除
	(map/)
	map.h
		struct map_session_dataに取引関係のメンバ追加
	trade.c
		構造体の変更にあわせて修正
	map.c
		map_quit()で取引中ならキャンセルするようにした

・カードの組み合わせ実装
	pc.c/pc.h
		pc_insert_card()でカードを実際に挿入する
	clif.c/clif.h
		clif_parse_UseCard(),clif_parse_InsertCard()追加
		clif_use_card(),clif_insert_card()追加

・一部のカード効果実装
	スキル習得カード、ステータスボーナスカードなど。

	(map/)
	map.h
		struct map_session_dataに装備カード検索用の変数追加
	pc.c/pc.h
		pc_calcstatus()でカードの処理追加
		あるIDのカードが装備済みか検索するための関数、
		pc_equip_card(),pc_equip_wcard(),pc_equip_dcard()を用意

・重量オーバー/鷹/騎乗アイコンの表示
	(map/)
	pc.c/pc.h
		pc_checkweighticon()追加、重量のアイコン処理
	clif.c
		clif_updatestatus()で重量送信時にpc_checkweighticon()の実行
		clif_changeoption()で鷹と騎乗のアイコン処理

・0241のアイテムデータベース修正の通常価格版用意
	(db/)
	item_db.txt
		item_db2.txtに前のitem_db.txtの価格情報をマージしただけです。


----------
//0241 by れあ
・アイテムデータベースの修正
	新頭装備のグラフィックが異なるのを修正
	装備の効果の実装
	上段・中段が間違ってたのを少し修正
	速報版ってことで間違え多いかも。
	テストもあまりしてません。
	あと、相場調整版しか用意してません。
	
	item_db2.txt
		亀島にあわせて調整

----------
//0240 by nabe

・取引を実装しました。
	(common/)
	mmo.h
		struct mmo_charstatus に
			int trade_partner;
			int deal_item_index[10];
			int deal_item_amount[10];
			int deal_zeny;
			short deal_locked;
		を追加
	(map/)
	clif.c,clif.h
		clif_traderequest()	: 0xe5（取り引き要請受け）
		clif_tradestart()	: 0xe7（取り引き要求応答）
		clif_tradeadditem()	: 0xe9（相手方からのアイテム追加）
		clif_tradeitemok()	: 0xea（アイテム追加成功）
		clif_tradedeal_lock()	: 0xec（ok押し）
		clif_tradecancelled()	: 0xee（取り引きキャンセル）
		clif_tradecompleted()	: 0xf0（取り引き完了）
		を追加。
	trade.c,trade.h
		trade_traderequest()	: 取引要請を相手に送る
		trade_tradeack()	: 取引要請
		trade_tradeadditem()	: アイテム追加
		trade_tradeok()	: アイテム追加完了(ok押し)
		trade_tradecancel()	: 取引キャンセル
		trade_tradecommit()	: 取引許諾(trade押し)
		を実装。それぞれclif.c::clif_parse_Trade*から呼ばれる。


----------
//0238 by れあ

・速度変更に関して少し修正
	atcommand.c
		速度変更の部分を少し修正
		これで一応動くみたい？
	pc.c
		ついでにですが
		速度上昇で歩行速度が上がるようにした。
		一応動くみたいですが適当なので
		おかしなところがあればお願いします。

----------
//0236 by nabe

・スクリプトでmenuで飛んだ先で直ぐmenuを書くと誤動作するバグを修正しました。
	script.c
		goto動作の後のRERUNLINEに対処するため、
		goto,menuで飛んだ後には、st.state==GOTOでrerun_posを更新。


----------
//0233 by nabe

・アイテムを装備する際の装備判定を追加しました。
	pc.c
		pc_equipitem()に装備判定（性別判定、装備LV判定、職業判定）追加

・重量判定スクリプトコマンドを追加しました。
	if (checkweight(アイテムID,アイテム数量))
	でそのアイテム×数量を取得できるかどうか判定できます。
	script.c
		buildin_checkweight()を追加

・スクリプト詰め合わせをathena dev-2.1.1用に移植しました。
	map_athena1.cnf
	npc_event_*.txt	イベントNPC
	npc_job_*.txt	転職NPC
	npc_mob_job.txt	転職用モンスター
	npc_town_*.txt	町NPC


----------
//0232 by 胡蝶蘭

・装備ボーナスが実装されました
	ボーナスに使うスクリプト(bonus,skill)を実装
	スクリプトはI-Athenaのデータを使ってコンバートしました。
	（まだカードには対応していません）

	(common/)
	mmo.h
		struct skillにflagメンバ追加（カードスキルかどうか）
	(map/)
	map.h
		struct map_session_dataにatk_eleなどのメンバ追加
		enumでSP_ATKELEMENTなど追加
	pc.c
		pc_bonus()の実装、pc_skill()追加
	script.c
		buildin_skill()の追加
		buildin_bonus()の修正(const.txtの定数が使えるように)
	clif.c
		clif_skillinfoblock()の修正(カードスキルは上げられない)
	(db/)
	const.txt
		bonusに使うための定数追加
	item_db.txt
		標準のデータに装備スクリプトを追加したもの
	item_db2.txt
		0213で相場調整されたデータに装備スクリプトを追加したもの

・詠唱関係のバグが修正されました
	(map/)
	skill.c
		skill_use_id(),skill_use_pos()を修正
	(db/)
	cast_db.txt
		少し追加（ブリッツビートなど）

・攻撃属性が適用されるようになりました
・星のかけらの修正が適用されるようになりました
	map.h
		struct map_session_dataにstarメンバ追加
	pc.c
		pc_calcstatus()で属性初期化
	battle.c
		battle_get_element(),battle_get_attack_element()修正
		battle_calc_weapon_damage()の該当個所修正
		
・杖装備時にMATK+15%が適用されるようになりました
	battle.c
		battle_calc_magic_damage()の該当個所修正

・製造武器のキャラクター名が正しく表示されるようになりました
	
	原理としては、map鯖内のキャラクタ名データベースを検索して、
	存在すれば即返信、存在しなければchar鯖に解決要求を出す。
	このとき、名前を要求してきたクライアントのIDをデータベースに登録する。
	char鯖から名前データがくると、対応するデータベースに名前をセットし、
	要求してきたクライアントに名前を返信する。
	未解決の同じキャラID解決を複数のクライアントが要求してきた場合、
	最後に要求してきたクライアントにしか返信しないが、
	返信されなかったクライアントは数秒後に再び解決要求を送ってくる
	（そしてそのときはmap鯖から即返信される）ので大きな問題はない。

	パケット0x2b08,0x2b09でmap鯖とchar鯖が通信してます。
	
	(char/)
	char.h
		UNKNOWN_CHAR_NAME定義（キャラデータが無いときに返される名前）
	char2.c
		parse_frommap()にパケット0x2b08の処理を追加
		
	(map/)
	chrif.c/chif.h
		chrif_searchcharid()追加
		chrif_parse()で0x2b09の処理追加
	map.c
		データベース charid_db 宣言
		struct charid2nick宣言。nickは名前、
		req_idは0で名前解決済み、0以外で未解決で解決待ちのブロックID
		map_addchariddb()追加。データベースへ名前登録、要求に返信。
		map_reqchariddb()追加。要求があったことをデータベースへ追加。
		map_charid2nick()でデータベースの検索
		do_init()で charid_db の初期化を追加
	clif.c/clif.h
		clif_parse_SolveCharName(),clif_solved_charname()追加


----------
//0231 by nabe

・スクリプトで mes "$charaname"; 等と書くとキャラの名前をしゃべる機能を追加。
	script.c
		buildin_mes()内で
		mes内部の$charanameをキャラの名前に置換する処理を追加。
		＃同様にして変数の値などをmes内部で表示するようにすることも
		＃できますが、これについては未実装です・・・。
		＃とりあえず
		＃	mes Global_Val;
		＃のように直接書くことで対処してください。

・敵に攻撃されたときにmap鯖が落ちることがあるのを修正。
	battle.c
		battle_calc_weapon_attack()の
		ディバインプロテクションのスキルチェック部分、
		pc_checkskill(sd,22)を、
		pc_checkskill(tsd,22)に。

----------
//0230 by nabe

・回避率増加スキルをステータスに反映。
	pc.c
		0228でのpc_calcstatus()の回避率増加分を元に戻しfleeを増加。
	battle.c
		battle_calc_weapon_attack()のhitrate計算で回避率保証を計算。
・グローバル変数を実装。
　	'@'もしくは'l'で始まらない変数名は、全てグローバル変数とみなされます。
	mmo.h
		struct mmo_charstatus に
			int global_reg_num;
			struct global_reg global_reg[GLOBAL_REG_NUM];
		を追加。
	pc.c
		pc_readglobalreg(),pc_setglobalreg()を追加。
	script.c
		get_val(),buildin_input(),buildin_set()に
		グローバル変数のための処理を追加。
	char2.c
		mmo_char_tostr(),mmo_char_fromstr()に
		グローバル変数のための処理を追加。

----------
//0229 by 胡蝶蘭

・一部スキルの実装/修正
	ディバインプロテクション、デーモンベイン、ビーストベイン実装
	エナジーコート修正（魔法による攻撃にはスキルが働かないように修正）
	武器攻撃系スキル修正（エフェクトを通常攻撃からスキルに変更）

	battle.c
		battle_addmastery()でベイン系追加
		battle_calc_damage()でエナジーコート修正
	skill.c
		skill_castend_damage_id()の武器攻撃系スキルの部分を修正

・敵攻撃計算をPCのものと一本化
	これでPCvsPC、PCvsMOB、MOBvsPC、MOBvsMOB(!?)を１つの関数で計算できます

	battle.c/battle.h
		battle_calc_weapon_attack()を修正
		battle_calc_weapon_attack_pc(),~mob()を削除
	mob.c
		mob_attack()で計算にbattle_calc_weapon_attack()を使うように修正

・詠唱時間データがない場合のデフォルトの詠唱時間を０に変更
	今までは１秒にしてましたが、バッシュとかがおかしくなるので。
	（バッシュとかのデータを用意すればこうしなくても直るんですが）
	
	pc.c
		pc_readdb()で1000msをセットするのを止めた

・遠距離攻撃してこないバグ、その他を修正
	mob.c
		mob_attack()の射程を修正し忘れていた
		mob_ai_sub_hard()で射程距離外の時、無移動の敵は
		ターゲットを外すようにした


----------
//0228 by nabe

・ダブルアタックのSkillIDを修正。
	battle.c
		battle_calc_weapon_attack_pc()で
		pc_checkskill(sd,49) -> pc_checkskill(sd,48)に。
・回避率向上を陽に表さない
	pc.c
		pc_calcstatus()でのfleeの回避率向上分を削除し、
	mob.c
		mob_attack()のhitrate計算で回避率向上を計算。
・盗蟲、盗蟲雌、盗蟲雄を正常化。
	npc_monster3J.txt
		mob_db.txtに合わせて、たぶん正しいと思われるIDに修正。
		盗蟲	1006 -> 1051
		盗蟲雌	1017 -> 1053
		盗蟲雄	1021 -> 1054
・デバッグメッセージの消し忘れ（？）を削除。
	pc.c
		printf("pc.c 63 clif_clearchar_area\n");をコメントアウト

----------
//0227 by 胡蝶蘭

・一部のスキル効果が実装されました
	HP回復向上、SP回復向上、マグニフィカート、
	ハイディング、クローキング、死んだふり、応急手当

	map.h
		struct map_session_data に inchealtick メンバ追加
	pc.c
		pc_spheal()でマグニフィカート処理追加
		pc_natual_heal_sub()で回復向上スキル処理追加
		pc_authok()でinchealtickを初期化するように変更
		pc_walk()でincheaktickを再設定するように変更
		pc_walk()でクローキングの終了条件を調査するように変更
		pc_walktoxy()で状態によって移動不可能にした
	skill.c/skill.h
		skill_status_change_start(),~timer(),~end()に処理追加
		skill_check_cloaking()追加、クローキングの終了条件を検査
	battle.c/battle.h
		battle_stopattack()追加
		battle_calc_weapon_attack()で攻撃を止める処理追加
	mob.c
		mob_ai_sub_hard()で攻撃を止める処理追加

・通常攻撃処理、対MOB、対PCを共用に。
	pc.c
		pc_attack_mob(),pc_attack_pc()削除
		pc_attack()に攻撃処理追加

・モンスターの行動の一部実装
	アクティヴ、無反応、移動しない、遠距離攻撃一部

	mob.c
		mob_ai_sub_hard()に行動追加
		mob_ai_sub_hard_activesearch()追加、近くのPCへの策敵

・オーバートラストの増加倍率が100倍になっているバグが修正されました
	battle.c
		battle_calc_weapon_attack()で、該当個所を修正


----------
//0226 by 胡蝶蘭

やっぱりテストはあんまりしていません

・一部のスキル効果が実装されました
	速度増加、エンジェラス、キュアー
	インポシティオマヌス、サフラギウム、リカバリー、グロリア
	ふくろうの目、ワシの目、集中力向上、回避率向上、解毒
	所持量増加、ラウドボイス、アドレナリンラッシュ、オーバートラスト
	ウェポンパーフェクション、マキシマイズパワー、２ＨＱ

	(map/)
	map.h
		struct map_session_dataにwatk2,def2など追加
	pc.c
		pc_calcstatus()にスキル修正追加
		atk2なども送信するように変更
	battle.c/battle.h
		battle_get_def2()など多数追加
		battle_calc_weapon_damage()で敵減算防御の所得を
		battle_get_def2()に変更
		battle_calc_magic_damage()で敵減算魔法防御の所得を
		battle_get_mdef2()に変更
		battle_calc_weapon_damage()でスキル修正を追加
	skill.c/skill.h
		skill_use_nodamage_id()の該当個所追加
		skill_status_change_start()の該当個所追加
	clif.c
		clif_updatestatus()のatk2などの処理追加
		clif_initialstatus()でatk2などの扱い変更、aspdなど送信追加
	
・精錬ダメージ修正/精錬防御修正が適用されました
	(map/)
	pc.c
		pc_calcstatus()でwatk2とdefの追加計算追加
	battle.c
		battle_calc_weapon_damage()でwatk2をダメージに追加

・inter鯖のパケット解析部の致命的な問題が修正されました
	TCP/IPプログラムでやってはいけないことをそのままやってました(汗
	inter鯖のパケット長データをinter.cに持つように修正されました。

	(char/)
	inter.c/inter.h
		パケット長データ inter_*_packet_length[] を追加
		パケット長チェック inter_check_length() を追加
		mapif_parse_*()でRFIFOSKIPをなしに変更
	int_storage.c/int_storage.h
		mapif_parse_*()でRFIFOSKIPをなしに変更
	int_party.c/int_guild.c
		仕様変更に対応させた変更
	INTER鯖パケット.txt
		パケット長リスト追加

・ちょっとした修正
	(char/)
	inter.h
		inter_cfgNameを"conf/inter_athena.cnf"に修正
	char2.c
		char.exe第２引数省略時、inter_cfgNameを使うように修正
	(db/)
	cast_db.txt
		ホーリーライトの詠唱時間追加（ディレイは適当）
		詳しい人追加求む

----------
//0225 by 胡蝶蘭

なんかかなり弄りましたが相変わらずテストはあんまりしてません。

・スキル使用時の変数を変更
	よく見たら最初から用意されてましたね。

	map.h
		struct map_session_dataのcast_*を削除
	skill.c
		cast_*の変数をskill*に変更。

・ステータス異常スキルの処理を追加（効果は未実装）
	見かけ上、ステータス異常に掛かったりとかだけ。
	効果はまだなし。

	skill.c/skill.h
		skill_status_change_start(),~end(),~timer(),~clear()追加。
		それぞれステータス異常の開始、終了、タイマ処理、全消去。
	map.c/map.h
		map_quit()でskill_status_change_clear()を呼ぶようにした。
		struct map_session_dataにsc_data,sc_count追加。
		struct mob_dataにsc_data,sc_count,option,opt1,opt2追加。
	pc.c
		pc_authok()でsc_data,sc_countを初期化するようにした。
		pc_setoptionでclif_changeoption()の引数変更。
		pc_damage()で死亡時にskill_status_change_clear()を呼ぶように。
	mob.c
		mob_spawn()でsc_data,sc_countを初期化するようにした。
		mob_attack()でbattle_calc_damage()を呼ぶようにした。
		mob_damage()で死亡時にskill_status_change_clear()を呼ぶように。
	battle.c/battle.h
		battle_get_*()たくさん追加。
		battle_calc_damage()追加。最終的なダメージ計算用。
		battle_calc_magic_attack(),battle_calc_weapon_attack()で
		battle_calc_damage()を呼ぶようにした。
	clif.h/clif.c
		clif_status_change()追加。ステータス異常アイコン表示用。
		clif_changeoption()の引数変更。
	atcommand.c
		clif_changeoption()を呼んでいる２ヶ所で引数変更。
		@dieでskill_status_change_clear()を呼ぶように。

・マグヌスエクソシズムの習得条件が間違っているのを修正。
	db/skill_tree.txt
		該当個所修正。（レックスエーテルナの必要Lvを１に）

・アクティブな敵は攻撃するとき時々ターゲットが変わるようになりました
	mob.c
		mob_ai_sub_hard()の攻撃されたか確認する部分に
		アクティブなら25%の確率でターゲットが変わるように変更。

・一部のスキル効果が実装されました
	キリエエレイソン、エナジーコート、レックスエーテルナ、
	ホーリーライト、リザレクション、ターンアンデッド、モンスター情報

	skill.c/skill.h
		skill_castend_nodamage_id()にスキルの処理を追加。
		skill_castend_*_id()の引数を変更
	battle.c
		battle_calc_damage()にスキルの処理を追加。
		battle_damage(),battle_heal()の引数変更
		battle_calc_weapon_damage(),battle_calc_magic_damage()引数変更
	clif.c/clif.h
		clif_skill_estimation()追加。モンスター情報送信用
	pc.c
		battle_calc_weapon_damage()呼び出しの引数変更

・storage.txtが無い場合inter鯖が強制終了する仕様を変更しました
	(char/)
	int_storage.c
		inter_storage_init()でファイルが読めないとexitしてたのを修正


----------
//0224
・2-2次職のスキルをツリーに追加しました（実装はまだです）
	(db/)
	skill_db.txt
	skill_tree.txt


----------
//0223 by 胡蝶蘭
・カプラ倉庫をinter鯖に対応させました
	いままでのstorage.txtはそのまま使えます。
	inter鯖用の設定ファイルとしてconf/inter_athena.cnfを使います。
	（設定ファイルはchar.exeの第２引数で他のファイルを指定できます）

	カプラ倉庫のinter鯖実装の概要
	
	inter鯖はstorage.txtの全データを持つ。map鯖はアカウントが要求するまで
	そのアカウントの倉庫データを持たない。クライアントから倉庫を開く要求が
	あったとき、map鯖は対応するアカウントの倉庫データをinter鯖に要求する。
	inter鯖からデータが届くとクライアントに倉庫データを送る。
	倉庫の出し入れはクライアントとmap鯖間の通信だけで行われる。
	クライアントが倉庫を閉じるか終了すると、map鯖は該当アカウントの
	倉庫データをinter鯖に送る。このときinter鯖の応答を待たずにクライアントに
	倉庫クローズを送る。inter鯖は倉庫データを受け取ると、
	全員分のデータをファイルに保存して、map鯖に成功ステータスを返す。
	map鯖は成功ステータスを無視する。(デバッグ用に画面に出力するだけ)
	inter鯖終了時にも倉庫データをファイルに保存する。

	map鯖でaccount2storageで新しい倉庫データを作るとき、
	すでに閉じられている倉庫データのメモリを使いまわしたほうがメモリが
	節約できるかも？（これは実装していません）

	(common/)
	mmo.h
		struct storage を map/storage.h から移動。
		inter鯖とmap鯖両方で使用するため。
	(char/)
	char2.c
		do_final()を作成、終了時にmmo_char_sync()以外にinter_save()を
		呼ぶようにした（これでinter_*_save()は全部呼ばれます）
		inter_init()をchar.exeの第２引数もしくは"conf/inter.cnf"で
		呼ぶようにした（athena.shにinter鯖コンフィグファイルを指定できます）
	inter.c/inter.h
		inter_storage_init(),inter_storage_save(),
		inter_storage_parse_frommap()を呼ぶように。
		inter_init()にコンフィグファイル名の引数を付けた。
		inter_config_read()追加、コンフィグファイルから
		倉庫とパーティー、ギルドのファイル名を読み込みます。
	int_storage.c/int_storage.h
		新規追加。倉庫部分のinter鯖機能。
	int_party.h/int_party.c/int_guild.h/int_guild.c/
		ファイル名変数の宣言追加
	INTER鯖パケット.txt
		倉庫パケットの解説追加

	(map/)
	storage.h/storage.c
		storage_fromstr(),storage_tostr()をchar/int_storage.cに移動。
		同じくdo_init,do_finalでのファイル処理も移動。
		do_final()は処理なし、do_init()は変数初期化のみに変更。
		storage_storageopen()では単にintif_request_storage()を呼ぶだけに。
		storage_storageclose()にintif_send_storage()を追加
		storage_storage_quitsave()追加。クライアント終了時に
		カプラ倉庫が開いていればintif_send_storage()を呼ぶ関数。
	intif.h/intif.c
		intif_parse_LoadStorage(),intif_parse_SaveStorage(),
		intif_send_storage(),intif_request_storage()追加
	map.c
		map_quit()でstorage_storage_quitsave()を呼ぶように。

	(conf/)
	inter_athena.cnf
		新規追加。inter鯖用のコンフィグレーションファイル


----------
//0221 by 胡蝶蘭

・スキルターゲットのIDが正しく所得できない問題修正
	clif.c
		clif_parse_UseSkillToId()でIDをWORDとして扱ってたのをLONGに修正

・スキル詠唱時間と属性表、および魔法系スキルの属性修正実装
	属性ダメージ修正は battle_attr_fix() で計算します。
	atk_elemは属性そのまま、def_elemは（属性lv*20＋属性）です。
	詠唱時間はskill.cのCASTFIXの値を変えることで倍率を調整できます

	pc.c
		pc_readdb()でcast_db.txtとattr_fix.txtの読み込み追加
	skill.c/skill.h
		struct skill_db にcast,delay追加、それらのアクセサも追加
		スキル詠唱時間を skill_get_cast() で所得するようにした
	battle.c/battle.h
		attr_fix_table定義
		battle_attr_fix()追加、属性修正を計算する
		属性系アクセサ(battle_get_element()など)を追加
		battle_calc_magic_damage()に属性修正を追加
	cast_db.txt
		新規追加。詠唱時間とディレイのデータベース
		全然足りないので、誰か追加希望。
	attr_fix.txt
		新規追加。属性修正テーブル

・ヒールの実装
	clif.c/clif.h
		clif_skill_nodamage()追加、支援系や回復のエフェクト
	skill.c/skill.h
		skill_castend_damage_id()、skill_castend_nodamage_id()追加、
		攻撃系と支援/回復系で関数を分けた
		ヒール計算マクロ skill_calc_heal() 追加
	battle.c
		battle_calc_magic_damage()でヒールのダメージ計算追加


----------
//0220 by れあ

0216の修正
HITの計算がおかしかったので修正してみました。
間違ってたらごめんなさい。

・battle.c
	256行目の
	hitrate=battle_get_hit(&sd->bl) - battle_get_flee(&sd->bl) + 80;
	がたぶん、自分のＨＩＴと自分のＦＬＥＥで計算してる気がするので
	hitrate=battle_get_hit(&sd->bl) - battle_get_flee(target) + 80;
	に修正しました。


----------
//0218 by 胡蝶蘭

実際に分散させてテストしていなかったり。

・map鯖分散処理用にinter鯖機能をつけてみる（今後のための拡張）
	char鯖にinter鯖を寄生させました。複数のmap鯖間の通信に利用します。
	map鯖を分散して処理できるようにするための機能です。
	今後partyやguild実装時にきっと役にたってくれるかと。
	
	倉庫の実装もinter鯖に移動すべきかもしれません。
	どのキャラクターがどのmap鯖にいるか検索する機能もいるかも。

	使うパケットのIDは以下のようになります
		map鯖=>inter鯖はパケット0x3000〜
		inter鯖=>map鯖はパケット0x3800〜
	パケットを作った場合は、INTER鯖パケット.txtに書いてください

	この機能によるメリット
		map鯖分散にも対応できる
	この機能によるデメリット
		inter鯖経由の全ての命令の動作速度が落ちる
		（一回inter鯖まで渡すため）
		鯖とクライアントを同じPCで使っているとつらいかも

	(char/)
	char2.c/char.h
		mapif_sendall()追加（全MAP鯖にパケットを送る）
		mapif_send()追加（特定MAP鯖に送る：生存判定付き）
		parse_frommap()でinter_parse_frommap()を呼ぶようにした
		(inter鯖のmap鯖解析部をchar鯖に寄生させたことになる)
	inter.h/inter.c
		新規追加。inter鯖の中核。
		inter_parse_frommapでMAP鯖からのパケットを解析します。
	int_party.h/int_party.c/int_guild.h/int_guild.c
		新規追加。今後のための予約。パーティやギルド機能用
		initでデータを読んで、saveで保存すべき？
		saveはまだ呼ばれない。parseでパケット解析。
		common/mmo.hあたりでパーティーやギルドの構造体を
		定義する必要があると思われる。
	INTER鯖パケット.txt
		パケットのリスト
	
	(map/)
	intif.h/intif.c
		inter鯖と通信する部分。
		inter_parse()でinter鯖からのパケットを解析します。
		inter鯖へデータを送るときはinter_fdを使います。
	chrif.h/chrif.c
		chrif_parse()でinter_parse()を呼ぶようにした
		（intif.cのinter鯖解析部をchar鯖解析部に寄生させたことになる)

・@kamiコマンドをinter鯖経由に変更
	原理としては次のような感じです
	クライアント＝＞map鯖＝＞inter鯖＝＞全map鯖＝＞全クライアント
	
	(char/)
	inter.c
		mapif_GMmessage()追加
	(map/)
	intif.h/intif.c
		intif_GMmessage()追加
		intif_parseでGMメッセージの処理を追加
	clif.c/clif.h
		clif_GMmessage()の引数を変更
	atcommand.c
		@kami部分でintif_GMmessage()を呼ぶようにした

・Wisをinter鯖経由に変更
	原理としては次のような感じです
	
	送り主クライアント＝＞送り主map鯖＝＞inter鯖＝＞全マップ鯖＝＞(分岐A)
	[分岐A]
	1.相手の人いるmap鯖＝＞相手のクライアント
	　　　　〃　　   　＝＞inter鯖＝＞送り主map鯖＝＞送り主クライアント 
	2.相手のいないmap鯖＝＞inter鯖（分岐B）
	[分岐B]
	1.全map鯖が応答したinter鯖 ＝＞送り主map鯖＝＞送り主クライアント
	2.(全部は応答してないときは、全map鯖の応答を待つ)

	ものすごい複雑になってますね。

	(char/)
	inter.c
		struct WisList 定義（Wisデータのリンクリスト）
		add_wislist(),del_wislist(),search_wislist(),
		check_ttl_wislist()追加,リンクリストを扱う関数群
		mapif_wis_message(),mapif_wis_end()追加
	(map/)
	intif.h/intif.c
		intif_wis_message(),intif_wis_end()追加
		intif_parse_WisMessage()追加,intif_parse()から呼ばれるように
	clif.c/clif.h
		clif_wis_message(),clif_wis_end()追加
		clif_parse_Wis()を変更,intif_wis_message()を呼ぶようにした

・スキル使用時のヒット数/消費SP所得のバグ修正
	skill.c
		skill_get_sp(),skill_get_num()で参照する配列インデックスをlv-1にした


----------
//0216 by 胡蝶蘭

いつもどおりテストほとんどしてないので、バグ大量かも。

・0213の修正？のよくわからないところ修正
	itemdb.c
		コンパイルが通らないのでitemdb_equipointの引数リスト変更

・Athena dev 2.1.1の適用
	dev-2.1.1で適用された修正を適用しました

	timer.c
		2.1.1のものと差し替え
	script.c
		C_NE: の修正の適用
	README
		最後の文章を2.1.1のものに差し替え

・スキルデータベースの修正
	一部の消費SPやヒット数などを修正。

	skill_db.txt
		該当個所の修正

・スキル攻撃の実装変更＆追加実装
	バッシュ、メマーナイト、ダブルストレイフィング、ピアース
	スピアブーメラン、スピアスタブ、ボーリングバッシュ
	ソニックブロー、グリムトゥース などの実装変更

	ナパームビート、ソウルストライク、
	ファイヤーボルト、コールドボルト、ライトニングボルト、アーススパイク、
	ユピテルサンダー などを追加実装
	（全て、範囲攻撃やステータス異常などは未実装）

	pc.c/pc.h
		0213の変更をなかったことにした
		pc_attack_mob()の修正、計算はbattle_calc_weapon_attack()に任せ、
		その計算結果を適用するだけに変更
	clif.c/clif.h
		clif_skill_fail(),clif_skill_damage(),clif_skill_damage2()追加
		それぞれ使用失敗、使用エフェクト、吹き飛ばし付き使用エフェクト
	skill.c/skill.h
		0213の変更をなかったことにした（ダメージ倍率計算がおかしい）
		skill_castend_id()にSP/Zeny確認と消費部分を追加、
		種類別に処理を追加。
	battle.c/battle.h
		新規追加
		武器攻撃計算用にbattle_calc_weapon_attack(),
		魔法攻撃計算用にbattle_calc_magic_attack()を用意
		（双方とも、MOBとPC両方計算可能なはず）
		ファイル増やしすぎという意見も…(汗)


----------
//0214 by れあ
・ダブルアタックがおかしかったところを修正。
・スキルの一部実装
	バッシュ・メマーナイト・ダブルストレイフィング・ピアース
	スピアブーメラン・スピアスタブ・ボーリングバッシュ
	ソニックブロー・グリムトゥースなどです。

	適当なのでどこか、不具合があるかもしれません。
	あと、テストもあまりしてませんのでおかしいところがあったら修正をお願いします。
	他にも問題があったら手直しをお願いします。
	変更内容は以下の通りです。

	clif.c,clif.h
		clif_skill_damage()を追加しました。

	pc.c,pc.h
		pc_attack_mob()の引数を一つ追加。
		ダブルアタックがおかしかったので正常に動作するように修正。

	skill.c
		一部スキルの実装をしてみました。


----------
//0213 by れあ
・0208の＠コマンドで少し修正
	atcommand.c
		@itemで個数指定が無い場合、入手個数を１個にするようにした。
		@itemでIDの指定が無い場合、アイテムを入手してたことになって
		いたのを修正
	itemdb.c
		item_db.txtでSellの項目を店売りの値段としてみた。
	item_db2.txt
		試しにカードやレアアイテムの店売り価格を値段を本鯖の相場にし
		てみたもの。使用する場合はitem_db.txtと差し替えてください。


----------
//0208 by nabe

・＠コマンド実装。
	atcommand.h,atcommand.c
		ほぼI-Athenaの＠コマンド相当ですが、@GMとPVPは未実装です。
		help.txtも同梱しています。
		GM（アカウントID＝704554〜704583）専用にするには、
		atcommand.cの該当部分のコメントアウトを解除して下さい。
	clif.h,clif.c
		clif_displaymessage()
		clif_GMmessage()
		clif_heal()
		clif_resurrection()
		clif_pvpon()
		clif_pvpset()
		clif_refine()
		を追加しました。
		clif_parse_GlobalMessage()内でatcommand()を呼んでいます。

・ちょっとだけ修正。
	script.c
		{buildin_openstorage,"openstorage","s"},
		から
		{buildin_openstorage,"openstorage",""},
		に修正しました。


----------
//0206 by 胡蝶蘭
・スキルツリー/スキル使用機構の実装
	mmo.h
		MAX_SKILLを増やした
	char2.c
		mmo_char_fromstr()
		mmo_charstatusのskillのインデックスにスキル番号を使うようにした
		=>スキルの検索高速化のため（かわりにメモリ使用量が増える）
	pc.h/pc.c
		pc_skillup(),pc_calc_skilltree()追加
		pc_checkskill()変更（インデックスをスキル番号に）
		pc_readdb()でskill_db.txtも読むようにした
		pc_authok()でcast_timerを初期化するようにした
		pc_calcstatus()でpc_calc_skilltree()とclif_skillinfoblock()を
		呼ぶようにした
	clif.c/clif.h
		clif_skillinfoblock(),clif_skillcasting(),
		clif_skillup()を追加
		clif_parse_SkillUp(),clif_parse_UseSkillToId(),
		clif_parse_UseSkillToPos()を実装
	skill.h/skill.c
		ファイル追加(map/)
	map.h
		struct map_session_dataにcast_*を追加
	skill_db.txt
		ファイル追加(db/)
		(I-Athena0200のskill_info2.txtをコンバートしたもの)
	(スキル使用部分開発者向け情報)
		スキルの効果を実装する場所はskill.cの
		skill_castend_id(),skill_castend_pos()です。
		ターゲットや使用スキルは sd->cast_* から得ます
		スキルデータベースへは skill_get_* でアクセスしてください
		今後、キャスティングタイムもデータベースに入れる予定

----------
//0205 by nabe

・storage.cのバグフィクス。
・倉庫データを、マップ鯖起動時に読み、マップ鯖終了時に書くように変更。
	storage.h,storage.c
		storage_init()をdo_init_storage()に改名。
		storage_save()をdo_final_storage()に改名。
		fcloseを忘れていたのを追加。
	map.c
		#include "storage.h"を追加。
		do_final()にdo_final_storage()を追加。
		do_init()にdo_init_storage()を追加。

----------

//0203(unofficial) by なみ 

item_db.txtの書き換えのみです。

・アイテムの回復量を追加/変更
	赤ポーション　　　　　　　　　HP  30- 44
	紅ポーション　　　　　　　　　HP  70- 89
	黄色いポーション　　　　　　　HP 175-234
	白いポーション　　　　　　　　HP 350-429
	青いポーション　　　　　　　　SP  40- 99
	赤いハーブ　　　　　　　　　　HP  12- 19
	黄色いハーブ　　　　　　　　　HP  21- 29
	白いハーブ　　　　　　　　　　HP  80-111
	青いハーブ　　　　　　　　　　SP  15- 44
	リンゴ　　　　　　　　　　　　HP  12- 15
	バナナ　　　　　　　　　　　　HP  11- 16
	ブドウ　　　　　　　　　　　　SP  10- 24
	いも　　　　　　　　　　　　　HP  11- 15
	にく　　　　　　　　　　　　　HP  70- 99
	ハチの蜜　　　　　　　　　　　HP  72- 97 / SP  20- 59
	ミルク　　　　　　　　　　　　HP  25- 34
	キャンディ　　　　　　　　　　HP  31- 74
	スティックキャンディ　　　　　HP  46-109
	リンゴジュース　　　　　　※　HP  28- 32
	バナナジュース　　　　　　　　HP  27- 33
	ブドウジュース　　　　　　　　SP  15- 39
	ニンジンジュース　　　　　※　HP  29- 32
	カボチャ　　　　　　　　　　　HP  14
	ペットフード　　　　　　　　　HP  53- 83
	よく焼いたクッキー　　　　　　HP  80-177
	ひとくちケーキー　　　　　　　HP 251-359
	ひなあられ　　　　　　　　　　HP 175-234
	菱餅　　　　　　　　　　　　　HP 350-429
	レッドスリムポーション　　※　HP  30- 44
	イエロスリムポーション　　※　HP 175-234
	ホワイトスリムポーション　※　HP 350-429
　現在のAthenaではVITやスキルによるボーナスは加味されません。
　（適用する場合はscript.c内のbuildin_heal関数あたりにに手を加える必要あり）
　なお、※付のアイテムのデータは適当です。
・古いカード帖を実装(UseScript)
・その他修正
　　ひなあられ　　　　　　　　　　重量なし→重量0.1に修正
　　菱餅　　　　　　　　　　　　　重量なし→重量0.1に修正
　　バルムン　　　　　　　　　　　重量0.1S4片手剣→重量100S0両手剣に修正
　なお、Sellの項目はあるだけ無駄っぽいので全部消しました。

----------

//0202 by nabe

・カプラ倉庫の「同一アカウントなのに共有できないバグ」を改良しました。
	各キャラに倉庫データを持たせるのは無駄が多い気がするので、
	アカウントIDで管理するように仕様を変更しました。
	ついでに、倉庫データは全てstorage.cでまかない、
	char鯖は関与しないようにしました。
	これに伴い、char_athena.cnf,mmo.h,char2.cは元に戻しました。
	また、倉庫ファイル名は“storage.txt”に固定しています。

	改変、追加したのは次のファイルです。
	map/storage.h,
	map/storage.c,
	map/clif.h,//引数変更だけ
	map/clif.c,//引数変更だけ
	conf/char_athena.cnf,//元に戻しただけ
	common/mmo.h,//元に戻しただけ
	char/char2.c,//元に戻しただけ
	map/itemdb.h,//itemdb_equippoint()引数宣言変更だけ
	map/itemdb.c,//itemdb_equippoint()引数宣言変更だけ
	map/pc.c,//itemdb_equippoint()引数宣言変更だけ

----------

//0201 by nabe

・カプラ倉庫を実装しました。

	スクリプトから呼び出すには、スクリプト内で
		openstorage;
	としてください。
	サンプルとしてnpc_kafraJ.txtを付けてあります。
	併せてnpc_script3J.txtの該当部分も改変しました。

	char_athena.cnfの
		stor_txt: 
	で倉庫ファイル名を指定しています。

	改変、追加したのは次のファイルです。
	map/Makefile,
	map/storage.c,
	map/storage.h,
	map/clif.c,
	map/clif.h,
	map/script.c,
	char/char2.c,
	common/mmo,h
	詳しくは、上記ファイルのコメントなどを参考にしてください。

・カプラ倉庫実装に伴い、map_athena1.cnfを少し書き換えました。

・全てのコメント文をEUCからSJISに変換しました。

----------

    Athena Dev. v2.1.1       Released: Middle July, 2003
    (c) 2003 Athena Project.
     http://project-yare.de/

1. Athena(アテナ)について
2. このリリースについて
3. 必要な物
4. 使い方
5. 現在の仕様
6. 祝辞
7. 免責事項
8. 募集
9. English


1. アテナについて
    アテナとは2003年1月半ばにでた0052.lzhをベースとして作られているエミュレータの一つです。
    基本的なライセンスはオリジナルがGPLの下に配布されている為、
    これに従いGPLの下配布を許可します。
    /*
        改良版を配布する場合は必ずこのREADMEを書き換えてください。
        何処を改良したのか報告(athena@project-yare.deまで)して貰えると助かります。
        バイナリのみの配布はGPL違反ですので"必ず"ソースも添付してください。
     */
    動作の確認は以下の通りのみ行っています。
    // ただし完璧に動く事を保証するものでありません
    対象CPU: Intel Pentium系   // PentiumII以上で確認.
        FreeBSD 4.8R, 4.6.2R
        Linux RedHat 7.3
        cygwin + gcc 3.2 20020927 (prerelease)
    開発元URL: http://project-yare.de/


2. このリリースについて
    今回のリリースは前回(V2.1)同様開発版のリリースのみです。
    2.1に比べ下記の点が修正されています。
        mapのデフォルト設定が韓国data.grfのみ正常に動作するようになっていた点
        common/timer.cやmap/script.cの幾つかのバグ

    迅速にUpdateを強く推奨するものではありませんが各自の判断で行って下さい。


3. 必要な物
    data.grf      //sdata.grfは必要に応じて
    account.txt   //存在しない場合athena.shが自動生成します
    conf/*.cnf    //Map用とChar用の二種類あります
    conf/npc*.txt //npc設定用ファイルです。複数のファイルに分けることが可能です。
    db/*.txt      //アイテム、job情報など


4. 使い方
    > tar xvfz athena-d?.?.tar.gz
    > cd athena-d?.?.tar.gz
    > make
    > vi conf/char_athena.cnf       //IP(127.0.0.1)の部分を環境に合わせて変更してください
    > vi conf/map_athena.cnf        //同上、またmap設定などは、このファイルで行います。
    > ./athena.sh
    上記を行えば"たぶん"起動します。

    補足:
    conf/npc_sampleJ.txtにはスクリプトの書き方について色々な説明が記載されています。
    もし、独自のMap設定を行ってみたい人や、スクリプトを弄りたい方は参考にしてください。
    ただし、開発中のためスクリプトの仕様が変更される可能性が高いです。
    command.txtには実装済みの特殊コマンドについての説明を記載しています。


5. 現在の仕様
    本鯖と比べておかしい(例えばプバが歩く、ポリンがアイテムを拾わないなど)点は、
    全て現在開発中に因るものです。
    現状としてキャラクタ系及びモンスター系のバグ報告は無視される可能性が高いです。

    バグ報告について必ず発生条件をお書き下さい。
    下にある報告用テンプレートを使って報告して頂くと助かります。
    報告先はエミュ板の開発スレにでも。
    ---- Athena v 2.0 (stable or develop) ----
    【gcc ver】gcc -vを実行時に表示される内容
    【動作システム】FreeBSD, Linux(ディストリビュージョンも), cygwinなど
    【発生内容】mapが落ちてしまった時の表示されていたデバッグ情報など具体的に書いてください。
    【操作内容】具体的にどんな操作を行ったかを書いてください。
    ------------------ END -------------------
    理想はテンプレに加えてmap.coreなどcoreファイルをUploaderにアップして頂くことですが
    問題のMapだけの状態にしcoreの吐く容量に注意してください。
    /*
        確認した限りでは324個ほどmapデータを読み込ませると、
         40MB近いcoreファイルを吐き出します @FreeBSD
         cygwinの場合はstackdumpというファイルになるそうです。
        しかし、coreファイルなどをgzip圧縮などすれば大幅に小さくなります。
         大凡30MBのcoreファイルが2.9MBほどになるようです。
        ですので、もしアップロードする場合はgzip圧縮など各自行ってください。
     */

    今回のリリースだけでなくHISTORYを作成すると大量に記述が必要な為省略しています。
    // 多い日だと本当に結構ありますので‥‥。


6. 祝辞
    今回このAthena開発版を出すに当たって感謝したい方々(順番不同)
        Lemming氏 (Project YARE)
        0052氏 (Uploader)
        35氏 (エミュ開発スレ)
        Johan Lindh氏(Author of memwatch)
        YARE forumのNPC情報を作成した方々
        weiss研究会BBSの様々な情報ファイルを作成した方々
        最後に、.coreファイル達


7. 免責事項
    Athena Projectは一切Athenaの動作に関する保証等は行いません。
    つまり、Athenaは無保証です。
    athena@project-yare.deに動作・操作等に関する質問などを送られても一切お答えできません。
    又Athenaを用いたことにより生じた被害・問題等の責任は一切Athena Projectは負いません。


8. 募集
    athenaの開発に参加したい//興味があるという方ご連絡下さい。
    我々は貴方の参加をお待ちしています。
    // 最新版が欲しいだけで何ら協力して頂けないという方はお断りです;-)
    [募集要項: プログラマ(2-3人)]
        年齢: 不問
        性別: 不問
        言語: 日本語が理解可能
        内容: C言語もしくはC++による開発。(特にネットワークやDBの経験が有る方大募集!)
    [募集要項: 翻訳(?人)]
        年齢: 不問
        性別: 不問
        言語: 日本語、英語が理解可能
        内容: 仏蘭西語、独逸語、西班牙語、伊太利亜語、泰(タイ)語、朝鮮語、中国語へ文献、サイトなどの翻訳
    連絡先: athena@project-yare.de 雑務担当まで。


9. English
     This release is just fixed some bugs in timer.c, script.c and map_athena1.conf.


(c) 2003 Athena Project.

